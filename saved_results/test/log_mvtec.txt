下面是正确的(k=i+1)实验结果：cuda:3
cuda:3
shots: 1
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9932, P-AP:0.7317, P-F1:0.7180, P-AUPRO:0.9826
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5442, P-F1:0.5984, P-AUPRO:0.9774
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9886, P-AP:0.4063, P-F1:0.4321, P-AUPRO:0.9771
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9722, P-AP:0.7033, P-F1:0.7342, P-AUPRO:0.9093
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9656, P-AP:0.6893, P-F1:0.6832, P-AUPRO:0.9223
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9787, P-AP:0.8433, P-F1:0.7947, P-AUPRO:0.9508
cable: I-Auroc:0.9387, I-AP:0.9702, I-F1:0.9143, P-AUROC:0.9292, P-AP:0.6245, P-F1:0.6517, P-AUPRO:0.8544
capsule: I-Auroc:0.7786, I-AP:0.9437, I-F1:0.9106, P-AUROC:0.9623, P-AP:0.3730, P-F1:0.4119, P-AUPRO:0.9384
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9929, P-AUROC:0.9902, P-AP:0.7530, P-F1:0.7466, P-AUPRO:0.9599
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.8958, P-AP:0.6169, P-F1:0.6178, P-AUPRO:0.8785
pill: I-Auroc:0.9689, I-AP:0.9944, I-F1:0.9682, P-AUROC:0.8993, P-AP:0.5245, P-F1:0.5504, P-AUPRO:0.9404
screw: I-Auroc:0.9238, I-AP:0.9749, I-F1:0.9127, P-AUROC:0.9878, P-AP:0.4830, P-F1:0.5147, P-AUPRO:0.9454
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9920, P-AP:0.7254, P-F1:0.7089, P-AUPRO:0.9549
transistor: I-Auroc:0.9512, I-AP:0.9239, I-F1:0.9157, P-AUROC:0.8461, P-AP:0.3737, P-F1:0.3924, P-AUPRO:0.6657
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9430, P-AP:0.5292, P-F1:0.5292, P-AUPRO:0.8720
Mean: I-Auroc:0.9702, I-AP:0.9869, I-F1:0.9725, P-AUROC:0.9559, P-AP:0.5947, P-F1:0.6056, P-AUPRO:0.9153
cuda:3
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9930, P-AP:0.7177, P-F1:0.7109, P-AUPRO:0.9815
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5459, P-F1:0.5965, P-AUPRO:0.9776
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9881, P-AP:0.3875, P-F1:0.4157, P-AUPRO:0.9767
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9729, P-AP:0.7055, P-F1:0.7369, P-AUPRO:0.9075
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9681, P-AP:0.6880, P-F1:0.6789, P-AUPRO:0.9273
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9834, P-AP:0.8569, P-F1:0.8095, P-AUPRO:0.9592
cable: I-Auroc:0.9472, I-AP:0.9738, I-F1:0.9205, P-AUROC:0.9369, P-AP:0.6435, P-F1:0.6643, P-AUPRO:0.8710
capsule: I-Auroc:0.8073, I-AP:0.9519, I-F1:0.9304, P-AUROC:0.9634, P-AP:0.3895, P-F1:0.4336, P-AUPRO:0.9444
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9916, P-AP:0.7718, P-F1:0.7559, P-AUPRO:0.9658
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.9209, P-AP:0.6809, P-F1:0.6904, P-AUPRO:0.8999
pill: I-Auroc:0.9744, I-AP:0.9954, I-F1:0.9645, P-AUROC:0.9041, P-AP:0.5401, P-F1:0.5597, P-AUPRO:0.9466
screw: I-Auroc:0.9182, I-AP:0.9737, I-F1:0.9138, P-AUROC:0.9883, P-AP:0.4940, P-F1:0.5277, P-AUPRO:0.9552
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9913, P-AP:0.7108, P-F1:0.6951, P-AUPRO:0.9598
transistor: I-Auroc:0.9542, I-AP:0.9335, I-F1:0.9157, P-AUROC:0.8621, P-AP:0.3878, P-F1:0.4033, P-AUPRO:0.6877
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9958, P-AUROC:0.9449, P-AP:0.5382, P-F1:0.5374, P-AUPRO:0.8675
Mean: I-Auroc:0.9728, I-AP:0.9883, I-F1:0.9737, P-AUROC:0.9602, P-AP:0.6039, P-F1:0.6144, P-AUPRO:0.9219
cuda:3
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9931, P-AP:0.7132, P-F1:0.7128, P-AUPRO:0.9813
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5414, P-F1:0.5958, P-AUPRO:0.9771
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9880, P-AP:0.3854, P-F1:0.4126, P-AUPRO:0.9757
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9735, P-AP:0.7107, P-F1:0.7392, P-AUPRO:0.9091
wood: I-Auroc:0.9912, I-AP:0.9972, I-F1:0.9756, P-AUROC:0.9683, P-AP:0.6961, P-F1:0.6798, P-AUPRO:0.9190
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9852, P-AP:0.8658, P-F1:0.8135, P-AUPRO:0.9612
cable: I-Auroc:0.9698, I-AP:0.9833, I-F1:0.9318, P-AUROC:0.9421, P-AP:0.6586, P-F1:0.6692, P-AUPRO:0.8774
capsule: I-Auroc:0.9629, I-AP:0.9924, I-F1:0.9550, P-AUROC:0.9688, P-AP:0.5217, P-F1:0.5246, P-AUPRO:0.9577
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9930, P-AP:0.7983, P-F1:0.7678, P-AUPRO:0.9692
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9246, P-AP:0.6950, P-F1:0.7051, P-AUPRO:0.9034
pill: I-Auroc:0.9722, I-AP:0.9950, I-F1:0.9712, P-AUROC:0.9073, P-AP:0.5406, P-F1:0.5641, P-AUPRO:0.9471
screw: I-Auroc:0.9154, I-AP:0.9706, I-F1:0.9170, P-AUROC:0.9906, P-AP:0.5174, P-F1:0.5362, P-AUPRO:0.9617
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.7245, P-F1:0.7121, P-AUPRO:0.9652
transistor: I-Auroc:0.9658, I-AP:0.9536, I-F1:0.9176, P-AUROC:0.8708, P-AP:0.3934, P-F1:0.4081, P-AUPRO:0.6971
zipper: I-Auroc:0.9989, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9528, P-AP:0.5633, P-F1:0.5615, P-AUPRO:0.8850
Mean: I-Auroc:0.9846, I-AP:0.9926, I-F1:0.9762, P-AUROC:0.9630, P-AP:0.6217, P-F1:0.6268, P-AUPRO:0.9258

-------------------------------------------------------------------------------------------------------------------------------------

# 以下变换后的检测；brightness=1.1, contrast=1.1, saturation=1.1
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
7:3

cuda:3
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7819, P-F1:0.7313, P-AUPRO:0.9830
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9933, P-AP:0.5213, P-F1:0.5636, P-AUPRO:0.9762
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4271, P-F1:0.4786, P-AUPRO:0.9758
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9940, P-AUROC:0.9744, P-AP:0.7203, P-F1:0.7463, P-AUPRO:0.9022
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9639, P-AP:0.6775, P-F1:0.6626, P-AUPRO:0.9215
bottle: I-Auroc:0.9944, I-AP:0.9983, I-F1:0.9844, P-AUROC:0.9655, P-AP:0.7823, P-F1:0.7405, P-AUPRO:0.9297
cable: I-Auroc:0.8949, I-AP:0.9483, I-F1:0.8655, P-AUROC:0.9243, P-AP:0.5179, P-F1:0.5523, P-AUPRO:0.8197
capsule: I-Auroc:0.9274, I-AP:0.9842, I-F1:0.9397, P-AUROC:0.9780, P-AP:0.5074, P-F1:0.4979, P-AUPRO:0.9624
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9928, P-AUROC:0.9895, P-AP:0.7668, P-F1:0.7412, P-AUPRO:0.9496
metal_nut: I-Auroc:0.9677, I-AP:0.9930, I-F1:0.9529, P-AUROC:0.9026, P-AP:0.6494, P-F1:0.6376, P-AUPRO:0.8553
pill: I-Auroc:0.9809, I-AP:0.9967, I-F1:0.9714, P-AUROC:0.9124, P-AP:0.5234, P-F1:0.5582, P-AUPRO:0.9483
screw: I-Auroc:0.6177, I-AP:0.8014, I-F1:0.8686, P-AUROC:0.9664, P-AP:0.2150, P-F1:0.2810, P-AUPRO:0.8784
toothbrush: I-Auroc:0.9861, I-AP:0.9952, I-F1:0.9831, P-AUROC:0.9926, P-AP:0.7537, P-F1:0.7231, P-AUPRO:0.9501
transistor: I-Auroc:0.9742, I-AP:0.9539, I-F1:0.9136, P-AUROC:0.8744, P-AP:0.4567, P-F1:0.4577, P-AUPRO:0.7028
zipper: I-Auroc:0.9958, I-AP:0.9989, I-F1:0.9874, P-AUROC:0.9702, P-AP:0.5964, P-F1:0.5936, P-AUPRO:0.9200
Mean: I-Auroc:0.9550, I-AP:0.9777, I-F1:0.9620, P-AUROC:0.9595, P-AP:0.5931, P-F1:0.5977, P-AUPRO:0.9117
cuda:3
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7657, P-F1:0.7181, P-AUPRO:0.9817
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5350, P-F1:0.5755, P-AUPRO:0.9771
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4083, P-F1:0.4734, P-AUPRO:0.9755
tile: I-Auroc:0.9968, I-AP:0.9988, I-F1:0.9940, P-AUROC:0.9745, P-AP:0.7184, P-F1:0.7439, P-AUPRO:0.9025
wood: I-Auroc:0.9982, I-AP:0.9994, I-F1:0.9917, P-AUROC:0.9658, P-AP:0.6723, P-F1:0.6604, P-AUPRO:0.9240
bottle: I-Auroc:0.9976, I-AP:0.9992, I-F1:0.9921, P-AUROC:0.9732, P-AP:0.8040, P-F1:0.7557, P-AUPRO:0.9443
cable: I-Auroc:0.9485, I-AP:0.9721, I-F1:0.8990, P-AUROC:0.9459, P-AP:0.5779, P-F1:0.6008, P-AUPRO:0.8670
capsule: I-Auroc:0.9318, I-AP:0.9849, I-F1:0.9561, P-AUROC:0.9782, P-AP:0.5171, P-F1:0.5048, P-AUPRO:0.9650
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9859, P-AUROC:0.9897, P-AP:0.7682, P-F1:0.7454, P-AUPRO:0.9562
metal_nut: I-Auroc:0.9844, I-AP:0.9964, I-F1:0.9730, P-AUROC:0.9255, P-AP:0.7145, P-F1:0.7036, P-AUPRO:0.8821
pill: I-Auroc:0.9798, I-AP:0.9965, I-F1:0.9686, P-AUROC:0.9183, P-AP:0.5341, P-F1:0.5627, P-AUPRO:0.9509
screw: I-Auroc:0.6487, I-AP:0.8122, I-F1:0.8750, P-AUROC:0.9641, P-AP:0.2135, P-F1:0.2731, P-AUPRO:0.8811
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9922, P-AP:0.7346, P-F1:0.7093, P-AUPRO:0.9570
transistor: I-Auroc:0.9833, I-AP:0.9703, I-F1:0.9383, P-AUROC:0.8929, P-AP:0.4825, P-F1:0.4763, P-AUPRO:0.7315
zipper: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9706, P-AP:0.6019, P-F1:0.5976, P-AUPRO:0.9193
Mean: I-Auroc:0.9628, I-AP:0.9814, I-F1:0.9689, P-AUROC:0.9646, P-AP:0.6032, P-F1:0.6067, P-AUPRO:0.9210
cuda:3
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7703, P-F1:0.7183, P-AUPRO:0.9814
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5274, P-F1:0.5679, P-AUPRO:0.9761
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4026, P-F1:0.4649, P-AUPRO:0.9739
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9748, P-AP:0.7174, P-F1:0.7438, P-AUPRO:0.9045
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9833, P-AUROC:0.9661, P-AP:0.6758, P-F1:0.6645, P-AUPRO:0.9219
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9765, P-AP:0.8147, P-F1:0.7667, P-AUPRO:0.9480
cable: I-Auroc:0.9792, I-AP:0.9878, I-F1:0.9468, P-AUROC:0.9532, P-AP:0.5989, P-F1:0.6164, P-AUPRO:0.8772
capsule: I-Auroc:0.9860, I-AP:0.9970, I-F1:0.9772, P-AUROC:0.9820, P-AP:0.5649, P-F1:0.5565, P-AUPRO:0.9713
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.8059, P-F1:0.7669, P-AUPRO:0.9645
metal_nut: I-Auroc:0.9941, I-AP:0.9986, I-F1:0.9789, P-AUROC:0.9322, P-AP:0.7410, P-F1:0.7280, P-AUPRO:0.8888
pill: I-Auroc:0.9765, I-AP:0.9959, I-F1:0.9673, P-AUROC:0.9220, P-AP:0.5415, P-F1:0.5715, P-AUPRO:0.9524
screw: I-Auroc:0.6876, I-AP:0.8417, I-F1:0.8881, P-AUROC:0.9703, P-AP:0.2672, P-F1:0.3419, P-AUPRO:0.8930
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7451, P-F1:0.7257, P-AUPRO:0.9621
transistor: I-Auroc:0.9900, I-AP:0.9842, I-F1:0.9639, P-AUROC:0.9003, P-AP:0.4950, P-F1:0.4842, P-AUPRO:0.7445
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9739, P-AP:0.6084, P-F1:0.6058, P-AUPRO:0.9305
Mean: I-Auroc:0.9731, I-AP:0.9867, I-F1:0.9784, P-AUROC:0.9677, P-AP:0.6184, P-F1:0.6215, P-AUPRO:0.9260

-------------------------------------------------------------------------------------------------------------------------------------

# 以下变换后的检测；brightness=1.2, contrast=1.2, saturation=1.2
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug

cuda:3
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7824, P-F1:0.7315, P-AUPRO:0.9831
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9933, P-AP:0.5202, P-F1:0.5624, P-AUPRO:0.9763
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4263, P-F1:0.4802, P-AUPRO:0.9762
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9940, P-AUROC:0.9750, P-AP:0.7242, P-F1:0.7478, P-AUPRO:0.9079
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9635, P-AP:0.6753, P-F1:0.6606, P-AUPRO:0.9227
bottle: I-Auroc:0.9944, I-AP:0.9983, I-F1:0.9844, P-AUROC:0.9654, P-AP:0.7821, P-F1:0.7404, P-AUPRO:0.9293
cable: I-Auroc:0.8951, I-AP:0.9489, I-F1:0.8712, P-AUROC:0.9232, P-AP:0.5169, P-F1:0.5525, P-AUPRO:0.8184
capsule: I-Auroc:0.9326, I-AP:0.9855, I-F1:0.9397, P-AUROC:0.9778, P-AP:0.5024, P-F1:0.4951, P-AUPRO:0.9641
hazelnut: I-Auroc:0.9986, I-AP:0.9992, I-F1:0.9928, P-AUROC:0.9894, P-AP:0.7654, P-F1:0.7408, P-AUPRO:0.9499
metal_nut: I-Auroc:0.9687, I-AP:0.9932, I-F1:0.9524, P-AUROC:0.9019, P-AP:0.6482, P-F1:0.6358, P-AUPRO:0.8547
pill: I-Auroc:0.9801, I-AP:0.9965, I-F1:0.9714, P-AUROC:0.9127, P-AP:0.5200, P-F1:0.5584, P-AUPRO:0.9468
screw: I-Auroc:0.6204, I-AP:0.8029, I-F1:0.8686, P-AUROC:0.9670, P-AP:0.2192, P-F1:0.2850, P-AUPRO:0.8816
toothbrush: I-Auroc:0.9861, I-AP:0.9952, I-F1:0.9831, P-AUROC:0.9926, P-AP:0.7541, P-F1:0.7244, P-AUPRO:0.9499
transistor: I-Auroc:0.9750, I-AP:0.9546, I-F1:0.9231, P-AUROC:0.8733, P-AP:0.4551, P-F1:0.4573, P-AUPRO:0.7022
zipper: I-Auroc:0.9958, I-AP:0.9989, I-F1:0.9874, P-AUROC:0.9706, P-AP:0.5981, P-F1:0.5946, P-AUPRO:0.9219
Mean: I-Auroc:0.9556, I-AP:0.9779, I-F1:0.9630, P-AUROC:0.9593, P-AP:0.5927, P-F1:0.5978, P-AUPRO:0.9123
cuda:3
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7665, P-F1:0.7181, P-AUPRO:0.9814
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5344, P-F1:0.5747, P-AUPRO:0.9770
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9902, P-AP:0.4063, P-F1:0.4736, P-AUPRO:0.9755
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9940, P-AUROC:0.9748, P-AP:0.7202, P-F1:0.7448, P-AUPRO:0.9021
wood: I-Auroc:0.9965, I-AP:0.9989, I-F1:0.9833, P-AUROC:0.9656, P-AP:0.6721, P-F1:0.6592, P-AUPRO:0.9213
bottle: I-Auroc:0.9976, I-AP:0.9992, I-F1:0.9921, P-AUROC:0.9731, P-AP:0.8039, P-F1:0.7556, P-AUPRO:0.9441
cable: I-Auroc:0.9464, I-AP:0.9710, I-F1:0.8989, P-AUROC:0.9453, P-AP:0.5772, P-F1:0.6015, P-AUPRO:0.8626
capsule: I-Auroc:0.9382, I-AP:0.9866, I-F1:0.9561, P-AUROC:0.9782, P-AP:0.5127, P-F1:0.5026, P-AUPRO:0.9648
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9859, P-AUROC:0.9896, P-AP:0.7670, P-F1:0.7451, P-AUPRO:0.9559
metal_nut: I-Auroc:0.9844, I-AP:0.9964, I-F1:0.9730, P-AUROC:0.9251, P-AP:0.7139, P-F1:0.7024, P-AUPRO:0.8826
pill: I-Auroc:0.9809, I-AP:0.9967, I-F1:0.9720, P-AUROC:0.9188, P-AP:0.5297, P-F1:0.5617, P-AUPRO:0.9522
screw: I-Auroc:0.6505, I-AP:0.8134, I-F1:0.8750, P-AUROC:0.9645, P-AP:0.2144, P-F1:0.2718, P-AUPRO:0.8805
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9922, P-AP:0.7358, P-F1:0.7106, P-AUPRO:0.9570
transistor: I-Auroc:0.9842, I-AP:0.9713, I-F1:0.9302, P-AUROC:0.8926, P-AP:0.4826, P-F1:0.4764, P-AUPRO:0.7302
zipper: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9709, P-AP:0.6029, P-F1:0.5982, P-AUPRO:0.9201
Mean: I-Auroc:0.9633, I-AP:0.9816, I-F1:0.9681, P-AUROC:0.9645, P-AP:0.6026, P-F1:0.6064, P-AUPRO:0.9205
cuda:3
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7707, P-F1:0.7181, P-AUPRO:0.9807
grid: I-Auroc:0.9908, I-AP:0.9972, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5274, P-F1:0.5676, P-AUPRO:0.9765
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9902, P-AP:0.4019, P-F1:0.4658, P-AUPRO:0.9743
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9751, P-AP:0.7195, P-F1:0.7447, P-AUPRO:0.9008
wood: I-Auroc:0.9930, I-AP:0.9979, I-F1:0.9833, P-AUROC:0.9657, P-AP:0.6753, P-F1:0.6640, P-AUPRO:0.9190
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9764, P-AP:0.8148, P-F1:0.7668, P-AUPRO:0.9480
cable: I-Auroc:0.9786, I-AP:0.9875, I-F1:0.9418, P-AUROC:0.9528, P-AP:0.5978, P-F1:0.6165, P-AUPRO:0.8779
capsule: I-Auroc:0.9876, I-AP:0.9973, I-F1:0.9818, P-AUROC:0.9819, P-AP:0.5601, P-F1:0.5538, P-AUPRO:0.9712
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9928, P-AP:0.8049, P-F1:0.7664, P-AUPRO:0.9645
metal_nut: I-Auroc:0.9936, I-AP:0.9985, I-F1:0.9789, P-AUROC:0.9319, P-AP:0.7405, P-F1:0.7269, P-AUPRO:0.8892
pill: I-Auroc:0.9793, I-AP:0.9964, I-F1:0.9677, P-AUROC:0.9220, P-AP:0.5379, P-F1:0.5707, P-AUPRO:0.9522
screw: I-Auroc:0.6874, I-AP:0.8419, I-F1:0.8881, P-AUROC:0.9706, P-AP:0.2673, P-F1:0.3407, P-AUPRO:0.8925
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7461, P-F1:0.7263, P-AUPRO:0.9621
transistor: I-Auroc:0.9900, I-AP:0.9840, I-F1:0.9639, P-AUROC:0.9002, P-AP:0.4957, P-F1:0.4849, P-AUPRO:0.7450
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9742, P-AP:0.6097, P-F1:0.6067, P-AUPRO:0.9311
Mean: I-Auroc:0.9732, I-AP:0.9867, I-F1:0.9788, P-AUROC:0.9676, P-AP:0.6180, P-F1:0.6213, P-AUPRO:0.9257

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=1.1, contrast=1.1, saturation=1.1
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
5:5
不行的！
cuda:3
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7731, P-F1:0.7253, P-AUPRO:0.9772
grid: I-Auroc:0.9908, I-AP:0.9972, I-F1:0.9912, P-AUROC:0.9919, P-AP:0.4999, P-F1:0.5284, P-AUPRO:0.9742
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9946, P-AUROC:0.9903, P-AP:0.4324, P-F1:0.4769, P-AUPRO:0.9698
tile: I-Auroc:0.9906, I-AP:0.9972, I-F1:0.9940, P-AUROC:0.9751, P-AP:0.7268, P-F1:0.7487, P-AUPRO:0.8867
wood: I-Auroc:0.9965, I-AP:0.9989, I-F1:0.9833, P-AUROC:0.9624, P-AP:0.6677, P-F1:0.6460, P-AUPRO:0.9143
bottle: I-Auroc:0.9770, I-AP:0.9932, I-F1:0.9606, P-AUROC:0.9425, P-AP:0.6955, P-F1:0.6666, P-AUPRO:0.8852
cable: I-Auroc:0.8703, I-AP:0.9357, I-F1:0.8506, P-AUROC:0.9013, P-AP:0.4150, P-F1:0.4387, P-AUPRO:0.7681
capsule: I-Auroc:0.9613, I-AP:0.9919, I-F1:0.9680, P-AUROC:0.9822, P-AP:0.5292, P-F1:0.5266, P-AUPRO:0.9636
hazelnut: I-Auroc:0.9936, I-AP:0.9966, I-F1:0.9714, P-AUROC:0.9857, P-AP:0.7412, P-F1:0.7117, P-AUPRO:0.9315
metal_nut: I-Auroc:0.9428, I-AP:0.9875, I-F1:0.9405, P-AUROC:0.9013, P-AP:0.6588, P-F1:0.6399, P-AUPRO:0.7979
pill: I-Auroc:0.9782, I-AP:0.9961, I-F1:0.9712, P-AUROC:0.9126, P-AP:0.5094, P-F1:0.5476, P-AUPRO:0.9428
screw: I-Auroc:0.6007, I-AP:0.7932, I-F1:0.8686, P-AUROC:0.9620, P-AP:0.1928, P-F1:0.2579, P-AUPRO:0.8647
toothbrush: I-Auroc:0.9750, I-AP:0.9923, I-F1:0.9831, P-AUROC:0.9913, P-AP:0.7466, P-F1:0.7173, P-AUPRO:0.9336
transistor: I-Auroc:0.9371, I-AP:0.9211, I-F1:0.8642, P-AUROC:0.8481, P-AP:0.4024, P-F1:0.4163, P-AUPRO:0.6655
zipper: I-Auroc:0.9777, I-AP:0.9933, I-F1:0.9712, P-AUROC:0.9778, P-AP:0.5953, P-F1:0.6104, P-AUPRO:0.9356
Mean: I-Auroc:0.9460, I-AP:0.9729, I-F1:0.9538, P-AUROC:0.9545, P-AP:0.5724, P-F1:0.5772, P-AUPRO:0.8940

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug

cuda:3
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9938, P-AP:0.7815, P-F1:0.7310, P-AUPRO:0.9822
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9932, P-AP:0.5137, P-F1:0.5620, P-AUPRO:0.9759
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4287, P-F1:0.4765, P-AUPRO:0.9766
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9940, P-AUROC:0.9741, P-AP:0.7158, P-F1:0.7450, P-AUPRO:0.8985
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9642, P-AP:0.6777, P-F1:0.6633, P-AUPRO:0.9235
bottle: I-Auroc:0.9937, I-AP:0.9980, I-F1:0.9844, P-AUROC:0.9658, P-AP:0.7833, P-F1:0.7412, P-AUPRO:0.9295
cable: I-Auroc:0.8924, I-AP:0.9472, I-F1:0.8671, P-AUROC:0.9237, P-AP:0.5173, P-F1:0.5520, P-AUPRO:0.8180
capsule: I-Auroc:0.9218, I-AP:0.9828, I-F1:0.9397, P-AUROC:0.9777, P-AP:0.5085, P-F1:0.4988, P-AUPRO:0.9641
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9928, P-AUROC:0.9896, P-AP:0.7684, P-F1:0.7416, P-AUPRO:0.9514
metal_nut: I-Auroc:0.9668, I-AP:0.9927, I-F1:0.9529, P-AUROC:0.9028, P-AP:0.6483, P-F1:0.6368, P-AUPRO:0.8523
pill: I-Auroc:0.9828, I-AP:0.9970, I-F1:0.9787, P-AUROC:0.9124, P-AP:0.5262, P-F1:0.5568, P-AUPRO:0.9482
screw: I-Auroc:0.6177, I-AP:0.8014, I-F1:0.8655, P-AUROC:0.9653, P-AP:0.2147, P-F1:0.2837, P-AUPRO:0.8744
toothbrush: I-Auroc:0.9861, I-AP:0.9952, I-F1:0.9831, P-AUROC:0.9928, P-AP:0.7613, P-F1:0.7259, P-AUPRO:0.9504
transistor: I-Auroc:0.9783, I-AP:0.9627, I-F1:0.9302, P-AUROC:0.8739, P-AP:0.4562, P-F1:0.4567, P-AUPRO:0.7060
zipper: I-Auroc:0.9958, I-AP:0.9989, I-F1:0.9874, P-AUROC:0.9693, P-AP:0.5921, P-F1:0.5902, P-AUPRO:0.9169
Mean: I-Auroc:0.9550, I-AP:0.9781, I-F1:0.9635, P-AUROC:0.9593, P-AP:0.5929, P-F1:0.5974, P-AUPRO:0.9112
cuda:3
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7645, P-F1:0.7178, P-AUPRO:0.9798
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5279, P-F1:0.5725, P-AUPRO:0.9762
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4146, P-F1:0.4710, P-AUPRO:0.9761
tile: I-Auroc:0.9964, I-AP:0.9987, I-F1:0.9881, P-AUROC:0.9744, P-AP:0.7157, P-F1:0.7429, P-AUPRO:0.8981
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9836, P-AUROC:0.9664, P-AP:0.6747, P-F1:0.6636, P-AUPRO:0.9252
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9921, P-AUROC:0.9734, P-AP:0.8046, P-F1:0.7565, P-AUPRO:0.9439
cable: I-Auroc:0.9505, I-AP:0.9731, I-F1:0.8980, P-AUROC:0.9455, P-AP:0.5788, P-F1:0.6016, P-AUPRO:0.8624
capsule: I-Auroc:0.9278, I-AP:0.9837, I-F1:0.9561, P-AUROC:0.9778, P-AP:0.5179, P-F1:0.5062, P-AUPRO:0.9640
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9898, P-AP:0.7707, P-F1:0.7467, P-AUPRO:0.9571
metal_nut: I-Auroc:0.9844, I-AP:0.9964, I-F1:0.9730, P-AUROC:0.9258, P-AP:0.7141, P-F1:0.7038, P-AUPRO:0.8822
pill: I-Auroc:0.9804, I-AP:0.9966, I-F1:0.9749, P-AUROC:0.9182, P-AP:0.5363, P-F1:0.5618, P-AUPRO:0.9518
screw: I-Auroc:0.6415, I-AP:0.8094, I-F1:0.8667, P-AUROC:0.9620, P-AP:0.2081, P-F1:0.2720, P-AUPRO:0.8755
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9923, P-AP:0.7404, P-F1:0.7136, P-AUPRO:0.9574
transistor: I-Auroc:0.9850, I-AP:0.9731, I-F1:0.9412, P-AUROC:0.8926, P-AP:0.4813, P-F1:0.4745, P-AUPRO:0.7312
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9702, P-AP:0.5995, P-F1:0.5957, P-AUPRO:0.9177
Mean: I-Auroc:0.9623, I-AP:0.9814, I-F1:0.9685, P-AUROC:0.9644, P-AP:0.6033, P-F1:0.6067, P-AUPRO:0.9199
cuda:3
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9936, P-AP:0.7698, P-F1:0.7185, P-AUPRO:0.9798
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5238, P-F1:0.5676, P-AUPRO:0.9766
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4023, P-F1:0.4597, P-AUPRO:0.9734
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9747, P-AP:0.7151, P-F1:0.7429, P-AUPRO:0.8992
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9833, P-AUROC:0.9664, P-AP:0.6766, P-F1:0.6651, P-AUPRO:0.9206
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9766, P-AP:0.8149, P-F1:0.7676, P-AUPRO:0.9475
cable: I-Auroc:0.9796, I-AP:0.9876, I-F1:0.9468, P-AUROC:0.9532, P-AP:0.6004, P-F1:0.6175, P-AUPRO:0.8771
capsule: I-Auroc:0.9840, I-AP:0.9966, I-F1:0.9720, P-AUROC:0.9816, P-AP:0.5650, P-F1:0.5567, P-AUPRO:0.9722
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.8068, P-F1:0.7670, P-AUPRO:0.9662
metal_nut: I-Auroc:0.9946, I-AP:0.9988, I-F1:0.9789, P-AUROC:0.9323, P-AP:0.7397, P-F1:0.7271, P-AUPRO:0.8909
pill: I-Auroc:0.9779, I-AP:0.9961, I-F1:0.9747, P-AUROC:0.9208, P-AP:0.5400, P-F1:0.5666, P-AUPRO:0.9514
screw: I-Auroc:0.6852, I-AP:0.8426, I-F1:0.8830, P-AUROC:0.9687, P-AP:0.2645, P-F1:0.3423, P-AUPRO:0.8900
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7478, P-F1:0.7278, P-AUPRO:0.9625
transistor: I-Auroc:0.9912, I-AP:0.9865, I-F1:0.9639, P-AUROC:0.8998, P-AP:0.4936, P-F1:0.4822, P-AUPRO:0.7429
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9736, P-AP:0.6052, P-F1:0.6034, P-AUPRO:0.9283
Mean: I-Auroc:0.9731, I-AP:0.9869, I-F1:0.9783, P-AUROC:0.9674, P-AP:0.6177, P-F1:0.6208, P-AUPRO:0.9252

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = anomaly_map_ori + anomaly_map_aug

cuda:3
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.7717, P-F1:0.7244, P-AUPRO:0.9778
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9917, P-AP:0.4890, P-F1:0.5276, P-AUPRO:0.9724
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9903, P-AP:0.4336, P-F1:0.4745, P-AUPRO:0.9708
tile: I-Auroc:0.9895, I-AP:0.9969, I-F1:0.9881, P-AUROC:0.9746, P-AP:0.7194, P-F1:0.7460, P-AUPRO:0.8771
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9632, P-AP:0.6680, P-F1:0.6500, P-AUPRO:0.9141
bottle: I-Auroc:0.9746, I-AP:0.9925, I-F1:0.9606, P-AUROC:0.9432, P-AP:0.6970, P-F1:0.6671, P-AUPRO:0.8871
cable: I-Auroc:0.8639, I-AP:0.9324, I-F1:0.8409, P-AUROC:0.9012, P-AP:0.4146, P-F1:0.4393, P-AUPRO:0.7682
capsule: I-Auroc:0.9485, I-AP:0.9888, I-F1:0.9636, P-AUROC:0.9820, P-AP:0.5320, P-F1:0.5275, P-AUPRO:0.9629
hazelnut: I-Auroc:0.9943, I-AP:0.9969, I-F1:0.9714, P-AUROC:0.9858, P-AP:0.7439, P-F1:0.7139, P-AUPRO:0.9328
metal_nut: I-Auroc:0.9413, I-AP:0.9871, I-F1:0.9305, P-AUROC:0.9015, P-AP:0.6565, P-F1:0.6383, P-AUPRO:0.8013
pill: I-Auroc:0.9804, I-AP:0.9966, I-F1:0.9710, P-AUROC:0.9143, P-AP:0.5233, P-F1:0.5567, P-AUPRO:0.9486
screw: I-Auroc:0.6003, I-AP:0.7930, I-F1:0.8623, P-AUROC:0.9601, P-AP:0.1927, P-F1:0.2596, P-AUPRO:0.8599
toothbrush: I-Auroc:0.9750, I-AP:0.9919, I-F1:0.9667, P-AUROC:0.9916, P-AP:0.7572, P-F1:0.7208, P-AUPRO:0.9353
transistor: I-Auroc:0.9383, I-AP:0.9250, I-F1:0.8605, P-AUROC:0.8473, P-AP:0.4004, P-F1:0.4153, P-AUPRO:0.6614
zipper: I-Auroc:0.9774, I-AP:0.9933, I-F1:0.9672, P-AUROC:0.9770, P-AP:0.5887, P-F1:0.6040, P-AUPRO:0.9311
Mean: I-Auroc:0.9449, I-AP:0.9727, I-F1:0.9507, P-AUROC:0.9545, P-AP:0.5725, P-F1:0.5777, P-AUPRO:0.8934
cuda:3
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9928, P-AP:0.7569, P-F1:0.7113, P-AUPRO:0.9773
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9923, P-AP:0.5054, P-F1:0.5430, P-AUPRO:0.9731
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4189, P-F1:0.4686, P-AUPRO:0.9692
tile: I-Auroc:0.9892, I-AP:0.9967, I-F1:0.9880, P-AUROC:0.9739, P-AP:0.7142, P-F1:0.7362, P-AUPRO:0.8664
wood: I-Auroc:0.9939, I-AP:0.9982, I-F1:0.9833, P-AUROC:0.9650, P-AP:0.6630, P-F1:0.6498, P-AUPRO:0.9160
bottle: I-Auroc:0.9714, I-AP:0.9917, I-F1:0.9516, P-AUROC:0.9547, P-AP:0.7249, P-F1:0.6894, P-AUPRO:0.9041
cable: I-Auroc:0.9380, I-AP:0.9657, I-F1:0.8889, P-AUROC:0.9304, P-AP:0.4860, P-F1:0.5115, P-AUPRO:0.8194
capsule: I-Auroc:0.9513, I-AP:0.9891, I-F1:0.9593, P-AUROC:0.9818, P-AP:0.5367, P-F1:0.5296, P-AUPRO:0.9660
hazelnut: I-Auroc:0.9971, I-AP:0.9984, I-F1:0.9790, P-AUROC:0.9859, P-AP:0.7437, P-F1:0.7170, P-AUPRO:0.9401
metal_nut: I-Auroc:0.9643, I-AP:0.9919, I-F1:0.9468, P-AUROC:0.9245, P-AP:0.7275, P-F1:0.7057, P-AUPRO:0.8381
pill: I-Auroc:0.9779, I-AP:0.9962, I-F1:0.9710, P-AUROC:0.9208, P-AP:0.5331, P-F1:0.5601, P-AUPRO:0.9508
screw: I-Auroc:0.6177, I-AP:0.7965, I-F1:0.8592, P-AUROC:0.9572, P-AP:0.1845, P-F1:0.2502, P-AUPRO:0.8601
toothbrush: I-Auroc:0.9861, I-AP:0.9950, I-F1:0.9667, P-AUROC:0.9918, P-AP:0.7400, P-F1:0.7103, P-AUPRO:0.9474
transistor: I-Auroc:0.9371, I-AP:0.9302, I-F1:0.8750, P-AUROC:0.8716, P-AP:0.4295, P-F1:0.4369, P-AUPRO:0.7029
zipper: I-Auroc:0.9905, I-AP:0.9973, I-F1:0.9833, P-AUROC:0.9782, P-AP:0.6113, P-F1:0.6222, P-AUPRO:0.9347
Mean: I-Auroc:0.9533, I-AP:0.9762, I-F1:0.9562, P-AUROC:0.9607, P-AP:0.5851, P-F1:0.5895, P-AUPRO:0.9044
cuda:3
shots: 4
carpet: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9944, P-AUROC:0.9928, P-AP:0.7617, P-F1:0.7124, P-AUPRO:0.9747
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9920, P-AP:0.5030, P-F1:0.5419, P-AUPRO:0.9714
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9897, P-AP:0.4049, P-F1:0.4584, P-AUPRO:0.9663
tile: I-Auroc:0.9931, I-AP:0.9978, I-F1:0.9881, P-AUROC:0.9743, P-AP:0.7151, P-F1:0.7368, P-AUPRO:0.8842
wood: I-Auroc:0.9912, I-AP:0.9973, I-F1:0.9833, P-AUROC:0.9653, P-AP:0.6662, P-F1:0.6538, P-AUPRO:0.9159
bottle: I-Auroc:0.9698, I-AP:0.9918, I-F1:0.9587, P-AUROC:0.9608, P-AP:0.7409, P-F1:0.7048, P-AUPRO:0.9169
cable: I-Auroc:0.9672, I-AP:0.9813, I-F1:0.9290, P-AUROC:0.9392, P-AP:0.5042, P-F1:0.5284, P-AUPRO:0.8364
capsule: I-Auroc:0.9749, I-AP:0.9948, I-F1:0.9604, P-AUROC:0.9846, P-AP:0.5552, P-F1:0.5441, P-AUPRO:0.9699
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9908, P-AP:0.7920, P-F1:0.7493, P-AUPRO:0.9541
metal_nut: I-Auroc:0.9751, I-AP:0.9945, I-F1:0.9630, P-AUROC:0.9313, P-AP:0.7520, P-F1:0.7273, P-AUPRO:0.8503
pill: I-Auroc:0.9755, I-AP:0.9957, I-F1:0.9710, P-AUROC:0.9229, P-AP:0.5383, P-F1:0.5659, P-AUPRO:0.9510
screw: I-Auroc:0.6567, I-AP:0.8239, I-F1:0.8736, P-AUROC:0.9643, P-AP:0.2374, P-F1:0.3184, P-AUPRO:0.8729
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9935, P-AP:0.7496, P-F1:0.7241, P-AUPRO:0.9563
transistor: I-Auroc:0.9542, I-AP:0.9508, I-F1:0.8831, P-AUROC:0.8804, P-AP:0.4441, P-F1:0.4504, P-AUPRO:0.7090
zipper: I-Auroc:0.9861, I-AP:0.9959, I-F1:0.9752, P-AUROC:0.9795, P-AP:0.6052, P-F1:0.6182, P-AUPRO:0.9388
Mean: I-Auroc:0.9620, I-AP:0.9813, I-F1:0.9631, P-AUROC:0.9641, P-AP:0.5980, P-F1:0.6023, P-AUPRO:0.9112

-------------------------------------------------------------------------------------------------------------------------------------
img_aug1 = color_jitter_batch(img, 0.9)
supports_aug1 =color_jitter_batch(supports, 0.9)
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)

img_aug2 = color_jitter_batch(img, 1.1)
supports_aug2 =color_jitter_batch(supports, 1.1)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2)   

img_aug3 = color_jitter_batch(img, 1.2)
supports_aug3 =color_jitter_batch(supports, 1.2)
anomaly_map_aug3 = model(img_aug3, supports_aug3, memorize_supports, use_memory, aug=3)  

anomaly_map = 0.7 * anomaly_map_ori + 0.1 * anomaly_map_aug1 + 0.1 * anomaly_map_aug2 + 0.1 * anomaly_map_aug3

cuda:3
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7822, P-F1:0.7313, P-AUPRO:0.9821
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9933, P-AP:0.5190, P-F1:0.5629, P-AUPRO:0.9770
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4276, P-F1:0.4787, P-AUPRO:0.9748
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9940, P-AUROC:0.9746, P-AP:0.7203, P-F1:0.7466, P-AUPRO:0.9059
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9641, P-AP:0.6775, P-F1:0.6627, P-AUPRO:0.9235
bottle: I-Auroc:0.9944, I-AP:0.9983, I-F1:0.9844, P-AUROC:0.9656, P-AP:0.7826, P-F1:0.7408, P-AUPRO:0.9295
cable: I-Auroc:0.8941, I-AP:0.9481, I-F1:0.8671, P-AUROC:0.9239, P-AP:0.5183, P-F1:0.5532, P-AUPRO:0.8195
capsule: I-Auroc:0.9290, I-AP:0.9847, I-F1:0.9397, P-AUROC:0.9780, P-AP:0.5070, P-F1:0.4978, P-AUPRO:0.9628
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9928, P-AUROC:0.9895, P-AP:0.7671, P-F1:0.7414, P-AUPRO:0.9508
metal_nut: I-Auroc:0.9677, I-AP:0.9929, I-F1:0.9529, P-AUROC:0.9025, P-AP:0.6489, P-F1:0.6371, P-AUPRO:0.8543
pill: I-Auroc:0.9834, I-AP:0.9971, I-F1:0.9753, P-AUROC:0.9132, P-AP:0.5265, P-F1:0.5608, P-AUPRO:0.9479
screw: I-Auroc:0.6188, I-AP:0.8023, I-F1:0.8655, P-AUROC:0.9664, P-AP:0.2170, P-F1:0.2835, P-AUPRO:0.8804
toothbrush: I-Auroc:0.9861, I-AP:0.9952, I-F1:0.9831, P-AUROC:0.9927, P-AP:0.7573, P-F1:0.7251, P-AUPRO:0.9505
transistor: I-Auroc:0.9763, I-AP:0.9563, I-F1:0.9176, P-AUROC:0.8742, P-AP:0.4570, P-F1:0.4579, P-AUPRO:0.7013
zipper: I-Auroc:0.9958, I-AP:0.9989, I-F1:0.9874, P-AUROC:0.9701, P-AP:0.5958, P-F1:0.5929, P-AUPRO:0.9196
Mean: I-Auroc:0.9554, I-AP:0.9779, I-F1:0.9625, P-AUROC:0.9595, P-AP:0.5936, P-F1:0.5982, P-AUPRO:0.9120
cuda:3
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7658, P-F1:0.7181, P-AUPRO:0.9795
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5330, P-F1:0.5745, P-AUPRO:0.9775
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4102, P-F1:0.4729, P-AUPRO:0.9765
tile: I-Auroc:0.9964, I-AP:0.9987, I-F1:0.9881, P-AUROC:0.9746, P-AP:0.7182, P-F1:0.7440, P-AUPRO:0.9043
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9836, P-AUROC:0.9661, P-AP:0.6736, P-F1:0.6617, P-AUPRO:0.9248
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9921, P-AUROC:0.9733, P-AP:0.8042, P-F1:0.7560, P-AUPRO:0.9442
cable: I-Auroc:0.9481, I-AP:0.9719, I-F1:0.8990, P-AUROC:0.9457, P-AP:0.5787, P-F1:0.6019, P-AUPRO:0.8628
capsule: I-Auroc:0.9330, I-AP:0.9852, I-F1:0.9561, P-AUROC:0.9782, P-AP:0.5168, P-F1:0.5046, P-AUPRO:0.9654
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9928, P-AUROC:0.9897, P-AP:0.7689, P-F1:0.7459, P-AUPRO:0.9565
metal_nut: I-Auroc:0.9844, I-AP:0.9964, I-F1:0.9730, P-AUROC:0.9255, P-AP:0.7144, P-F1:0.7036, P-AUPRO:0.8827
pill: I-Auroc:0.9815, I-AP:0.9968, I-F1:0.9720, P-AUROC:0.9190, P-AP:0.5362, P-F1:0.5649, P-AUPRO:0.9520
screw: I-Auroc:0.6479, I-AP:0.8119, I-F1:0.8718, P-AUROC:0.9638, P-AP:0.2126, P-F1:0.2725, P-AUPRO:0.8806
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9923, P-AP:0.7377, P-F1:0.7116, P-AUPRO:0.9571
transistor: I-Auroc:0.9846, I-AP:0.9719, I-F1:0.9383, P-AUROC:0.8930, P-AP:0.4830, P-F1:0.4766, P-AUPRO:0.7328
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9707, P-AP:0.6016, P-F1:0.5972, P-AUPRO:0.9191
Mean: I-Auroc:0.9629, I-AP:0.9815, I-F1:0.9685, P-AUROC:0.9646, P-AP:0.6037, P-F1:0.6071, P-AUPRO:0.9210
cuda:3
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7705, P-F1:0.7183, P-AUPRO:0.9814
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5267, P-F1:0.5681, P-AUPRO:0.9760
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4025, P-F1:0.4637, P-AUPRO:0.9732
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9749, P-AP:0.7175, P-F1:0.7440, P-AUPRO:0.9033
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9833, P-AUROC:0.9662, P-AP:0.6764, P-F1:0.6649, P-AUPRO:0.9193
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9765, P-AP:0.8149, P-F1:0.7671, P-AUPRO:0.9479
cable: I-Auroc:0.9783, I-AP:0.9872, I-F1:0.9468, P-AUROC:0.9532, P-AP:0.5998, P-F1:0.6174, P-AUPRO:0.8778
capsule: I-Auroc:0.9868, I-AP:0.9972, I-F1:0.9774, P-AUROC:0.9819, P-AP:0.5642, P-F1:0.5563, P-AUPRO:0.9716
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.8062, P-F1:0.7670, P-AUPRO:0.9655
metal_nut: I-Auroc:0.9946, I-AP:0.9988, I-F1:0.9789, P-AUROC:0.9322, P-AP:0.7406, P-F1:0.7276, P-AUPRO:0.8891
pill: I-Auroc:0.9787, I-AP:0.9963, I-F1:0.9747, P-AUROC:0.9222, P-AP:0.5425, P-F1:0.5721, P-AUPRO:0.9536
screw: I-Auroc:0.6881, I-AP:0.8422, I-F1:0.8881, P-AUROC:0.9701, P-AP:0.2669, P-F1:0.3422, P-AUPRO:0.8918
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7468, P-F1:0.7271, P-AUPRO:0.9627
transistor: I-Auroc:0.9904, I-AP:0.9851, I-F1:0.9639, P-AUROC:0.9004, P-AP:0.4955, P-F1:0.4844, P-AUPRO:0.7460
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9740, P-AP:0.6080, P-F1:0.6054, P-AUPRO:0.9300
Mean: I-Auroc:0.9734, I-AP:0.9868, I-F1:0.9790, P-AUROC:0.9677, P-AP:0.6186, P-F1:0.6217, P-AUPRO:0.9259

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
cuda:3
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7701, P-F1:0.7258, P-AUPRO:0.9814
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9936, P-AP:0.5222, P-F1:0.5647, P-AUPRO:0.9779
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9906, P-AP:0.4444, P-F1:0.4776, P-AUPRO:0.9759
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9744, P-AP:0.7122, P-F1:0.7437, P-AUPRO:0.9006
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9663, P-AP:0.6782, P-F1:0.6723, P-AUPRO:0.9243
bottle: I-Auroc:0.9865, I-AP:0.9961, I-F1:0.9760, P-AUROC:0.9683, P-AP:0.7935, P-F1:0.7524, P-AUPRO:0.9356
cable: I-Auroc:0.9305, I-AP:0.9651, I-F1:0.8953, P-AUROC:0.9252, P-AP:0.5404, P-F1:0.5825, P-AUPRO:0.8354
capsule: I-Auroc:0.9234, I-AP:0.9833, I-F1:0.9397, P-AUROC:0.9782, P-AP:0.5139, P-F1:0.5020, P-AUPRO:0.9625
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9905, P-AP:0.7716, P-F1:0.7440, P-AUPRO:0.9594
metal_nut: I-Auroc:0.9731, I-AP:0.9940, I-F1:0.9560, P-AUROC:0.9070, P-AP:0.6564, P-F1:0.6479, P-AUPRO:0.8655
pill: I-Auroc:0.9809, I-AP:0.9967, I-F1:0.9786, P-AUROC:0.9143, P-AP:0.5447, P-F1:0.5646, P-AUPRO:0.9476
screw: I-Auroc:0.8965, I-AP:0.9649, I-F1:0.8889, P-AUROC:0.9876, P-AP:0.4962, P-F1:0.5211, P-AUPRO:0.9454
toothbrush: I-Auroc:0.9889, I-AP:0.9961, I-F1:0.9831, P-AUROC:0.9928, P-AP:0.7670, P-F1:0.7298, P-AUPRO:0.9484
transistor: I-Auroc:0.9833, I-AP:0.9746, I-F1:0.9500, P-AUROC:0.8434, P-AP:0.3769, P-F1:0.3969, P-AUPRO:0.6856
zipper: I-Auroc:0.9971, I-AP:0.9992, I-F1:0.9916, P-AUROC:0.9723, P-AP:0.6049, P-F1:0.5983, P-AUPRO:0.9242
Mean: I-Auroc:0.9767, I-AP:0.9911, I-F1:0.9682, P-AUROC:0.9599, P-AP:0.6128, P-F1:0.6149, P-AUPRO:0.9180
cuda:3
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7576, P-F1:0.7111, P-AUPRO:0.9790
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5230, P-F1:0.5655, P-AUPRO:0.9774
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4216, P-F1:0.4651, P-AUPRO:0.9745
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9745, P-AP:0.7104, P-F1:0.7408, P-AUPRO:0.9038
wood: I-Auroc:0.9982, I-AP:0.9994, I-F1:0.9917, P-AUROC:0.9682, P-AP:0.6757, P-F1:0.6713, P-AUPRO:0.9258
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9844, P-AUROC:0.9747, P-AP:0.8115, P-F1:0.7659, P-AUPRO:0.9464
cable: I-Auroc:0.9578, I-AP:0.9779, I-F1:0.9205, P-AUROC:0.9361, P-AP:0.5758, P-F1:0.6122, P-AUPRO:0.8582
capsule: I-Auroc:0.9318, I-AP:0.9849, I-F1:0.9515, P-AUROC:0.9783, P-AP:0.5228, P-F1:0.5096, P-AUPRO:0.9655
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9913, P-AP:0.7810, P-F1:0.7541, P-AUPRO:0.9644
metal_nut: I-Auroc:0.9892, I-AP:0.9975, I-F1:0.9735, P-AUROC:0.9307, P-AP:0.7272, P-F1:0.7242, P-AUPRO:0.8923
pill: I-Auroc:0.9782, I-AP:0.9962, I-F1:0.9677, P-AUROC:0.9200, P-AP:0.5535, P-F1:0.5710, P-AUPRO:0.9514
screw: I-Auroc:0.8893, I-AP:0.9626, I-F1:0.8963, P-AUROC:0.9886, P-AP:0.5143, P-F1:0.5378, P-AUPRO:0.9562
toothbrush: I-Auroc:0.9889, I-AP:0.9959, I-F1:0.9667, P-AUROC:0.9924, P-AP:0.7537, P-F1:0.7182, P-AUPRO:0.9559
transistor: I-Auroc:0.9863, I-AP:0.9809, I-F1:0.9500, P-AUROC:0.8656, P-AP:0.4033, P-F1:0.4174, P-AUPRO:0.7078
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9958, P-AUROC:0.9724, P-AP:0.6136, P-F1:0.6031, P-AUPRO:0.9233
Mean: I-Auroc:0.9805, I-AP:0.9928, I-F1:0.9719, P-AUROC:0.9647, P-AP:0.6230, P-F1:0.6245, P-AUPRO:0.9255
cuda:3
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7554, P-F1:0.7139, P-AUPRO:0.9783
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9934, P-AP:0.5185, P-F1:0.5629, P-AUPRO:0.9758
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.4126, P-F1:0.4523, P-AUPRO:0.9739
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9749, P-AP:0.7158, P-F1:0.7424, P-AUPRO:0.9002
wood: I-Auroc:0.9912, I-AP:0.9973, I-F1:0.9752, P-AUROC:0.9685, P-AP:0.6838, P-F1:0.6758, P-AUPRO:0.9236
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9775, P-AP:0.8217, P-F1:0.7753, P-AUPRO:0.9497
cable: I-Auroc:0.9719, I-AP:0.9843, I-F1:0.9326, P-AUROC:0.9413, P-AP:0.5862, P-F1:0.6171, P-AUPRO:0.8666
capsule: I-Auroc:0.9844, I-AP:0.9967, I-F1:0.9689, P-AUROC:0.9820, P-AP:0.5685, P-F1:0.5595, P-AUPRO:0.9713
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.8108, P-F1:0.7702, P-AUPRO:0.9713
metal_nut: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9892, P-AUROC:0.9352, P-AP:0.7439, P-F1:0.7410, P-AUPRO:0.8971
pill: I-Auroc:0.9752, I-AP:0.9956, I-F1:0.9643, P-AUROC:0.9223, P-AP:0.5565, P-F1:0.5749, P-AUPRO:0.9513
screw: I-Auroc:0.8828, I-AP:0.9560, I-F1:0.9040, P-AUROC:0.9906, P-AP:0.5226, P-F1:0.5386, P-AUPRO:0.9625
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.7656, P-F1:0.7322, P-AUPRO:0.9624
transistor: I-Auroc:0.9925, I-AP:0.9886, I-F1:0.9630, P-AUROC:0.8746, P-AP:0.4122, P-F1:0.4228, P-AUPRO:0.7264
zipper: I-Auroc:0.9987, I-AP:0.9997, I-F1:0.9916, P-AUROC:0.9751, P-AP:0.6202, P-F1:0.6150, P-AUPRO:0.9295
Mean: I-Auroc:0.9858, I-AP:0.9944, I-F1:0.9783, P-AUROC:0.9671, P-AP:0.6329, P-F1:0.6329, P-AUPRO:0.9293

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_small

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9944, P-AP:0.7704, P-F1:0.7219, P-AUPRO:0.9803
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9925, P-AP:0.5429, P-F1:0.5645, P-AUPRO:0.9760
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.5491, P-F1:0.5643, P-AUPRO:0.9841
tile: I-Auroc:0.9978, I-AP:0.9992, I-F1:0.9940, P-AUROC:0.9698, P-AP:0.6589, P-F1:0.7294, P-AUPRO:0.8936
wood: I-Auroc:0.9825, I-AP:0.9945, I-F1:0.9677, P-AUROC:0.9702, P-AP:0.6980, P-F1:0.6739, P-AUPRO:0.9260
bottle: I-Auroc:0.9770, I-AP:0.9936, I-F1:0.9677, P-AUROC:0.9649, P-AP:0.7820, P-F1:0.7394, P-AUPRO:0.9268
cable: I-Auroc:0.9050, I-AP:0.9513, I-F1:0.8750, P-AUROC:0.9195, P-AP:0.5162, P-F1:0.5560, P-AUPRO:0.8087
capsule: I-Auroc:0.9055, I-AP:0.9788, I-F1:0.9432, P-AUROC:0.9756, P-AP:0.4824, P-F1:0.4873, P-AUPRO:0.9555
hazelnut: I-Auroc:0.9943, I-AP:0.9970, I-F1:0.9714, P-AUROC:0.9877, P-AP:0.7522, P-F1:0.7129, P-AUPRO:0.9552
metal_nut: I-Auroc:0.9731, I-AP:0.9938, I-F1:0.9588, P-AUROC:0.8774, P-AP:0.5906, P-F1:0.5847, P-AUPRO:0.8348
pill: I-Auroc:0.9651, I-AP:0.9939, I-F1:0.9562, P-AUROC:0.9139, P-AP:0.5641, P-F1:0.5792, P-AUPRO:0.9397
screw: I-Auroc:0.8151, I-AP:0.9323, I-F1:0.8750, P-AUROC:0.9800, P-AP:0.4313, P-F1:0.4692, P-AUPRO:0.9148
toothbrush: I-Auroc:0.9778, I-AP:0.9921, I-F1:0.9655, P-AUROC:0.9915, P-AP:0.7375, P-F1:0.7178, P-AUPRO:0.9355
transistor: I-Auroc:0.9538, I-AP:0.9135, I-F1:0.8736, P-AUROC:0.8348, P-AP:0.3193, P-F1:0.3682, P-AUPRO:0.6846
zipper: I-Auroc:0.9916, I-AP:0.9978, I-F1:0.9832, P-AUROC:0.9774, P-AP:0.6295, P-F1:0.6093, P-AUPRO:0.9364
Mean: I-Auroc:0.9620, I-AP:0.9823, I-F1:0.9548, P-AUROC:0.9562, P-AP:0.6016, P-F1:0.6052, P-AUPRO:0.9101
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9941, P-AP:0.7635, P-F1:0.7112, P-AUPRO:0.9798
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9925, P-AP:0.5382, P-F1:0.5622, P-AUPRO:0.9689
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.5299, P-F1:0.5520, P-AUPRO:0.9817
tile: I-Auroc:0.9957, I-AP:0.9985, I-F1:0.9881, P-AUROC:0.9707, P-AP:0.6658, P-F1:0.7282, P-AUPRO:0.8881
wood: I-Auroc:0.9860, I-AP:0.9955, I-F1:0.9756, P-AUROC:0.9704, P-AP:0.7017, P-F1:0.6747, P-AUPRO:0.9276
bottle: I-Auroc:0.9889, I-AP:0.9969, I-F1:0.9839, P-AUROC:0.9728, P-AP:0.8044, P-F1:0.7566, P-AUPRO:0.9413
cable: I-Auroc:0.9320, I-AP:0.9617, I-F1:0.8750, P-AUROC:0.9324, P-AP:0.5476, P-F1:0.5809, P-AUPRO:0.8386
capsule: I-Auroc:0.9170, I-AP:0.9810, I-F1:0.9515, P-AUROC:0.9754, P-AP:0.4943, P-F1:0.4968, P-AUPRO:0.9589
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9896, P-AP:0.7699, P-F1:0.7374, P-AUPRO:0.9621
metal_nut: I-Auroc:0.9878, I-AP:0.9971, I-F1:0.9738, P-AUROC:0.9076, P-AP:0.6731, P-F1:0.6673, P-AUPRO:0.8691
pill: I-Auroc:0.9588, I-AP:0.9927, I-F1:0.9521, P-AUROC:0.9187, P-AP:0.5628, P-F1:0.5753, P-AUPRO:0.9413
screw: I-Auroc:0.8426, I-AP:0.9465, I-F1:0.8696, P-AUROC:0.9827, P-AP:0.4781, P-F1:0.5141, P-AUPRO:0.9309
toothbrush: I-Auroc:0.9778, I-AP:0.9920, I-F1:0.9655, P-AUROC:0.9910, P-AP:0.7221, P-F1:0.6997, P-AUPRO:0.9396
transistor: I-Auroc:0.9542, I-AP:0.8991, I-F1:0.8966, P-AUROC:0.8588, P-AP:0.3544, P-F1:0.3986, P-AUPRO:0.7166
zipper: I-Auroc:0.9932, I-AP:0.9982, I-F1:0.9832, P-AUROC:0.9781, P-AP:0.6341, P-F1:0.6145, P-AUPRO:0.9375
Mean: I-Auroc:0.9681, I-AP:0.9837, I-F1:0.9604, P-AUROC:0.9619, P-AP:0.6160, P-F1:0.6180, P-AUPRO:0.9188
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9943, P-AP:0.7695, P-F1:0.7138, P-AUPRO:0.9803
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9922, P-AP:0.5409, P-F1:0.5617, P-AUPRO:0.9681
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.5278, P-F1:0.5457, P-AUPRO:0.9801
tile: I-Auroc:0.9968, I-AP:0.9988, I-F1:0.9881, P-AUROC:0.9714, P-AP:0.6695, P-F1:0.7303, P-AUPRO:0.8924
wood: I-Auroc:0.9842, I-AP:0.9951, I-F1:0.9600, P-AUROC:0.9711, P-AP:0.7044, P-F1:0.6847, P-AUPRO:0.9262
bottle: I-Auroc:0.9944, I-AP:0.9983, I-F1:0.9839, P-AUROC:0.9763, P-AP:0.8182, P-F1:0.7672, P-AUPRO:0.9468
cable: I-Auroc:0.9533, I-AP:0.9731, I-F1:0.9091, P-AUROC:0.9385, P-AP:0.5690, P-F1:0.5947, P-AUPRO:0.8534
capsule: I-Auroc:0.9617, I-AP:0.9917, I-F1:0.9646, P-AUROC:0.9805, P-AP:0.5408, P-F1:0.5429, P-AUPRO:0.9661
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9922, P-AP:0.7977, P-F1:0.7588, P-AUPRO:0.9716
metal_nut: I-Auroc:0.9966, I-AP:0.9992, I-F1:0.9894, P-AUROC:0.9151, P-AP:0.6938, P-F1:0.6884, P-AUPRO:0.8777
pill: I-Auroc:0.9564, I-AP:0.9923, I-F1:0.9485, P-AUROC:0.9208, P-AP:0.5678, P-F1:0.5801, P-AUPRO:0.9422
screw: I-Auroc:0.8055, I-AP:0.9242, I-F1:0.8670, P-AUROC:0.9840, P-AP:0.4603, P-F1:0.4994, P-AUPRO:0.9365
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9935, P-AP:0.7443, P-F1:0.7242, P-AUPRO:0.9562
transistor: I-Auroc:0.9704, I-AP:0.9410, I-F1:0.9048, P-AUROC:0.8700, P-AP:0.3699, P-F1:0.4066, P-AUPRO:0.7401
zipper: I-Auroc:0.9916, I-AP:0.9978, I-F1:0.9832, P-AUROC:0.9776, P-AP:0.6248, P-F1:0.6056, P-AUPRO:0.9376
Mean: I-Auroc:0.9730, I-AP:0.9871, I-F1:0.9649, P-AUROC:0.9647, P-AP:0.6266, P-F1:0.6269, P-AUPRO:0.9250



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_large

cuda:4
shots: 1
carpet: I-Auroc:0.9691, I-AP:0.9915, I-F1:0.9600, P-AUROC:0.9450, P-AP:0.6205, P-F1:0.6207, P-AUPRO:0.8780
grid: I-Auroc:0.8037, I-AP:0.9014, I-F1:0.8710, P-AUROC:0.8955, P-AP:0.2105, P-F1:0.2630, P-AUPRO:0.7330
leather: I-Auroc:0.9246, I-AP:0.9782, I-F1:0.9282, P-AUROC:0.9485, P-AP:0.5837, P-F1:0.6102, P-AUPRO:0.9163
tile: I-Auroc:0.9791, I-AP:0.9924, I-F1:0.9639, P-AUROC:0.9608, P-AP:0.7474, P-F1:0.7412, P-AUPRO:0.8783
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9518, P-AP:0.6789, P-F1:0.6480, P-AUPRO:0.9232
bottle: I-Auroc:0.9825, I-AP:0.9951, I-F1:0.9672, P-AUROC:0.9511, P-AP:0.7136, P-F1:0.6579, P-AUPRO:0.8903
cable: I-Auroc:0.5006, I-AP:0.6028, I-F1:0.7603, P-AUROC:0.8488, P-AP:0.1359, P-F1:0.2511, P-AUPRO:0.6206
capsule: I-Auroc:0.6921, I-AP:0.9032, I-F1:0.9231, P-AUROC:0.9579, P-AP:0.2796, P-F1:0.3261, P-AUPRO:0.9199
hazelnut: I-Auroc:0.8943, I-AP:0.9430, I-F1:0.8722, P-AUROC:0.9577, P-AP:0.5283, P-F1:0.4922, P-AUPRO:0.9232
metal_nut: I-Auroc:0.6237, I-AP:0.8871, I-F1:0.9118, P-AUROC:0.8545, P-AP:0.4509, P-F1:0.5367, P-AUPRO:0.6543
pill: I-Auroc:0.9370, I-AP:0.9885, I-F1:0.9466, P-AUROC:0.9187, P-AP:0.6060, P-F1:0.5726, P-AUPRO:0.8967
screw: I-Auroc:0.6239, I-AP:0.8194, I-F1:0.8655, P-AUROC:0.9569, P-AP:0.0694, P-F1:0.1229, P-AUPRO:0.8337
toothbrush: I-Auroc:0.8194, I-AP:0.9236, I-F1:0.8889, P-AUROC:0.9656, P-AP:0.4172, P-F1:0.4229, P-AUPRO:0.8291
transistor: I-Auroc:0.6675, I-AP:0.6709, I-F1:0.6202, P-AUROC:0.7874, P-AP:0.2246, P-F1:0.2824, P-AUPRO:0.5630
zipper: I-Auroc:0.7996, I-AP:0.9432, I-F1:0.8915, P-AUROC:0.9250, P-AP:0.3644, P-F1:0.3629, P-AUPRO:0.7807
Mean: I-Auroc:0.8144, I-AP:0.9027, I-F1:0.8908, P-AUROC:0.9217, P-AP:0.4421, P-F1:0.4607, P-AUPRO:0.8160
cuda:4
shots: 2
carpet: I-Auroc:0.9651, I-AP:0.9906, I-F1:0.9651, P-AUROC:0.9405, P-AP:0.6150, P-F1:0.6173, P-AUPRO:0.8742
grid: I-Auroc:0.8480, I-AP:0.9440, I-F1:0.8696, P-AUROC:0.9344, P-AP:0.3753, P-F1:0.4231, P-AUPRO:0.8510
leather: I-Auroc:0.9395, I-AP:0.9826, I-F1:0.9355, P-AUROC:0.9506, P-AP:0.5848, P-F1:0.6096, P-AUPRO:0.9272
tile: I-Auroc:0.9491, I-AP:0.9819, I-F1:0.9250, P-AUROC:0.9449, P-AP:0.7296, P-F1:0.7221, P-AUPRO:0.8110
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9569, P-AP:0.6949, P-F1:0.6589, P-AUPRO:0.9256
bottle: I-Auroc:0.9937, I-AP:0.9982, I-F1:0.9841, P-AUROC:0.9644, P-AP:0.7594, P-F1:0.6980, P-AUPRO:0.9198
cable: I-Auroc:0.6166, I-AP:0.6928, I-F1:0.7603, P-AUROC:0.8529, P-AP:0.1499, P-F1:0.2536, P-AUPRO:0.6549
capsule: I-Auroc:0.6933, I-AP:0.8969, I-F1:0.9310, P-AUROC:0.9543, P-AP:0.2769, P-F1:0.3335, P-AUPRO:0.9288
hazelnut: I-Auroc:0.9286, I-AP:0.9624, I-F1:0.8955, P-AUROC:0.9612, P-AP:0.5472, P-F1:0.5097, P-AUPRO:0.9292
metal_nut: I-Auroc:0.8104, I-AP:0.9504, I-F1:0.9208, P-AUROC:0.8943, P-AP:0.6158, P-F1:0.6108, P-AUPRO:0.7587
pill: I-Auroc:0.9326, I-AP:0.9878, I-F1:0.9416, P-AUROC:0.9237, P-AP:0.6271, P-F1:0.5911, P-AUPRO:0.9043
screw: I-Auroc:0.7245, I-AP:0.8922, I-F1:0.8712, P-AUROC:0.9701, P-AP:0.2004, P-F1:0.2730, P-AUPRO:0.8842
toothbrush: I-Auroc:0.8361, I-AP:0.9240, I-F1:0.9231, P-AUROC:0.9664, P-AP:0.3792, P-F1:0.3805, P-AUPRO:0.8550
transistor: I-Auroc:0.7538, I-AP:0.7404, I-F1:0.6522, P-AUROC:0.8155, P-AP:0.2564, P-F1:0.3110, P-AUPRO:0.6353
zipper: I-Auroc:0.9648, I-AP:0.9906, I-F1:0.9583, P-AUROC:0.9456, P-AP:0.5240, P-F1:0.5286, P-AUPRO:0.8601
Mean: I-Auroc:0.8636, I-AP:0.9289, I-F1:0.9017, P-AUROC:0.9317, P-AP:0.4891, P-F1:0.5014, P-AUPRO:0.8480
cuda:4
shots: 4
carpet: I-Auroc:0.9703, I-AP:0.9919, I-F1:0.9551, P-AUROC:0.9463, P-AP:0.6350, P-F1:0.6325, P-AUPRO:0.8881
grid: I-Auroc:0.8296, I-AP:0.9345, I-F1:0.8780, P-AUROC:0.9396, P-AP:0.3744, P-F1:0.4240, P-AUPRO:0.8564
leather: I-Auroc:0.9895, I-AP:0.9968, I-F1:0.9785, P-AUROC:0.9757, P-AP:0.6545, P-F1:0.6509, P-AUPRO:0.9691
tile: I-Auroc:0.9621, I-AP:0.9858, I-F1:0.9371, P-AUROC:0.9550, P-AP:0.7482, P-F1:0.7411, P-AUPRO:0.8431
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9584, P-AP:0.7095, P-F1:0.6723, P-AUPRO:0.9329
bottle: I-Auroc:0.9960, I-AP:0.9988, I-F1:0.9841, P-AUROC:0.9689, P-AP:0.7807, P-F1:0.7193, P-AUPRO:0.9303
cable: I-Auroc:0.6685, I-AP:0.7746, I-F1:0.7603, P-AUROC:0.8603, P-AP:0.1755, P-F1:0.2669, P-AUPRO:0.6709
capsule: I-Auroc:0.7822, I-AP:0.9357, I-F1:0.9422, P-AUROC:0.9612, P-AP:0.3873, P-F1:0.4074, P-AUPRO:0.9475
hazelnut: I-Auroc:0.9771, I-AP:0.9873, I-F1:0.9583, P-AUROC:0.9715, P-AP:0.6307, P-F1:0.6071, P-AUPRO:0.9443
metal_nut: I-Auroc:0.8646, I-AP:0.9651, I-F1:0.9286, P-AUROC:0.9032, P-AP:0.6556, P-F1:0.6336, P-AUPRO:0.7866
pill: I-Auroc:0.9332, I-AP:0.9878, I-F1:0.9412, P-AUROC:0.9264, P-AP:0.6439, P-F1:0.6085, P-AUPRO:0.9103
screw: I-Auroc:0.7018, I-AP:0.8645, I-F1:0.8769, P-AUROC:0.9764, P-AP:0.2655, P-F1:0.3208, P-AUPRO:0.9075
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9911, P-AP:0.7308, P-F1:0.6985, P-AUPRO:0.9514
transistor: I-Auroc:0.7792, I-AP:0.7760, I-F1:0.6757, P-AUROC:0.8298, P-AP:0.2736, P-F1:0.3200, P-AUPRO:0.6506
zipper: I-Auroc:0.9680, I-AP:0.9904, I-F1:0.9620, P-AUROC:0.9535, P-AP:0.5555, P-F1:0.5513, P-AUPRO:0.8815
Mean: I-Auroc:0.8945, I-AP:0.9458, I-F1:0.9169, P-AUROC:0.9412, P-AP:0.5481, P-F1:0.5503, P-AUPRO:0.8714



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 320
crop_size = 280

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7701, P-F1:0.7141, P-AUPRO:0.9733
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9917, P-AP:0.4854, P-F1:0.5355, P-AUPRO:0.9662
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4286, P-F1:0.4669, P-AUPRO:0.9695
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9718, P-AP:0.6929, P-F1:0.7223, P-AUPRO:0.8959
wood: I-Auroc:0.9912, I-AP:0.9974, I-F1:0.9831, P-AUROC:0.9595, P-AP:0.6373, P-F1:0.6344, P-AUPRO:0.8932
bottle: I-Auroc:0.9897, I-AP:0.9970, I-F1:0.9764, P-AUROC:0.9690, P-AP:0.7842, P-F1:0.7473, P-AUPRO:0.9332
cable: I-Auroc:0.9249, I-AP:0.9625, I-F1:0.8982, P-AUROC:0.9293, P-AP:0.5476, P-F1:0.5962, P-AUPRO:0.8336
capsule: I-Auroc:0.9146, I-AP:0.9811, I-F1:0.9356, P-AUROC:0.9789, P-AP:0.5132, P-F1:0.5068, P-AUPRO:0.9479
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9928, P-AUROC:0.9897, P-AP:0.7545, P-F1:0.7388, P-AUPRO:0.9489
metal_nut: I-Auroc:0.9648, I-AP:0.9922, I-F1:0.9519, P-AUROC:0.9015, P-AP:0.6542, P-F1:0.6517, P-AUPRO:0.8488
pill: I-Auroc:0.9869, I-AP:0.9978, I-F1:0.9754, P-AUROC:0.9150, P-AP:0.5499, P-F1:0.5728, P-AUPRO:0.9416
screw: I-Auroc:0.8289, I-AP:0.9368, I-F1:0.8724, P-AUROC:0.9747, P-AP:0.4187, P-F1:0.4604, P-AUPRO:0.9005
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9909, P-AP:0.7384, P-F1:0.7221, P-AUPRO:0.9247
transistor: I-Auroc:0.9717, I-AP:0.9567, I-F1:0.9398, P-AUROC:0.8395, P-AP:0.3834, P-F1:0.4092, P-AUPRO:0.6902
zipper: I-Auroc:0.9945, I-AP:0.9985, I-F1:0.9833, P-AUROC:0.9581, P-AP:0.5204, P-F1:0.5380, P-AUPRO:0.8949
Mean: I-Auroc:0.9704, I-AP:0.9877, I-F1:0.9651, P-AUROC:0.9569, P-AP:0.5919, P-F1:0.6011, P-AUPRO:0.9042
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.7593, P-F1:0.6930, P-AUPRO:0.9717
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9913, P-AP:0.4786, P-F1:0.5307, P-AUPRO:0.9648
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4099, P-F1:0.4608, P-AUPRO:0.9688
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9715, P-AP:0.6889, P-F1:0.7173, P-AUPRO:0.8844
wood: I-Auroc:0.9904, I-AP:0.9972, I-F1:0.9831, P-AUROC:0.9618, P-AP:0.6340, P-F1:0.6285, P-AUPRO:0.8966
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9844, P-AUROC:0.9744, P-AP:0.7965, P-F1:0.7620, P-AUPRO:0.9380
cable: I-Auroc:0.9526, I-AP:0.9749, I-F1:0.9149, P-AUROC:0.9403, P-AP:0.5795, P-F1:0.6193, P-AUPRO:0.8561
capsule: I-Auroc:0.9110, I-AP:0.9796, I-F1:0.9474, P-AUROC:0.9791, P-AP:0.5132, P-F1:0.5093, P-AUPRO:0.9516
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.7687, P-F1:0.7506, P-AUPRO:0.9549
metal_nut: I-Auroc:0.9873, I-AP:0.9970, I-F1:0.9738, P-AUROC:0.9292, P-AP:0.7296, P-F1:0.7324, P-AUPRO:0.8776
pill: I-Auroc:0.9809, I-AP:0.9967, I-F1:0.9718, P-AUROC:0.9195, P-AP:0.5565, P-F1:0.5759, P-AUPRO:0.9426
screw: I-Auroc:0.8305, I-AP:0.9384, I-F1:0.8682, P-AUROC:0.9787, P-AP:0.4376, P-F1:0.4827, P-AUPRO:0.9155
toothbrush: I-Auroc:0.9944, I-AP:0.9978, I-F1:0.9836, P-AUROC:0.9908, P-AP:0.7216, P-F1:0.7049, P-AUPRO:0.9288
transistor: I-Auroc:0.9850, I-AP:0.9816, I-F1:0.9398, P-AUROC:0.8606, P-AP:0.4106, P-F1:0.4333, P-AUPRO:0.7165
zipper: I-Auroc:0.9947, I-AP:0.9986, I-F1:0.9835, P-AUROC:0.9630, P-AP:0.5460, P-F1:0.5603, P-AUPRO:0.9019
Mean: I-Auroc:0.9746, I-AP:0.9906, I-F1:0.9694, P-AUROC:0.9622, P-AP:0.6020, P-F1:0.6107, P-AUPRO:0.9113
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9931, P-AP:0.7588, P-F1:0.6908, P-AUPRO:0.9719
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9909, P-AP:0.4698, P-F1:0.5241, P-AUPRO:0.9600
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9896, P-AP:0.4053, P-F1:0.4510, P-AUPRO:0.9659
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9720, P-AP:0.6926, P-F1:0.7182, P-AUPRO:0.8835
wood: I-Auroc:0.9912, I-AP:0.9974, I-F1:0.9752, P-AUROC:0.9620, P-AP:0.6423, P-F1:0.6371, P-AUPRO:0.9020
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9770, P-AP:0.8033, P-F1:0.7681, P-AUPRO:0.9428
cable: I-Auroc:0.9616, I-AP:0.9797, I-F1:0.9257, P-AUROC:0.9438, P-AP:0.5872, P-F1:0.6260, P-AUPRO:0.8706
capsule: I-Auroc:0.9745, I-AP:0.9947, I-F1:0.9640, P-AUROC:0.9826, P-AP:0.5552, P-F1:0.5486, P-AUPRO:0.9619
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9919, P-AP:0.7799, P-F1:0.7593, P-AUPRO:0.9619
metal_nut: I-Auroc:0.9917, I-AP:0.9981, I-F1:0.9780, P-AUROC:0.9333, P-AP:0.7446, P-F1:0.7465, P-AUPRO:0.8826
pill: I-Auroc:0.9839, I-AP:0.9972, I-F1:0.9754, P-AUROC:0.9228, P-AP:0.5667, P-F1:0.5806, P-AUPRO:0.9464
screw: I-Auroc:0.8315, I-AP:0.9313, I-F1:0.8816, P-AUROC:0.9824, P-AP:0.4342, P-F1:0.4805, P-AUPRO:0.9267
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.7392, P-F1:0.7186, P-AUPRO:0.9432
transistor: I-Auroc:0.9954, I-AP:0.9934, I-F1:0.9750, P-AUROC:0.8758, P-AP:0.4305, P-F1:0.4451, P-AUPRO:0.7373
zipper: I-Auroc:0.9932, I-AP:0.9981, I-F1:0.9876, P-AUROC:0.9661, P-AP:0.5484, P-F1:0.5667, P-AUPRO:0.9086
Mean: I-Auroc:0.9812, I-AP:0.9925, I-F1:0.9769, P-AUROC:0.9651, P-AP:0.6105, P-F1:0.6174, P-AUPRO:0.9177



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 384
crop_size = 336

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.7740, P-F1:0.7138, P-AUPRO:0.9790
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9928, P-AP:0.5162, P-F1:0.5459, P-AUPRO:0.9723
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4233, P-F1:0.4696, P-AUPRO:0.9746
tile: I-Auroc:0.9978, I-AP:0.9992, I-F1:0.9881, P-AUROC:0.9741, P-AP:0.7052, P-F1:0.7375, P-AUPRO:0.8941
wood: I-Auroc:0.9886, I-AP:0.9965, I-F1:0.9752, P-AUROC:0.9596, P-AP:0.6428, P-F1:0.6404, P-AUPRO:0.9006
bottle: I-Auroc:0.9921, I-AP:0.9976, I-F1:0.9764, P-AUROC:0.9682, P-AP:0.7907, P-F1:0.7480, P-AUPRO:0.9335
cable: I-Auroc:0.9387, I-AP:0.9689, I-F1:0.9017, P-AUROC:0.9298, P-AP:0.5541, P-F1:0.5960, P-AUPRO:0.8461
capsule: I-Auroc:0.9378, I-AP:0.9863, I-F1:0.9474, P-AUROC:0.9787, P-AP:0.5278, P-F1:0.5069, P-AUPRO:0.9589
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9928, P-AUROC:0.9898, P-AP:0.7555, P-F1:0.7391, P-AUPRO:0.9549
metal_nut: I-Auroc:0.9692, I-AP:0.9932, I-F1:0.9519, P-AUROC:0.9053, P-AP:0.6600, P-F1:0.6559, P-AUPRO:0.8572
pill: I-Auroc:0.9779, I-AP:0.9960, I-F1:0.9648, P-AUROC:0.9130, P-AP:0.5472, P-F1:0.5627, P-AUPRO:0.9440
screw: I-Auroc:0.8705, I-AP:0.9547, I-F1:0.8855, P-AUROC:0.9844, P-AP:0.4715, P-F1:0.5025, P-AUPRO:0.9358
toothbrush: I-Auroc:0.9889, I-AP:0.9957, I-F1:0.9677, P-AUROC:0.9923, P-AP:0.7413, P-F1:0.7258, P-AUPRO:0.9477
transistor: I-Auroc:0.9788, I-AP:0.9659, I-F1:0.9500, P-AUROC:0.8360, P-AP:0.3741, P-F1:0.3990, P-AUPRO:0.6977
zipper: I-Auroc:0.9942, I-AP:0.9984, I-F1:0.9916, P-AUROC:0.9676, P-AP:0.5661, P-F1:0.5819, P-AUPRO:0.9156
Mean: I-Auroc:0.9755, I-AP:0.9901, I-F1:0.9656, P-AUROC:0.9584, P-AP:0.6033, P-F1:0.6083, P-AUPRO:0.9141
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9932, P-AP:0.7561, P-F1:0.6999, P-AUPRO:0.9755
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9925, P-AP:0.5119, P-F1:0.5477, P-AUPRO:0.9695
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9894, P-AP:0.3902, P-F1:0.4457, P-AUPRO:0.9703
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9880, P-AUROC:0.9740, P-AP:0.7058, P-F1:0.7343, P-AUPRO:0.8857
wood: I-Auroc:0.9860, I-AP:0.9957, I-F1:0.9748, P-AUROC:0.9629, P-AP:0.6483, P-F1:0.6467, P-AUPRO:0.9075
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9844, P-AUROC:0.9744, P-AP:0.8077, P-F1:0.7637, P-AUPRO:0.9418
cable: I-Auroc:0.9590, I-AP:0.9785, I-F1:0.9240, P-AUROC:0.9396, P-AP:0.5857, P-F1:0.6231, P-AUPRO:0.8656
capsule: I-Auroc:0.9234, I-AP:0.9826, I-F1:0.9561, P-AUROC:0.9796, P-AP:0.5313, P-F1:0.5107, P-AUPRO:0.9614
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9928, P-AUROC:0.9905, P-AP:0.7643, P-F1:0.7462, P-AUPRO:0.9599
metal_nut: I-Auroc:0.9897, I-AP:0.9976, I-F1:0.9738, P-AUROC:0.9305, P-AP:0.7291, P-F1:0.7295, P-AUPRO:0.8903
pill: I-Auroc:0.9738, I-AP:0.9953, I-F1:0.9645, P-AUROC:0.9178, P-AP:0.5574, P-F1:0.5731, P-AUPRO:0.9447
screw: I-Auroc:0.8901, I-AP:0.9633, I-F1:0.8954, P-AUROC:0.9862, P-AP:0.5032, P-F1:0.5170, P-AUPRO:0.9481
toothbrush: I-Auroc:0.9833, I-AP:0.9938, I-F1:0.9667, P-AUROC:0.9923, P-AP:0.7440, P-F1:0.7194, P-AUPRO:0.9537
transistor: I-Auroc:0.9842, I-AP:0.9722, I-F1:0.9620, P-AUROC:0.8611, P-AP:0.4012, P-F1:0.4222, P-AUPRO:0.7270
zipper: I-Auroc:0.9974, I-AP:0.9993, I-F1:0.9917, P-AUROC:0.9695, P-AP:0.5824, P-F1:0.5947, P-AUPRO:0.9199
Mean: I-Auroc:0.9784, I-AP:0.9916, I-F1:0.9706, P-AUROC:0.9636, P-AP:0.6146, P-F1:0.6183, P-AUPRO:0.9214
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9932, P-AP:0.7602, P-F1:0.7016, P-AUPRO:0.9761
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9923, P-AP:0.5069, P-F1:0.5440, P-AUPRO:0.9632
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9890, P-AP:0.3819, P-F1:0.4370, P-AUPRO:0.9698
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9882, P-AUROC:0.9741, P-AP:0.7077, P-F1:0.7336, P-AUPRO:0.8907
wood: I-Auroc:0.9895, I-AP:0.9966, I-F1:0.9756, P-AUROC:0.9644, P-AP:0.6626, P-F1:0.6609, P-AUPRO:0.9094
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9773, P-AP:0.8186, P-F1:0.7725, P-AUPRO:0.9488
cable: I-Auroc:0.9730, I-AP:0.9847, I-F1:0.9257, P-AUROC:0.9429, P-AP:0.5901, P-F1:0.6255, P-AUPRO:0.8705
capsule: I-Auroc:0.9805, I-AP:0.9961, I-F1:0.9636, P-AUROC:0.9833, P-AP:0.5793, P-F1:0.5611, P-AUPRO:0.9675
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.7921, P-F1:0.7615, P-AUPRO:0.9682
metal_nut: I-Auroc:0.9990, I-AP:0.9998, I-F1:0.9947, P-AUROC:0.9342, P-AP:0.7427, P-F1:0.7431, P-AUPRO:0.8912
pill: I-Auroc:0.9744, I-AP:0.9954, I-F1:0.9650, P-AUROC:0.9205, P-AP:0.5625, P-F1:0.5774, P-AUPRO:0.9469
screw: I-Auroc:0.8707, I-AP:0.9525, I-F1:0.8952, P-AUROC:0.9881, P-AP:0.5007, P-F1:0.5162, P-AUPRO:0.9525
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9936, P-AP:0.7598, P-F1:0.7283, P-AUPRO:0.9614
transistor: I-Auroc:0.9921, I-AP:0.9872, I-F1:0.9524, P-AUROC:0.8727, P-AP:0.4157, P-F1:0.4292, P-AUPRO:0.7428
zipper: I-Auroc:0.9958, I-AP:0.9988, I-F1:0.9916, P-AUROC:0.9721, P-AP:0.5947, P-F1:0.6053, P-AUPRO:0.9233
Mean: I-Auroc:0.9843, I-AP:0.9938, I-F1:0.9747, P-AUROC:0.9660, P-AP:0.6250, P-F1:0.6265, P-AUPRO:0.9255



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 512
crop_size = 448

cuda:4
shots: 1
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7548, P-F1:0.7223, P-AUPRO:0.9815
grid: I-Auroc:0.9983, I-AP:0.9994, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5565, P-F1:0.5877, P-AUPRO:0.9794
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9899, P-AP:0.4203, P-F1:0.4527, P-AUPRO:0.9735
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9751, P-AP:0.7201, P-F1:0.7464, P-AUPRO:0.9173
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9916, P-AUROC:0.9645, P-AP:0.6716, P-F1:0.6669, P-AUPRO:0.9279
bottle: I-Auroc:0.9825, I-AP:0.9950, I-F1:0.9677, P-AUROC:0.9680, P-AP:0.7962, P-F1:0.7515, P-AUPRO:0.9374
cable: I-Auroc:0.9413, I-AP:0.9709, I-F1:0.9123, P-AUROC:0.9293, P-AP:0.5440, P-F1:0.5793, P-AUPRO:0.8465
capsule: I-Auroc:0.9294, I-AP:0.9845, I-F1:0.9397, P-AUROC:0.9768, P-AP:0.5182, P-F1:0.4999, P-AUPRO:0.9609
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9908, P-AP:0.7797, P-F1:0.7512, P-AUPRO:0.9564
metal_nut: I-Auroc:0.9736, I-AP:0.9941, I-F1:0.9574, P-AUROC:0.9107, P-AP:0.6623, P-F1:0.6508, P-AUPRO:0.8729
pill: I-Auroc:0.9785, I-AP:0.9962, I-F1:0.9749, P-AUROC:0.9127, P-AP:0.5395, P-F1:0.5588, P-AUPRO:0.9500
screw: I-Auroc:0.9035, I-AP:0.9669, I-F1:0.9076, P-AUROC:0.9882, P-AP:0.5168, P-F1:0.5326, P-AUPRO:0.9484
toothbrush: I-Auroc:0.9778, I-AP:0.9930, I-F1:0.9831, P-AUROC:0.9929, P-AP:0.7623, P-F1:0.7324, P-AUPRO:0.9459
transistor: I-Auroc:0.9762, I-AP:0.9655, I-F1:0.9136, P-AUROC:0.8472, P-AP:0.3840, P-F1:0.4060, P-AUPRO:0.6894
zipper: I-Auroc:0.9987, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9777, P-AP:0.6536, P-F1:0.6345, P-AUPRO:0.9408
Mean: I-Auroc:0.9770, I-AP:0.9909, I-F1:0.9681, P-AUROC:0.9608, P-AP:0.6187, P-F1:0.6182, P-AUPRO:0.9219
cuda:4
shots: 2
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7533, P-F1:0.7206, P-AUPRO:0.9819
grid: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5570, P-F1:0.5858, P-AUPRO:0.9789
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9895, P-AP:0.3947, P-F1:0.4445, P-AUPRO:0.9692
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9751, P-AP:0.7199, P-F1:0.7443, P-AUPRO:0.9083
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9679, P-AP:0.6750, P-F1:0.6697, P-AUPRO:0.9341
bottle: I-Auroc:0.9952, I-AP:0.9985, I-F1:0.9844, P-AUROC:0.9751, P-AP:0.8153, P-F1:0.7649, P-AUPRO:0.9470
cable: I-Auroc:0.9608, I-AP:0.9794, I-F1:0.9257, P-AUROC:0.9393, P-AP:0.5763, P-F1:0.6098, P-AUPRO:0.8675
capsule: I-Auroc:0.9282, I-AP:0.9841, I-F1:0.9478, P-AUROC:0.9772, P-AP:0.5306, P-F1:0.5102, P-AUPRO:0.9645
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9916, P-AP:0.7871, P-F1:0.7631, P-AUPRO:0.9624
metal_nut: I-Auroc:0.9907, I-AP:0.9978, I-F1:0.9840, P-AUROC:0.9345, P-AP:0.7362, P-F1:0.7319, P-AUPRO:0.9010
pill: I-Auroc:0.9755, I-AP:0.9957, I-F1:0.9682, P-AUROC:0.9196, P-AP:0.5512, P-F1:0.5686, P-AUPRO:0.9526
screw: I-Auroc:0.9061, I-AP:0.9677, I-F1:0.8952, P-AUROC:0.9893, P-AP:0.5316, P-F1:0.5446, P-AUPRO:0.9588
toothbrush: I-Auroc:0.9889, I-AP:0.9961, I-F1:0.9831, P-AUROC:0.9921, P-AP:0.7417, P-F1:0.7084, P-AUPRO:0.9538
transistor: I-Auroc:0.9821, I-AP:0.9757, I-F1:0.9367, P-AUROC:0.8664, P-AP:0.4051, P-F1:0.4189, P-AUPRO:0.7167
zipper: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9958, P-AUROC:0.9769, P-AP:0.6511, P-F1:0.6306, P-AUPRO:0.9361
Mean: I-Auroc:0.9813, I-AP:0.9928, I-F1:0.9728, P-AUROC:0.9655, P-AP:0.6284, P-F1:0.6277, P-AUPRO:0.9289
cuda:4
shots: 4
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9936, P-AP:0.7490, P-F1:0.7206, P-AUPRO:0.9813
grid: I-Auroc:0.9958, I-AP:0.9986, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5522, P-F1:0.5853, P-AUPRO:0.9786
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9894, P-AP:0.3948, P-F1:0.4396, P-AUPRO:0.9685
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9753, P-AP:0.7226, P-F1:0.7450, P-AUPRO:0.9100
wood: I-Auroc:0.9947, I-AP:0.9984, I-F1:0.9833, P-AUROC:0.9690, P-AP:0.6840, P-F1:0.6756, P-AUPRO:0.9301
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9781, P-AP:0.8263, P-F1:0.7746, P-AUPRO:0.9527
cable: I-Auroc:0.9721, I-AP:0.9844, I-F1:0.9240, P-AUROC:0.9450, P-AP:0.5931, P-F1:0.6187, P-AUPRO:0.8775
capsule: I-Auroc:0.9817, I-AP:0.9961, I-F1:0.9689, P-AUROC:0.9810, P-AP:0.5740, P-F1:0.5583, P-AUPRO:0.9710
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.8132, P-F1:0.7754, P-AUPRO:0.9717
metal_nut: I-Auroc:0.9966, I-AP:0.9992, I-F1:0.9892, P-AUROC:0.9375, P-AP:0.7478, P-F1:0.7456, P-AUPRO:0.9051
pill: I-Auroc:0.9768, I-AP:0.9959, I-F1:0.9718, P-AUROC:0.9211, P-AP:0.5540, P-F1:0.5735, P-AUPRO:0.9542
screw: I-Auroc:0.9096, I-AP:0.9669, I-F1:0.9231, P-AUROC:0.9912, P-AP:0.5461, P-F1:0.5495, P-AUPRO:0.9645
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9937, P-AP:0.7551, P-F1:0.7249, P-AUPRO:0.9611
transistor: I-Auroc:0.9937, I-AP:0.9910, I-F1:0.9620, P-AUROC:0.8740, P-AP:0.4119, P-F1:0.4215, P-AUPRO:0.7361
zipper: I-Auroc:0.9961, I-AP:0.9990, I-F1:0.9916, P-AUROC:0.9790, P-AP:0.6576, P-F1:0.6388, P-AUPRO:0.9424
Mean: I-Auroc:0.9874, I-AP:0.9951, I-F1:0.9784, P-AUROC:0.9677, P-AP:0.6388, P-F1:0.6365, P-AUPRO:0.9337



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 256
crop_size = 224

cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9926, P-AP:0.7389, P-F1:0.6920, P-AUPRO:0.9666
grid: I-Auroc:0.9958, I-AP:0.9986, I-F1:0.9912, P-AUROC:0.9888, P-AP:0.4263, P-F1:0.4948, P-AUPRO:0.9573
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9876, P-AP:0.3967, P-F1:0.4314, P-AUPRO:0.9588
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9706, P-AP:0.6808, P-F1:0.7090, P-AUPRO:0.8769
wood: I-Auroc:0.9868, I-AP:0.9962, I-F1:0.9744, P-AUROC:0.9574, P-AP:0.6236, P-F1:0.6263, P-AUPRO:0.8703
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9921, P-AUROC:0.9683, P-AP:0.7692, P-F1:0.7415, P-AUPRO:0.9236
cable: I-Auroc:0.8952, I-AP:0.9476, I-F1:0.8675, P-AUROC:0.9242, P-AP:0.5374, P-F1:0.5814, P-AUPRO:0.8161
capsule: I-Auroc:0.8819, I-AP:0.9726, I-F1:0.9474, P-AUROC:0.9771, P-AP:0.4814, P-F1:0.4749, P-AUPRO:0.9267
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9929, P-AUROC:0.9887, P-AP:0.7403, P-F1:0.7384, P-AUPRO:0.9403
metal_nut: I-Auroc:0.9648, I-AP:0.9922, I-F1:0.9503, P-AUROC:0.8922, P-AP:0.6360, P-F1:0.6399, P-AUPRO:0.8267
pill: I-Auroc:0.9719, I-AP:0.9950, I-F1:0.9622, P-AUROC:0.9161, P-AP:0.5429, P-F1:0.5645, P-AUPRO:0.9310
screw: I-Auroc:0.7577, I-AP:0.9104, I-F1:0.8702, P-AUROC:0.9603, P-AP:0.3543, P-F1:0.4042, P-AUPRO:0.8475
toothbrush: I-Auroc:0.9722, I-AP:0.9908, I-F1:0.9655, P-AUROC:0.9889, P-AP:0.7200, P-F1:0.7092, P-AUPRO:0.9072
transistor: I-Auroc:0.9542, I-AP:0.9391, I-F1:0.8837, P-AUROC:0.8436, P-AP:0.3836, P-F1:0.4131, P-AUPRO:0.7079
zipper: I-Auroc:0.9491, I-AP:0.9834, I-F1:0.9636, P-AUROC:0.9475, P-AP:0.4846, P-F1:0.5135, P-AUPRO:0.8753
Mean: I-Auroc:0.9551, I-AP:0.9816, I-F1:0.9563, P-AUROC:0.9536, P-AP:0.5677, P-F1:0.5823, P-AUPRO:0.8888
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9920, P-AP:0.7324, P-F1:0.6797, P-AUPRO:0.9678
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9884, P-AP:0.4238, P-F1:0.4916, P-AUPRO:0.9536
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9875, P-AP:0.3609, P-F1:0.4325, P-AUPRO:0.9560
tile: I-Auroc:0.9968, I-AP:0.9988, I-F1:0.9881, P-AUROC:0.9706, P-AP:0.6823, P-F1:0.7059, P-AUPRO:0.8660
wood: I-Auroc:0.9851, I-AP:0.9958, I-F1:0.9744, P-AUROC:0.9603, P-AP:0.6303, P-F1:0.6322, P-AUPRO:0.8796
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9744, P-AP:0.7862, P-F1:0.7538, P-AUPRO:0.9364
cable: I-Auroc:0.9220, I-AP:0.9583, I-F1:0.8750, P-AUROC:0.9356, P-AP:0.5646, P-F1:0.5975, P-AUPRO:0.8447
capsule: I-Auroc:0.8660, I-AP:0.9680, I-F1:0.9397, P-AUROC:0.9775, P-AP:0.4823, P-F1:0.4776, P-AUPRO:0.9281
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9897, P-AP:0.7521, P-F1:0.7472, P-AUPRO:0.9464
metal_nut: I-Auroc:0.9858, I-AP:0.9966, I-F1:0.9738, P-AUROC:0.9235, P-AP:0.7153, P-F1:0.7200, P-AUPRO:0.8662
pill: I-Auroc:0.9692, I-AP:0.9945, I-F1:0.9653, P-AUROC:0.9228, P-AP:0.5564, P-F1:0.5766, P-AUPRO:0.9352
screw: I-Auroc:0.7706, I-AP:0.9095, I-F1:0.8647, P-AUROC:0.9680, P-AP:0.3851, P-F1:0.4312, P-AUPRO:0.8746
toothbrush: I-Auroc:0.9833, I-AP:0.9939, I-F1:0.9655, P-AUROC:0.9881, P-AP:0.6928, P-F1:0.6924, P-AUPRO:0.9140
transistor: I-Auroc:0.9688, I-AP:0.9511, I-F1:0.9048, P-AUROC:0.8691, P-AP:0.4203, P-F1:0.4441, P-AUPRO:0.7279
zipper: I-Auroc:0.9808, I-AP:0.9943, I-F1:0.9833, P-AUROC:0.9508, P-AP:0.5040, P-F1:0.5336, P-AUPRO:0.8767
Mean: I-Auroc:0.9613, I-AP:0.9839, I-F1:0.9610, P-AUROC:0.9599, P-AP:0.5792, P-F1:0.5944, P-AUPRO:0.8982
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9917, P-AP:0.7253, P-F1:0.6771, P-AUPRO:0.9618
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9879, P-AP:0.4207, P-F1:0.4846, P-AUPRO:0.9524
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9875, P-AP:0.3703, P-F1:0.4299, P-AUPRO:0.9586
tile: I-Auroc:0.9986, I-AP:0.9995, I-F1:0.9940, P-AUROC:0.9702, P-AP:0.6778, P-F1:0.7050, P-AUPRO:0.8610
wood: I-Auroc:0.9842, I-AP:0.9957, I-F1:0.9744, P-AUROC:0.9590, P-AP:0.6368, P-F1:0.6357, P-AUPRO:0.8834
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9765, P-AP:0.7919, P-F1:0.7587, P-AUPRO:0.9387
cable: I-Auroc:0.9314, I-AP:0.9629, I-F1:0.8877, P-AUROC:0.9433, P-AP:0.5808, P-F1:0.6101, P-AUPRO:0.8628
capsule: I-Auroc:0.9354, I-AP:0.9851, I-F1:0.9636, P-AUROC:0.9826, P-AP:0.5441, P-F1:0.5363, P-AUPRO:0.9448
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9915, P-AP:0.7746, P-F1:0.7605, P-AUPRO:0.9511
metal_nut: I-Auroc:0.9888, I-AP:0.9974, I-F1:0.9787, P-AUROC:0.9303, P-AP:0.7370, P-F1:0.7383, P-AUPRO:0.8697
pill: I-Auroc:0.9735, I-AP:0.9952, I-F1:0.9653, P-AUROC:0.9261, P-AP:0.5679, P-F1:0.5793, P-AUPRO:0.9393
screw: I-Auroc:0.7481, I-AP:0.8889, I-F1:0.8706, P-AUROC:0.9731, P-AP:0.3686, P-F1:0.4227, P-AUPRO:0.8891
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9908, P-AP:0.6876, P-F1:0.6955, P-AUPRO:0.9337
transistor: I-Auroc:0.9904, I-AP:0.9839, I-F1:0.9524, P-AUROC:0.8813, P-AP:0.4304, P-F1:0.4433, P-AUPRO:0.7469
zipper: I-Auroc:0.9806, I-AP:0.9942, I-F1:0.9833, P-AUROC:0.9562, P-AP:0.5141, P-F1:0.5429, P-AUPRO:0.8852
Mean: I-Auroc:0.9682, I-AP:0.9867, I-F1:0.9704, P-AUROC:0.9632, P-AP:0.5885, P-F1:0.6013, P-AUPRO:0.9052



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9
augmented_image = TF.adjust_brightness(tensor_image_batch, brightness)

cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7811, P-F1:0.7310, P-AUPRO:0.9825
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9932, P-AP:0.5173, P-F1:0.5639, P-AUPRO:0.9770
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4284, P-F1:0.4768, P-AUPRO:0.9752
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9940, P-AUROC:0.9740, P-AP:0.7159, P-F1:0.7449, P-AUPRO:0.9039
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9642, P-AP:0.6776, P-F1:0.6633, P-AUPRO:0.9202
bottle: I-Auroc:0.9937, I-AP:0.9980, I-F1:0.9844, P-AUROC:0.9657, P-AP:0.7827, P-F1:0.7407, P-AUPRO:0.9296
cable: I-Auroc:0.8921, I-AP:0.9470, I-F1:0.8671, P-AUROC:0.9237, P-AP:0.5178, P-F1:0.5527, P-AUPRO:0.8184
capsule: I-Auroc:0.9214, I-AP:0.9827, I-F1:0.9397, P-AUROC:0.9777, P-AP:0.5095, P-F1:0.4994, P-AUPRO:0.9643
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9928, P-AUROC:0.9895, P-AP:0.7683, P-F1:0.7415, P-AUPRO:0.9510
metal_nut: I-Auroc:0.9677, I-AP:0.9929, I-F1:0.9529, P-AUROC:0.9034, P-AP:0.6502, P-F1:0.6388, P-AUPRO:0.8539
pill: I-Auroc:0.9817, I-AP:0.9968, I-F1:0.9787, P-AUROC:0.9128, P-AP:0.5269, P-F1:0.5571, P-AUPRO:0.9484
screw: I-Auroc:0.6163, I-AP:0.8010, I-F1:0.8655, P-AUROC:0.9653, P-AP:0.2143, P-F1:0.2830, P-AUPRO:0.8744
toothbrush: I-Auroc:0.9861, I-AP:0.9952, I-F1:0.9831, P-AUROC:0.9928, P-AP:0.7605, P-F1:0.7252, P-AUPRO:0.9504
transistor: I-Auroc:0.9775, I-AP:0.9602, I-F1:0.9268, P-AUROC:0.8736, P-AP:0.4553, P-F1:0.4562, P-AUPRO:0.7056
zipper: I-Auroc:0.9955, I-AP:0.9988, I-F1:0.9874, P-AUROC:0.9696, P-AP:0.5932, P-F1:0.5915, P-AUPRO:0.9179
Mean: I-Auroc:0.9548, I-AP:0.9779, I-F1:0.9633, P-AUROC:0.9593, P-AP:0.5933, P-F1:0.5977, P-AUPRO:0.9115
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7645, P-F1:0.7179, P-AUPRO:0.9798
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5315, P-F1:0.5745, P-AUPRO:0.9763
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4139, P-F1:0.4718, P-AUPRO:0.9747
tile: I-Auroc:0.9964, I-AP:0.9987, I-F1:0.9881, P-AUROC:0.9744, P-AP:0.7161, P-F1:0.7428, P-AUPRO:0.9038
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9836, P-AUROC:0.9664, P-AP:0.6746, P-F1:0.6639, P-AUPRO:0.9251
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9921, P-AUROC:0.9733, P-AP:0.8042, P-F1:0.7559, P-AUPRO:0.9442
cable: I-Auroc:0.9494, I-AP:0.9725, I-F1:0.8980, P-AUROC:0.9455, P-AP:0.5793, P-F1:0.6023, P-AUPRO:0.8663
capsule: I-Auroc:0.9282, I-AP:0.9839, I-F1:0.9561, P-AUROC:0.9778, P-AP:0.5189, P-F1:0.5067, P-AUPRO:0.9642
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9898, P-AP:0.7704, P-F1:0.7466, P-AUPRO:0.9569
metal_nut: I-Auroc:0.9839, I-AP:0.9963, I-F1:0.9730, P-AUROC:0.9261, P-AP:0.7153, P-F1:0.7051, P-AUPRO:0.8826
pill: I-Auroc:0.9804, I-AP:0.9966, I-F1:0.9751, P-AUROC:0.9187, P-AP:0.5374, P-F1:0.5624, P-AUPRO:0.9522
screw: I-Auroc:0.6411, I-AP:0.8088, I-F1:0.8667, P-AUROC:0.9620, P-AP:0.2073, P-F1:0.2710, P-AUPRO:0.8754
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9923, P-AP:0.7396, P-F1:0.7139, P-AUPRO:0.9574
transistor: I-Auroc:0.9846, I-AP:0.9718, I-F1:0.9412, P-AUROC:0.8924, P-AP:0.4808, P-F1:0.4741, P-AUPRO:0.7314
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9703, P-AP:0.6000, P-F1:0.5962, P-AUPRO:0.9181
Mean: I-Auroc:0.9621, I-AP:0.9812, I-F1:0.9685, P-AUROC:0.9644, P-AP:0.6036, P-F1:0.6070, P-AUPRO:0.9206
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9936, P-AP:0.7694, P-F1:0.7184, P-AUPRO:0.9798
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5263, P-F1:0.5688, P-AUPRO:0.9768
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4026, P-F1:0.4605, P-AUPRO:0.9735
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9747, P-AP:0.7156, P-F1:0.7430, P-AUPRO:0.8986
wood: I-Auroc:0.9930, I-AP:0.9979, I-F1:0.9833, P-AUROC:0.9664, P-AP:0.6769, P-F1:0.6655, P-AUPRO:0.9203
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9766, P-AP:0.8145, P-F1:0.7670, P-AUPRO:0.9478
cable: I-Auroc:0.9798, I-AP:0.9877, I-F1:0.9468, P-AUROC:0.9532, P-AP:0.6009, P-F1:0.6181, P-AUPRO:0.8774
capsule: I-Auroc:0.9844, I-AP:0.9967, I-F1:0.9720, P-AUROC:0.9816, P-AP:0.5659, P-F1:0.5571, P-AUPRO:0.9721
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.8066, P-F1:0.7668, P-AUPRO:0.9651
metal_nut: I-Auroc:0.9951, I-AP:0.9989, I-F1:0.9789, P-AUROC:0.9326, P-AP:0.7410, P-F1:0.7285, P-AUPRO:0.8914
pill: I-Auroc:0.9779, I-AP:0.9961, I-F1:0.9747, P-AUROC:0.9212, P-AP:0.5409, P-F1:0.5671, P-AUPRO:0.9515
screw: I-Auroc:0.6858, I-AP:0.8427, I-F1:0.8830, P-AUROC:0.9687, P-AP:0.2637, P-F1:0.3405, P-AUPRO:0.8884
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7472, P-F1:0.7278, P-AUPRO:0.9625
transistor: I-Auroc:0.9904, I-AP:0.9849, I-F1:0.9639, P-AUROC:0.8997, P-AP:0.4935, P-F1:0.4820, P-AUPRO:0.7433
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9737, P-AP:0.6057, P-F1:0.6038, P-AUPRO:0.9289
Mean: I-Auroc:0.9731, I-AP:0.9868, I-F1:0.9783, P-AUROC:0.9675, P-AP:0.6180, P-F1:0.6210, P-AUPRO:0.9252



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；saturation=0.9
augmented_image = TF.adjust_saturation(augmented_image, saturation)

cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7819, P-F1:0.7312, P-AUPRO:0.9812
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9932, P-AP:0.5164, P-F1:0.5613, P-AUPRO:0.9772
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4273, P-F1:0.4751, P-AUPRO:0.9763
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9940, P-AUROC:0.9741, P-AP:0.7172, P-F1:0.7451, P-AUPRO:0.9038
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9644, P-AP:0.6786, P-F1:0.6634, P-AUPRO:0.9207
bottle: I-Auroc:0.9929, I-AP:0.9977, I-F1:0.9844, P-AUROC:0.9658, P-AP:0.7838, P-F1:0.7415, P-AUPRO:0.9295
cable: I-Auroc:0.8941, I-AP:0.9479, I-F1:0.8671, P-AUROC:0.9238, P-AP:0.5177, P-F1:0.5519, P-AUPRO:0.8187
capsule: I-Auroc:0.9238, I-AP:0.9834, I-F1:0.9397, P-AUROC:0.9778, P-AP:0.5047, P-F1:0.4967, P-AUPRO:0.9628
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9928, P-AUROC:0.9893, P-AP:0.7663, P-F1:0.7389, P-AUPRO:0.9505
metal_nut: I-Auroc:0.9668, I-AP:0.9927, I-F1:0.9529, P-AUROC:0.9031, P-AP:0.6498, P-F1:0.6374, P-AUPRO:0.8531
pill: I-Auroc:0.9798, I-AP:0.9965, I-F1:0.9718, P-AUROC:0.9131, P-AP:0.5277, P-F1:0.5597, P-AUPRO:0.9479
screw: I-Auroc:0.6175, I-AP:0.8020, I-F1:0.8655, P-AUROC:0.9659, P-AP:0.2125, P-F1:0.2810, P-AUPRO:0.8790
toothbrush: I-Auroc:0.9861, I-AP:0.9952, I-F1:0.9831, P-AUROC:0.9926, P-AP:0.7585, P-F1:0.7227, P-AUPRO:0.9490
transistor: I-Auroc:0.9771, I-AP:0.9618, I-F1:0.9114, P-AUROC:0.8729, P-AP:0.4558, P-F1:0.4569, P-AUPRO:0.7021
zipper: I-Auroc:0.9955, I-AP:0.9988, I-F1:0.9874, P-AUROC:0.9695, P-AP:0.5924, P-F1:0.5903, P-AUPRO:0.9167
Mean: I-Auroc:0.9548, I-AP:0.9781, I-F1:0.9618, P-AUROC:0.9593, P-AP:0.5927, P-F1:0.5969, P-AUPRO:0.9112
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7655, P-F1:0.7183, P-AUPRO:0.9799
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5308, P-F1:0.5730, P-AUPRO:0.9767
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9902, P-AP:0.4165, P-F1:0.4700, P-AUPRO:0.9757
tile: I-Auroc:0.9964, I-AP:0.9987, I-F1:0.9881, P-AUROC:0.9744, P-AP:0.7165, P-F1:0.7427, P-AUPRO:0.8991
wood: I-Auroc:0.9965, I-AP:0.9989, I-F1:0.9833, P-AUROC:0.9665, P-AP:0.6749, P-F1:0.6635, P-AUPRO:0.9254
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9921, P-AUROC:0.9734, P-AP:0.8050, P-F1:0.7568, P-AUPRO:0.9434
cable: I-Auroc:0.9503, I-AP:0.9730, I-F1:0.9036, P-AUROC:0.9455, P-AP:0.5791, P-F1:0.6015, P-AUPRO:0.8630
capsule: I-Auroc:0.9314, I-AP:0.9847, I-F1:0.9561, P-AUROC:0.9779, P-AP:0.5136, P-F1:0.5041, P-AUPRO:0.9651
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9899, P-AP:0.7704, P-F1:0.7456, P-AUPRO:0.9577
metal_nut: I-Auroc:0.9839, I-AP:0.9963, I-F1:0.9730, P-AUROC:0.9260, P-AP:0.7150, P-F1:0.7039, P-AUPRO:0.8822
pill: I-Auroc:0.9795, I-AP:0.9965, I-F1:0.9714, P-AUROC:0.9189, P-AP:0.5367, P-F1:0.5633, P-AUPRO:0.9518
screw: I-Auroc:0.6436, I-AP:0.8093, I-F1:0.8731, P-AUROC:0.9632, P-AP:0.2085, P-F1:0.2716, P-AUPRO:0.8760
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9922, P-AP:0.7378, P-F1:0.7104, P-AUPRO:0.9566
transistor: I-Auroc:0.9862, I-AP:0.9756, I-F1:0.9412, P-AUROC:0.8918, P-AP:0.4815, P-F1:0.4746, P-AUPRO:0.7297
zipper: I-Auroc:0.9979, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9704, P-AP:0.6000, P-F1:0.5960, P-AUPRO:0.9177
Mean: I-Auroc:0.9626, I-AP:0.9816, I-F1:0.9690, P-AUROC:0.9645, P-AP:0.6035, P-F1:0.6064, P-AUPRO:0.9200
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7702, P-F1:0.7187, P-AUPRO:0.9798
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5259, P-F1:0.5681, P-AUPRO:0.9771
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4070, P-F1:0.4609, P-AUPRO:0.9752
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9746, P-AP:0.7158, P-F1:0.7429, P-AUPRO:0.9051
wood: I-Auroc:0.9930, I-AP:0.9979, I-F1:0.9833, P-AUROC:0.9665, P-AP:0.6777, P-F1:0.6664, P-AUPRO:0.9211
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9766, P-AP:0.8154, P-F1:0.7678, P-AUPRO:0.9471
cable: I-Auroc:0.9805, I-AP:0.9882, I-F1:0.9468, P-AUROC:0.9531, P-AP:0.5996, P-F1:0.6170, P-AUPRO:0.8779
capsule: I-Auroc:0.9844, I-AP:0.9967, I-F1:0.9722, P-AUROC:0.9817, P-AP:0.5622, P-F1:0.5553, P-AUPRO:0.9717
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.8078, P-F1:0.7656, P-AUPRO:0.9667
metal_nut: I-Auroc:0.9951, I-AP:0.9989, I-F1:0.9789, P-AUROC:0.9324, P-AP:0.7403, P-F1:0.7270, P-AUPRO:0.8910
pill: I-Auroc:0.9768, I-AP:0.9959, I-F1:0.9677, P-AUROC:0.9215, P-AP:0.5415, P-F1:0.5690, P-AUPRO:0.9513
screw: I-Auroc:0.6854, I-AP:0.8423, I-F1:0.8848, P-AUROC:0.9697, P-AP:0.2639, P-F1:0.3398, P-AUPRO:0.8904
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7474, P-F1:0.7277, P-AUPRO:0.9621
transistor: I-Auroc:0.9917, I-AP:0.9873, I-F1:0.9639, P-AUROC:0.8993, P-AP:0.4939, P-F1:0.4825, P-AUPRO:0.7417
zipper: I-Auroc:0.9974, I-AP:0.9993, I-F1:0.9916, P-AUROC:0.9738, P-AP:0.6062, P-F1:0.6039, P-AUPRO:0.9291
Mean: I-Auroc:0.9731, I-AP:0.9869, I-F1:0.9779, P-AUROC:0.9675, P-AP:0.6183, P-F1:0.6208, P-AUPRO:0.9258




-------------------------------------------------------------------------------------------------------------------------------------
# Baseline （无四张增强）
cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9932, P-AP:0.7456, P-F1:0.7207, P-AUPRO:0.9823
grid: I-Auroc:0.9967, I-AP:0.9988, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5445, P-F1:0.5889, P-AUPRO:0.9766
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9886, P-AP:0.3938, P-F1:0.4371, P-AUPRO:0.9766
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9711, P-AP:0.7047, P-F1:0.7323, P-AUPRO:0.9051
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9631, P-AP:0.6818, P-F1:0.6685, P-AUPRO:0.9233
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9771, P-AP:0.8390, P-F1:0.7880, P-AUPRO:0.9496
cable: I-Auroc:0.9121, I-AP:0.9579, I-F1:0.8876, P-AUROC:0.9287, P-AP:0.6000, P-F1:0.6230, P-AUPRO:0.8455
capsule: I-Auroc:0.7754, I-AP:0.9411, I-F1:0.9138, P-AUROC:0.9616, P-AP:0.3682, P-F1:0.4102, P-AUPRO:0.9394
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9883, P-AP:0.7472, P-F1:0.7445, P-AUPRO:0.9484
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.8906, P-AP:0.6066, P-F1:0.6055, P-AUPRO:0.8718
pill: I-Auroc:0.9689, I-AP:0.9944, I-F1:0.9648, P-AUROC:0.8957, P-AP:0.5027, P-F1:0.5409, P-AUPRO:0.9384
screw: I-Auroc:0.6409, I-AP:0.8133, I-F1:0.8679, P-AUROC:0.9693, P-AP:0.2352, P-F1:0.3070, P-AUPRO:0.8906
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9918, P-AP:0.7119, P-F1:0.7043, P-AUPRO:0.9561
transistor: I-Auroc:0.9558, I-AP:0.9235, I-F1:0.9176, P-AUROC:0.8746, P-AP:0.4577, P-F1:0.4549, P-AUPRO:0.6973
zipper: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9376, P-AP:0.5151, P-F1:0.5189, P-AUPRO:0.8605
Mean: I-Auroc:0.9496, I-AP:0.9752, I-F1:0.9670, P-AUROC:0.9550, P-AP:0.5769, P-F1:0.5897, P-AUPRO:0.9108
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9929, P-AP:0.7254, P-F1:0.7132, P-AUPRO:0.9819
grid: I-Auroc:0.9883, I-AP:0.9965, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5520, P-F1:0.6024, P-AUPRO:0.9781
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9884, P-AP:0.3837, P-F1:0.4224, P-AUPRO:0.9774
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9724, P-AP:0.7118, P-F1:0.7360, P-AUPRO:0.9062
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9662, P-AP:0.6834, P-F1:0.6701, P-AUPRO:0.9263
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9824, P-AP:0.8537, P-F1:0.8042, P-AUPRO:0.9581
cable: I-Auroc:0.9353, I-AP:0.9676, I-F1:0.9059, P-AUROC:0.9463, P-AP:0.6448, P-F1:0.6537, P-AUPRO:0.8779
capsule: I-Auroc:0.8022, I-AP:0.9490, I-F1:0.9339, P-AUROC:0.9627, P-AP:0.3853, P-F1:0.4287, P-AUPRO:0.9437
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9891, P-AP:0.7546, P-F1:0.7495, P-AUPRO:0.9542
metal_nut: I-Auroc:0.9980, I-AP:0.9996, I-F1:0.9946, P-AUROC:0.9144, P-AP:0.6625, P-F1:0.6659, P-AUPRO:0.8912
pill: I-Auroc:0.9768, I-AP:0.9959, I-F1:0.9749, P-AUROC:0.9012, P-AP:0.5198, P-F1:0.5487, P-AUPRO:0.9451
screw: I-Auroc:0.6643, I-AP:0.8243, I-F1:0.8764, P-AUROC:0.9654, P-AP:0.2324, P-F1:0.2979, P-AUPRO:0.8853
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9911, P-AP:0.6908, P-F1:0.6916, P-AUPRO:0.9596
transistor: I-Auroc:0.9775, I-AP:0.9577, I-F1:0.9286, P-AUROC:0.8873, P-AP:0.4715, P-F1:0.4644, P-AUPRO:0.7109
zipper: I-Auroc:0.9989, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9411, P-AP:0.5251, P-F1:0.5301, P-AUPRO:0.8626
Mean: I-Auroc:0.9560, I-AP:0.9793, I-F1:0.9726, P-AUROC:0.9597, P-AP:0.5864, P-F1:0.5986, P-AUPRO:0.9172
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9931, P-AP:0.7292, P-F1:0.7141, P-AUPRO:0.9822
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5464, P-F1:0.5968, P-AUPRO:0.9769
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9883, P-AP:0.3794, P-F1:0.4201, P-AUPRO:0.9763
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9730, P-AP:0.7097, P-F1:0.7373, P-AUPRO:0.9092
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9833, P-AUROC:0.9660, P-AP:0.6838, P-F1:0.6692, P-AUPRO:0.9180
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9844, P-AP:0.8620, P-F1:0.8086, P-AUPRO:0.9597
cable: I-Auroc:0.9732, I-AP:0.9850, I-F1:0.9326, P-AUROC:0.9534, P-AP:0.6704, P-F1:0.6682, P-AUPRO:0.8881
capsule: I-Auroc:0.9637, I-AP:0.9922, I-F1:0.9633, P-AUROC:0.9684, P-AP:0.5223, P-F1:0.5241, P-AUPRO:0.9582
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.7919, P-F1:0.7663, P-AUPRO:0.9620
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.9209, P-AP:0.6878, P-F1:0.6892, P-AUPRO:0.8979
pill: I-Auroc:0.9730, I-AP:0.9951, I-F1:0.9677, P-AUROC:0.9049, P-AP:0.5217, P-F1:0.5549, P-AUPRO:0.9473
screw: I-Auroc:0.7085, I-AP:0.8572, I-F1:0.8923, P-AUROC:0.9716, P-AP:0.2881, P-F1:0.3599, P-AUPRO:0.8989
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.6990, P-F1:0.7064, P-AUPRO:0.9644
transistor: I-Auroc:0.9796, I-AP:0.9698, I-F1:0.9136, P-AUROC:0.8952, P-AP:0.4806, P-F1:0.4702, P-AUPRO:0.7182
zipper: I-Auroc:0.9987, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9501, P-AP:0.5494, P-F1:0.5502, P-AUPRO:0.8789
Mean: I-Auroc:0.9724, I-AP:0.9864, I-F1:0.9753, P-AUROC:0.9633, P-AP:0.6081, P-F1:0.6157, P-AUPRO:0.9224






-------------------------------------------------------------------------------------------------------------------------------------
# Baseline + 3次旋转 + 水平翻转 + 垂直翻转

cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9931, P-AP:0.7289, P-F1:0.7167, P-AUPRO:0.9821
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5437, P-F1:0.5932, P-AUPRO:0.9763
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9883, P-AP:0.3981, P-F1:0.4262, P-AUPRO:0.9746
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9725, P-AP:0.7073, P-F1:0.7352, P-AUPRO:0.9108
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9664, P-AP:0.6901, P-F1:0.6829, P-AUPRO:0.9219
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9789, P-AP:0.8437, P-F1:0.7958, P-AUPRO:0.9517
cable: I-Auroc:0.9419, I-AP:0.9714, I-F1:0.9205, P-AUROC:0.9299, P-AP:0.6253, P-F1:0.6527, P-AUPRO:0.8589
capsule: I-Auroc:0.7874, I-AP:0.9466, I-F1:0.9145, P-AUROC:0.9627, P-AP:0.3787, P-F1:0.4153, P-AUPRO:0.9397
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9929, P-AUROC:0.9905, P-AP:0.7552, P-F1:0.7462, P-AUPRO:0.9596
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.8823, P-AP:0.5926, P-F1:0.5908, P-AUPRO:0.8716
pill: I-Auroc:0.9700, I-AP:0.9945, I-F1:0.9648, P-AUROC:0.8995, P-AP:0.5258, P-F1:0.5498, P-AUPRO:0.9415
screw: I-Auroc:0.9221, I-AP:0.9740, I-F1:0.9218, P-AUROC:0.9875, P-AP:0.4802, P-F1:0.5137, P-AUPRO:0.9461
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9923, P-AP:0.7264, P-F1:0.7118, P-AUPRO:0.9567
transistor: I-Auroc:0.9479, I-AP:0.9188, I-F1:0.9157, P-AUROC:0.8529, P-AP:0.3836, P-F1:0.4010, P-AUPRO:0.6836
zipper: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9444, P-AP:0.5262, P-F1:0.5248, P-AUPRO:0.8711
Mean: I-Auroc:0.9707, I-AP:0.9868, I-F1:0.9735, P-AUROC:0.9557, P-AP:0.5937, P-F1:0.6037, P-AUPRO:0.9164
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9930, P-AP:0.7210, P-F1:0.7115, P-AUPRO:0.9810
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5485, P-F1:0.6002, P-AUPRO:0.9780
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9878, P-AP:0.3803, P-F1:0.4108, P-AUPRO:0.9748
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9732, P-AP:0.7097, P-F1:0.7381, P-AUPRO:0.9094
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9690, P-AP:0.6896, P-F1:0.6807, P-AUPRO:0.9279
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9836, P-AP:0.8565, P-F1:0.8095, P-AUPRO:0.9591
cable: I-Auroc:0.9511, I-AP:0.9754, I-F1:0.9205, P-AUROC:0.9386, P-AP:0.6464, P-F1:0.6662, P-AUPRO:0.8734
capsule: I-Auroc:0.8177, I-AP:0.9555, I-F1:0.9292, P-AUROC:0.9640, P-AP:0.4019, P-F1:0.4358, P-AUPRO:0.9470
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9929, P-AUROC:0.9918, P-AP:0.7752, P-F1:0.7570, P-AUPRO:0.9667
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9041, P-AP:0.6470, P-F1:0.6508, P-AUPRO:0.8910
pill: I-Auroc:0.9752, I-AP:0.9956, I-F1:0.9712, P-AUROC:0.9051, P-AP:0.5408, P-F1:0.5597, P-AUPRO:0.9468
screw: I-Auroc:0.9176, I-AP:0.9724, I-F1:0.9083, P-AUROC:0.9890, P-AP:0.4946, P-F1:0.5279, P-AUPRO:0.9582
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9915, P-AP:0.7101, P-F1:0.6981, P-AUPRO:0.9611
transistor: I-Auroc:0.9579, I-AP:0.9404, I-F1:0.9157, P-AUROC:0.8664, P-AP:0.4003, P-F1:0.4129, P-AUPRO:0.7017
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9475, P-AP:0.5430, P-F1:0.5409, P-AUPRO:0.8744
Mean: I-Auroc:0.9740, I-AP:0.9891, I-F1:0.9741, P-AUROC:0.9599, P-AP:0.6043, P-F1:0.6133, P-AUPRO:0.9234
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9931, P-AP:0.7154, P-F1:0.7128, P-AUPRO:0.9816
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5447, P-F1:0.5990, P-AUPRO:0.9778
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9877, P-AP:0.3794, P-F1:0.4093, P-AUPRO:0.9739
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9737, P-AP:0.7129, P-F1:0.7398, P-AUPRO:0.9092
wood: I-Auroc:0.9930, I-AP:0.9978, I-F1:0.9756, P-AUROC:0.9692, P-AP:0.6977, P-F1:0.6813, P-AUPRO:0.9212
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9853, P-AP:0.8654, P-F1:0.8126, P-AUPRO:0.9616
cable: I-Auroc:0.9685, I-AP:0.9831, I-F1:0.9318, P-AUROC:0.9424, P-AP:0.6580, P-F1:0.6686, P-AUPRO:0.8800
capsule: I-Auroc:0.9609, I-AP:0.9919, I-F1:0.9550, P-AUROC:0.9689, P-AP:0.5211, P-F1:0.5254, P-AUPRO:0.9586
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.7993, P-F1:0.7686, P-AUPRO:0.9708
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9091, P-AP:0.6622, P-F1:0.6666, P-AUPRO:0.8957
pill: I-Auroc:0.9703, I-AP:0.9947, I-F1:0.9675, P-AUROC:0.9088, P-AP:0.5415, P-F1:0.5635, P-AUPRO:0.9479
screw: I-Auroc:0.9131, I-AP:0.9695, I-F1:0.9163, P-AUROC:0.9905, P-AP:0.5192, P-F1:0.5375, P-AUPRO:0.9590
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9931, P-AP:0.7256, P-F1:0.7156, P-AUPRO:0.9661
transistor: I-Auroc:0.9654, I-AP:0.9540, I-F1:0.9176, P-AUROC:0.8715, P-AP:0.4025, P-F1:0.4170, P-AUPRO:0.7038
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9958, P-AUROC:0.9538, P-AP:0.5674, P-F1:0.5652, P-AUPRO:0.8898
Mean: I-Auroc:0.9842, I-AP:0.9926, I-F1:0.9763, P-AUROC:0.9623, P-AP:0.6208, P-F1:0.6255, P-AUPRO:0.9265



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
transforms.Lambda(lambda x: torch.flip(x,dims=[-2]))  # 垂直翻转
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来
原始的结果*0.7 + 增强后的结果*0.3 = anomaly_map；

cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7484, P-F1:0.7247, P-AUPRO:0.9827
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5640, P-F1:0.5979, P-AUPRO:0.9772
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9889, P-AP:0.3973, P-F1:0.4375, P-AUPRO:0.9775
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9725, P-AP:0.7106, P-F1:0.7367, P-AUPRO:0.9100
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9651, P-AP:0.6895, P-F1:0.6757, P-AUPRO:0.9246
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9783, P-AP:0.8447, P-F1:0.7916, P-AUPRO:0.9513
cable: I-Auroc:0.9164, I-AP:0.9596, I-F1:0.8927, P-AUROC:0.9311, P-AP:0.6116, P-F1:0.6327, P-AUPRO:0.8483
capsule: I-Auroc:0.7854, I-AP:0.9446, I-F1:0.9185, P-AUROC:0.9630, P-AP:0.3804, P-F1:0.4168, P-AUPRO:0.9418
hazelnut: I-Auroc:0.9982, I-AP:0.9990, I-F1:0.9857, P-AUROC:0.9888, P-AP:0.7485, P-F1:0.7460, P-AUPRO:0.9503
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.8942, P-AP:0.6149, P-F1:0.6129, P-AUPRO:0.8746
pill: I-Auroc:0.9755, I-AP:0.9956, I-F1:0.9751, P-AUROC:0.8972, P-AP:0.5082, P-F1:0.5452, P-AUPRO:0.9444
screw: I-Auroc:0.6487, I-AP:0.8251, I-F1:0.8679, P-AUROC:0.9704, P-AP:0.2683, P-F1:0.3274, P-AUPRO:0.8917
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9923, P-AP:0.7215, P-F1:0.7132, P-AUPRO:0.9587
transistor: I-Auroc:0.9675, I-AP:0.9472, I-F1:0.9286, P-AUROC:0.8822, P-AP:0.4729, P-F1:0.4667, P-AUPRO:0.7125
zipper: I-Auroc:0.9984, I-AP:0.9996, I-F1:0.9915, P-AUROC:0.9362, P-AP:0.5108, P-F1:0.5144, P-AUPRO:0.8586
Mean: I-Auroc:0.9520, I-AP:0.9778, I-F1:0.9682, P-AUROC:0.9565, P-AP:0.5861, P-F1:0.5960, P-AUPRO:0.9136
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9932, P-AP:0.7312, P-F1:0.7173, P-AUPRO:0.9817
grid: I-Auroc:0.9891, I-AP:0.9967, I-F1:0.9912, P-AUROC:0.9946, P-AP:0.5739, P-F1:0.6157, P-AUPRO:0.9782
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9887, P-AP:0.3866, P-F1:0.4211, P-AUPRO:0.9771
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9735, P-AP:0.7169, P-F1:0.7398, P-AUPRO:0.9081
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9679, P-AP:0.6917, P-F1:0.6751, P-AUPRO:0.9307
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9833, P-AP:0.8585, P-F1:0.8080, P-AUPRO:0.9611
cable: I-Auroc:0.9382, I-AP:0.9691, I-F1:0.9112, P-AUROC:0.9485, P-AP:0.6523, P-F1:0.6613, P-AUPRO:0.8831
capsule: I-Auroc:0.8097, I-AP:0.9517, I-F1:0.9339, P-AUROC:0.9641, P-AP:0.3997, P-F1:0.4348, P-AUPRO:0.9462
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9895, P-AP:0.7575, P-F1:0.7506, P-AUPRO:0.9542
metal_nut: I-Auroc:0.9980, I-AP:0.9995, I-F1:0.9892, P-AUROC:0.9187, P-AP:0.6748, P-F1:0.6795, P-AUPRO:0.8963
pill: I-Auroc:0.9790, I-AP:0.9962, I-F1:0.9786, P-AUROC:0.9037, P-AP:0.5256, P-F1:0.5531, P-AUPRO:0.9494
screw: I-Auroc:0.6733, I-AP:0.8297, I-F1:0.8731, P-AUROC:0.9667, P-AP:0.2594, P-F1:0.3180, P-AUPRO:0.8900
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9913, P-AP:0.6947, P-F1:0.6950, P-AUPRO:0.9616
transistor: I-Auroc:0.9821, I-AP:0.9675, I-F1:0.9630, P-AUROC:0.8937, P-AP:0.4852, P-F1:0.4751, P-AUPRO:0.7226
zipper: I-Auroc:0.9987, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9404, P-AP:0.5264, P-F1:0.5303, P-AUPRO:0.8631
Mean: I-Auroc:0.9578, I-AP:0.9806, I-F1:0.9749, P-AUROC:0.9612, P-AP:0.5956, P-F1:0.6050, P-AUPRO:0.9202
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9933, P-AP:0.7333, P-F1:0.7181, P-AUPRO:0.9833
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9946, P-AP:0.5710, P-F1:0.6130, P-AUPRO:0.9790
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9886, P-AP:0.3858, P-F1:0.4211, P-AUPRO:0.9776
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9739, P-AP:0.7142, P-F1:0.7408, P-AUPRO:0.9118
wood: I-Auroc:0.9947, I-AP:0.9984, I-F1:0.9833, P-AUROC:0.9680, P-AP:0.6919, P-F1:0.6741, P-AUPRO:0.9245
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9852, P-AP:0.8668, P-F1:0.8118, P-AUPRO:0.9627
cable: I-Auroc:0.9745, I-AP:0.9860, I-F1:0.9432, P-AUROC:0.9555, P-AP:0.6740, P-F1:0.6723, P-AUPRO:0.8965
capsule: I-Auroc:0.9637, I-AP:0.9920, I-F1:0.9636, P-AUROC:0.9697, P-AP:0.5308, P-F1:0.5280, P-AUPRO:0.9609
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9928, P-AP:0.7941, P-F1:0.7694, P-AUPRO:0.9634
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.9242, P-AP:0.6977, P-F1:0.7021, P-AUPRO:0.9004
pill: I-Auroc:0.9752, I-AP:0.9956, I-F1:0.9749, P-AUROC:0.9073, P-AP:0.5278, P-F1:0.5599, P-AUPRO:0.9510
screw: I-Auroc:0.7237, I-AP:0.8691, I-F1:0.8872, P-AUROC:0.9731, P-AP:0.3265, P-F1:0.3895, P-AUPRO:0.9018
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9927, P-AP:0.7018, P-F1:0.7064, P-AUPRO:0.9665
transistor: I-Auroc:0.9871, I-AP:0.9823, I-F1:0.9211, P-AUROC:0.9014, P-AP:0.4950, P-F1:0.4822, P-AUPRO:0.7310
zipper: I-Auroc:0.9987, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9497, P-AP:0.5521, P-F1:0.5515, P-AUPRO:0.8839
Mean: I-Auroc:0.9740, I-AP:0.9880, I-F1:0.9761, P-AUROC:0.9647, P-AP:0.6175, P-F1:0.6227, P-AUPRO:0.9263



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
transforms.Lambda(lambda x: x[[2, 1, 0], :, :])  # 通道交换
anomaly_map_aug1 = model(aug_img, aug_supports, memorize_supports, use_memory, aug=1)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug1

cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7531, P-F1:0.7263, P-AUPRO:0.9838
grid: I-Auroc:0.9967, I-AP:0.9988, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5438, P-F1:0.5881, P-AUPRO:0.9765
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9885, P-AP:0.3897, P-F1:0.4330, P-AUPRO:0.9765
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9721, P-AP:0.7076, P-F1:0.7354, P-AUPRO:0.9105
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9636, P-AP:0.6822, P-F1:0.6693, P-AUPRO:0.9233
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9766, P-AP:0.8383, P-F1:0.7886, P-AUPRO:0.9484
cable: I-Auroc:0.9106, I-AP:0.9574, I-F1:0.8889, P-AUROC:0.9283, P-AP:0.6003, P-F1:0.6266, P-AUPRO:0.8455
capsule: I-Auroc:0.7750, I-AP:0.9403, I-F1:0.9145, P-AUROC:0.9628, P-AP:0.3746, P-F1:0.4135, P-AUPRO:0.9416
hazelnut: I-Auroc:0.9982, I-AP:0.9990, I-F1:0.9857, P-AUROC:0.9882, P-AP:0.7458, P-F1:0.7453, P-AUPRO:0.9477
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.8911, P-AP:0.6079, P-F1:0.6064, P-AUPRO:0.8709
pill: I-Auroc:0.9686, I-AP:0.9944, I-F1:0.9650, P-AUROC:0.8963, P-AP:0.5023, P-F1:0.5404, P-AUPRO:0.9361
screw: I-Auroc:0.6419, I-AP:0.8146, I-F1:0.8679, P-AUROC:0.9687, P-AP:0.2344, P-F1:0.3037, P-AUPRO:0.8868
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9920, P-AP:0.7147, P-F1:0.7067, P-AUPRO:0.9572
transistor: I-Auroc:0.9604, I-AP:0.9294, I-F1:0.9176, P-AUROC:0.8762, P-AP:0.4600, P-F1:0.4572, P-AUPRO:0.6989
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9360, P-AP:0.5092, P-F1:0.5138, P-AUPRO:0.8616
Mean: I-Auroc:0.9498, I-AP:0.9755, I-F1:0.9666, P-AUROC:0.9552, P-AP:0.5776, P-F1:0.5903, P-AUPRO:0.9110
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9933, P-AP:0.7357, P-F1:0.7181, P-AUPRO:0.9822
grid: I-Auroc:0.9883, I-AP:0.9965, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5503, P-F1:0.6019, P-AUPRO:0.9768
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9882, P-AP:0.3794, P-F1:0.4175, P-AUPRO:0.9751
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9732, P-AP:0.7148, P-F1:0.7390, P-AUPRO:0.9065
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9666, P-AP:0.6829, P-F1:0.6689, P-AUPRO:0.9267
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9821, P-AP:0.8534, P-F1:0.8042, P-AUPRO:0.9588
cable: I-Auroc:0.9382, I-AP:0.9686, I-F1:0.9061, P-AUROC:0.9462, P-AP:0.6423, P-F1:0.6549, P-AUPRO:0.8798
capsule: I-Auroc:0.8002, I-AP:0.9484, I-F1:0.9339, P-AUROC:0.9639, P-AP:0.3885, P-F1:0.4324, P-AUPRO:0.9462
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9890, P-AP:0.7538, P-F1:0.7489, P-AUPRO:0.9543
metal_nut: I-Auroc:0.9985, I-AP:0.9997, I-F1:0.9946, P-AUROC:0.9147, P-AP:0.6635, P-F1:0.6665, P-AUPRO:0.8918
pill: I-Auroc:0.9741, I-AP:0.9955, I-F1:0.9716, P-AUROC:0.9021, P-AP:0.5186, P-F1:0.5477, P-AUPRO:0.9435
screw: I-Auroc:0.6635, I-AP:0.8245, I-F1:0.8764, P-AUROC:0.9646, P-AP:0.2334, P-F1:0.2976, P-AUPRO:0.8849
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9914, P-AP:0.6957, P-F1:0.6952, P-AUPRO:0.9613
transistor: I-Auroc:0.9800, I-AP:0.9607, I-F1:0.9500, P-AUROC:0.8884, P-AP:0.4726, P-F1:0.4655, P-AUPRO:0.7148
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9397, P-AP:0.5209, P-F1:0.5266, P-AUPRO:0.8591
Mean: I-Auroc:0.9561, I-AP:0.9795, I-F1:0.9738, P-AUROC:0.9598, P-AP:0.5871, P-F1:0.5990, P-AUPRO:0.9175
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7391, P-F1:0.7188, P-AUPRO:0.9832
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5456, P-F1:0.5963, P-AUPRO:0.9773
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9881, P-AP:0.3749, P-F1:0.4149, P-AUPRO:0.9752
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9738, P-AP:0.7132, P-F1:0.7401, P-AUPRO:0.9131
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9833, P-AUROC:0.9660, P-AP:0.6836, P-F1:0.6677, P-AUPRO:0.9207
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9842, P-AP:0.8615, P-F1:0.8088, P-AUPRO:0.9601
cable: I-Auroc:0.9743, I-AP:0.9854, I-F1:0.9318, P-AUROC:0.9536, P-AP:0.6681, P-F1:0.6679, P-AUPRO:0.8894
capsule: I-Auroc:0.9633, I-AP:0.9920, I-F1:0.9593, P-AUROC:0.9696, P-AP:0.5291, P-F1:0.5289, P-AUPRO:0.9600
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9925, P-AP:0.7889, P-F1:0.7654, P-AUPRO:0.9637
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.9213, P-AP:0.6893, P-F1:0.6910, P-AUPRO:0.8962
pill: I-Auroc:0.9711, I-AP:0.9949, I-F1:0.9677, P-AUROC:0.9066, P-AP:0.5223, P-F1:0.5560, P-AUPRO:0.9451
screw: I-Auroc:0.7079, I-AP:0.8567, I-F1:0.8889, P-AUROC:0.9711, P-AP:0.2879, P-F1:0.3584, P-AUPRO:0.8963
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9928, P-AP:0.7027, P-F1:0.7082, P-AUPRO:0.9642
transistor: I-Auroc:0.9833, I-AP:0.9745, I-F1:0.9412, P-AUROC:0.8960, P-AP:0.4819, P-F1:0.4710, P-AUPRO:0.7213
zipper: I-Auroc:0.9987, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9489, P-AP:0.5455, P-F1:0.5467, P-AUPRO:0.8768
Mean: I-Auroc:0.9723, I-AP:0.9866, I-F1:0.9761, P-AUROC:0.9635, P-AP:0.6089, P-F1:0.6160, P-AUPRO:0.9228



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = 0.6 * anomaly_map_ori + 0.2 * anomaly_map_aug1 + 0.2 * anomaly_map_aug2

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.7764, P-F1:0.7310, P-AUPRO:0.9821
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5401, P-F1:0.5845, P-AUPRO:0.9777
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9904, P-AP:0.4236, P-F1:0.4702, P-AUPRO:0.9781
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9739, P-AP:0.7157, P-F1:0.7435, P-AUPRO:0.9074
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9651, P-AP:0.6840, P-F1:0.6706, P-AUPRO:0.9252
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9921, P-AUROC:0.9726, P-AP:0.8141, P-F1:0.7620, P-AUPRO:0.9427
cable: I-Auroc:0.9042, I-AP:0.9530, I-F1:0.8786, P-AUROC:0.9291, P-AP:0.5641, P-F1:0.5958, P-AUPRO:0.8383
capsule: I-Auroc:0.8903, I-AP:0.9749, I-F1:0.9381, P-AUROC:0.9708, P-AP:0.4771, P-F1:0.4779, P-AUPRO:0.9566
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9928, P-AUROC:0.9903, P-AP:0.7716, P-F1:0.7487, P-AUPRO:0.9543
metal_nut: I-Auroc:0.9863, I-AP:0.9969, I-F1:0.9733, P-AUROC:0.9032, P-AP:0.6451, P-F1:0.6362, P-AUPRO:0.8677
pill: I-Auroc:0.9798, I-AP:0.9965, I-F1:0.9753, P-AUROC:0.9088, P-AP:0.5222, P-F1:0.5496, P-AUPRO:0.9485
screw: I-Auroc:0.6368, I-AP:0.8171, I-F1:0.8655, P-AUROC:0.9672, P-AP:0.2473, P-F1:0.3106, P-AUPRO:0.8828
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9930, P-AP:0.7575, P-F1:0.7281, P-AUPRO:0.9559
transistor: I-Auroc:0.9846, I-AP:0.9742, I-F1:0.9412, P-AUROC:0.8842, P-AP:0.4784, P-F1:0.4712, P-AUPRO:0.7202
zipper: I-Auroc:0.9966, I-AP:0.9991, I-F1:0.9873, P-AUROC:0.9610, P-AP:0.5625, P-F1:0.5639, P-AUPRO:0.9011
Mean: I-Auroc:0.9574, I-AP:0.9804, I-F1:0.9669, P-AUROC:0.9598, P-AP:0.5986, P-F1:0.6029, P-AUPRO:0.9159
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7598, P-F1:0.7195, P-AUPRO:0.9813
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5549, P-F1:0.6028, P-AUPRO:0.9775
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4101, P-F1:0.4600, P-AUPRO:0.9778
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9745, P-AP:0.7182, P-F1:0.7443, P-AUPRO:0.9024
wood: I-Auroc:0.9982, I-AP:0.9994, I-F1:0.9917, P-AUROC:0.9675, P-AP:0.6835, P-F1:0.6710, P-AUPRO:0.9290
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9787, P-AP:0.8317, P-F1:0.7804, P-AUPRO:0.9529
cable: I-Auroc:0.9466, I-AP:0.9723, I-F1:0.9123, P-AUROC:0.9489, P-AP:0.6176, P-F1:0.6352, P-AUPRO:0.8791
capsule: I-Auroc:0.8927, I-AP:0.9750, I-F1:0.9478, P-AUROC:0.9711, P-AP:0.4910, P-F1:0.4887, P-AUPRO:0.9589
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9907, P-AP:0.7762, P-F1:0.7540, P-AUPRO:0.9601
metal_nut: I-Auroc:0.9936, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9265, P-AP:0.7094, P-F1:0.7052, P-AUPRO:0.8931
pill: I-Auroc:0.9828, I-AP:0.9970, I-F1:0.9821, P-AUROC:0.9144, P-AP:0.5339, P-F1:0.5558, P-AUPRO:0.9536
screw: I-Auroc:0.6626, I-AP:0.8222, I-F1:0.8764, P-AUROC:0.9636, P-AP:0.2372, P-F1:0.2979, P-AUPRO:0.8817
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9923, P-AP:0.7343, P-F1:0.7113, P-AUPRO:0.9611
transistor: I-Auroc:0.9896, I-AP:0.9812, I-F1:0.9639, P-AUROC:0.8996, P-AP:0.4984, P-F1:0.4847, P-AUPRO:0.7389
zipper: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9915, P-AUROC:0.9626, P-AP:0.5733, P-F1:0.5723, P-AUPRO:0.9030
Mean: I-Auroc:0.9631, I-AP:0.9827, I-F1:0.9736, P-AUROC:0.9646, P-AP:0.6086, P-F1:0.6122, P-AUPRO:0.9234
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9937, P-AP:0.7638, P-F1:0.7199, P-AUPRO:0.9816
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5514, P-F1:0.5924, P-AUPRO:0.9782
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.3986, P-F1:0.4513, P-AUPRO:0.9757
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9747, P-AP:0.7168, P-F1:0.7447, P-AUPRO:0.9044
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9833, P-AUROC:0.9676, P-AP:0.6851, P-F1:0.6716, P-AUPRO:0.9231
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9813, P-AP:0.8405, P-F1:0.7884, P-AUPRO:0.9554
cable: I-Auroc:0.9796, I-AP:0.9885, I-F1:0.9432, P-AUROC:0.9561, P-AP:0.6379, P-F1:0.6458, P-AUPRO:0.8917
capsule: I-Auroc:0.9805, I-AP:0.9957, I-F1:0.9732, P-AUROC:0.9758, P-AP:0.5584, P-F1:0.5506, P-AUPRO:0.9670
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.8093, P-F1:0.7725, P-AUPRO:0.9683
metal_nut: I-Auroc:0.9985, I-AP:0.9997, I-F1:0.9946, P-AUROC:0.9323, P-AP:0.7331, P-F1:0.7283, P-AUPRO:0.8998
pill: I-Auroc:0.9785, I-AP:0.9963, I-F1:0.9749, P-AUROC:0.9178, P-AP:0.5379, P-F1:0.5625, P-AUPRO:0.9536
screw: I-Auroc:0.7077, I-AP:0.8577, I-F1:0.8897, P-AUROC:0.9704, P-AP:0.3007, P-F1:0.3733, P-AUPRO:0.8943
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7408, P-F1:0.7239, P-AUPRO:0.9654
transistor: I-Auroc:0.9954, I-AP:0.9932, I-F1:0.9639, P-AUROC:0.9067, P-AP:0.5096, P-F1:0.4920, P-AUPRO:0.7501
zipper: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9874, P-AUROC:0.9677, P-AP:0.5865, P-F1:0.5868, P-AUPRO:0.9171
Mean: I-Auroc:0.9750, I-AP:0.9884, I-F1:0.9797, P-AUROC:0.9677, P-AP:0.6247, P-F1:0.6269, P-AUPRO:0.9284



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.7798, P-F1:0.7313, P-AUPRO:0.9813
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9933, P-AP:0.5299, P-F1:0.5648, P-AUPRO:0.9753
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9908, P-AP:0.4328, P-F1:0.4748, P-AUPRO:0.9750
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9748, P-AP:0.7203, P-F1:0.7476, P-AUPRO:0.9054
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9916, P-AUROC:0.9653, P-AP:0.6798, P-F1:0.6659, P-AUPRO:0.9248
bottle: I-Auroc:0.9905, I-AP:0.9970, I-F1:0.9767, P-AUROC:0.9653, P-AP:0.7766, P-F1:0.7341, P-AUPRO:0.9290
cable: I-Auroc:0.8802, I-AP:0.9412, I-F1:0.8642, P-AUROC:0.9234, P-AP:0.5121, P-F1:0.5377, P-AUPRO:0.8163
capsule: I-Auroc:0.9338, I-AP:0.9855, I-F1:0.9427, P-AUROC:0.9749, P-AP:0.5140, P-F1:0.5095, P-AUPRO:0.9596
hazelnut: I-Auroc:0.9982, I-AP:0.9990, I-F1:0.9928, P-AUROC:0.9896, P-AP:0.7683, P-F1:0.7392, P-AUPRO:0.9485
metal_nut: I-Auroc:0.9648, I-AP:0.9923, I-F1:0.9519, P-AUROC:0.9066, P-AP:0.6610, P-F1:0.6469, P-AUPRO:0.8518
pill: I-Auroc:0.9823, I-AP:0.9969, I-F1:0.9753, P-AUROC:0.9133, P-AP:0.5246, P-F1:0.5498, P-AUPRO:0.9517
screw: I-Auroc:0.6288, I-AP:0.8144, I-F1:0.8655, P-AUROC:0.9648, P-AP:0.2437, P-F1:0.3072, P-AUPRO:0.8765
toothbrush: I-Auroc:0.9833, I-AP:0.9944, I-F1:0.9831, P-AUROC:0.9928, P-AP:0.7615, P-F1:0.7288, P-AUPRO:0.9507
transistor: I-Auroc:0.9875, I-AP:0.9805, I-F1:0.9412, P-AUROC:0.8771, P-AP:0.4624, P-F1:0.4634, P-AUPRO:0.7181
zipper: I-Auroc:0.9887, I-AP:0.9969, I-F1:0.9833, P-AUROC:0.9707, P-AP:0.5781, P-F1:0.5838, P-AUPRO:0.9199
Mean: I-Auroc:0.9552, I-AP:0.9797, I-F1:0.9636, P-AUROC:0.9598, P-AP:0.5963, P-F1:0.5990, P-AUPRO:0.9123
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9935, P-AP:0.7645, P-F1:0.7177, P-AUPRO:0.9806
grid: I-Auroc:0.9883, I-AP:0.9965, I-F1:0.9912, P-AUROC:0.9939, P-AP:0.5489, P-F1:0.5763, P-AUPRO:0.9763
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9906, P-AP:0.4190, P-F1:0.4715, P-AUPRO:0.9753
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9881, P-AUROC:0.9750, P-AP:0.7198, P-F1:0.7442, P-AUPRO:0.8979
wood: I-Auroc:0.9965, I-AP:0.9989, I-F1:0.9833, P-AUROC:0.9674, P-AP:0.6789, P-F1:0.6659, P-AUPRO:0.9265
bottle: I-Auroc:0.9944, I-AP:0.9982, I-F1:0.9844, P-AUROC:0.9728, P-AP:0.7985, P-F1:0.7485, P-AUPRO:0.9432
cable: I-Auroc:0.9500, I-AP:0.9731, I-F1:0.9053, P-AUROC:0.9461, P-AP:0.5784, P-F1:0.6015, P-AUPRO:0.8672
capsule: I-Auroc:0.9322, I-AP:0.9849, I-F1:0.9515, P-AUROC:0.9748, P-AP:0.5256, P-F1:0.5159, P-AUPRO:0.9640
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9928, P-AUROC:0.9898, P-AP:0.7709, P-F1:0.7445, P-AUPRO:0.9544
metal_nut: I-Auroc:0.9795, I-AP:0.9953, I-F1:0.9626, P-AUROC:0.9299, P-AP:0.7299, P-F1:0.7187, P-AUPRO:0.8809
pill: I-Auroc:0.9823, I-AP:0.9970, I-F1:0.9786, P-AUROC:0.9193, P-AP:0.5359, P-F1:0.5558, P-AUPRO:0.9537
screw: I-Auroc:0.6573, I-AP:0.8155, I-F1:0.8718, P-AUROC:0.9614, P-AP:0.2307, P-F1:0.2925, P-AUPRO:0.8740
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9923, P-AP:0.7421, P-F1:0.7141, P-AUPRO:0.9580
transistor: I-Auroc:0.9888, I-AP:0.9835, I-F1:0.9398, P-AUROC:0.8950, P-AP:0.4856, P-F1:0.4790, P-AUPRO:0.7463
zipper: I-Auroc:0.9924, I-AP:0.9979, I-F1:0.9874, P-AUROC:0.9718, P-AP:0.5935, P-F1:0.5967, P-AUPRO:0.9203
Mean: I-Auroc:0.9635, I-AP:0.9825, I-F1:0.9680, P-AUROC:0.9649, P-AP:0.6081, P-F1:0.6095, P-AUPRO:0.9212
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7673, P-F1:0.7179, P-AUPRO:0.9798
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5475, P-F1:0.5742, P-AUPRO:0.9761
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9902, P-AP:0.4041, P-F1:0.4550, P-AUPRO:0.9735
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9752, P-AP:0.7192, P-F1:0.7447, P-AUPRO:0.8967
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9833, P-AUROC:0.9677, P-AP:0.6815, P-F1:0.6683, P-AUPRO:0.9240
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9763, P-AP:0.8096, P-F1:0.7592, P-AUPRO:0.9473
cable: I-Auroc:0.9773, I-AP:0.9868, I-F1:0.9348, P-AUROC:0.9535, P-AP:0.5955, P-F1:0.6139, P-AUPRO:0.8815
capsule: I-Auroc:0.9797, I-AP:0.9956, I-F1:0.9689, P-AUROC:0.9788, P-AP:0.5640, P-F1:0.5579, P-AUPRO:0.9687
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.8061, P-F1:0.7665, P-AUPRO:0.9642
metal_nut: I-Auroc:0.9922, I-AP:0.9982, I-F1:0.9783, P-AUROC:0.9355, P-AP:0.7522, P-F1:0.7409, P-AUPRO:0.8911
pill: I-Auroc:0.9787, I-AP:0.9963, I-F1:0.9784, P-AUROC:0.9225, P-AP:0.5416, P-F1:0.5634, P-AUPRO:0.9545
screw: I-Auroc:0.7047, I-AP:0.8587, I-F1:0.8881, P-AUROC:0.9687, P-AP:0.3020, P-F1:0.3806, P-AUPRO:0.8914
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9938, P-AP:0.7494, P-F1:0.7268, P-AUPRO:0.9643
transistor: I-Auroc:0.9958, I-AP:0.9937, I-F1:0.9756, P-AUROC:0.9028, P-AP:0.4989, P-F1:0.4875, P-AUPRO:0.7577
zipper: I-Auroc:0.9921, I-AP:0.9978, I-F1:0.9874, P-AUROC:0.9748, P-AP:0.5986, P-F1:0.6053, P-AUPRO:0.9323
Mean: I-Auroc:0.9738, I-AP:0.9882, I-F1:0.9787, P-AUROC:0.9680, P-AP:0.6225, P-F1:0.6241, P-AUPRO:0.9269



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转

cuda:4
shots: 1
carpet: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9944, P-AUROC:0.9938, P-AP:0.7652, P-F1:0.7236, P-AUPRO:0.9807
grid: I-Auroc:0.9958, I-AP:0.9986, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5387, P-F1:0.5700, P-AUPRO:0.9782
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9909, P-AP:0.4349, P-F1:0.4766, P-AUPRO:0.9743
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9748, P-AP:0.7162, P-F1:0.7450, P-AUPRO:0.8996
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9916, P-AUROC:0.9680, P-AP:0.6821, P-F1:0.6735, P-AUPRO:0.9260
bottle: I-Auroc:0.9810, I-AP:0.9946, I-F1:0.9760, P-AUROC:0.9682, P-AP:0.7879, P-F1:0.7453, P-AUPRO:0.9338
cable: I-Auroc:0.9207, I-AP:0.9600, I-F1:0.8780, P-AUROC:0.9240, P-AP:0.5296, P-F1:0.5625, P-AUPRO:0.8334
capsule: I-Auroc:0.9406, I-AP:0.9873, I-F1:0.9474, P-AUROC:0.9761, P-AP:0.5245, P-F1:0.5175, P-AUPRO:0.9610
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9906, P-AP:0.7743, P-F1:0.7433, P-AUPRO:0.9579
metal_nut: I-Auroc:0.9673, I-AP:0.9927, I-F1:0.9492, P-AUROC:0.9010, P-AP:0.6440, P-F1:0.6347, P-AUPRO:0.8581
pill: I-Auroc:0.9793, I-AP:0.9964, I-F1:0.9716, P-AUROC:0.9147, P-AP:0.5431, P-F1:0.5574, P-AUPRO:0.9521
screw: I-Auroc:0.8910, I-AP:0.9617, I-F1:0.9091, P-AUROC:0.9867, P-AP:0.4940, P-F1:0.5218, P-AUPRO:0.9430
toothbrush: I-Auroc:0.9889, I-AP:0.9961, I-F1:0.9831, P-AUROC:0.9931, P-AP:0.7718, P-F1:0.7331, P-AUPRO:0.9504
transistor: I-Auroc:0.9883, I-AP:0.9822, I-F1:0.9630, P-AUROC:0.8506, P-AP:0.3931, P-F1:0.4079, P-AUPRO:0.7021
zipper: I-Auroc:0.9916, I-AP:0.9977, I-F1:0.9835, P-AUROC:0.9747, P-AP:0.5919, P-F1:0.5912, P-AUPRO:0.9289
Mean: I-Auroc:0.9760, I-AP:0.9911, I-F1:0.9683, P-AUROC:0.9601, P-AP:0.6127, P-F1:0.6136, P-AUPRO:0.9186
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7558, P-F1:0.7116, P-AUPRO:0.9793
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5433, P-F1:0.5705, P-AUPRO:0.9788
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4121, P-F1:0.4631, P-AUPRO:0.9724
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9749, P-AP:0.7156, P-F1:0.7418, P-AUPRO:0.8962
wood: I-Auroc:0.9965, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9697, P-AP:0.6792, P-F1:0.6718, P-AUPRO:0.9285
bottle: I-Auroc:0.9952, I-AP:0.9985, I-F1:0.9841, P-AUROC:0.9746, P-AP:0.8054, P-F1:0.7573, P-AUPRO:0.9434
cable: I-Auroc:0.9539, I-AP:0.9764, I-F1:0.9266, P-AUROC:0.9373, P-AP:0.5778, P-F1:0.6137, P-AUPRO:0.8617
capsule: I-Auroc:0.9410, I-AP:0.9871, I-F1:0.9478, P-AUROC:0.9758, P-AP:0.5333, P-F1:0.5237, P-AUPRO:0.9637
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9912, P-AP:0.7811, P-F1:0.7542, P-AUPRO:0.9635
metal_nut: I-Auroc:0.9878, I-AP:0.9971, I-F1:0.9687, P-AUROC:0.9225, P-AP:0.7091, P-F1:0.7033, P-AUPRO:0.8881
pill: I-Auroc:0.9801, I-AP:0.9965, I-F1:0.9784, P-AUROC:0.9209, P-AP:0.5531, P-F1:0.5646, P-AUPRO:0.9524
screw: I-Auroc:0.8990, I-AP:0.9645, I-F1:0.8992, P-AUROC:0.9889, P-AP:0.5148, P-F1:0.5350, P-AUPRO:0.9584
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9927, P-AP:0.7575, P-F1:0.7242, P-AUPRO:0.9587
transistor: I-Auroc:0.9896, I-AP:0.9861, I-F1:0.9750, P-AUROC:0.8693, P-AP:0.4194, P-F1:0.4297, P-AUPRO:0.7352
zipper: I-Auroc:0.9937, I-AP:0.9983, I-F1:0.9876, P-AUROC:0.9755, P-AP:0.6101, P-F1:0.6068, P-AUPRO:0.9291
Mean: I-Auroc:0.9814, I-AP:0.9932, I-F1:0.9743, P-AUROC:0.9647, P-AP:0.6245, P-F1:0.6248, P-AUPRO:0.9273
cuda:4
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7531, P-F1:0.7129, P-AUPRO:0.9778
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5408, P-F1:0.5700, P-AUPRO:0.9766
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.4000, P-F1:0.4475, P-AUPRO:0.9702
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9753, P-AP:0.7201, P-F1:0.7428, P-AUPRO:0.8982
wood: I-Auroc:0.9912, I-AP:0.9972, I-F1:0.9833, P-AUROC:0.9702, P-AP:0.6867, P-F1:0.6760, P-AUPRO:0.9276
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9774, P-AP:0.8157, P-F1:0.7673, P-AUPRO:0.9478
cable: I-Auroc:0.9636, I-AP:0.9809, I-F1:0.9379, P-AUROC:0.9410, P-AP:0.5838, P-F1:0.6158, P-AUPRO:0.8675
capsule: I-Auroc:0.9813, I-AP:0.9960, I-F1:0.9683, P-AUROC:0.9795, P-AP:0.5684, P-F1:0.5612, P-AUPRO:0.9696
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.8089, P-F1:0.7711, P-AUPRO:0.9709
metal_nut: I-Auroc:0.9946, I-AP:0.9988, I-F1:0.9838, P-AUROC:0.9278, P-AP:0.7274, P-F1:0.7214, P-AUPRO:0.8938
pill: I-Auroc:0.9757, I-AP:0.9958, I-F1:0.9714, P-AUROC:0.9243, P-AP:0.5592, P-F1:0.5713, P-AUPRO:0.9531
screw: I-Auroc:0.8906, I-AP:0.9580, I-F1:0.9170, P-AUROC:0.9898, P-AP:0.5238, P-F1:0.5421, P-AUPRO:0.9601
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9941, P-AP:0.7682, P-F1:0.7370, P-AUPRO:0.9648
transistor: I-Auroc:0.9950, I-AP:0.9927, I-F1:0.9750, P-AUROC:0.8747, P-AP:0.4243, P-F1:0.4317, P-AUPRO:0.7446
zipper: I-Auroc:0.9932, I-AP:0.9981, I-F1:0.9876, P-AUROC:0.9771, P-AP:0.6142, P-F1:0.6175, P-AUPRO:0.9377
Mean: I-Auroc:0.9852, I-AP:0.9943, I-F1:0.9807, P-AUROC:0.9668, P-AP:0.6330, P-F1:0.6324, P-AUPRO:0.9307



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.7479, P-F1:0.7256, P-AUPRO:0.9799
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5670, P-F1:0.5819, P-AUPRO:0.9784
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9906, P-AP:0.4353, P-F1:0.4635, P-AUPRO:0.9754
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9753, P-AP:0.7198, P-F1:0.7411, P-AUPRO:0.9038
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9694, P-AP:0.7104, P-F1:0.6881, P-AUPRO:0.9352
bottle: I-Auroc:0.9683, I-AP:0.9914, I-F1:0.9600, P-AUROC:0.9666, P-AP:0.7913, P-F1:0.7434, P-AUPRO:0.9330
cable: I-Auroc:0.9198, I-AP:0.9607, I-F1:0.8889, P-AUROC:0.9281, P-AP:0.5487, P-F1:0.5786, P-AUPRO:0.8445
capsule: I-Auroc:0.9326, I-AP:0.9855, I-F1:0.9391, P-AUROC:0.9757, P-AP:0.5212, P-F1:0.5125, P-AUPRO:0.9616
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9915, P-AP:0.7881, P-F1:0.7554, P-AUPRO:0.9643
metal_nut: I-Auroc:0.9726, I-AP:0.9937, I-F1:0.9588, P-AUROC:0.9099, P-AP:0.6535, P-F1:0.6443, P-AUPRO:0.8725
pill: I-Auroc:0.9820, I-AP:0.9968, I-F1:0.9784, P-AUROC:0.9098, P-AP:0.5254, P-F1:0.5385, P-AUPRO:0.9501
screw: I-Auroc:0.9065, I-AP:0.9666, I-F1:0.9129, P-AUROC:0.9891, P-AP:0.5504, P-F1:0.5498, P-AUPRO:0.9522
toothbrush: I-Auroc:0.9889, I-AP:0.9961, I-F1:0.9831, P-AUROC:0.9921, P-AP:0.7448, P-F1:0.7096, P-AUPRO:0.9512
transistor: I-Auroc:0.9942, I-AP:0.9909, I-F1:0.9630, P-AUROC:0.8705, P-AP:0.4282, P-F1:0.4408, P-AUPRO:0.7492
zipper: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9958, P-AUROC:0.9744, P-AP:0.6270, P-F1:0.6291, P-AUPRO:0.9358
Mean: I-Auroc:0.9768, I-AP:0.9918, I-F1:0.9703, P-AUROC:0.9621, P-AP:0.6240, P-F1:0.6202, P-AUPRO:0.9258
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.7288, P-F1:0.7055, P-AUPRO:0.9788
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5568, P-F1:0.5711, P-AUPRO:0.9760
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4254, P-F1:0.4565, P-AUPRO:0.9734
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9756, P-AP:0.7207, P-F1:0.7416, P-AUPRO:0.9002
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9917, P-AUROC:0.9740, P-AP:0.7173, P-F1:0.6878, P-AUPRO:0.9454
bottle: I-Auroc:0.9825, I-AP:0.9949, I-F1:0.9677, P-AUROC:0.9734, P-AP:0.8099, P-F1:0.7545, P-AUPRO:0.9448
cable: I-Auroc:0.9563, I-AP:0.9777, I-F1:0.9231, P-AUROC:0.9422, P-AP:0.5977, P-F1:0.6247, P-AUPRO:0.8731
capsule: I-Auroc:0.9314, I-AP:0.9848, I-F1:0.9478, P-AUROC:0.9755, P-AP:0.5320, P-F1:0.5196, P-AUPRO:0.9656
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9921, P-AP:0.8027, P-F1:0.7656, P-AUPRO:0.9672
metal_nut: I-Auroc:0.9951, I-AP:0.9988, I-F1:0.9841, P-AUROC:0.9328, P-AP:0.7245, P-F1:0.7227, P-AUPRO:0.9036
pill: I-Auroc:0.9825, I-AP:0.9970, I-F1:0.9784, P-AUROC:0.9174, P-AP:0.5376, P-F1:0.5487, P-AUPRO:0.9553
screw: I-Auroc:0.9180, I-AP:0.9731, I-F1:0.9061, P-AUROC:0.9915, P-AP:0.5873, P-F1:0.5726, P-AUPRO:0.9660
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9913, P-AP:0.7266, P-F1:0.6863, P-AUPRO:0.9618
transistor: I-Auroc:0.9933, I-AP:0.9900, I-F1:0.9620, P-AUROC:0.8842, P-AP:0.4482, P-F1:0.4591, P-AUPRO:0.7651
zipper: I-Auroc:0.9989, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9756, P-AP:0.6411, P-F1:0.6388, P-AUPRO:0.9347
Mean: I-Auroc:0.9826, I-AP:0.9940, I-F1:0.9754, P-AUROC:0.9669, P-AP:0.6371, P-F1:0.6303, P-AUPRO:0.9341
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.7280, P-F1:0.7067, P-AUPRO:0.9783
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5559, P-F1:0.5693, P-AUPRO:0.9752
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9899, P-AP:0.4152, P-F1:0.4436, P-AUPRO:0.9672
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9758, P-AP:0.7217, P-F1:0.7419, P-AUPRO:0.9021
wood: I-Auroc:0.9904, I-AP:0.9967, I-F1:0.9917, P-AUROC:0.9735, P-AP:0.7172, P-F1:0.6897, P-AUPRO:0.9432
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9920, P-AUROC:0.9764, P-AP:0.8214, P-F1:0.7635, P-AUPRO:0.9495
cable: I-Auroc:0.9620, I-AP:0.9798, I-F1:0.9371, P-AUROC:0.9454, P-AP:0.6036, P-F1:0.6308, P-AUPRO:0.8786
capsule: I-Auroc:0.9697, I-AP:0.9931, I-F1:0.9689, P-AUROC:0.9788, P-AP:0.5706, P-F1:0.5623, P-AUPRO:0.9703
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.8191, P-F1:0.7749, P-AUPRO:0.9727
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.9386, P-AP:0.7470, P-F1:0.7477, P-AUPRO:0.9083
pill: I-Auroc:0.9823, I-AP:0.9969, I-F1:0.9784, P-AUROC:0.9205, P-AP:0.5405, P-F1:0.5550, P-AUPRO:0.9561
screw: I-Auroc:0.9166, I-AP:0.9710, I-F1:0.9163, P-AUROC:0.9919, P-AP:0.5983, P-F1:0.5792, P-AUPRO:0.9659
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9935, P-AP:0.7397, P-F1:0.7156, P-AUPRO:0.9696
transistor: I-Auroc:0.9979, I-AP:0.9970, I-F1:0.9750, P-AUROC:0.8905, P-AP:0.4547, P-F1:0.4638, P-AUPRO:0.7783
zipper: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9958, P-AUROC:0.9773, P-AP:0.6388, P-F1:0.6368, P-AUPRO:0.9391
Mean: I-Auroc:0.9872, I-AP:0.9954, I-F1:0.9827, P-AUROC:0.9689, P-AP:0.6448, P-F1:0.6387, P-AUPRO:0.9370



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_small_14，结果如下：

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9944, P-AP:0.7698, P-F1:0.7208, P-AUPRO:0.9810
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9925, P-AP:0.5304, P-F1:0.5560, P-AUPRO:0.9761
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.5335, P-F1:0.5494, P-AUPRO:0.9824
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9940, P-AUROC:0.9704, P-AP:0.6622, P-F1:0.7304, P-AUPRO:0.8958
wood: I-Auroc:0.9868, I-AP:0.9959, I-F1:0.9756, P-AUROC:0.9720, P-AP:0.7113, P-F1:0.6831, P-AUPRO:0.9278
bottle: I-Auroc:0.9738, I-AP:0.9928, I-F1:0.9677, P-AUROC:0.9653, P-AP:0.7797, P-F1:0.7365, P-AUPRO:0.9280
cable: I-Auroc:0.8992, I-AP:0.9474, I-F1:0.8571, P-AUROC:0.9137, P-AP:0.4906, P-F1:0.5332, P-AUPRO:0.7990
capsule: I-Auroc:0.9190, I-AP:0.9821, I-F1:0.9397, P-AUROC:0.9706, P-AP:0.4862, P-F1:0.4944, P-AUPRO:0.9484
hazelnut: I-Auroc:0.9971, I-AP:0.9984, I-F1:0.9790, P-AUROC:0.9876, P-AP:0.7495, P-F1:0.7124, P-AUPRO:0.9549
metal_nut: I-Auroc:0.9717, I-AP:0.9936, I-F1:0.9503, P-AUROC:0.8719, P-AP:0.5792, P-F1:0.5753, P-AUPRO:0.8345
pill: I-Auroc:0.9607, I-AP:0.9930, I-F1:0.9524, P-AUROC:0.9159, P-AP:0.5650, P-F1:0.5757, P-AUPRO:0.9389
screw: I-Auroc:0.8196, I-AP:0.9350, I-F1:0.8897, P-AUROC:0.9772, P-AP:0.4276, P-F1:0.4649, P-AUPRO:0.9087
toothbrush: I-Auroc:0.9750, I-AP:0.9915, I-F1:0.9655, P-AUROC:0.9923, P-AP:0.7514, P-F1:0.7346, P-AUPRO:0.9390
transistor: I-Auroc:0.9629, I-AP:0.9214, I-F1:0.8864, P-AUROC:0.8388, P-AP:0.3353, P-F1:0.3811, P-AUPRO:0.7072
zipper: I-Auroc:0.9887, I-AP:0.9969, I-F1:0.9791, P-AUROC:0.9800, P-AP:0.6296, P-F1:0.6094, P-AUPRO:0.9407
Mean: I-Auroc:0.9630, I-AP:0.9830, I-F1:0.9552, P-AUROC:0.9558, P-AP:0.6001, P-F1:0.6038, P-AUPRO:0.9108
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9941, P-AP:0.7613, P-F1:0.7088, P-AUPRO:0.9800
grid: I-Auroc:0.9883, I-AP:0.9965, I-F1:0.9912, P-AUROC:0.9926, P-AP:0.5325, P-F1:0.5557, P-AUPRO:0.9723
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.5164, P-F1:0.5383, P-AUPRO:0.9815
tile: I-Auroc:0.9960, I-AP:0.9986, I-F1:0.9880, P-AUROC:0.9712, P-AP:0.6681, P-F1:0.7270, P-AUPRO:0.8949
wood: I-Auroc:0.9895, I-AP:0.9967, I-F1:0.9756, P-AUROC:0.9723, P-AP:0.7135, P-F1:0.6860, P-AUPRO:0.9299
bottle: I-Auroc:0.9817, I-AP:0.9950, I-F1:0.9760, P-AUROC:0.9730, P-AP:0.8017, P-F1:0.7523, P-AUPRO:0.9399
cable: I-Auroc:0.9325, I-AP:0.9605, I-F1:0.8757, P-AUROC:0.9292, P-AP:0.5340, P-F1:0.5725, P-AUPRO:0.8312
capsule: I-Auroc:0.9278, I-AP:0.9836, I-F1:0.9520, P-AUROC:0.9694, P-AP:0.4982, P-F1:0.5071, P-AUPRO:0.9543
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9895, P-AP:0.7699, P-F1:0.7388, P-AUPRO:0.9625
metal_nut: I-Auroc:0.9878, I-AP:0.9971, I-F1:0.9733, P-AUROC:0.8990, P-AP:0.6499, P-F1:0.6472, P-AUPRO:0.8647
pill: I-Auroc:0.9594, I-AP:0.9928, I-F1:0.9524, P-AUROC:0.9219, P-AP:0.5683, P-F1:0.5762, P-AUPRO:0.9414
screw: I-Auroc:0.8332, I-AP:0.9373, I-F1:0.8924, P-AUROC:0.9806, P-AP:0.4684, P-F1:0.5017, P-AUPRO:0.9246
toothbrush: I-Auroc:0.9778, I-AP:0.9920, I-F1:0.9655, P-AUROC:0.9918, P-AP:0.7386, P-F1:0.7173, P-AUPRO:0.9455
transistor: I-Auroc:0.9633, I-AP:0.9181, I-F1:0.9176, P-AUROC:0.8616, P-AP:0.3741, P-F1:0.4147, P-AUPRO:0.7441
zipper: I-Auroc:0.9895, I-AP:0.9972, I-F1:0.9791, P-AUROC:0.9799, P-AP:0.6332, P-F1:0.6134, P-AUPRO:0.9414
Mean: I-Auroc:0.9685, I-AP:0.9844, I-F1:0.9626, P-AUROC:0.9613, P-AP:0.6152, P-F1:0.6171, P-AUPRO:0.9205
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9943, P-AP:0.7695, P-F1:0.7111, P-AUPRO:0.9783
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9924, P-AP:0.5358, P-F1:0.5552, P-AUPRO:0.9696
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9931, P-AP:0.5072, P-F1:0.5221, P-AUPRO:0.9794
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9881, P-AUROC:0.9718, P-AP:0.6721, P-F1:0.7294, P-AUPRO:0.8973
wood: I-Auroc:0.9860, I-AP:0.9957, I-F1:0.9677, P-AUROC:0.9732, P-AP:0.7153, P-F1:0.6910, P-AUPRO:0.9274
bottle: I-Auroc:0.9913, I-AP:0.9974, I-F1:0.9839, P-AUROC:0.9762, P-AP:0.8146, P-F1:0.7636, P-AUPRO:0.9457
cable: I-Auroc:0.9481, I-AP:0.9704, I-F1:0.9032, P-AUROC:0.9344, P-AP:0.5543, P-F1:0.5856, P-AUPRO:0.8453
capsule: I-Auroc:0.9661, I-AP:0.9926, I-F1:0.9646, P-AUROC:0.9745, P-AP:0.5343, P-F1:0.5407, P-AUPRO:0.9606
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9924, P-AP:0.7970, P-F1:0.7594, P-AUPRO:0.9720
metal_nut: I-Auroc:0.9946, I-AP:0.9987, I-F1:0.9841, P-AUROC:0.9067, P-AP:0.6723, P-F1:0.6667, P-AUPRO:0.8721
pill: I-Auroc:0.9566, I-AP:0.9923, I-F1:0.9547, P-AUROC:0.9247, P-AP:0.5761, P-F1:0.5809, P-AUPRO:0.9431
screw: I-Auroc:0.8137, I-AP:0.9247, I-F1:0.8835, P-AUROC:0.9809, P-AP:0.4625, P-F1:0.5016, P-AUPRO:0.9242
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9940, P-AP:0.7537, P-F1:0.7367, P-AUPRO:0.9592
transistor: I-Auroc:0.9767, I-AP:0.9492, I-F1:0.9398, P-AUROC:0.8689, P-AP:0.3865, P-F1:0.4217, P-AUPRO:0.7576
zipper: I-Auroc:0.9858, I-AP:0.9961, I-F1:0.9791, P-AUROC:0.9793, P-AP:0.6223, P-F1:0.6051, P-AUPRO:0.9400
Mean: I-Auroc:0.9734, I-AP:0.9874, I-F1:0.9682, P-AUROC:0.9638, P-AP:0.6249, P-F1:0.6247, P-AUPRO:0.9248



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14    (R320-C280)

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7693, P-F1:0.7105, P-AUPRO:0.9716
grid: I-Auroc:0.9967, I-AP:0.9988, I-F1:0.9912, P-AUROC:0.9918, P-AP:0.4923, P-F1:0.5346, P-AUPRO:0.9702
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4158, P-F1:0.4685, P-AUPRO:0.9689
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9722, P-AP:0.6940, P-F1:0.7227, P-AUPRO:0.8927
wood: I-Auroc:0.9895, I-AP:0.9969, I-F1:0.9831, P-AUROC:0.9612, P-AP:0.6469, P-F1:0.6334, P-AUPRO:0.9015
bottle: I-Auroc:0.9905, I-AP:0.9972, I-F1:0.9841, P-AUROC:0.9689, P-AP:0.7797, P-F1:0.7410, P-AUPRO:0.9310
cable: I-Auroc:0.9159, I-AP:0.9587, I-F1:0.8929, P-AUROC:0.9291, P-AP:0.5465, P-F1:0.5931, P-AUPRO:0.8304
capsule: I-Auroc:0.9274, I-AP:0.9843, I-F1:0.9345, P-AUROC:0.9774, P-AP:0.5187, P-F1:0.5198, P-AUPRO:0.9446
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9928, P-AUROC:0.9900, P-AP:0.7620, P-F1:0.7443, P-AUPRO:0.9491
metal_nut: I-Auroc:0.9589, I-AP:0.9909, I-F1:0.9474, P-AUROC:0.8949, P-AP:0.6400, P-F1:0.6348, P-AUPRO:0.8449
pill: I-Auroc:0.9891, I-AP:0.9982, I-F1:0.9856, P-AUROC:0.9157, P-AP:0.5542, P-F1:0.5707, P-AUPRO:0.9434
screw: I-Auroc:0.8532, I-AP:0.9473, I-F1:0.8828, P-AUROC:0.9724, P-AP:0.4207, P-F1:0.4694, P-AUPRO:0.8934
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9917, P-AP:0.7503, P-F1:0.7323, P-AUPRO:0.9249
transistor: I-Auroc:0.9812, I-AP:0.9734, I-F1:0.9250, P-AUROC:0.8517, P-AP:0.4081, P-F1:0.4278, P-AUPRO:0.7178
zipper: I-Auroc:0.9858, I-AP:0.9958, I-F1:0.9793, P-AUROC:0.9611, P-AP:0.5088, P-F1:0.5348, P-AUPRO:0.8941
Mean: I-Auroc:0.9723, I-AP:0.9893, I-F1:0.9651, P-AUROC:0.9574, P-AP:0.5938, P-F1:0.6025, P-AUPRO:0.9052
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.7568, P-F1:0.6939, P-AUPRO:0.9702
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9915, P-AP:0.4891, P-F1:0.5240, P-AUPRO:0.9666
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9896, P-AP:0.3875, P-F1:0.4563, P-AUPRO:0.9638
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9719, P-AP:0.6920, P-F1:0.7162, P-AUPRO:0.8856
wood: I-Auroc:0.9895, I-AP:0.9969, I-F1:0.9748, P-AUROC:0.9631, P-AP:0.6427, P-F1:0.6290, P-AUPRO:0.9051
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9920, P-AUROC:0.9739, P-AP:0.7910, P-F1:0.7528, P-AUPRO:0.9388
cable: I-Auroc:0.9434, I-AP:0.9706, I-F1:0.9091, P-AUROC:0.9415, P-AP:0.5820, P-F1:0.6200, P-AUPRO:0.8602
capsule: I-Auroc:0.9218, I-AP:0.9821, I-F1:0.9427, P-AUROC:0.9776, P-AP:0.5181, P-F1:0.5194, P-AUPRO:0.9508
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.7724, P-F1:0.7531, P-AUPRO:0.9545
metal_nut: I-Auroc:0.9868, I-AP:0.9969, I-F1:0.9738, P-AUROC:0.9206, P-AP:0.7084, P-F1:0.7073, P-AUPRO:0.8762
pill: I-Auroc:0.9812, I-AP:0.9968, I-F1:0.9751, P-AUROC:0.9221, P-AP:0.5627, P-F1:0.5759, P-AUPRO:0.9456
screw: I-Auroc:0.8604, I-AP:0.9475, I-F1:0.9027, P-AUROC:0.9785, P-AP:0.4404, P-F1:0.4813, P-AUPRO:0.9127
toothbrush: I-Auroc:0.9944, I-AP:0.9978, I-F1:0.9836, P-AUROC:0.9915, P-AP:0.7318, P-F1:0.7135, P-AUPRO:0.9328
transistor: I-Auroc:0.9900, I-AP:0.9857, I-F1:0.9367, P-AUROC:0.8712, P-AP:0.4377, P-F1:0.4541, P-AUPRO:0.7474
zipper: I-Auroc:0.9871, I-AP:0.9961, I-F1:0.9876, P-AUROC:0.9654, P-AP:0.5391, P-F1:0.5612, P-AUPRO:0.9088
Mean: I-Auroc:0.9765, I-AP:0.9912, I-F1:0.9713, P-AUROC:0.9628, P-AP:0.6034, P-F1:0.6105, P-AUPRO:0.9146
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.7509, P-F1:0.6904, P-AUPRO:0.9685
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9911, P-AP:0.4820, P-F1:0.5182, P-AUPRO:0.9610
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9890, P-AP:0.3785, P-F1:0.4409, P-AUPRO:0.9620
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9723, P-AP:0.6951, P-F1:0.7166, P-AUPRO:0.8876
wood: I-Auroc:0.9895, I-AP:0.9969, I-F1:0.9752, P-AUROC:0.9635, P-AP:0.6505, P-F1:0.6396, P-AUPRO:0.9037
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9764, P-AP:0.7980, P-F1:0.7598, P-AUPRO:0.9411
cable: I-Auroc:0.9569, I-AP:0.9771, I-F1:0.9171, P-AUROC:0.9444, P-AP:0.5882, P-F1:0.6251, P-AUPRO:0.8712
capsule: I-Auroc:0.9701, I-AP:0.9936, I-F1:0.9636, P-AUROC:0.9810, P-AP:0.5519, P-F1:0.5494, P-AUPRO:0.9608
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9922, P-AP:0.7854, P-F1:0.7643, P-AUPRO:0.9619
metal_nut: I-Auroc:0.9888, I-AP:0.9974, I-F1:0.9733, P-AUROC:0.9267, P-AP:0.7285, P-F1:0.7237, P-AUPRO:0.8799
pill: I-Auroc:0.9817, I-AP:0.9969, I-F1:0.9753, P-AUROC:0.9263, P-AP:0.5768, P-F1:0.5832, P-AUPRO:0.9443
screw: I-Auroc:0.8469, I-AP:0.9379, I-F1:0.8898, P-AUROC:0.9809, P-AP:0.4283, P-F1:0.4760, P-AUPRO:0.9231
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.7451, P-F1:0.7225, P-AUPRO:0.9463
transistor: I-Auroc:0.9975, I-AP:0.9963, I-F1:0.9756, P-AUROC:0.8819, P-AP:0.4526, P-F1:0.4644, P-AUPRO:0.7626
zipper: I-Auroc:0.9863, I-AP:0.9959, I-F1:0.9874, P-AUROC:0.9675, P-AP:0.5419, P-F1:0.5684, P-AUPRO:0.9128
Mean: I-Auroc:0.9807, I-AP:0.9926, I-F1:0.9760, P-AUROC:0.9653, P-AP:0.6102, P-F1:0.6162, P-AUPRO:0.9191



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14    (R384-C336)

cuda:4
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9943, P-AP:0.7832, P-F1:0.7210, P-AUPRO:0.9794
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9928, P-AP:0.5248, P-F1:0.5478, P-AUPRO:0.9741
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4186, P-F1:0.4664, P-AUPRO:0.9736
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9745, P-AP:0.7089, P-F1:0.7380, P-AUPRO:0.9009
wood: I-Auroc:0.9921, I-AP:0.9977, I-F1:0.9752, P-AUROC:0.9615, P-AP:0.6524, P-F1:0.6447, P-AUPRO:0.9048
bottle: I-Auroc:0.9889, I-AP:0.9968, I-F1:0.9760, P-AUROC:0.9680, P-AP:0.7855, P-F1:0.7432, P-AUPRO:0.9331
cable: I-Auroc:0.9217, I-AP:0.9602, I-F1:0.8889, P-AUROC:0.9278, P-AP:0.5454, P-F1:0.5808, P-AUPRO:0.8417
capsule: I-Auroc:0.9450, I-AP:0.9881, I-F1:0.9422, P-AUROC:0.9771, P-AP:0.5324, P-F1:0.5177, P-AUPRO:0.9536
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9901, P-AP:0.7619, P-F1:0.7415, P-AUPRO:0.9551
metal_nut: I-Auroc:0.9658, I-AP:0.9925, I-F1:0.9519, P-AUROC:0.8985, P-AP:0.6438, P-F1:0.6386, P-AUPRO:0.8518
pill: I-Auroc:0.9757, I-AP:0.9957, I-F1:0.9650, P-AUROC:0.9133, P-AP:0.5450, P-F1:0.5559, P-AUPRO:0.9456
screw: I-Auroc:0.8780, I-AP:0.9571, I-F1:0.8931, P-AUROC:0.9828, P-AP:0.4758, P-F1:0.4995, P-AUPRO:0.9278
toothbrush: I-Auroc:0.9861, I-AP:0.9947, I-F1:0.9667, P-AUROC:0.9927, P-AP:0.7528, P-F1:0.7309, P-AUPRO:0.9471
transistor: I-Auroc:0.9846, I-AP:0.9758, I-F1:0.9512, P-AUROC:0.8451, P-AP:0.3909, P-F1:0.4131, P-AUPRO:0.7176
zipper: I-Auroc:0.9882, I-AP:0.9965, I-F1:0.9833, P-AUROC:0.9700, P-AP:0.5523, P-F1:0.5726, P-AUPRO:0.9172
Mean: I-Auroc:0.9749, I-AP:0.9903, I-F1:0.9644, P-AUROC:0.9586, P-AP:0.6049, P-F1:0.6074, P-AUPRO:0.9149
cuda:4
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9936, P-AP:0.7641, P-F1:0.7055, P-AUPRO:0.9769
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9927, P-AP:0.5289, P-F1:0.5441, P-AUPRO:0.9710
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.3924, P-F1:0.4498, P-AUPRO:0.9694
tile: I-Auroc:0.9986, I-AP:0.9994, I-F1:0.9882, P-AUROC:0.9744, P-AP:0.7089, P-F1:0.7341, P-AUPRO:0.8876
wood: I-Auroc:0.9904, I-AP:0.9971, I-F1:0.9748, P-AUROC:0.9641, P-AP:0.6548, P-F1:0.6485, P-AUPRO:0.9103
bottle: I-Auroc:0.9960, I-AP:0.9988, I-F1:0.9841, P-AUROC:0.9740, P-AP:0.8013, P-F1:0.7550, P-AUPRO:0.9430
cable: I-Auroc:0.9541, I-AP:0.9760, I-F1:0.9180, P-AUROC:0.9398, P-AP:0.5855, P-F1:0.6232, P-AUPRO:0.8667
capsule: I-Auroc:0.9402, I-AP:0.9869, I-F1:0.9520, P-AUROC:0.9775, P-AP:0.5348, P-F1:0.5228, P-AUPRO:0.9563
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9906, P-AP:0.7669, P-F1:0.7494, P-AUPRO:0.9605
metal_nut: I-Auroc:0.9883, I-AP:0.9972, I-F1:0.9738, P-AUROC:0.9217, P-AP:0.7078, P-F1:0.7040, P-AUPRO:0.8847
pill: I-Auroc:0.9738, I-AP:0.9954, I-F1:0.9648, P-AUROC:0.9193, P-AP:0.5555, P-F1:0.5661, P-AUPRO:0.9479
screw: I-Auroc:0.8992, I-AP:0.9645, I-F1:0.9129, P-AUROC:0.9863, P-AP:0.5119, P-F1:0.5233, P-AUPRO:0.9454
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9925, P-AP:0.7521, P-F1:0.7231, P-AUPRO:0.9550
transistor: I-Auroc:0.9875, I-AP:0.9743, I-F1:0.9750, P-AUROC:0.8677, P-AP:0.4205, P-F1:0.4398, P-AUPRO:0.7382
zipper: I-Auroc:0.9955, I-AP:0.9987, I-F1:0.9916, P-AUROC:0.9726, P-AP:0.5795, P-F1:0.5955, P-AUPRO:0.9263
Mean: I-Auroc:0.9806, I-AP:0.9922, I-F1:0.9731, P-AUROC:0.9638, P-AP:0.6177, P-F1:0.6190, P-AUPRO:0.9226
cuda:4
shots: 4
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9936, P-AP:0.7651, P-F1:0.7065, P-AUPRO:0.9764
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9926, P-AP:0.5271, P-F1:0.5439, P-AUPRO:0.9663
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9890, P-AP:0.3727, P-F1:0.4327, P-AUPRO:0.9676
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9744, P-AP:0.7096, P-F1:0.7326, P-AUPRO:0.8963
wood: I-Auroc:0.9895, I-AP:0.9967, I-F1:0.9748, P-AUROC:0.9654, P-AP:0.6668, P-F1:0.6605, P-AUPRO:0.9141
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9769, P-AP:0.8117, P-F1:0.7641, P-AUPRO:0.9479
cable: I-Auroc:0.9678, I-AP:0.9823, I-F1:0.9282, P-AUROC:0.9427, P-AP:0.5902, P-F1:0.6247, P-AUPRO:0.8686
capsule: I-Auroc:0.9813, I-AP:0.9962, I-F1:0.9680, P-AUROC:0.9809, P-AP:0.5711, P-F1:0.5629, P-AUPRO:0.9642
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9928, P-AP:0.7940, P-F1:0.7645, P-AUPRO:0.9690
metal_nut: I-Auroc:0.9941, I-AP:0.9986, I-F1:0.9841, P-AUROC:0.9268, P-AP:0.7252, P-F1:0.7198, P-AUPRO:0.8878
pill: I-Auroc:0.9755, I-AP:0.9957, I-F1:0.9640, P-AUROC:0.9228, P-AP:0.5625, P-F1:0.5729, P-AUPRO:0.9500
screw: I-Auroc:0.8819, I-AP:0.9555, I-F1:0.9040, P-AUROC:0.9872, P-AP:0.5076, P-F1:0.5215, P-AUPRO:0.9474
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7586, P-F1:0.7315, P-AUPRO:0.9622
transistor: I-Auroc:0.9933, I-AP:0.9886, I-F1:0.9750, P-AUROC:0.8750, P-AP:0.4313, P-F1:0.4446, P-AUPRO:0.7568
zipper: I-Auroc:0.9937, I-AP:0.9982, I-F1:0.9916, P-AUROC:0.9740, P-AP:0.5890, P-F1:0.6050, P-AUPRO:0.9233
Mean: I-Auroc:0.9847, I-AP:0.9940, I-F1:0.9780, P-AUROC:0.9659, P-AP:0.6255, P-F1:0.6259, P-AUPRO:0.9265



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14    (R512-C448)

cuda:4
shots: 1
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7583, P-F1:0.7271, P-AUPRO:0.9810
grid: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9945, P-AP:0.5669, P-F1:0.5910, P-AUPRO:0.9798
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4203, P-F1:0.4588, P-AUPRO:0.9729
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9755, P-AP:0.7211, P-F1:0.7481, P-AUPRO:0.9124
wood: I-Auroc:0.9982, I-AP:0.9995, I-F1:0.9916, P-AUROC:0.9666, P-AP:0.6753, P-F1:0.6650, P-AUPRO:0.9304
bottle: I-Auroc:0.9778, I-AP:0.9936, I-F1:0.9677, P-AUROC:0.9679, P-AP:0.7902, P-F1:0.7470, P-AUPRO:0.9370
cable: I-Auroc:0.9175, I-AP:0.9585, I-F1:0.8800, P-AUROC:0.9278, P-AP:0.5258, P-F1:0.5528, P-AUPRO:0.8398
capsule: I-Auroc:0.9426, I-AP:0.9876, I-F1:0.9459, P-AUROC:0.9747, P-AP:0.5249, P-F1:0.5133, P-AUPRO:0.9608
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9909, P-AP:0.7827, P-F1:0.7500, P-AUPRO:0.9557
metal_nut: I-Auroc:0.9682, I-AP:0.9929, I-F1:0.9519, P-AUROC:0.9038, P-AP:0.6464, P-F1:0.6364, P-AUPRO:0.8665
pill: I-Auroc:0.9763, I-AP:0.9959, I-F1:0.9712, P-AUROC:0.9127, P-AP:0.5377, P-F1:0.5528, P-AUPRO:0.9526
screw: I-Auroc:0.9061, I-AP:0.9671, I-F1:0.9048, P-AUROC:0.9877, P-AP:0.5208, P-F1:0.5307, P-AUPRO:0.9464
toothbrush: I-Auroc:0.9806, I-AP:0.9937, I-F1:0.9831, P-AUROC:0.9930, P-AP:0.7623, P-F1:0.7320, P-AUPRO:0.9499
transistor: I-Auroc:0.9858, I-AP:0.9780, I-F1:0.9351, P-AUROC:0.8530, P-AP:0.3991, P-F1:0.4149, P-AUPRO:0.7150
zipper: I-Auroc:0.9940, I-AP:0.9984, I-F1:0.9916, P-AUROC:0.9807, P-AP:0.6509, P-F1:0.6380, P-AUPRO:0.9431
Mean: I-Auroc:0.9764, I-AP:0.9910, I-F1:0.9678, P-AUROC:0.9609, P-AP:0.6188, P-F1:0.6172, P-AUPRO:0.9229
cuda:4
shots: 2
carpet: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7545, P-F1:0.7244, P-AUPRO:0.9822
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9945, P-AP:0.5682, P-F1:0.5869, P-AUPRO:0.9811
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9897, P-AP:0.3891, P-F1:0.4454, P-AUPRO:0.9684
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9882, P-AUROC:0.9756, P-AP:0.7232, P-F1:0.7455, P-AUPRO:0.9088
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9699, P-AP:0.6783, P-F1:0.6678, P-AUPRO:0.9372
bottle: I-Auroc:0.9952, I-AP:0.9985, I-F1:0.9844, P-AUROC:0.9748, P-AP:0.8088, P-F1:0.7588, P-AUPRO:0.9469
cable: I-Auroc:0.9599, I-AP:0.9785, I-F1:0.9195, P-AUROC:0.9398, P-AP:0.5768, P-F1:0.6117, P-AUPRO:0.8679
capsule: I-Auroc:0.9430, I-AP:0.9876, I-F1:0.9520, P-AUROC:0.9746, P-AP:0.5371, P-F1:0.5232, P-AUPRO:0.9619
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9916, P-AP:0.7886, P-F1:0.7620, P-AUPRO:0.9618
metal_nut: I-Auroc:0.9888, I-AP:0.9974, I-F1:0.9787, P-AUROC:0.9255, P-AP:0.7151, P-F1:0.7097, P-AUPRO:0.8972
pill: I-Auroc:0.9746, I-AP:0.9955, I-F1:0.9653, P-AUROC:0.9203, P-AP:0.5511, P-F1:0.5630, P-AUPRO:0.9550
screw: I-Auroc:0.9174, I-AP:0.9711, I-F1:0.9163, P-AUROC:0.9901, P-AP:0.5417, P-F1:0.5468, P-AUPRO:0.9624
toothbrush: I-Auroc:0.9889, I-AP:0.9961, I-F1:0.9831, P-AUROC:0.9921, P-AP:0.7414, P-F1:0.7065, P-AUPRO:0.9580
transistor: I-Auroc:0.9833, I-AP:0.9768, I-F1:0.9351, P-AUROC:0.8689, P-AP:0.4205, P-F1:0.4306, P-AUPRO:0.7427
zipper: I-Auroc:0.9953, I-AP:0.9988, I-F1:0.9916, P-AUROC:0.9801, P-AP:0.6525, P-F1:0.6382, P-AUPRO:0.9456
Mean: I-Auroc:0.9828, I-AP:0.9933, I-F1:0.9728, P-AUROC:0.9654, P-AP:0.6298, P-F1:0.6280, P-AUPRO:0.9318
cuda:4
shots: 4
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7487, P-F1:0.7247, P-AUPRO:0.9807
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9944, P-AP:0.5670, P-F1:0.5884, P-AUPRO:0.9797
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9894, P-AP:0.3818, P-F1:0.4351, P-AUPRO:0.9684
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9756, P-AP:0.7243, P-F1:0.7453, P-AUPRO:0.9100
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9833, P-AUROC:0.9704, P-AP:0.6828, P-F1:0.6734, P-AUPRO:0.9333
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9779, P-AP:0.8206, P-F1:0.7687, P-AUPRO:0.9517
cable: I-Auroc:0.9687, I-AP:0.9827, I-F1:0.9247, P-AUROC:0.9442, P-AP:0.5918, P-F1:0.6222, P-AUPRO:0.8776
capsule: I-Auroc:0.9793, I-AP:0.9956, I-F1:0.9686, P-AUROC:0.9784, P-AP:0.5708, P-F1:0.5591, P-AUPRO:0.9674
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9938, P-AP:0.8147, P-F1:0.7746, P-AUPRO:0.9730
metal_nut: I-Auroc:0.9936, I-AP:0.9986, I-F1:0.9892, P-AUROC:0.9297, P-AP:0.7295, P-F1:0.7250, P-AUPRO:0.9010
pill: I-Auroc:0.9760, I-AP:0.9957, I-F1:0.9684, P-AUROC:0.9232, P-AP:0.5564, P-F1:0.5700, P-AUPRO:0.9545
screw: I-Auroc:0.9139, I-AP:0.9689, I-F1:0.9200, P-AUROC:0.9906, P-AP:0.5500, P-F1:0.5553, P-AUPRO:0.9602
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9937, P-AP:0.7520, P-F1:0.7202, P-AUPRO:0.9648
transistor: I-Auroc:0.9967, I-AP:0.9952, I-F1:0.9630, P-AUROC:0.8733, P-AP:0.4244, P-F1:0.4302, P-AUPRO:0.7531
zipper: I-Auroc:0.9937, I-AP:0.9983, I-F1:0.9916, P-AUROC:0.9809, P-AP:0.6512, P-F1:0.6386, P-AUPRO:0.9456
Mean: I-Auroc:0.9869, I-AP:0.9953, I-F1:0.9781, P-AUROC:0.9673, P-AP:0.6377, P-F1:0.6354, P-AUPRO:0.9347



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : deit_vit_base_16   (R512-C448)

cuda:4
shots: 1
carpet: I-Auroc:0.9852, I-AP:0.9960, I-F1:0.9831, P-AUROC:0.9558, P-AP:0.6858, P-F1:0.6883, P-AUPRO:0.8842
grid: I-Auroc:0.4862, I-AP:0.7756, I-F1:0.8444, P-AUROC:0.8035, P-AP:0.0872, P-F1:0.1797, P-AUPRO:0.6014
leather: I-Auroc:0.9827, I-AP:0.9948, I-F1:0.9727, P-AUROC:0.9832, P-AP:0.5699, P-F1:0.5686, P-AUPRO:0.9430
tile: I-Auroc:0.9968, I-AP:0.9988, I-F1:0.9940, P-AUROC:0.9784, P-AP:0.8045, P-F1:0.7855, P-AUPRO:0.8746
wood: I-Auroc:0.9982, I-AP:0.9994, I-F1:0.9917, P-AUROC:0.9720, P-AP:0.7463, P-F1:0.6899, P-AUPRO:0.9227
bottle: I-Auroc:0.9841, I-AP:0.9956, I-F1:0.9760, P-AUROC:0.9514, P-AP:0.7591, P-F1:0.7147, P-AUPRO:0.9043
cable: I-Auroc:0.6816, I-AP:0.7634, I-F1:0.7830, P-AUROC:0.7984, P-AP:0.2120, P-F1:0.3028, P-AUPRO:0.6494
capsule: I-Auroc:0.8022, I-AP:0.9515, I-F1:0.9270, P-AUROC:0.9489, P-AP:0.3813, P-F1:0.4054, P-AUPRO:0.8988
hazelnut: I-Auroc:0.9543, I-AP:0.9766, I-F1:0.9275, P-AUROC:0.9712, P-AP:0.6167, P-F1:0.5753, P-AUPRO:0.9254
metal_nut: I-Auroc:0.8539, I-AP:0.9631, I-F1:0.9163, P-AUROC:0.8741, P-AP:0.5908, P-F1:0.5395, P-AUPRO:0.7070
pill: I-Auroc:0.9550, I-AP:0.9920, I-F1:0.9537, P-AUROC:0.9573, P-AP:0.7601, P-F1:0.7212, P-AUPRO:0.9041
screw: I-Auroc:0.6253, I-AP:0.8058, I-F1:0.8686, P-AUROC:0.9542, P-AP:0.0991, P-F1:0.1381, P-AUPRO:0.8290
toothbrush: I-Auroc:0.8556, I-AP:0.9462, I-F1:0.8824, P-AUROC:0.9580, P-AP:0.5482, P-F1:0.5521, P-AUPRO:0.7332
transistor: I-Auroc:0.8767, I-AP:0.8710, I-F1:0.8169, P-AUROC:0.8242, P-AP:0.3718, P-F1:0.3882, P-AUPRO:0.6134
zipper: I-Auroc:0.8936, I-AP:0.9698, I-F1:0.9224, P-AUROC:0.9156, P-AP:0.4038, P-F1:0.4339, P-AUPRO:0.7854
Mean: I-Auroc:0.8621, I-AP:0.9333, I-F1:0.9173, P-AUROC:0.9231, P-AP:0.5091, P-F1:0.5122, P-AUPRO:0.8117
cuda:4
shots: 2
carpet: I-Auroc:0.9868, I-AP:0.9962, I-F1:0.9831, P-AUROC:0.9541, P-AP:0.6729, P-F1:0.6797, P-AUPRO:0.8804
grid: I-Auroc:0.5038, I-AP:0.7812, I-F1:0.8444, P-AUROC:0.8470, P-AP:0.1373, P-F1:0.2395, P-AUPRO:0.6761
leather: I-Auroc:0.9772, I-AP:0.9934, I-F1:0.9674, P-AUROC:0.9824, P-AP:0.5528, P-F1:0.5609, P-AUPRO:0.9407
tile: I-Auroc:0.9899, I-AP:0.9968, I-F1:0.9880, P-AUROC:0.9751, P-AP:0.7941, P-F1:0.7771, P-AUPRO:0.8626
wood: I-Auroc:0.9956, I-AP:0.9987, I-F1:0.9833, P-AUROC:0.9741, P-AP:0.7618, P-F1:0.7085, P-AUPRO:0.9225
bottle: I-Auroc:0.9905, I-AP:0.9972, I-F1:0.9760, P-AUROC:0.9610, P-AP:0.7889, P-F1:0.7403, P-AUPRO:0.9216
cable: I-Auroc:0.9070, I-AP:0.9429, I-F1:0.8757, P-AUROC:0.8239, P-AP:0.3386, P-F1:0.3663, P-AUPRO:0.7049
capsule: I-Auroc:0.7962, I-AP:0.9485, I-F1:0.9333, P-AUROC:0.9439, P-AP:0.3690, P-F1:0.3994, P-AUPRO:0.8978
hazelnut: I-Auroc:0.9711, I-AP:0.9856, I-F1:0.9403, P-AUROC:0.9772, P-AP:0.6568, P-F1:0.6276, P-AUPRO:0.9371
metal_nut: I-Auroc:0.9409, I-AP:0.9861, I-F1:0.9362, P-AUROC:0.9040, P-AP:0.7048, P-F1:0.6224, P-AUPRO:0.7785
pill: I-Auroc:0.9487, I-AP:0.9908, I-F1:0.9485, P-AUROC:0.9624, P-AP:0.7787, P-F1:0.7351, P-AUPRO:0.9094
screw: I-Auroc:0.7141, I-AP:0.8788, I-F1:0.8649, P-AUROC:0.9682, P-AP:0.3301, P-F1:0.3856, P-AUPRO:0.8904
toothbrush: I-Auroc:0.8778, I-AP:0.9505, I-F1:0.9091, P-AUROC:0.9578, P-AP:0.4185, P-F1:0.4026, P-AUPRO:0.7916
transistor: I-Auroc:0.8917, I-AP:0.8800, I-F1:0.7887, P-AUROC:0.8402, P-AP:0.3902, P-F1:0.4069, P-AUPRO:0.6498
zipper: I-Auroc:0.9737, I-AP:0.9921, I-F1:0.9712, P-AUROC:0.9224, P-AP:0.4584, P-F1:0.4828, P-AUPRO:0.8062
Mean: I-Auroc:0.8977, I-AP:0.9546, I-F1:0.9273, P-AUROC:0.9329, P-AP:0.5435, P-F1:0.5423, P-AUPRO:0.8380
cuda:4
shots: 4
carpet: I-Auroc:0.9839, I-AP:0.9954, I-F1:0.9773, P-AUROC:0.9572, P-AP:0.6809, P-F1:0.6825, P-AUPRO:0.8783
grid: I-Auroc:0.5472, I-AP:0.7632, I-F1:0.8615, P-AUROC:0.8640, P-AP:0.1314, P-F1:0.2256, P-AUPRO:0.7098
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.6222, P-F1:0.6080, P-AUPRO:0.9733
tile: I-Auroc:0.9935, I-AP:0.9979, I-F1:0.9881, P-AUROC:0.9773, P-AP:0.7992, P-F1:0.7816, P-AUPRO:0.8733
wood: I-Auroc:0.9947, I-AP:0.9984, I-F1:0.9833, P-AUROC:0.9748, P-AP:0.7760, P-F1:0.7189, P-AUPRO:0.9214
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9844, P-AUROC:0.9654, P-AP:0.8044, P-F1:0.7556, P-AUPRO:0.9304
cable: I-Auroc:0.9528, I-AP:0.9724, I-F1:0.9062, P-AUROC:0.8340, P-AP:0.3828, P-F1:0.4080, P-AUPRO:0.7282
capsule: I-Auroc:0.9322, I-AP:0.9854, I-F1:0.9427, P-AUROC:0.9513, P-AP:0.4985, P-F1:0.5282, P-AUPRO:0.9136
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9884, P-AP:0.7494, P-F1:0.7369, P-AUPRO:0.9548
metal_nut: I-Auroc:0.9663, I-AP:0.9925, I-F1:0.9503, P-AUROC:0.9105, P-AP:0.7280, P-F1:0.6446, P-AUPRO:0.7964
pill: I-Auroc:0.9514, I-AP:0.9914, I-F1:0.9451, P-AUROC:0.9636, P-AP:0.7872, P-F1:0.7435, P-AUPRO:0.9111
screw: I-Auroc:0.7088, I-AP:0.8664, I-F1:0.8689, P-AUROC:0.9691, P-AP:0.3525, P-F1:0.4147, P-AUPRO:0.8873
toothbrush: I-Auroc:0.9889, I-AP:0.9958, I-F1:0.9677, P-AUROC:0.9914, P-AP:0.7173, P-F1:0.7095, P-AUPRO:0.9257
transistor: I-Auroc:0.9100, I-AP:0.9011, I-F1:0.8052, P-AUROC:0.8489, P-AP:0.4063, P-F1:0.4188, P-AUPRO:0.6682
zipper: I-Auroc:0.9756, I-AP:0.9924, I-F1:0.9714, P-AUROC:0.9243, P-AP:0.4683, P-F1:0.4912, P-AUPRO:0.7942
Mean: I-Auroc:0.9268, I-AP:0.9634, I-F1:0.9430, P-AUROC:0.9409, P-AP:0.5936, P-F1:0.5912, P-AUPRO:0.8577



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : deit_vit_base_16   (R256-C224)

cuda:4
shots: 1
carpet: I-Auroc:0.9948, I-AP:0.9985, I-F1:0.9888, P-AUROC:0.9849, P-AP:0.6711, P-F1:0.6892, P-AUPRO:0.9470
grid: I-Auroc:0.8229, I-AP:0.9421, I-F1:0.8485, P-AUROC:0.9172, P-AP:0.2494, P-F1:0.3746, P-AUPRO:0.8084
leather: I-Auroc:0.9874, I-AP:0.9966, I-F1:0.9891, P-AUROC:0.9876, P-AP:0.4728, P-F1:0.5001, P-AUPRO:0.9449
tile: I-Auroc:0.9881, I-AP:0.9964, I-F1:0.9822, P-AUROC:0.9722, P-AP:0.7953, P-F1:0.7570, P-AUPRO:0.8684
wood: I-Auroc:0.9825, I-AP:0.9944, I-F1:0.9752, P-AUROC:0.9654, P-AP:0.7026, P-F1:0.6426, P-AUPRO:0.8781
bottle: I-Auroc:0.9841, I-AP:0.9956, I-F1:0.9760, P-AUROC:0.9633, P-AP:0.7807, P-F1:0.7292, P-AUPRO:0.9028
cable: I-Auroc:0.8025, I-AP:0.8895, I-F1:0.7960, P-AUROC:0.8246, P-AP:0.3094, P-F1:0.3496, P-AUPRO:0.6704
capsule: I-Auroc:0.7112, I-AP:0.9225, I-F1:0.9083, P-AUROC:0.9165, P-AP:0.3280, P-F1:0.3768, P-AUPRO:0.7167
hazelnut: I-Auroc:0.9511, I-AP:0.9758, I-F1:0.9185, P-AUROC:0.9718, P-AP:0.6012, P-F1:0.5949, P-AUPRO:0.9118
metal_nut: I-Auroc:0.8583, I-AP:0.9644, I-F1:0.9163, P-AUROC:0.8514, P-AP:0.5233, P-F1:0.5228, P-AUPRO:0.6707
pill: I-Auroc:0.9304, I-AP:0.9868, I-F1:0.9396, P-AUROC:0.9366, P-AP:0.6842, P-F1:0.6645, P-AUPRO:0.8445
screw: I-Auroc:0.6081, I-AP:0.8073, I-F1:0.8551, P-AUROC:0.9154, P-AP:0.1128, P-F1:0.1560, P-AUPRO:0.7265
toothbrush: I-Auroc:0.9083, I-AP:0.9668, I-F1:0.8889, P-AUROC:0.9631, P-AP:0.5782, P-F1:0.5698, P-AUPRO:0.7181
transistor: I-Auroc:0.9104, I-AP:0.9056, I-F1:0.8354, P-AUROC:0.8542, P-AP:0.4109, P-F1:0.4184, P-AUPRO:0.6782
zipper: I-Auroc:0.8522, I-AP:0.9573, I-F1:0.9134, P-AUROC:0.9103, P-AP:0.3493, P-F1:0.4071, P-AUPRO:0.7711
Mean: I-Auroc:0.8862, I-AP:0.9533, I-F1:0.9154, P-AUROC:0.9290, P-AP:0.5046, P-F1:0.5168, P-AUPRO:0.8039
cuda:4
shots: 2
carpet: I-Auroc:0.9956, I-AP:0.9987, I-F1:0.9888, P-AUROC:0.9852, P-AP:0.6695, P-F1:0.6890, P-AUPRO:0.9473
grid: I-Auroc:0.8346, I-AP:0.9446, I-F1:0.8548, P-AUROC:0.9328, P-AP:0.2562, P-F1:0.3738, P-AUPRO:0.8424
leather: I-Auroc:0.9878, I-AP:0.9967, I-F1:0.9891, P-AUROC:0.9878, P-AP:0.4679, P-F1:0.4927, P-AUPRO:0.9476
tile: I-Auroc:0.9877, I-AP:0.9964, I-F1:0.9880, P-AUROC:0.9716, P-AP:0.7895, P-F1:0.7546, P-AUPRO:0.8612
wood: I-Auroc:0.9772, I-AP:0.9927, I-F1:0.9672, P-AUROC:0.9665, P-AP:0.7130, P-F1:0.6532, P-AUPRO:0.8862
bottle: I-Auroc:0.9944, I-AP:0.9983, I-F1:0.9764, P-AUROC:0.9704, P-AP:0.8031, P-F1:0.7501, P-AUPRO:0.9188
cable: I-Auroc:0.9314, I-AP:0.9594, I-F1:0.9032, P-AUROC:0.8519, P-AP:0.3855, P-F1:0.4284, P-AUPRO:0.7235
capsule: I-Auroc:0.7104, I-AP:0.9193, I-F1:0.9191, P-AUROC:0.9137, P-AP:0.3107, P-F1:0.3627, P-AUPRO:0.7162
hazelnut: I-Auroc:0.9664, I-AP:0.9834, I-F1:0.9333, P-AUROC:0.9746, P-AP:0.6200, P-F1:0.6194, P-AUPRO:0.9200
metal_nut: I-Auroc:0.9487, I-AP:0.9876, I-F1:0.9519, P-AUROC:0.8922, P-AP:0.6667, P-F1:0.6179, P-AUPRO:0.7656
pill: I-Auroc:0.9378, I-AP:0.9888, I-F1:0.9458, P-AUROC:0.9440, P-AP:0.7032, P-F1:0.6768, P-AUPRO:0.8608
screw: I-Auroc:0.6055, I-AP:0.8370, I-F1:0.8530, P-AUROC:0.9310, P-AP:0.2179, P-F1:0.3026, P-AUPRO:0.7788
toothbrush: I-Auroc:0.9111, I-AP:0.9651, I-F1:0.9231, P-AUROC:0.9636, P-AP:0.4823, P-F1:0.4873, P-AUPRO:0.7691
transistor: I-Auroc:0.9342, I-AP:0.9221, I-F1:0.8462, P-AUROC:0.8740, P-AP:0.4510, P-F1:0.4564, P-AUPRO:0.7205
zipper: I-Auroc:0.8361, I-AP:0.9514, I-F1:0.9147, P-AUROC:0.8992, P-AP:0.3318, P-F1:0.3906, P-AUPRO:0.7440
Mean: I-Auroc:0.9039, I-AP:0.9628, I-F1:0.9303, P-AUROC:0.9372, P-AP:0.5245, P-F1:0.5370, P-AUPRO:0.8268
cuda:4
shots: 4
carpet: I-Auroc:0.9964, I-AP:0.9990, I-F1:0.9944, P-AUROC:0.9859, P-AP:0.6768, P-F1:0.6939, P-AUPRO:0.9499
grid: I-Auroc:0.8463, I-AP:0.9437, I-F1:0.8871, P-AUROC:0.9321, P-AP:0.2554, P-F1:0.3688, P-AUPRO:0.8414
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9946, P-AUROC:0.9914, P-AP:0.5107, P-F1:0.5188, P-AUPRO:0.9622
tile: I-Auroc:0.9877, I-AP:0.9964, I-F1:0.9880, P-AUROC:0.9726, P-AP:0.7926, P-F1:0.7580, P-AUPRO:0.8580
wood: I-Auroc:0.9711, I-AP:0.9911, I-F1:0.9587, P-AUROC:0.9658, P-AP:0.7206, P-F1:0.6617, P-AUPRO:0.8860
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9921, P-AUROC:0.9731, P-AP:0.8122, P-F1:0.7589, P-AUPRO:0.9211
cable: I-Auroc:0.9545, I-AP:0.9737, I-F1:0.9111, P-AUROC:0.8621, P-AP:0.4158, P-F1:0.4648, P-AUPRO:0.7542
capsule: I-Auroc:0.7842, I-AP:0.9458, I-F1:0.9115, P-AUROC:0.9167, P-AP:0.3846, P-F1:0.4487, P-AUPRO:0.7009
hazelnut: I-Auroc:0.9946, I-AP:0.9972, I-F1:0.9784, P-AUROC:0.9831, P-AP:0.6780, P-F1:0.6915, P-AUPRO:0.9417
metal_nut: I-Auroc:0.9619, I-AP:0.9911, I-F1:0.9579, P-AUROC:0.9028, P-AP:0.7030, P-F1:0.6499, P-AUPRO:0.7851
pill: I-Auroc:0.9370, I-AP:0.9886, I-F1:0.9420, P-AUROC:0.9465, P-AP:0.7102, P-F1:0.6830, P-AUPRO:0.8687
screw: I-Auroc:0.5571, I-AP:0.8096, I-F1:0.8592, P-AUROC:0.9268, P-AP:0.2052, P-F1:0.2905, P-AUPRO:0.7508
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9898, P-AP:0.6941, P-F1:0.6867, P-AUPRO:0.9018
transistor: I-Auroc:0.9496, I-AP:0.9397, I-F1:0.8649, P-AUROC:0.8785, P-AP:0.4545, P-F1:0.4633, P-AUPRO:0.7275
zipper: I-Auroc:0.8711, I-AP:0.9612, I-F1:0.9112, P-AUROC:0.9078, P-AP:0.3604, P-F1:0.4025, P-AUPRO:0.7664
Mean: I-Auroc:0.9204, I-AP:0.9690, I-F1:0.9423, P-AUROC:0.9423, P-AP:0.5583, P-F1:0.5694, P-AUPRO:0.8410



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mae_vit_base_16   (R512-C448)

cuda:4
shots: 1
carpet: I-Auroc:0.7885, I-AP:0.9316, I-F1:0.8657, P-AUROC:0.8265, P-AP:0.3481, P-F1:0.3933, P-AUPRO:0.6344
grid: I-Auroc:0.6165, I-AP:0.8232, I-F1:0.8444, P-AUROC:0.8030, P-AP:0.0552, P-F1:0.1053, P-AUPRO:0.5330
leather: I-Auroc:0.7103, I-AP:0.9064, I-F1:0.8519, P-AUROC:0.8332, P-AP:0.3056, P-F1:0.3879, P-AUPRO:0.6336
tile: I-Auroc:0.9199, I-AP:0.9739, I-F1:0.9241, P-AUROC:0.8915, P-AP:0.6193, P-F1:0.6167, P-AUPRO:0.7296
wood: I-Auroc:0.9868, I-AP:0.9959, I-F1:0.9756, P-AUROC:0.9203, P-AP:0.5928, P-F1:0.5697, P-AUPRO:0.8687
bottle: I-Auroc:0.9175, I-AP:0.9772, I-F1:0.9244, P-AUROC:0.8806, P-AP:0.4741, P-F1:0.4547, P-AUPRO:0.7420
cable: I-Auroc:0.5176, I-AP:0.6324, I-F1:0.7603, P-AUROC:0.8101, P-AP:0.1035, P-F1:0.2060, P-AUPRO:0.5319
capsule: I-Auroc:0.6123, I-AP:0.8711, I-F1:0.9046, P-AUROC:0.8779, P-AP:0.1730, P-F1:0.2379, P-AUPRO:0.8308
hazelnut: I-Auroc:0.8857, I-AP:0.9364, I-F1:0.8732, P-AUROC:0.9716, P-AP:0.5817, P-F1:0.5424, P-AUPRO:0.9224
metal_nut: I-Auroc:0.4027, I-AP:0.7531, I-F1:0.9029, P-AUROC:0.7852, P-AP:0.3060, P-F1:0.4411, P-AUPRO:0.4788
pill: I-Auroc:0.8380, I-AP:0.9674, I-F1:0.9276, P-AUROC:0.9319, P-AP:0.5965, P-F1:0.5343, P-AUPRO:0.9023
screw: I-Auroc:0.6395, I-AP:0.8333, I-F1:0.8623, P-AUROC:0.9543, P-AP:0.0510, P-F1:0.1004, P-AUPRO:0.8257
toothbrush: I-Auroc:0.7111, I-AP:0.8662, I-F1:0.8696, P-AUROC:0.9331, P-AP:0.2095, P-F1:0.2452, P-AUPRO:0.7114
transistor: I-Auroc:0.5908, I-AP:0.6394, I-F1:0.5755, P-AUROC:0.7203, P-AP:0.1785, P-F1:0.2209, P-AUPRO:0.4585
zipper: I-Auroc:0.7752, I-AP:0.9352, I-F1:0.8914, P-AUROC:0.8790, P-AP:0.3070, P-F1:0.3363, P-AUPRO:0.7128
Mean: I-Auroc:0.7275, I-AP:0.8695, I-F1:0.8636, P-AUROC:0.8679, P-AP:0.3268, P-F1:0.3595, P-AUPRO:0.7011
cuda:4
shots: 2
carpet: I-Auroc:0.8118, I-AP:0.9417, I-F1:0.8683, P-AUROC:0.8278, P-AP:0.3748, P-F1:0.4200, P-AUPRO:0.6512
grid: I-Auroc:0.5898, I-AP:0.7960, I-F1:0.8571, P-AUROC:0.8540, P-AP:0.1093, P-F1:0.1792, P-AUPRO:0.6682
leather: I-Auroc:0.7252, I-AP:0.9132, I-F1:0.8519, P-AUROC:0.8378, P-AP:0.3160, P-F1:0.3955, P-AUPRO:0.6453
tile: I-Auroc:0.8633, I-AP:0.9569, I-F1:0.8974, P-AUROC:0.8404, P-AP:0.5801, P-F1:0.5916, P-AUPRO:0.6525
wood: I-Auroc:0.9860, I-AP:0.9956, I-F1:0.9677, P-AUROC:0.9295, P-AP:0.6144, P-F1:0.5922, P-AUPRO:0.8800
bottle: I-Auroc:0.9278, I-AP:0.9788, I-F1:0.9194, P-AUROC:0.9043, P-AP:0.5282, P-F1:0.5011, P-AUPRO:0.7829
cable: I-Auroc:0.5525, I-AP:0.6806, I-F1:0.7603, P-AUROC:0.8195, P-AP:0.1110, P-F1:0.2165, P-AUPRO:0.5537
capsule: I-Auroc:0.5832, I-AP:0.8601, I-F1:0.9083, P-AUROC:0.8709, P-AP:0.1650, P-F1:0.2392, P-AUPRO:0.8452
hazelnut: I-Auroc:0.9014, I-AP:0.9450, I-F1:0.8777, P-AUROC:0.9720, P-AP:0.5850, P-F1:0.5478, P-AUPRO:0.9246
metal_nut: I-Auroc:0.5543, I-AP:0.8258, I-F1:0.8986, P-AUROC:0.8173, P-AP:0.3731, P-F1:0.4687, P-AUPRO:0.5461
pill: I-Auroc:0.8437, I-AP:0.9675, I-F1:0.9241, P-AUROC:0.9392, P-AP:0.6213, P-F1:0.5570, P-AUPRO:0.9103
screw: I-Auroc:0.7042, I-AP:0.8784, I-F1:0.8692, P-AUROC:0.9658, P-AP:0.1133, P-F1:0.2014, P-AUPRO:0.8614
toothbrush: I-Auroc:0.7472, I-AP:0.8683, I-F1:0.8955, P-AUROC:0.9350, P-AP:0.1700, P-F1:0.2692, P-AUPRO:0.7470
transistor: I-Auroc:0.6275, I-AP:0.6417, I-F1:0.5821, P-AUROC:0.7729, P-AP:0.2107, P-F1:0.2628, P-AUPRO:0.5449
zipper: I-Auroc:0.8839, I-AP:0.9663, I-F1:0.9187, P-AUROC:0.8827, P-AP:0.3683, P-F1:0.4170, P-AUPRO:0.7292
Mean: I-Auroc:0.7534, I-AP:0.8811, I-F1:0.8664, P-AUROC:0.8780, P-AP:0.3494, P-F1:0.3906, P-AUPRO:0.7295
cuda:4
shots: 4
carpet: I-Auroc:0.8146, I-AP:0.9436, I-F1:0.8683, P-AUROC:0.8483, P-AP:0.4196, P-F1:0.4611, P-AUPRO:0.6896
grid: I-Auroc:0.5773, I-AP:0.7888, I-F1:0.8550, P-AUROC:0.8715, P-AP:0.1128, P-F1:0.1793, P-AUPRO:0.6836
leather: I-Auroc:0.8060, I-AP:0.9389, I-F1:0.8519, P-AUROC:0.8649, P-AP:0.3828, P-F1:0.4519, P-AUPRO:0.7439
tile: I-Auroc:0.8766, I-AP:0.9603, I-F1:0.9032, P-AUROC:0.8631, P-AP:0.6032, P-F1:0.6133, P-AUPRO:0.6769
wood: I-Auroc:0.9877, I-AP:0.9962, I-F1:0.9677, P-AUROC:0.9230, P-AP:0.6281, P-F1:0.6077, P-AUPRO:0.8836
bottle: I-Auroc:0.9278, I-AP:0.9786, I-F1:0.9106, P-AUROC:0.9158, P-AP:0.5561, P-F1:0.5263, P-AUPRO:0.8083
cable: I-Auroc:0.5572, I-AP:0.6986, I-F1:0.7603, P-AUROC:0.8199, P-AP:0.1129, P-F1:0.2179, P-AUPRO:0.5719
capsule: I-Auroc:0.6127, I-AP:0.8660, I-F1:0.9083, P-AUROC:0.8721, P-AP:0.2054, P-F1:0.2779, P-AUPRO:0.8407
hazelnut: I-Auroc:0.9443, I-AP:0.9697, I-F1:0.9103, P-AUROC:0.9741, P-AP:0.6182, P-F1:0.5973, P-AUPRO:0.9300
metal_nut: I-Auroc:0.5674, I-AP:0.8414, I-F1:0.9029, P-AUROC:0.8201, P-AP:0.3824, P-F1:0.4698, P-AUPRO:0.5626
pill: I-Auroc:0.8696, I-AP:0.9733, I-F1:0.9236, P-AUROC:0.9431, P-AP:0.6437, P-F1:0.5784, P-AUPRO:0.9105
screw: I-Auroc:0.6612, I-AP:0.8312, I-F1:0.8702, P-AUROC:0.9686, P-AP:0.1367, P-F1:0.2215, P-AUPRO:0.8760
toothbrush: I-Auroc:0.8750, I-AP:0.9492, I-F1:0.8955, P-AUROC:0.9735, P-AP:0.5265, P-F1:0.5276, P-AUPRO:0.8691
transistor: I-Auroc:0.6383, I-AP:0.6631, I-F1:0.5714, P-AUROC:0.7856, P-AP:0.2214, P-F1:0.2725, P-AUPRO:0.5667
zipper: I-Auroc:0.8973, I-AP:0.9689, I-F1:0.9355, P-AUROC:0.9029, P-AP:0.4063, P-F1:0.4545, P-AUPRO:0.7572
Mean: I-Auroc:0.7742, I-AP:0.8912, I-F1:0.8690, P-AUROC:0.8898, P-AP:0.3971, P-F1:0.4305, P-AUPRO:0.7580



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mae_vit_base_16   (R256-C224)

cuda:3
shots: 1
carpet: I-Auroc:0.8130, I-AP:0.9398, I-F1:0.8718, P-AUROC:0.9124, P-AP:0.4552, P-F1:0.4889, P-AUPRO:0.7106
grid: I-Auroc:0.5840, I-AP:0.8025, I-F1:0.8507, P-AUROC:0.6995, P-AP:0.0250, P-F1:0.0501, P-AUPRO:0.2844
leather: I-Auroc:0.8016, I-AP:0.9402, I-F1:0.8519, P-AUROC:0.9470, P-AP:0.4771, P-F1:0.5279, P-AUPRO:0.8108
tile: I-Auroc:0.9495, I-AP:0.9826, I-F1:0.9357, P-AUROC:0.8828, P-AP:0.5822, P-F1:0.6059, P-AUPRO:0.7366
wood: I-Auroc:0.9939, I-AP:0.9981, I-F1:0.9752, P-AUROC:0.9274, P-AP:0.5454, P-F1:0.5361, P-AUPRO:0.8351
bottle: I-Auroc:0.9468, I-AP:0.9848, I-F1:0.9355, P-AUROC:0.9298, P-AP:0.6434, P-F1:0.5954, P-AUPRO:0.8175
cable: I-Auroc:0.5495, I-AP:0.6681, I-F1:0.7603, P-AUROC:0.8566, P-AP:0.1521, P-F1:0.2578, P-AUPRO:0.5357
capsule: I-Auroc:0.6350, I-AP:0.8917, I-F1:0.9114, P-AUROC:0.9513, P-AP:0.2796, P-F1:0.3179, P-AUPRO:0.7841
hazelnut: I-Auroc:0.8814, I-AP:0.9382, I-F1:0.8489, P-AUROC:0.9705, P-AP:0.5880, P-F1:0.5802, P-AUPRO:0.8945
metal_nut: I-Auroc:0.4106, I-AP:0.7499, I-F1:0.8986, P-AUROC:0.8228, P-AP:0.3644, P-F1:0.4971, P-AUPRO:0.4954
pill: I-Auroc:0.7400, I-AP:0.9318, I-F1:0.9324, P-AUROC:0.9170, P-AP:0.5520, P-F1:0.5136, P-AUPRO:0.8396
screw: I-Auroc:0.5563, I-AP:0.7866, I-F1:0.8530, P-AUROC:0.9316, P-AP:0.0356, P-F1:0.0727, P-AUPRO:0.7490
toothbrush: I-Auroc:0.7556, I-AP:0.8852, I-F1:0.8824, P-AUROC:0.9473, P-AP:0.3292, P-F1:0.3287, P-AUPRO:0.7293
transistor: I-Auroc:0.6721, I-AP:0.6909, I-F1:0.5854, P-AUROC:0.8030, P-AP:0.2666, P-F1:0.2769, P-AUPRO:0.5161
zipper: I-Auroc:0.8692, I-AP:0.9550, I-F1:0.9160, P-AUROC:0.9177, P-AP:0.4265, P-F1:0.4922, P-AUPRO:0.8159
Mean: I-Auroc:0.7439, I-AP:0.8764, I-F1:0.8673, P-AUROC:0.8945, P-AP:0.3815, P-F1:0.4094, P-AUPRO:0.7036
cuda:3
shots: 2
carpet: I-Auroc:0.8166, I-AP:0.9443, I-F1:0.8713, P-AUROC:0.9166, P-AP:0.5113, P-F1:0.5458, P-AUPRO:0.7574
grid: I-Auroc:0.5689, I-AP:0.7759, I-F1:0.8444, P-AUROC:0.8057, P-AP:0.1047, P-F1:0.1584, P-AUPRO:0.5315
leather: I-Auroc:0.8081, I-AP:0.9424, I-F1:0.8519, P-AUROC:0.9477, P-AP:0.4826, P-F1:0.5308, P-AUPRO:0.8208
tile: I-Auroc:0.8701, I-AP:0.9584, I-F1:0.8875, P-AUROC:0.8493, P-AP:0.5435, P-F1:0.5833, P-AUPRO:0.6575
wood: I-Auroc:0.9904, I-AP:0.9970, I-F1:0.9756, P-AUROC:0.9350, P-AP:0.5592, P-F1:0.5472, P-AUPRO:0.8460
bottle: I-Auroc:0.9603, I-AP:0.9878, I-F1:0.9457, P-AUROC:0.9451, P-AP:0.6775, P-F1:0.6249, P-AUPRO:0.8437
cable: I-Auroc:0.5993, I-AP:0.7159, I-F1:0.7603, P-AUROC:0.8772, P-AP:0.1773, P-F1:0.2889, P-AUPRO:0.6043
capsule: I-Auroc:0.6027, I-AP:0.8779, I-F1:0.9121, P-AUROC:0.9471, P-AP:0.2523, P-F1:0.3059, P-AUPRO:0.8083
hazelnut: I-Auroc:0.8975, I-AP:0.9462, I-F1:0.8571, P-AUROC:0.9710, P-AP:0.5923, P-F1:0.5833, P-AUPRO:0.9011
metal_nut: I-Auroc:0.5948, I-AP:0.8478, I-F1:0.8986, P-AUROC:0.8683, P-AP:0.5002, P-F1:0.5582, P-AUPRO:0.6021
pill: I-Auroc:0.7662, I-AP:0.9382, I-F1:0.9329, P-AUROC:0.9225, P-AP:0.5726, P-F1:0.5291, P-AUPRO:0.8482
screw: I-Auroc:0.5171, I-AP:0.7467, I-F1:0.8530, P-AUROC:0.9443, P-AP:0.0495, P-F1:0.1087, P-AUPRO:0.7940
toothbrush: I-Auroc:0.7972, I-AP:0.8964, I-F1:0.9375, P-AUROC:0.9486, P-AP:0.2414, P-F1:0.3322, P-AUPRO:0.7645
transistor: I-Auroc:0.6929, I-AP:0.6701, I-F1:0.6182, P-AUROC:0.8210, P-AP:0.2947, P-F1:0.3057, P-AUPRO:0.5860
zipper: I-Auroc:0.8708, I-AP:0.9528, I-F1:0.9225, P-AUROC:0.9176, P-AP:0.4232, P-F1:0.5034, P-AUPRO:0.8097
Mean: I-Auroc:0.7569, I-AP:0.8798, I-F1:0.8712, P-AUROC:0.9078, P-AP:0.3988, P-F1:0.4337, P-AUPRO:0.7450
cuda:3
shots: 4
carpet: I-Auroc:0.8343, I-AP:0.9476, I-F1:0.8852, P-AUROC:0.9318, P-AP:0.5447, P-F1:0.5640, P-AUPRO:0.7856
grid: I-Auroc:0.6224, I-AP:0.8048, I-F1:0.8548, P-AUROC:0.8350, P-AP:0.1475, P-F1:0.2305, P-AUPRO:0.5707
leather: I-Auroc:0.8984, I-AP:0.9688, I-F1:0.9111, P-AUROC:0.9612, P-AP:0.5311, P-F1:0.5717, P-AUPRO:0.8969
tile: I-Auroc:0.8979, I-AP:0.9653, I-F1:0.8874, P-AUROC:0.8667, P-AP:0.5653, P-F1:0.6048, P-AUPRO:0.6772
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9451, P-AP:0.5847, P-F1:0.5613, P-AUPRO:0.8598
bottle: I-Auroc:0.9730, I-AP:0.9917, I-F1:0.9683, P-AUROC:0.9517, P-AP:0.6994, P-F1:0.6454, P-AUPRO:0.8614
cable: I-Auroc:0.6274, I-AP:0.7661, I-F1:0.7603, P-AUROC:0.8791, P-AP:0.1876, P-F1:0.2905, P-AUPRO:0.6274
capsule: I-Auroc:0.6566, I-AP:0.8883, I-F1:0.9224, P-AUROC:0.9523, P-AP:0.3206, P-F1:0.3497, P-AUPRO:0.8392
hazelnut: I-Auroc:0.9482, I-AP:0.9729, I-F1:0.9118, P-AUROC:0.9777, P-AP:0.6471, P-F1:0.6477, P-AUPRO:0.9151
metal_nut: I-Auroc:0.6119, I-AP:0.8666, I-F1:0.9109, P-AUROC:0.8828, P-AP:0.5561, P-F1:0.5839, P-AUPRO:0.6324
pill: I-Auroc:0.7894, I-AP:0.9473, I-F1:0.9236, P-AUROC:0.9270, P-AP:0.5947, P-F1:0.5470, P-AUPRO:0.8562
screw: I-Auroc:0.5091, I-AP:0.7155, I-F1:0.8561, P-AUROC:0.9484, P-AP:0.0562, P-F1:0.1200, P-AUPRO:0.8073
toothbrush: I-Auroc:0.9917, I-AP:0.9967, I-F1:0.9836, P-AUROC:0.9850, P-AP:0.7038, P-F1:0.6715, P-AUPRO:0.8896
transistor: I-Auroc:0.7175, I-AP:0.7051, I-F1:0.6265, P-AUROC:0.8272, P-AP:0.3108, P-F1:0.3185, P-AUPRO:0.6121
zipper: I-Auroc:0.8734, I-AP:0.9546, I-F1:0.9249, P-AUROC:0.9220, P-AP:0.4500, P-F1:0.5157, P-AUPRO:0.8122
Mean: I-Auroc:0.7967, I-AP:0.8994, I-F1:0.8879, P-AUROC:0.9195, P-AP:0.4600, P-F1:0.4815, P-AUPRO:0.7762



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : digpt_vit_base_16   (R512-C448)

cuda:3
shots: 1
carpet: I-Auroc:0.9936, I-AP:0.9981, I-F1:0.9831, P-AUROC:0.9649, P-AP:0.6885, P-F1:0.6941, P-AUPRO:0.9102
grid: I-Auroc:0.6324, I-AP:0.8371, I-F1:0.8444, P-AUROC:0.8943, P-AP:0.1743, P-F1:0.2502, P-AUPRO:0.6948
leather: I-Auroc:0.9952, I-AP:0.9985, I-F1:0.9891, P-AUROC:0.9906, P-AP:0.5876, P-F1:0.6028, P-AUPRO:0.9781
tile: I-Auroc:0.9939, I-AP:0.9979, I-F1:0.9880, P-AUROC:0.9812, P-AP:0.8054, P-F1:0.7893, P-AUPRO:0.9038
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9630, P-AP:0.7042, P-F1:0.6641, P-AUPRO:0.9217
bottle: I-Auroc:0.9960, I-AP:0.9988, I-F1:0.9920, P-AUROC:0.9559, P-AP:0.7443, P-F1:0.7044, P-AUPRO:0.8968
cable: I-Auroc:0.6964, I-AP:0.7902, I-F1:0.7890, P-AUROC:0.9174, P-AP:0.2950, P-F1:0.4015, P-AUPRO:0.7369
capsule: I-Auroc:0.7423, I-AP:0.9248, I-F1:0.9375, P-AUROC:0.9613, P-AP:0.2617, P-F1:0.3258, P-AUPRO:0.9107
hazelnut: I-Auroc:0.9504, I-AP:0.9732, I-F1:0.9155, P-AUROC:0.9777, P-AP:0.6225, P-F1:0.5872, P-AUPRO:0.9328
metal_nut: I-Auroc:0.9189, I-AP:0.9814, I-F1:0.9278, P-AUROC:0.8929, P-AP:0.6174, P-F1:0.6014, P-AUPRO:0.7603
pill: I-Auroc:0.9236, I-AP:0.9850, I-F1:0.9412, P-AUROC:0.9390, P-AP:0.6702, P-F1:0.6419, P-AUPRO:0.9097
screw: I-Auroc:0.6339, I-AP:0.8233, I-F1:0.8655, P-AUROC:0.9502, P-AP:0.0756, P-F1:0.1319, P-AUPRO:0.8097
toothbrush: I-Auroc:0.7889, I-AP:0.9151, I-F1:0.8696, P-AUROC:0.9654, P-AP:0.5528, P-F1:0.5325, P-AUPRO:0.7434
transistor: I-Auroc:0.8504, I-AP:0.8394, I-F1:0.7500, P-AUROC:0.8715, P-AP:0.4558, P-F1:0.4588, P-AUPRO:0.6968
zipper: I-Auroc:0.9215, I-AP:0.9767, I-F1:0.9388, P-AUROC:0.9446, P-AP:0.4313, P-F1:0.4562, P-AUPRO:0.8099
Mean: I-Auroc:0.8692, I-AP:0.9360, I-F1:0.9154, P-AUROC:0.9447, P-AP:0.5124, P-F1:0.5228, P-AUPRO:0.8410
cuda:3
shots: 2
carpet: I-Auroc:0.9940, I-AP:0.9982, I-F1:0.9831, P-AUROC:0.9629, P-AP:0.6715, P-F1:0.6839, P-AUPRO:0.9004
grid: I-Auroc:0.6800, I-AP:0.8553, I-F1:0.8594, P-AUROC:0.8972, P-AP:0.1837, P-F1:0.2577, P-AUPRO:0.7015
leather: I-Auroc:0.9963, I-AP:0.9988, I-F1:0.9891, P-AUROC:0.9908, P-AP:0.5855, P-F1:0.5997, P-AUPRO:0.9785
tile: I-Auroc:0.9867, I-AP:0.9958, I-F1:0.9880, P-AUROC:0.9801, P-AP:0.8020, P-F1:0.7826, P-AUPRO:0.9015
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9656, P-AP:0.7083, P-F1:0.6692, P-AUPRO:0.9276
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9655, P-AP:0.7735, P-F1:0.7257, P-AUPRO:0.9161
cable: I-Auroc:0.8825, I-AP:0.9295, I-F1:0.8558, P-AUROC:0.9351, P-AP:0.4400, P-F1:0.4588, P-AUPRO:0.7894
capsule: I-Auroc:0.7256, I-AP:0.9157, I-F1:0.9391, P-AUROC:0.9594, P-AP:0.2491, P-F1:0.3200, P-AUPRO:0.9159
hazelnut: I-Auroc:0.9764, I-AP:0.9876, I-F1:0.9420, P-AUROC:0.9817, P-AP:0.6614, P-F1:0.6367, P-AUPRO:0.9430
metal_nut: I-Auroc:0.9702, I-AP:0.9934, I-F1:0.9617, P-AUROC:0.9312, P-AP:0.7724, P-F1:0.7238, P-AUPRO:0.8392
pill: I-Auroc:0.9343, I-AP:0.9873, I-F1:0.9571, P-AUROC:0.9473, P-AP:0.6965, P-F1:0.6579, P-AUPRO:0.9188
screw: I-Auroc:0.7668, I-AP:0.9040, I-F1:0.8726, P-AUROC:0.9704, P-AP:0.2808, P-F1:0.3838, P-AUPRO:0.8917
toothbrush: I-Auroc:0.8639, I-AP:0.9405, I-F1:0.9231, P-AUROC:0.9671, P-AP:0.4587, P-F1:0.4510, P-AUPRO:0.7978
transistor: I-Auroc:0.8667, I-AP:0.8529, I-F1:0.7895, P-AUROC:0.8904, P-AP:0.4944, P-F1:0.4934, P-AUPRO:0.7371
zipper: I-Auroc:0.9546, I-AP:0.9872, I-F1:0.9512, P-AUROC:0.9523, P-AP:0.4784, P-F1:0.5143, P-AUPRO:0.8471
Mean: I-Auroc:0.9064, I-AP:0.9564, I-F1:0.9336, P-AUROC:0.9531, P-AP:0.5504, P-F1:0.5572, P-AUPRO:0.8670
cuda:3
shots: 4
carpet: I-Auroc:0.9900, I-AP:0.9971, I-F1:0.9831, P-AUROC:0.9657, P-AP:0.6776, P-F1:0.6863, P-AUPRO:0.8996
grid: I-Auroc:0.6800, I-AP:0.8541, I-F1:0.8730, P-AUROC:0.8925, P-AP:0.1827, P-F1:0.2554, P-AUPRO:0.6982
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9948, P-AP:0.6030, P-F1:0.6161, P-AUPRO:0.9867
tile: I-Auroc:0.9939, I-AP:0.9979, I-F1:0.9880, P-AUROC:0.9809, P-AP:0.8009, P-F1:0.7843, P-AUPRO:0.9100
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9679, P-AP:0.7242, P-F1:0.6814, P-AUPRO:0.9293
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9921, P-AUROC:0.9705, P-AP:0.7910, P-F1:0.7387, P-AUPRO:0.9194
cable: I-Auroc:0.9323, I-AP:0.9592, I-F1:0.8844, P-AUROC:0.9424, P-AP:0.4944, P-F1:0.4959, P-AUPRO:0.8194
capsule: I-Auroc:0.8245, I-AP:0.9475, I-F1:0.9464, P-AUROC:0.9698, P-AP:0.3803, P-F1:0.4159, P-AUPRO:0.9363
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9885, P-AP:0.7123, P-F1:0.7197, P-AUPRO:0.9557
metal_nut: I-Auroc:0.9790, I-AP:0.9954, I-F1:0.9613, P-AUROC:0.9379, P-AP:0.7952, P-F1:0.7496, P-AUPRO:0.8557
pill: I-Auroc:0.9389, I-AP:0.9887, I-F1:0.9500, P-AUROC:0.9513, P-AP:0.7160, P-F1:0.6740, P-AUPRO:0.9239
screw: I-Auroc:0.6827, I-AP:0.8444, I-F1:0.8708, P-AUROC:0.9692, P-AP:0.2279, P-F1:0.3180, P-AUPRO:0.8858
toothbrush: I-Auroc:0.9917, I-AP:0.9968, I-F1:0.9677, P-AUROC:0.9897, P-AP:0.6694, P-F1:0.6760, P-AUPRO:0.9129
transistor: I-Auroc:0.9125, I-AP:0.9052, I-F1:0.8116, P-AUROC:0.8962, P-AP:0.5025, P-F1:0.4948, P-AUPRO:0.7469
zipper: I-Auroc:0.9485, I-AP:0.9852, I-F1:0.9465, P-AUROC:0.9525, P-AP:0.4679, P-F1:0.5030, P-AUPRO:0.8359
Mean: I-Auroc:0.9248, I-AP:0.9647, I-F1:0.9450, P-AUROC:0.9580, P-AP:0.5830, P-F1:0.5873, P-AUPRO:0.8810



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : digpt_vit_base_16   (R256-C224)

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9927, P-AP:0.7476, P-F1:0.7201, P-AUPRO:0.9707
grid: I-Auroc:0.9524, I-AP:0.9832, I-F1:0.9492, P-AUROC:0.9528, P-AP:0.3282, P-F1:0.4158, P-AUPRO:0.8602
leather: I-Auroc:0.9861, I-AP:0.9950, I-F1:0.9838, P-AUROC:0.9900, P-AP:0.5315, P-F1:0.5471, P-AUPRO:0.9665
tile: I-Auroc:0.9802, I-AP:0.9931, I-F1:0.9708, P-AUROC:0.9745, P-AP:0.7570, P-F1:0.7457, P-AUPRO:0.8635
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9542, P-AP:0.6276, P-F1:0.6330, P-AUPRO:0.8930
bottle: I-Auroc:0.9857, I-AP:0.9958, I-F1:0.9756, P-AUROC:0.9655, P-AP:0.7631, P-F1:0.7252, P-AUPRO:0.9126
cable: I-Auroc:0.7965, I-AP:0.8797, I-F1:0.7980, P-AUROC:0.9152, P-AP:0.3574, P-F1:0.4086, P-AUPRO:0.7475
capsule: I-Auroc:0.7168, I-AP:0.9073, I-F1:0.9286, P-AUROC:0.9503, P-AP:0.2136, P-F1:0.3026, P-AUPRO:0.8632
hazelnut: I-Auroc:0.9757, I-AP:0.9883, I-F1:0.9504, P-AUROC:0.9742, P-AP:0.5839, P-F1:0.5993, P-AUPRO:0.9127
metal_nut: I-Auroc:0.8793, I-AP:0.9681, I-F1:0.9239, P-AUROC:0.8392, P-AP:0.4767, P-F1:0.5169, P-AUPRO:0.6956
pill: I-Auroc:0.9397, I-AP:0.9888, I-F1:0.9496, P-AUROC:0.9192, P-AP:0.6244, P-F1:0.6188, P-AUPRO:0.8745
screw: I-Auroc:0.7038, I-AP:0.8835, I-F1:0.8655, P-AUROC:0.9569, P-AP:0.1984, P-F1:0.2775, P-AUPRO:0.8324
toothbrush: I-Auroc:0.9361, I-AP:0.9771, I-F1:0.9333, P-AUROC:0.9729, P-AP:0.6310, P-F1:0.6242, P-AUPRO:0.7701
transistor: I-Auroc:0.8771, I-AP:0.8554, I-F1:0.7907, P-AUROC:0.8795, P-AP:0.4607, P-F1:0.4718, P-AUPRO:0.7221
zipper: I-Auroc:0.7647, I-AP:0.9229, I-F1:0.8981, P-AUROC:0.9497, P-AP:0.3669, P-F1:0.4425, P-AUPRO:0.8574
Mean: I-Auroc:0.8995, I-AP:0.9559, I-F1:0.9273, P-AUROC:0.9458, P-AP:0.5112, P-F1:0.5366, P-AUPRO:0.8495
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.7422, P-F1:0.7188, P-AUPRO:0.9709
grid: I-Auroc:0.9541, I-AP:0.9840, I-F1:0.9483, P-AUROC:0.9520, P-AP:0.3239, P-F1:0.4191, P-AUPRO:0.8641
leather: I-Auroc:0.9881, I-AP:0.9955, I-F1:0.9838, P-AUROC:0.9900, P-AP:0.5272, P-F1:0.5431, P-AUPRO:0.9680
tile: I-Auroc:0.9704, I-AP:0.9892, I-F1:0.9651, P-AUROC:0.9730, P-AP:0.7434, P-F1:0.7348, P-AUPRO:0.8597
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9551, P-AP:0.6269, P-F1:0.6329, P-AUPRO:0.8942
bottle: I-Auroc:0.9929, I-AP:0.9979, I-F1:0.9839, P-AUROC:0.9721, P-AP:0.7821, P-F1:0.7407, P-AUPRO:0.9245
cable: I-Auroc:0.9338, I-AP:0.9632, I-F1:0.8800, P-AUROC:0.9344, P-AP:0.4678, P-F1:0.4877, P-AUPRO:0.8065
capsule: I-Auroc:0.7196, I-AP:0.9062, I-F1:0.9345, P-AUROC:0.9507, P-AP:0.2110, P-F1:0.3065, P-AUPRO:0.8624
hazelnut: I-Auroc:0.9882, I-AP:0.9940, I-F1:0.9645, P-AUROC:0.9768, P-AP:0.5988, P-F1:0.6248, P-AUPRO:0.9221
metal_nut: I-Auroc:0.9761, I-AP:0.9943, I-F1:0.9630, P-AUROC:0.8895, P-AP:0.6458, P-F1:0.6271, P-AUPRO:0.7981
pill: I-Auroc:0.9424, I-AP:0.9891, I-F1:0.9571, P-AUROC:0.9295, P-AP:0.6440, P-F1:0.6296, P-AUPRO:0.8911
screw: I-Auroc:0.7786, I-AP:0.9112, I-F1:0.8696, P-AUROC:0.9702, P-AP:0.2985, P-F1:0.3673, P-AUPRO:0.8916
toothbrush: I-Auroc:0.9167, I-AP:0.9671, I-F1:0.9375, P-AUROC:0.9732, P-AP:0.5493, P-F1:0.5644, P-AUPRO:0.8102
transistor: I-Auroc:0.9062, I-AP:0.8728, I-F1:0.8250, P-AUROC:0.8938, P-AP:0.5011, P-F1:0.5068, P-AUPRO:0.7567
zipper: I-Auroc:0.8776, I-AP:0.9620, I-F1:0.9187, P-AUROC:0.9398, P-AP:0.4203, P-F1:0.4714, P-AUPRO:0.8412
Mean: I-Auroc:0.9296, I-AP:0.9684, I-F1:0.9415, P-AUROC:0.9529, P-AP:0.5388, P-F1:0.5583, P-AUPRO:0.8708
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9925, P-AP:0.7396, P-F1:0.7148, P-AUPRO:0.9691
grid: I-Auroc:0.9449, I-AP:0.9808, I-F1:0.9381, P-AUROC:0.9488, P-AP:0.3157, P-F1:0.4163, P-AUPRO:0.8534
leather: I-Auroc:0.9949, I-AP:0.9981, I-F1:0.9892, P-AUROC:0.9932, P-AP:0.5332, P-F1:0.5604, P-AUPRO:0.9781
tile: I-Auroc:0.9856, I-AP:0.9950, I-F1:0.9822, P-AUROC:0.9755, P-AP:0.7561, P-F1:0.7496, P-AUPRO:0.8667
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9836, P-AUROC:0.9575, P-AP:0.6366, P-F1:0.6376, P-AUPRO:0.9025
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9841, P-AUROC:0.9747, P-AP:0.7888, P-F1:0.7477, P-AUPRO:0.9271
cable: I-Auroc:0.9563, I-AP:0.9756, I-F1:0.9247, P-AUROC:0.9440, P-AP:0.5087, P-F1:0.5333, P-AUPRO:0.8368
capsule: I-Auroc:0.8560, I-AP:0.9556, I-F1:0.9375, P-AUROC:0.9633, P-AP:0.3641, P-F1:0.4157, P-AUPRO:0.9057
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9825, P-AP:0.6243, P-F1:0.6638, P-AUPRO:0.9365
metal_nut: I-Auroc:0.9902, I-AP:0.9977, I-F1:0.9733, P-AUROC:0.9053, P-AP:0.6984, P-F1:0.6679, P-AUPRO:0.8173
pill: I-Auroc:0.9384, I-AP:0.9884, I-F1:0.9527, P-AUROC:0.9345, P-AP:0.6528, P-F1:0.6378, P-AUPRO:0.8944
screw: I-Auroc:0.7206, I-AP:0.8728, I-F1:0.8731, P-AUROC:0.9623, P-AP:0.2514, P-F1:0.3320, P-AUPRO:0.8633
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9886, P-AP:0.6523, P-F1:0.6560, P-AUPRO:0.9045
transistor: I-Auroc:0.9246, I-AP:0.8955, I-F1:0.8780, P-AUROC:0.8968, P-AP:0.5072, P-F1:0.5073, P-AUPRO:0.7593
zipper: I-Auroc:0.8787, I-AP:0.9633, I-F1:0.9150, P-AUROC:0.9478, P-AP:0.4271, P-F1:0.4696, P-AUPRO:0.8434
Mean: I-Auroc:0.9456, I-AP:0.9747, I-F1:0.9550, P-AUROC:0.9578, P-AP:0.5637, P-F1:0.5807, P-AUPRO:0.8839



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mocov3_vit_base_16   (R512-C448)

cuda:2
shots: 1
carpet: I-Auroc:0.9868, I-AP:0.9957, I-F1:0.9727, P-AUROC:0.9825, P-AP:0.7448, P-F1:0.7345, P-AUPRO:0.9324
grid: I-Auroc:0.7561, I-AP:0.9034, I-F1:0.8507, P-AUROC:0.9283, P-AP:0.2986, P-F1:0.3690, P-AUPRO:0.7956
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9945, P-AUROC:0.9950, P-AP:0.7297, P-F1:0.6859, P-AUPRO:0.9851
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9881, P-AUROC:0.9800, P-AP:0.8006, P-F1:0.7890, P-AUPRO:0.9053
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9696, P-AP:0.7617, P-F1:0.6839, P-AUPRO:0.9176
bottle: I-Auroc:0.9857, I-AP:0.9956, I-F1:0.9618, P-AUROC:0.9608, P-AP:0.7532, P-F1:0.6989, P-AUPRO:0.9056
cable: I-Auroc:0.6992, I-AP:0.7782, I-F1:0.7870, P-AUROC:0.8801, P-AP:0.2207, P-F1:0.3334, P-AUPRO:0.6939
capsule: I-Auroc:0.7343, I-AP:0.9237, I-F1:0.9292, P-AUROC:0.9553, P-AP:0.3310, P-F1:0.4027, P-AUPRO:0.9099
hazelnut: I-Auroc:0.9382, I-AP:0.9659, I-F1:0.9155, P-AUROC:0.9733, P-AP:0.6089, P-F1:0.5634, P-AUPRO:0.9222
metal_nut: I-Auroc:0.8578, I-AP:0.9648, I-F1:0.9154, P-AUROC:0.9233, P-AP:0.7259, P-F1:0.6638, P-AUPRO:0.7591
pill: I-Auroc:0.9621, I-AP:0.9931, I-F1:0.9568, P-AUROC:0.9520, P-AP:0.7248, P-F1:0.6679, P-AUPRO:0.9147
screw: I-Auroc:0.6389, I-AP:0.8103, I-F1:0.8655, P-AUROC:0.9622, P-AP:0.1881, P-F1:0.2440, P-AUPRO:0.8576
toothbrush: I-Auroc:0.8972, I-AP:0.9629, I-F1:0.9032, P-AUROC:0.9816, P-AP:0.7115, P-F1:0.6928, P-AUPRO:0.8276
transistor: I-Auroc:0.8325, I-AP:0.8318, I-F1:0.7397, P-AUROC:0.8195, P-AP:0.3529, P-F1:0.3757, P-AUPRO:0.6382
zipper: I-Auroc:0.9333, I-AP:0.9808, I-F1:0.9378, P-AUROC:0.9430, P-AP:0.4385, P-F1:0.4667, P-AUPRO:0.8578
Mean: I-Auroc:0.8810, I-AP:0.9403, I-F1:0.9134, P-AUROC:0.9471, P-AP:0.5594, P-F1:0.5581, P-AUPRO:0.8548
cuda:2
shots: 2
carpet: I-Auroc:0.9815, I-AP:0.9942, I-F1:0.9663, P-AUROC:0.9805, P-AP:0.7236, P-F1:0.7223, P-AUPRO:0.9247
grid: I-Auroc:0.7970, I-AP:0.9196, I-F1:0.8689, P-AUROC:0.9385, P-AP:0.3574, P-F1:0.4278, P-AUPRO:0.8264
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9949, P-AP:0.7306, P-F1:0.6875, P-AUPRO:0.9856
tile: I-Auroc:0.9917, I-AP:0.9972, I-F1:0.9818, P-AUROC:0.9756, P-AP:0.7873, P-F1:0.7728, P-AUPRO:0.8789
wood: I-Auroc:0.9895, I-AP:0.9967, I-F1:0.9752, P-AUROC:0.9703, P-AP:0.7665, P-F1:0.6927, P-AUPRO:0.9203
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9702, P-AP:0.7854, P-F1:0.7308, P-AUPRO:0.9267
cable: I-Auroc:0.8836, I-AP:0.9303, I-F1:0.8466, P-AUROC:0.9040, P-AP:0.3414, P-F1:0.3820, P-AUPRO:0.7543
capsule: I-Auroc:0.7339, I-AP:0.9208, I-F1:0.9375, P-AUROC:0.9532, P-AP:0.3200, P-F1:0.3957, P-AUPRO:0.9107
hazelnut: I-Auroc:0.9696, I-AP:0.9845, I-F1:0.9353, P-AUROC:0.9773, P-AP:0.6431, P-F1:0.5978, P-AUPRO:0.9335
metal_nut: I-Auroc:0.9413, I-AP:0.9860, I-F1:0.9368, P-AUROC:0.9452, P-AP:0.8231, P-F1:0.7533, P-AUPRO:0.8224
pill: I-Auroc:0.9569, I-AP:0.9924, I-F1:0.9571, P-AUROC:0.9580, P-AP:0.7477, P-F1:0.6818, P-AUPRO:0.9237
screw: I-Auroc:0.6981, I-AP:0.8634, I-F1:0.8699, P-AUROC:0.9701, P-AP:0.3819, P-F1:0.4299, P-AUPRO:0.8963
toothbrush: I-Auroc:0.9000, I-AP:0.9617, I-F1:0.9206, P-AUROC:0.9817, P-AP:0.6653, P-F1:0.6487, P-AUPRO:0.8512
transistor: I-Auroc:0.8742, I-AP:0.8586, I-F1:0.7714, P-AUROC:0.8357, P-AP:0.3723, P-F1:0.3902, P-AUPRO:0.6727
zipper: I-Auroc:0.9674, I-AP:0.9909, I-F1:0.9620, P-AUROC:0.9435, P-AP:0.5024, P-F1:0.5144, P-AUPRO:0.8620
Mean: I-Auroc:0.9123, I-AP:0.9598, I-F1:0.9286, P-AUROC:0.9533, P-AP:0.5965, P-F1:0.5885, P-AUPRO:0.8726
cuda:2
shots: 4
carpet: I-Auroc:0.9779, I-AP:0.9932, I-F1:0.9605, P-AUROC:0.9829, P-AP:0.7325, P-F1:0.7289, P-AUPRO:0.9324
grid: I-Auroc:0.7602, I-AP:0.8988, I-F1:0.8852, P-AUROC:0.9423, P-AP:0.3564, P-F1:0.4254, P-AUPRO:0.8298
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9964, P-AP:0.7338, P-F1:0.6901, P-AUPRO:0.9882
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9881, P-AUROC:0.9789, P-AP:0.7948, P-F1:0.7825, P-AUPRO:0.8902
wood: I-Auroc:0.9921, I-AP:0.9975, I-F1:0.9752, P-AUROC:0.9727, P-AP:0.7752, P-F1:0.7020, P-AUPRO:0.9261
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9747, P-AP:0.8041, P-F1:0.7493, P-AUPRO:0.9343
cable: I-Auroc:0.9204, I-AP:0.9517, I-F1:0.8736, P-AUROC:0.9086, P-AP:0.3738, P-F1:0.3948, P-AUPRO:0.7778
capsule: I-Auroc:0.8524, I-AP:0.9597, I-F1:0.9550, P-AUROC:0.9611, P-AP:0.4623, P-F1:0.4933, P-AUPRO:0.9296
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9895, P-AP:0.7616, P-F1:0.7396, P-AUPRO:0.9529
metal_nut: I-Auroc:0.9629, I-AP:0.9915, I-F1:0.9529, P-AUROC:0.9478, P-AP:0.8369, P-F1:0.7674, P-AUPRO:0.8338
pill: I-Auroc:0.9566, I-AP:0.9923, I-F1:0.9580, P-AUROC:0.9591, P-AP:0.7567, P-F1:0.6923, P-AUPRO:0.9230
screw: I-Auroc:0.6497, I-AP:0.8190, I-F1:0.8676, P-AUROC:0.9676, P-AP:0.3159, P-F1:0.3540, P-AUPRO:0.8851
toothbrush: I-Auroc:0.9833, I-AP:0.9944, I-F1:0.9831, P-AUROC:0.9922, P-AP:0.7588, P-F1:0.7286, P-AUPRO:0.9263
transistor: I-Auroc:0.8958, I-AP:0.8888, I-F1:0.8000, P-AUROC:0.8496, P-AP:0.3933, P-F1:0.4031, P-AUPRO:0.6919
zipper: I-Auroc:0.9677, I-AP:0.9907, I-F1:0.9669, P-AUROC:0.9467, P-AP:0.5211, P-F1:0.5341, P-AUPRO:0.8644
Mean: I-Auroc:0.9277, I-AP:0.9651, I-F1:0.9439, P-AUROC:0.9580, P-AP:0.6252, P-F1:0.6124, P-AUPRO:0.8857



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mocov3_vit_base_16   (R256-C224)

cuda:2
shots: 1
carpet: I-Auroc:0.9880, I-AP:0.9967, I-F1:0.9832, P-AUROC:0.9913, P-AP:0.7418, P-F1:0.7333, P-AUPRO:0.9599
grid: I-Auroc:0.9490, I-AP:0.9829, I-F1:0.9298, P-AUROC:0.9504, P-AP:0.4275, P-F1:0.4749, P-AUPRO:0.8944
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9940, P-AP:0.6142, P-F1:0.5913, P-AUPRO:0.9778
tile: I-Auroc:0.9957, I-AP:0.9984, I-F1:0.9881, P-AUROC:0.9660, P-AP:0.7567, P-F1:0.7575, P-AUPRO:0.8688
wood: I-Auroc:0.9781, I-AP:0.9932, I-F1:0.9667, P-AUROC:0.9613, P-AP:0.7046, P-F1:0.6356, P-AUPRO:0.8796
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9920, P-AUROC:0.9751, P-AP:0.7958, P-F1:0.7412, P-AUPRO:0.9200
cable: I-Auroc:0.8381, I-AP:0.9132, I-F1:0.8024, P-AUROC:0.9068, P-AP:0.3883, P-F1:0.4138, P-AUPRO:0.7380
capsule: I-Auroc:0.7000, I-AP:0.9163, I-F1:0.9076, P-AUROC:0.9312, P-AP:0.3310, P-F1:0.3721, P-AUPRO:0.7351
hazelnut: I-Auroc:0.9643, I-AP:0.9824, I-F1:0.9275, P-AUROC:0.9739, P-AP:0.6043, P-F1:0.5939, P-AUPRO:0.9079
metal_nut: I-Auroc:0.8016, I-AP:0.9449, I-F1:0.9118, P-AUROC:0.8631, P-AP:0.5226, P-F1:0.5535, P-AUPRO:0.6809
pill: I-Auroc:0.9239, I-AP:0.9864, I-F1:0.9296, P-AUROC:0.9183, P-AP:0.6461, P-F1:0.6146, P-AUPRO:0.8511
screw: I-Auroc:0.6122, I-AP:0.8209, I-F1:0.8551, P-AUROC:0.9243, P-AP:0.1830, P-F1:0.2378, P-AUPRO:0.7461
toothbrush: I-Auroc:0.9333, I-AP:0.9762, I-F1:0.9123, P-AUROC:0.9823, P-AP:0.7360, P-F1:0.7176, P-AUPRO:0.8116
transistor: I-Auroc:0.9254, I-AP:0.9300, I-F1:0.8767, P-AUROC:0.8677, P-AP:0.4279, P-F1:0.4218, P-AUPRO:0.6958
zipper: I-Auroc:0.7862, I-AP:0.9303, I-F1:0.9035, P-AUROC:0.9149, P-AP:0.3550, P-F1:0.4224, P-AUPRO:0.8054
Mean: I-Auroc:0.8929, I-AP:0.9581, I-F1:0.9254, P-AUROC:0.9414, P-AP:0.5490, P-F1:0.5521, P-AUPRO:0.8315
cuda:2
shots: 2
carpet: I-Auroc:0.9908, I-AP:0.9976, I-F1:0.9888, P-AUROC:0.9915, P-AP:0.7352, P-F1:0.7336, P-AUPRO:0.9579
grid: I-Auroc:0.9248, I-AP:0.9755, I-F1:0.9043, P-AUROC:0.9446, P-AP:0.4038, P-F1:0.4684, P-AUPRO:0.8684
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.6155, P-F1:0.5923, P-AUPRO:0.9787
tile: I-Auroc:0.9913, I-AP:0.9972, I-F1:0.9822, P-AUROC:0.9664, P-AP:0.7530, P-F1:0.7548, P-AUPRO:0.8605
wood: I-Auroc:0.9772, I-AP:0.9928, I-F1:0.9667, P-AUROC:0.9608, P-AP:0.6982, P-F1:0.6359, P-AUPRO:0.8789
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9799, P-AP:0.8132, P-F1:0.7583, P-AUPRO:0.9287
cable: I-Auroc:0.8849, I-AP:0.9370, I-F1:0.8421, P-AUROC:0.9220, P-AP:0.4473, P-F1:0.4789, P-AUPRO:0.7687
capsule: I-Auroc:0.7104, I-AP:0.9155, I-F1:0.9204, P-AUROC:0.9297, P-AP:0.3208, P-F1:0.3704, P-AUPRO:0.7445
hazelnut: I-Auroc:0.9700, I-AP:0.9849, I-F1:0.9333, P-AUROC:0.9750, P-AP:0.6165, P-F1:0.6012, P-AUPRO:0.9141
metal_nut: I-Auroc:0.9125, I-AP:0.9793, I-F1:0.9246, P-AUROC:0.9009, P-AP:0.6717, P-F1:0.6398, P-AUPRO:0.7711
pill: I-Auroc:0.9299, I-AP:0.9874, I-F1:0.9366, P-AUROC:0.9238, P-AP:0.6554, P-F1:0.6185, P-AUPRO:0.8606
screw: I-Auroc:0.6028, I-AP:0.8185, I-F1:0.8530, P-AUROC:0.9384, P-AP:0.2324, P-F1:0.3002, P-AUPRO:0.7962
toothbrush: I-Auroc:0.9278, I-AP:0.9720, I-F1:0.9375, P-AUROC:0.9831, P-AP:0.7126, P-F1:0.6934, P-AUPRO:0.8332
transistor: I-Auroc:0.9479, I-AP:0.9438, I-F1:0.8649, P-AUROC:0.8863, P-AP:0.4703, P-F1:0.4671, P-AUPRO:0.7332
zipper: I-Auroc:0.7981, I-AP:0.9368, I-F1:0.9049, P-AUROC:0.8978, P-AP:0.3450, P-F1:0.4096, P-AUPRO:0.7572
Mean: I-Auroc:0.9046, I-AP:0.9626, I-F1:0.9306, P-AUROC:0.9463, P-AP:0.5661, P-F1:0.5681, P-AUPRO:0.8435
cuda:2
shots: 4
carpet: I-Auroc:0.9892, I-AP:0.9972, I-F1:0.9831, P-AUROC:0.9920, P-AP:0.7429, P-F1:0.7361, P-AUPRO:0.9605
grid: I-Auroc:0.9273, I-AP:0.9756, I-F1:0.9138, P-AUROC:0.9480, P-AP:0.4077, P-F1:0.4698, P-AUPRO:0.8679
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9945, P-AP:0.6191, P-F1:0.5945, P-AUPRO:0.9785
tile: I-Auroc:0.9953, I-AP:0.9984, I-F1:0.9881, P-AUROC:0.9685, P-AP:0.7585, P-F1:0.7627, P-AUPRO:0.8693
wood: I-Auroc:0.9754, I-AP:0.9926, I-F1:0.9580, P-AUROC:0.9593, P-AP:0.6993, P-F1:0.6431, P-AUPRO:0.8781
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9815, P-AP:0.8204, P-F1:0.7661, P-AUPRO:0.9313
cable: I-Auroc:0.9288, I-AP:0.9597, I-F1:0.8878, P-AUROC:0.9273, P-AP:0.4699, P-F1:0.5073, P-AUPRO:0.7984
capsule: I-Auroc:0.8018, I-AP:0.9452, I-F1:0.9251, P-AUROC:0.9351, P-AP:0.4134, P-F1:0.4636, P-AUPRO:0.7383
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9851, P-AP:0.7015, P-F1:0.7176, P-AUPRO:0.9382
metal_nut: I-Auroc:0.9423, I-AP:0.9861, I-F1:0.9583, P-AUROC:0.9112, P-AP:0.7140, P-F1:0.6702, P-AUPRO:0.7866
pill: I-Auroc:0.9253, I-AP:0.9869, I-F1:0.9395, P-AUROC:0.9258, P-AP:0.6577, P-F1:0.6207, P-AUPRO:0.8649
screw: I-Auroc:0.5829, I-AP:0.8004, I-F1:0.8530, P-AUROC:0.9300, P-AP:0.1892, P-F1:0.2412, P-AUPRO:0.7751
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.7482, P-F1:0.7130, P-AUPRO:0.9043
transistor: I-Auroc:0.9471, I-AP:0.9406, I-F1:0.8750, P-AUROC:0.8925, P-AP:0.4806, P-F1:0.4702, P-AUPRO:0.7433
zipper: I-Auroc:0.8049, I-AP:0.9396, I-F1:0.9049, P-AUROC:0.9043, P-AP:0.3541, P-F1:0.4067, P-AUPRO:0.7691
Mean: I-Auroc:0.9213, I-AP:0.9682, I-F1:0.9458, P-AUROC:0.9497, P-AP:0.5851, P-F1:0.5855, P-AUPRO:0.8536



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dino_vit_base_16   (R512-C448)

cuda:3
shots: 1
carpet: I-Auroc:0.9916, I-AP:0.9973, I-F1:0.9834, P-AUROC:0.9768, P-AP:0.7293, P-F1:0.7224, P-AUPRO:0.9314
grid: I-Auroc:0.6917, I-AP:0.8886, I-F1:0.8507, P-AUROC:0.8882, P-AP:0.2688, P-F1:0.3404, P-AUPRO:0.7278
leather: I-Auroc:0.9847, I-AP:0.9955, I-F1:0.9778, P-AUROC:0.9887, P-AP:0.7087, P-F1:0.6807, P-AUPRO:0.9714
tile: I-Auroc:0.9939, I-AP:0.9980, I-F1:0.9940, P-AUROC:0.9776, P-AP:0.7885, P-F1:0.7837, P-AUPRO:0.8967
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9712, P-AP:0.7483, P-F1:0.6710, P-AUPRO:0.9301
bottle: I-Auroc:0.9905, I-AP:0.9972, I-F1:0.9756, P-AUROC:0.9689, P-AP:0.7871, P-F1:0.7366, P-AUPRO:0.9224
cable: I-Auroc:0.7802, I-AP:0.8468, I-F1:0.8020, P-AUROC:0.9180, P-AP:0.4036, P-F1:0.4441, P-AUPRO:0.7623
capsule: I-Auroc:0.7543, I-AP:0.9317, I-F1:0.9391, P-AUROC:0.9705, P-AP:0.3619, P-F1:0.4129, P-AUPRO:0.9338
hazelnut: I-Auroc:0.9636, I-AP:0.9816, I-F1:0.9343, P-AUROC:0.9813, P-AP:0.7007, P-F1:0.6370, P-AUPRO:0.9307
metal_nut: I-Auroc:0.8299, I-AP:0.9560, I-F1:0.9154, P-AUROC:0.9050, P-AP:0.6324, P-F1:0.6162, P-AUPRO:0.7674
pill: I-Auroc:0.9566, I-AP:0.9924, I-F1:0.9507, P-AUROC:0.9527, P-AP:0.7148, P-F1:0.6658, P-AUPRO:0.9226
screw: I-Auroc:0.6682, I-AP:0.8277, I-F1:0.8655, P-AUROC:0.9699, P-AP:0.2832, P-F1:0.3181, P-AUPRO:0.8798
toothbrush: I-Auroc:0.9139, I-AP:0.9699, I-F1:0.9032, P-AUROC:0.9831, P-AP:0.7165, P-F1:0.6993, P-AUPRO:0.8460
transistor: I-Auroc:0.8821, I-AP:0.8701, I-F1:0.7949, P-AUROC:0.8617, P-AP:0.4151, P-F1:0.4208, P-AUPRO:0.6998
zipper: I-Auroc:0.9241, I-AP:0.9777, I-F1:0.9333, P-AUROC:0.9553, P-AP:0.4626, P-F1:0.4956, P-AUPRO:0.8576
Mean: I-Auroc:0.8883, I-AP:0.9487, I-F1:0.9213, P-AUROC:0.9513, P-AP:0.5814, P-F1:0.5763, P-AUPRO:0.8653
cuda:3
shots: 2
carpet: I-Auroc:0.9892, I-AP:0.9967, I-F1:0.9670, P-AUROC:0.9763, P-AP:0.7207, P-F1:0.7171, P-AUPRO:0.9214
grid: I-Auroc:0.7335, I-AP:0.8914, I-F1:0.8667, P-AUROC:0.9090, P-AP:0.2837, P-F1:0.3613, P-AUPRO:0.7543
leather: I-Auroc:0.9844, I-AP:0.9955, I-F1:0.9783, P-AUROC:0.9887, P-AP:0.7085, P-F1:0.6804, P-AUPRO:0.9719
tile: I-Auroc:0.9870, I-AP:0.9959, I-F1:0.9880, P-AUROC:0.9779, P-AP:0.7900, P-F1:0.7829, P-AUPRO:0.8795
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9727, P-AP:0.7556, P-F1:0.6806, P-AUPRO:0.9337
bottle: I-Auroc:0.9960, I-AP:0.9988, I-F1:0.9841, P-AUROC:0.9761, P-AP:0.8109, P-F1:0.7566, P-AUPRO:0.9403
cable: I-Auroc:0.9226, I-AP:0.9562, I-F1:0.8700, P-AUROC:0.9342, P-AP:0.5266, P-F1:0.5306, P-AUPRO:0.8190
capsule: I-Auroc:0.7475, I-AP:0.9282, I-F1:0.9381, P-AUROC:0.9689, P-AP:0.3464, P-F1:0.4047, P-AUPRO:0.9354
hazelnut: I-Auroc:0.9786, I-AP:0.9890, I-F1:0.9474, P-AUROC:0.9838, P-AP:0.7290, P-F1:0.6675, P-AUPRO:0.9401
metal_nut: I-Auroc:0.9492, I-AP:0.9883, I-F1:0.9388, P-AUROC:0.9368, P-AP:0.7679, P-F1:0.7146, P-AUPRO:0.8465
pill: I-Auroc:0.9528, I-AP:0.9918, I-F1:0.9481, P-AUROC:0.9582, P-AP:0.7368, P-F1:0.6794, P-AUPRO:0.9338
screw: I-Auroc:0.7172, I-AP:0.8907, I-F1:0.8699, P-AUROC:0.9785, P-AP:0.4769, P-F1:0.5070, P-AUPRO:0.9178
toothbrush: I-Auroc:0.9028, I-AP:0.9627, I-F1:0.9062, P-AUROC:0.9834, P-AP:0.6659, P-F1:0.6487, P-AUPRO:0.8714
transistor: I-Auroc:0.8921, I-AP:0.8646, I-F1:0.7765, P-AUROC:0.8805, P-AP:0.4501, P-F1:0.4546, P-AUPRO:0.7384
zipper: I-Auroc:0.9588, I-AP:0.9865, I-F1:0.9667, P-AUROC:0.9610, P-AP:0.5272, P-F1:0.5362, P-AUPRO:0.8852
Mean: I-Auroc:0.9141, I-AP:0.9624, I-F1:0.9297, P-AUROC:0.9591, P-AP:0.6197, P-F1:0.6082, P-AUPRO:0.8859
cuda:3
shots: 4
carpet: I-Auroc:0.9884, I-AP:0.9964, I-F1:0.9724, P-AUROC:0.9794, P-AP:0.7319, P-F1:0.7238, P-AUPRO:0.9340
grid: I-Auroc:0.7393, I-AP:0.8890, I-F1:0.8871, P-AUROC:0.9192, P-AP:0.2923, P-F1:0.3683, P-AUPRO:0.7737
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9954, P-AP:0.7308, P-F1:0.6843, P-AUPRO:0.9903
tile: I-Auroc:0.9931, I-AP:0.9978, I-F1:0.9881, P-AUROC:0.9792, P-AP:0.7934, P-F1:0.7876, P-AUPRO:0.8912
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9732, P-AP:0.7668, P-F1:0.6904, P-AUPRO:0.9389
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9791, P-AP:0.8220, P-F1:0.7669, P-AUPRO:0.9461
cable: I-Auroc:0.9680, I-AP:0.9802, I-F1:0.9319, P-AUROC:0.9419, P-AP:0.5731, P-F1:0.5784, P-AUPRO:0.8483
capsule: I-Auroc:0.8759, I-AP:0.9679, I-F1:0.9558, P-AUROC:0.9754, P-AP:0.4935, P-F1:0.4944, P-AUPRO:0.9533
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9915, P-AP:0.8146, P-F1:0.7788, P-AUPRO:0.9586
metal_nut: I-Auroc:0.9726, I-AP:0.9935, I-F1:0.9630, P-AUROC:0.9435, P-AP:0.8028, P-F1:0.7406, P-AUPRO:0.8637
pill: I-Auroc:0.9542, I-AP:0.9920, I-F1:0.9481, P-AUROC:0.9601, P-AP:0.7496, P-F1:0.6918, P-AUPRO:0.9319
screw: I-Auroc:0.7161, I-AP:0.8713, I-F1:0.8769, P-AUROC:0.9779, P-AP:0.4364, P-F1:0.4646, P-AUPRO:0.9121
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9931, P-AP:0.7567, P-F1:0.7339, P-AUPRO:0.9423
transistor: I-Auroc:0.9167, I-AP:0.8971, I-F1:0.8000, P-AUROC:0.8874, P-AP:0.4648, P-F1:0.4639, P-AUPRO:0.7523
zipper: I-Auroc:0.9559, I-AP:0.9850, I-F1:0.9752, P-AUROC:0.9589, P-AP:0.5259, P-F1:0.5395, P-AUPRO:0.8700
Mean: I-Auroc:0.9380, I-AP:0.9711, I-F1:0.9507, P-AUROC:0.9637, P-AP:0.6503, P-F1:0.6338, P-AUPRO:0.9004



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dino_vit_base_16   (R256-C224)

cuda:4
shots: 1
carpet: I-Auroc:0.9980, I-AP:0.9994, I-F1:0.9888, P-AUROC:0.9913, P-AP:0.7300, P-F1:0.7237, P-AUPRO:0.9637
grid: I-Auroc:0.9465, I-AP:0.9826, I-F1:0.9231, P-AUROC:0.9488, P-AP:0.4208, P-F1:0.4703, P-AUPRO:0.8864
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9945, P-AUROC:0.9948, P-AP:0.6435, P-F1:0.6273, P-AUPRO:0.9816
tile: I-Auroc:0.9971, I-AP:0.9989, I-F1:0.9881, P-AUROC:0.9686, P-AP:0.7772, P-F1:0.7603, P-AUPRO:0.8813
wood: I-Auroc:0.9798, I-AP:0.9938, I-F1:0.9661, P-AUROC:0.9655, P-AP:0.6976, P-F1:0.6320, P-AUPRO:0.8912
bottle: I-Auroc:0.9913, I-AP:0.9974, I-F1:0.9760, P-AUROC:0.9792, P-AP:0.8031, P-F1:0.7500, P-AUPRO:0.9291
cable: I-Auroc:0.8426, I-AP:0.9190, I-F1:0.8261, P-AUROC:0.9188, P-AP:0.4615, P-F1:0.4818, P-AUPRO:0.7591
capsule: I-Auroc:0.7024, I-AP:0.9168, I-F1:0.9145, P-AUROC:0.9627, P-AP:0.3648, P-F1:0.3958, P-AUPRO:0.8453
hazelnut: I-Auroc:0.9746, I-AP:0.9873, I-F1:0.9379, P-AUROC:0.9802, P-AP:0.6913, P-F1:0.6787, P-AUPRO:0.9161
metal_nut: I-Auroc:0.7947, I-AP:0.9440, I-F1:0.9163, P-AUROC:0.8527, P-AP:0.5006, P-F1:0.5330, P-AUPRO:0.6924
pill: I-Auroc:0.9419, I-AP:0.9896, I-F1:0.9399, P-AUROC:0.9310, P-AP:0.6634, P-F1:0.6317, P-AUPRO:0.8855
screw: I-Auroc:0.6454, I-AP:0.8415, I-F1:0.8561, P-AUROC:0.9393, P-AP:0.2015, P-F1:0.2592, P-AUPRO:0.7888
toothbrush: I-Auroc:0.9250, I-AP:0.9726, I-F1:0.9062, P-AUROC:0.9816, P-AP:0.7333, P-F1:0.7140, P-AUPRO:0.8055
transistor: I-Auroc:0.9283, I-AP:0.9272, I-F1:0.8571, P-AUROC:0.8764, P-AP:0.4485, P-F1:0.4361, P-AUPRO:0.6992
zipper: I-Auroc:0.8209, I-AP:0.9409, I-F1:0.9119, P-AUROC:0.8951, P-AP:0.3566, P-F1:0.4309, P-AUPRO:0.7712
Mean: I-Auroc:0.8992, I-AP:0.9607, I-F1:0.9268, P-AUROC:0.9457, P-AP:0.5663, P-F1:0.5683, P-AUPRO:0.8464
cuda:4
shots: 2
carpet: I-Auroc:0.9964, I-AP:0.9989, I-F1:0.9832, P-AUROC:0.9910, P-AP:0.7105, P-F1:0.7172, P-AUPRO:0.9571
grid: I-Auroc:0.9140, I-AP:0.9722, I-F1:0.9091, P-AUROC:0.9372, P-AP:0.3893, P-F1:0.4645, P-AUPRO:0.8568
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9948, P-AP:0.6457, P-F1:0.6295, P-AUPRO:0.9808
tile: I-Auroc:0.9913, I-AP:0.9970, I-F1:0.9881, P-AUROC:0.9699, P-AP:0.7726, P-F1:0.7610, P-AUPRO:0.8816
wood: I-Auroc:0.9754, I-AP:0.9924, I-F1:0.9580, P-AUROC:0.9662, P-AP:0.7061, P-F1:0.6372, P-AUPRO:0.8936
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9825, P-AP:0.8170, P-F1:0.7615, P-AUPRO:0.9323
cable: I-Auroc:0.9067, I-AP:0.9490, I-F1:0.8523, P-AUROC:0.9372, P-AP:0.5259, P-F1:0.5513, P-AUPRO:0.8101
capsule: I-Auroc:0.7224, I-AP:0.9210, I-F1:0.9292, P-AUROC:0.9630, P-AP:0.3551, P-F1:0.3879, P-AUPRO:0.8516
hazelnut: I-Auroc:0.9857, I-AP:0.9930, I-F1:0.9635, P-AUROC:0.9813, P-AP:0.7065, P-F1:0.6844, P-AUPRO:0.9235
metal_nut: I-Auroc:0.9257, I-AP:0.9821, I-F1:0.9347, P-AUROC:0.8950, P-AP:0.6479, P-F1:0.6223, P-AUPRO:0.7919
pill: I-Auroc:0.9411, I-AP:0.9895, I-F1:0.9441, P-AUROC:0.9381, P-AP:0.6795, P-F1:0.6391, P-AUPRO:0.8980
screw: I-Auroc:0.6278, I-AP:0.8299, I-F1:0.8561, P-AUROC:0.9582, P-AP:0.2664, P-F1:0.3273, P-AUPRO:0.8597
toothbrush: I-Auroc:0.9194, I-AP:0.9680, I-F1:0.9375, P-AUROC:0.9823, P-AP:0.7040, P-F1:0.6782, P-AUPRO:0.8315
transistor: I-Auroc:0.9463, I-AP:0.9409, I-F1:0.8732, P-AUROC:0.8900, P-AP:0.4755, P-F1:0.4616, P-AUPRO:0.7327
zipper: I-Auroc:0.8196, I-AP:0.9422, I-F1:0.9084, P-AUROC:0.8883, P-AP:0.3573, P-F1:0.4281, P-AUPRO:0.7598
Mean: I-Auroc:0.9114, I-AP:0.9651, I-F1:0.9353, P-AUROC:0.9517, P-AP:0.5840, P-F1:0.5834, P-AUPRO:0.8641
cuda:4
shots: 4
carpet: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9886, P-AUROC:0.9915, P-AP:0.7253, P-F1:0.7211, P-AUPRO:0.9574
grid: I-Auroc:0.9114, I-AP:0.9702, I-F1:0.8991, P-AUROC:0.9415, P-AP:0.3899, P-F1:0.4617, P-AUPRO:0.8571
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9955, P-AP:0.6471, P-F1:0.6329, P-AUPRO:0.9845
tile: I-Auroc:0.9968, I-AP:0.9988, I-F1:0.9880, P-AUROC:0.9707, P-AP:0.7780, P-F1:0.7688, P-AUPRO:0.8803
wood: I-Auroc:0.9798, I-AP:0.9939, I-F1:0.9580, P-AUROC:0.9653, P-AP:0.7154, P-F1:0.6529, P-AUPRO:0.8962
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9835, P-AP:0.8225, P-F1:0.7665, P-AUPRO:0.9348
cable: I-Auroc:0.9442, I-AP:0.9683, I-F1:0.9032, P-AUROC:0.9426, P-AP:0.5538, P-F1:0.5810, P-AUPRO:0.8416
capsule: I-Auroc:0.8233, I-AP:0.9546, I-F1:0.9237, P-AUROC:0.9701, P-AP:0.4753, P-F1:0.4964, P-AUPRO:0.8613
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9876, P-AP:0.7600, P-F1:0.7523, P-AUPRO:0.9429
metal_nut: I-Auroc:0.9497, I-AP:0.9876, I-F1:0.9534, P-AUROC:0.9084, P-AP:0.6952, P-F1:0.6604, P-AUPRO:0.8110
pill: I-Auroc:0.9403, I-AP:0.9893, I-F1:0.9452, P-AUROC:0.9414, P-AP:0.6877, P-F1:0.6452, P-AUPRO:0.9034
screw: I-Auroc:0.6296, I-AP:0.8184, I-F1:0.8593, P-AUROC:0.9541, P-AP:0.2268, P-F1:0.2839, P-AUPRO:0.8397
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9913, P-AP:0.7540, P-F1:0.7142, P-AUPRO:0.9120
transistor: I-Auroc:0.9529, I-AP:0.9420, I-F1:0.8611, P-AUROC:0.8940, P-AP:0.4846, P-F1:0.4683, P-AUPRO:0.7409
zipper: I-Auroc:0.8183, I-AP:0.9421, I-F1:0.9084, P-AUROC:0.9007, P-AP:0.3646, P-F1:0.4268, P-AUPRO:0.7665
Mean: I-Auroc:0.9295, I-AP:0.9710, I-F1:0.9459, P-AUROC:0.9559, P-AP:0.6054, P-F1:0.6022, P-AUPRO:0.8753



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : ibot_vit_base_16   (R512-C448)

cuda:1
shots: 1
carpet: I-Auroc:0.9928, I-AP:0.9978, I-F1:0.9724, P-AUROC:0.9792, P-AP:0.7169, P-F1:0.7283, P-AUPRO:0.9399
grid: I-Auroc:0.6992, I-AP:0.8909, I-F1:0.8507, P-AUROC:0.8953, P-AP:0.2918, P-F1:0.3607, P-AUPRO:0.7498
leather: I-Auroc:0.9861, I-AP:0.9960, I-F1:0.9780, P-AUROC:0.9943, P-AP:0.7441, P-F1:0.6998, P-AUPRO:0.9733
tile: I-Auroc:0.9978, I-AP:0.9992, I-F1:0.9940, P-AUROC:0.9832, P-AP:0.8064, P-F1:0.8088, P-AUPRO:0.9142
wood: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9724, P-AP:0.7581, P-F1:0.6762, P-AUPRO:0.9340
bottle: I-Auroc:0.9944, I-AP:0.9984, I-F1:0.9920, P-AUROC:0.9760, P-AP:0.8035, P-F1:0.7428, P-AUPRO:0.9286
cable: I-Auroc:0.7178, I-AP:0.7961, I-F1:0.7981, P-AUROC:0.9205, P-AP:0.3489, P-F1:0.4385, P-AUPRO:0.7681
capsule: I-Auroc:0.7427, I-AP:0.9263, I-F1:0.9310, P-AUROC:0.9712, P-AP:0.3434, P-F1:0.4203, P-AUPRO:0.9300
hazelnut: I-Auroc:0.9739, I-AP:0.9875, I-F1:0.9474, P-AUROC:0.9813, P-AP:0.6922, P-F1:0.6346, P-AUPRO:0.9357
metal_nut: I-Auroc:0.8812, I-AP:0.9716, I-F1:0.9200, P-AUROC:0.9207, P-AP:0.6649, P-F1:0.6544, P-AUPRO:0.8000
pill: I-Auroc:0.9544, I-AP:0.9917, I-F1:0.9485, P-AUROC:0.9616, P-AP:0.7280, P-F1:0.6686, P-AUPRO:0.9341
screw: I-Auroc:0.6270, I-AP:0.8195, I-F1:0.8655, P-AUROC:0.9621, P-AP:0.1902, P-F1:0.2218, P-AUPRO:0.8529
toothbrush: I-Auroc:0.9194, I-AP:0.9723, I-F1:0.9091, P-AUROC:0.9839, P-AP:0.7128, P-F1:0.7086, P-AUPRO:0.8404
transistor: I-Auroc:0.9100, I-AP:0.8945, I-F1:0.8158, P-AUROC:0.8563, P-AP:0.4143, P-F1:0.4177, P-AUPRO:0.6557
zipper: I-Auroc:0.9020, I-AP:0.9722, I-F1:0.9200, P-AUROC:0.9608, P-AP:0.4538, P-F1:0.4875, P-AUPRO:0.8677
Mean: I-Auroc:0.8866, I-AP:0.9476, I-F1:0.9228, P-AUROC:0.9546, P-AP:0.5779, P-F1:0.5779, P-AUPRO:0.8683
cuda:1
shots: 2
carpet: I-Auroc:0.9920, I-AP:0.9975, I-F1:0.9724, P-AUROC:0.9800, P-AP:0.7114, P-F1:0.7227, P-AUPRO:0.9341
grid: I-Auroc:0.7109, I-AP:0.8851, I-F1:0.8462, P-AUROC:0.9161, P-AP:0.3092, P-F1:0.3834, P-AUPRO:0.7683
leather: I-Auroc:0.9868, I-AP:0.9962, I-F1:0.9834, P-AUROC:0.9940, P-AP:0.7444, P-F1:0.6995, P-AUPRO:0.9713
tile: I-Auroc:0.9946, I-AP:0.9982, I-F1:0.9881, P-AUROC:0.9824, P-AP:0.8030, P-F1:0.7990, P-AUPRO:0.9052
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9740, P-AP:0.7650, P-F1:0.6809, P-AUPRO:0.9340
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9810, P-AP:0.8247, P-F1:0.7681, P-AUPRO:0.9407
cable: I-Auroc:0.9136, I-AP:0.9483, I-F1:0.8705, P-AUROC:0.9395, P-AP:0.5407, P-F1:0.5333, P-AUPRO:0.8218
capsule: I-Auroc:0.7387, I-AP:0.9232, I-F1:0.9422, P-AUROC:0.9696, P-AP:0.3266, P-F1:0.4075, P-AUPRO:0.9262
hazelnut: I-Auroc:0.9861, I-AP:0.9929, I-F1:0.9630, P-AUROC:0.9845, P-AP:0.7247, P-F1:0.6718, P-AUPRO:0.9455
metal_nut: I-Auroc:0.9609, I-AP:0.9909, I-F1:0.9524, P-AUROC:0.9561, P-AP:0.8243, P-F1:0.7778, P-AUPRO:0.8828
pill: I-Auroc:0.9463, I-AP:0.9903, I-F1:0.9541, P-AUROC:0.9667, P-AP:0.7509, P-F1:0.6820, P-AUPRO:0.9421
screw: I-Auroc:0.6995, I-AP:0.8740, I-F1:0.8731, P-AUROC:0.9747, P-AP:0.4385, P-F1:0.4845, P-AUPRO:0.9084
toothbrush: I-Auroc:0.9083, I-AP:0.9640, I-F1:0.9231, P-AUROC:0.9830, P-AP:0.6513, P-F1:0.6512, P-AUPRO:0.8630
transistor: I-Auroc:0.9196, I-AP:0.8970, I-F1:0.8219, P-AUROC:0.8763, P-AP:0.4433, P-F1:0.4412, P-AUPRO:0.7061
zipper: I-Auroc:0.9561, I-AP:0.9861, I-F1:0.9712, P-AUROC:0.9705, P-AP:0.5553, P-F1:0.5605, P-AUPRO:0.9059
Mean: I-Auroc:0.9142, I-AP:0.9629, I-F1:0.9369, P-AUROC:0.9632, P-AP:0.6275, P-F1:0.6176, P-AUPRO:0.8904
cuda:1
shots: 4
carpet: I-Auroc:0.9896, I-AP:0.9969, I-F1:0.9724, P-AUROC:0.9821, P-AP:0.7155, P-F1:0.7252, P-AUPRO:0.9356
grid: I-Auroc:0.7160, I-AP:0.8805, I-F1:0.8819, P-AUROC:0.9221, P-AP:0.3035, P-F1:0.3817, P-AUPRO:0.7808
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9971, P-AP:0.7552, P-F1:0.7077, P-AUPRO:0.9907
tile: I-Auroc:0.9978, I-AP:0.9992, I-F1:0.9940, P-AUROC:0.9831, P-AP:0.8022, P-F1:0.8029, P-AUPRO:0.9103
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9770, P-AP:0.7847, P-F1:0.7010, P-AUPRO:0.9437
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9832, P-AP:0.8353, P-F1:0.7831, P-AUPRO:0.9457
cable: I-Auroc:0.9636, I-AP:0.9767, I-F1:0.9271, P-AUROC:0.9453, P-AP:0.5947, P-F1:0.5912, P-AUPRO:0.8531
capsule: I-Auroc:0.8097, I-AP:0.9401, I-F1:0.9558, P-AUROC:0.9763, P-AP:0.4600, P-F1:0.4898, P-AUPRO:0.9483
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.8189, P-F1:0.7972, P-AUPRO:0.9625
metal_nut: I-Auroc:0.9804, I-AP:0.9954, I-F1:0.9735, P-AUROC:0.9625, P-AP:0.8601, P-F1:0.8128, P-AUPRO:0.9001
pill: I-Auroc:0.9460, I-AP:0.9901, I-F1:0.9544, P-AUROC:0.9680, P-AP:0.7617, P-F1:0.6907, P-AUPRO:0.9434
screw: I-Auroc:0.6829, I-AP:0.8371, I-F1:0.8794, P-AUROC:0.9746, P-AP:0.3642, P-F1:0.4054, P-AUPRO:0.9038
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9934, P-AP:0.7451, P-F1:0.7343, P-AUPRO:0.9402
transistor: I-Auroc:0.9313, I-AP:0.9217, I-F1:0.8286, P-AUROC:0.8855, P-AP:0.4590, P-F1:0.4522, P-AUPRO:0.7156
zipper: I-Auroc:0.9577, I-AP:0.9860, I-F1:0.9672, P-AUROC:0.9725, P-AP:0.5669, P-F1:0.5710, P-AUPRO:0.9016
Mean: I-Auroc:0.9314, I-AP:0.9682, I-F1:0.9540, P-AUROC:0.9677, P-AP:0.6551, P-F1:0.6431, P-AUPRO:0.9050



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : ibot_vit_base_16   (R256-C224)

cuda:1
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9903, P-AP:0.7132, P-F1:0.7111, P-AUPRO:0.9652
grid: I-Auroc:0.9231, I-AP:0.9746, I-F1:0.9091, P-AUROC:0.9384, P-AP:0.3987, P-F1:0.4573, P-AUPRO:0.8669
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9954, P-AP:0.6623, P-F1:0.6370, P-AUPRO:0.9815
tile: I-Auroc:0.9910, I-AP:0.9969, I-F1:0.9881, P-AUROC:0.9747, P-AP:0.7964, P-F1:0.7789, P-AUPRO:0.8883
wood: I-Auroc:0.9842, I-AP:0.9952, I-F1:0.9667, P-AUROC:0.9671, P-AP:0.7268, P-F1:0.6524, P-AUPRO:0.8837
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9808, P-AP:0.8123, P-F1:0.7601, P-AUPRO:0.9333
cable: I-Auroc:0.8283, I-AP:0.9114, I-F1:0.8125, P-AUROC:0.9230, P-AP:0.4683, P-F1:0.4791, P-AUPRO:0.7591
capsule: I-Auroc:0.6984, I-AP:0.9154, I-F1:0.9217, P-AUROC:0.9639, P-AP:0.3629, P-F1:0.3932, P-AUPRO:0.8462
hazelnut: I-Auroc:0.9768, I-AP:0.9883, I-F1:0.9420, P-AUROC:0.9803, P-AP:0.6873, P-F1:0.6666, P-AUPRO:0.9199
metal_nut: I-Auroc:0.8079, I-AP:0.9483, I-F1:0.9163, P-AUROC:0.8568, P-AP:0.5052, P-F1:0.5418, P-AUPRO:0.7092
pill: I-Auroc:0.9394, I-AP:0.9891, I-F1:0.9437, P-AUROC:0.9444, P-AP:0.6918, P-F1:0.6476, P-AUPRO:0.9111
screw: I-Auroc:0.6245, I-AP:0.8311, I-F1:0.8561, P-AUROC:0.9376, P-AP:0.1881, P-F1:0.2492, P-AUPRO:0.7784
toothbrush: I-Auroc:0.9222, I-AP:0.9716, I-F1:0.9062, P-AUROC:0.9824, P-AP:0.7298, P-F1:0.7206, P-AUPRO:0.8017
transistor: I-Auroc:0.9492, I-AP:0.9455, I-F1:0.8732, P-AUROC:0.8879, P-AP:0.4801, P-F1:0.4678, P-AUPRO:0.7052
zipper: I-Auroc:0.8164, I-AP:0.9361, I-F1:0.9112, P-AUROC:0.9224, P-AP:0.3675, P-F1:0.4378, P-AUPRO:0.7968
Mean: I-Auroc:0.8973, I-AP:0.9602, I-F1:0.9289, P-AUROC:0.9497, P-AP:0.5727, P-F1:0.5734, P-AUPRO:0.8498
cuda:1
shots: 2
carpet: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9944, P-AUROC:0.9906, P-AP:0.7040, P-F1:0.7144, P-AUPRO:0.9627
grid: I-Auroc:0.8947, I-AP:0.9644, I-F1:0.9076, P-AUROC:0.9299, P-AP:0.3573, P-F1:0.4402, P-AUPRO:0.8327
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9954, P-AP:0.6617, P-F1:0.6368, P-AUPRO:0.9816
tile: I-Auroc:0.9881, I-AP:0.9960, I-F1:0.9881, P-AUROC:0.9748, P-AP:0.7944, P-F1:0.7750, P-AUPRO:0.8772
wood: I-Auroc:0.9816, I-AP:0.9943, I-F1:0.9593, P-AUROC:0.9680, P-AP:0.7321, P-F1:0.6548, P-AUPRO:0.8902
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9833, P-AP:0.8237, P-F1:0.7748, P-AUPRO:0.9398
cable: I-Auroc:0.9159, I-AP:0.9530, I-F1:0.8691, P-AUROC:0.9415, P-AP:0.5448, P-F1:0.5639, P-AUPRO:0.8171
capsule: I-Auroc:0.7244, I-AP:0.9204, I-F1:0.9286, P-AUROC:0.9648, P-AP:0.3508, P-F1:0.3921, P-AUPRO:0.8547
hazelnut: I-Auroc:0.9900, I-AP:0.9952, I-F1:0.9784, P-AUROC:0.9819, P-AP:0.7061, P-F1:0.6835, P-AUPRO:0.9292
metal_nut: I-Auroc:0.9335, I-AP:0.9841, I-F1:0.9394, P-AUROC:0.9057, P-AP:0.6628, P-F1:0.6476, P-AUPRO:0.8093
pill: I-Auroc:0.9362, I-AP:0.9884, I-F1:0.9496, P-AUROC:0.9516, P-AP:0.7053, P-F1:0.6570, P-AUPRO:0.9199
screw: I-Auroc:0.6243, I-AP:0.8253, I-F1:0.8530, P-AUROC:0.9566, P-AP:0.2612, P-F1:0.3220, P-AUPRO:0.8554
toothbrush: I-Auroc:0.9306, I-AP:0.9732, I-F1:0.9375, P-AUROC:0.9832, P-AP:0.7002, P-F1:0.6918, P-AUPRO:0.8341
transistor: I-Auroc:0.9621, I-AP:0.9541, I-F1:0.8919, P-AUROC:0.8997, P-AP:0.5106, P-F1:0.4986, P-AUPRO:0.7407
zipper: I-Auroc:0.8125, I-AP:0.9375, I-F1:0.9070, P-AUROC:0.9111, P-AP:0.3584, P-F1:0.4222, P-AUPRO:0.7820
Mean: I-Auroc:0.9129, I-AP:0.9657, I-F1:0.9403, P-AUROC:0.9559, P-AP:0.5916, P-F1:0.5916, P-AUPRO:0.8684
cuda:1
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9911, P-AP:0.7099, P-F1:0.7163, P-AUPRO:0.9645
grid: I-Auroc:0.8964, I-AP:0.9641, I-F1:0.8983, P-AUROC:0.9325, P-AP:0.3626, P-F1:0.4424, P-AUPRO:0.8337
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9945, P-AUROC:0.9957, P-AP:0.6582, P-F1:0.6410, P-AUPRO:0.9846
tile: I-Auroc:0.9913, I-AP:0.9972, I-F1:0.9880, P-AUROC:0.9760, P-AP:0.7963, P-F1:0.7823, P-AUPRO:0.8849
wood: I-Auroc:0.9868, I-AP:0.9961, I-F1:0.9667, P-AUROC:0.9701, P-AP:0.7518, P-F1:0.6807, P-AUPRO:0.8996
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9842, P-AP:0.8280, P-F1:0.7808, P-AUPRO:0.9382
cable: I-Auroc:0.9503, I-AP:0.9717, I-F1:0.9062, P-AUROC:0.9468, P-AP:0.5741, P-F1:0.5967, P-AUPRO:0.8483
capsule: I-Auroc:0.8077, I-AP:0.9464, I-F1:0.9417, P-AUROC:0.9717, P-AP:0.4712, P-F1:0.4907, P-AUPRO:0.8754
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9887, P-AP:0.7661, P-F1:0.7558, P-AUPRO:0.9486
metal_nut: I-Auroc:0.9653, I-AP:0.9914, I-F1:0.9634, P-AUROC:0.9206, P-AP:0.7188, P-F1:0.6898, P-AUPRO:0.8349
pill: I-Auroc:0.9348, I-AP:0.9880, I-F1:0.9466, P-AUROC:0.9550, P-AP:0.7160, P-F1:0.6646, P-AUPRO:0.9253
screw: I-Auroc:0.6348, I-AP:0.8196, I-F1:0.8582, P-AUROC:0.9530, P-AP:0.2235, P-F1:0.2764, P-AUPRO:0.8397
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9913, P-AP:0.7328, P-F1:0.7052, P-AUPRO:0.9120
transistor: I-Auroc:0.9617, I-AP:0.9508, I-F1:0.8800, P-AUROC:0.9055, P-AP:0.5208, P-F1:0.5026, P-AUPRO:0.7502
zipper: I-Auroc:0.8125, I-AP:0.9387, I-F1:0.9105, P-AUROC:0.9169, P-AP:0.3614, P-F1:0.4183, P-AUPRO:0.7770
Mean: I-Auroc:0.9294, I-AP:0.9709, I-F1:0.9499, P-AUROC:0.9599, P-AP:0.6128, P-F1:0.6096, P-AUPRO:0.8811



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2_vit_base_14   (R448-C392)

cuda:2
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9946, P-AP:0.7990, P-F1:0.7459, P-AUPRO:0.9838
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5627, P-F1:0.5813, P-AUPRO:0.9772
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.4857, P-F1:0.5240, P-AUPRO:0.9796
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9740, P-AP:0.7081, P-F1:0.7536, P-AUPRO:0.9013
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9836, P-AUROC:0.9682, P-AP:0.7115, P-F1:0.6966, P-AUPRO:0.9366
bottle: I-Auroc:0.9667, I-AP:0.9910, I-F1:0.9677, P-AUROC:0.9603, P-AP:0.7765, P-F1:0.7383, P-AUPRO:0.9234
cable: I-Auroc:0.9022, I-AP:0.9515, I-F1:0.8848, P-AUROC:0.9037, P-AP:0.4751, P-F1:0.5108, P-AUPRO:0.8044
capsule: I-Auroc:0.9362, I-AP:0.9860, I-F1:0.9478, P-AUROC:0.9766, P-AP:0.5220, P-F1:0.5131, P-AUPRO:0.9599
hazelnut: I-Auroc:0.9986, I-AP:0.9992, I-F1:0.9928, P-AUROC:0.9884, P-AP:0.7384, P-F1:0.7221, P-AUPRO:0.9577
metal_nut: I-Auroc:0.9741, I-AP:0.9940, I-F1:0.9637, P-AUROC:0.8928, P-AP:0.6208, P-F1:0.6156, P-AUPRO:0.8475
pill: I-Auroc:0.9801, I-AP:0.9965, I-F1:0.9751, P-AUROC:0.9232, P-AP:0.5613, P-F1:0.5743, P-AUPRO:0.9523
screw: I-Auroc:0.8442, I-AP:0.9438, I-F1:0.8915, P-AUROC:0.9830, P-AP:0.4682, P-F1:0.5050, P-AUPRO:0.9295
toothbrush: I-Auroc:0.9833, I-AP:0.9939, I-F1:0.9655, P-AUROC:0.9921, P-AP:0.7533, P-F1:0.7149, P-AUPRO:0.9473
transistor: I-Auroc:0.9883, I-AP:0.9814, I-F1:0.9500, P-AUROC:0.8650, P-AP:0.4206, P-F1:0.4411, P-AUPRO:0.7322
zipper: I-Auroc:0.9945, I-AP:0.9985, I-F1:0.9874, P-AUROC:0.9751, P-AP:0.5952, P-F1:0.5928, P-AUPRO:0.9286
Mean: I-Auroc:0.9705, I-AP:0.9888, I-F1:0.9660, P-AUROC:0.9589, P-AP:0.6132, P-F1:0.6153, P-AUPRO:0.9174
cuda:2
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9942, P-AP:0.7865, P-F1:0.7379, P-AUPRO:0.9817
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5708, P-F1:0.5845, P-AUPRO:0.9767
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9923, P-AP:0.4686, P-F1:0.5185, P-AUPRO:0.9789
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9747, P-AP:0.7122, P-F1:0.7543, P-AUPRO:0.8980
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9712, P-AP:0.7233, P-F1:0.6982, P-AUPRO:0.9418
bottle: I-Auroc:0.9802, I-AP:0.9943, I-F1:0.9677, P-AUROC:0.9682, P-AP:0.7973, P-F1:0.7511, P-AUPRO:0.9355
cable: I-Auroc:0.9462, I-AP:0.9718, I-F1:0.9011, P-AUROC:0.9207, P-AP:0.5184, P-F1:0.5507, P-AUPRO:0.8377
capsule: I-Auroc:0.9310, I-AP:0.9846, I-F1:0.9561, P-AUROC:0.9755, P-AP:0.5254, P-F1:0.5170, P-AUPRO:0.9626
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9896, P-AP:0.7539, P-F1:0.7357, P-AUPRO:0.9629
metal_nut: I-Auroc:0.9907, I-AP:0.9978, I-F1:0.9789, P-AUROC:0.9181, P-AP:0.7014, P-F1:0.6945, P-AUPRO:0.8847
pill: I-Auroc:0.9809, I-AP:0.9967, I-F1:0.9720, P-AUROC:0.9297, P-AP:0.5722, P-F1:0.5834, P-AUPRO:0.9565
screw: I-Auroc:0.8873, I-AP:0.9596, I-F1:0.9053, P-AUROC:0.9869, P-AP:0.5140, P-F1:0.5369, P-AUPRO:0.9521
toothbrush: I-Auroc:0.9833, I-AP:0.9939, I-F1:0.9655, P-AUROC:0.9910, P-AP:0.7310, P-F1:0.6959, P-AUPRO:0.9576
transistor: I-Auroc:0.9921, I-AP:0.9884, I-F1:0.9500, P-AUROC:0.8836, P-AP:0.4501, P-F1:0.4662, P-AUPRO:0.7589
zipper: I-Auroc:0.9968, I-AP:0.9992, I-F1:0.9874, P-AUROC:0.9757, P-AP:0.6164, P-F1:0.6100, P-AUPRO:0.9278
Mean: I-Auroc:0.9784, I-AP:0.9921, I-F1:0.9698, P-AUROC:0.9644, P-AP:0.6294, P-F1:0.6290, P-AUPRO:0.9276
cuda:2
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9944, P-AP:0.7891, P-F1:0.7388, P-AUPRO:0.9833
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5711, P-F1:0.5835, P-AUPRO:0.9752
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9923, P-AP:0.4659, P-F1:0.5051, P-AUPRO:0.9761
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9751, P-AP:0.7127, P-F1:0.7560, P-AUPRO:0.9032
wood: I-Auroc:0.9877, I-AP:0.9960, I-F1:0.9756, P-AUROC:0.9722, P-AP:0.7228, P-F1:0.7007, P-AUPRO:0.9418
bottle: I-Auroc:0.9889, I-AP:0.9967, I-F1:0.9756, P-AUROC:0.9718, P-AP:0.8081, P-F1:0.7601, P-AUPRO:0.9424
cable: I-Auroc:0.9526, I-AP:0.9748, I-F1:0.9091, P-AUROC:0.9269, P-AP:0.5293, P-F1:0.5557, P-AUPRO:0.8553
capsule: I-Auroc:0.9769, I-AP:0.9950, I-F1:0.9732, P-AUROC:0.9802, P-AP:0.5717, P-F1:0.5622, P-AUPRO:0.9699
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9923, P-AP:0.7787, P-F1:0.7531, P-AUPRO:0.9704
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.9237, P-AP:0.7201, P-F1:0.7119, P-AUPRO:0.8894
pill: I-Auroc:0.9815, I-AP:0.9968, I-F1:0.9720, P-AUROC:0.9336, P-AP:0.5772, P-F1:0.5907, P-AUPRO:0.9576
screw: I-Auroc:0.8860, I-AP:0.9558, I-F1:0.9084, P-AUROC:0.9878, P-AP:0.5203, P-F1:0.5392, P-AUPRO:0.9541
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9938, P-AP:0.7582, P-F1:0.7277, P-AUPRO:0.9686
transistor: I-Auroc:0.9971, I-AP:0.9954, I-F1:0.9877, P-AUROC:0.8874, P-AP:0.4516, P-F1:0.4670, P-AUPRO:0.7666
zipper: I-Auroc:0.9945, I-AP:0.9985, I-F1:0.9874, P-AUROC:0.9762, P-AP:0.6122, P-F1:0.6096, P-AUPRO:0.9272
Mean: I-Auroc:0.9837, I-AP:0.9937, I-F1:0.9776, P-AUROC:0.9668, P-AP:0.6393, P-F1:0.6374, P-AUPRO:0.9321



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2_vit_base_14   (R256-C224)

cuda:2
shots: 1
cuda:2
shots: 1
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9944, P-AUROC:0.9938, P-AP:0.7552, P-F1:0.7199, P-AUPRO:0.9723
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9889, P-AP:0.4396, P-F1:0.4887, P-AUPRO:0.9576
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9945, P-AUROC:0.9879, P-AP:0.3536, P-F1:0.4466, P-AUPRO:0.9565
tile: I-Auroc:0.9899, I-AP:0.9970, I-F1:0.9940, P-AUROC:0.9709, P-AP:0.6779, P-F1:0.7209, P-AUPRO:0.8637
wood: I-Auroc:0.9737, I-AP:0.9918, I-F1:0.9580, P-AUROC:0.9616, P-AP:0.6733, P-F1:0.6645, P-AUPRO:0.8888
bottle: I-Auroc:0.9833, I-AP:0.9953, I-F1:0.9756, P-AUROC:0.9636, P-AP:0.7602, P-F1:0.7258, P-AUPRO:0.9150
cable: I-Auroc:0.8874, I-AP:0.9454, I-F1:0.8639, P-AUROC:0.9121, P-AP:0.4749, P-F1:0.5241, P-AUPRO:0.7977
capsule: I-Auroc:0.8732, I-AP:0.9706, I-F1:0.9277, P-AUROC:0.9693, P-AP:0.4668, P-F1:0.4661, P-AUPRO:0.9032
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9879, P-AP:0.7238, P-F1:0.7281, P-AUPRO:0.9436
metal_nut: I-Auroc:0.9682, I-AP:0.9928, I-F1:0.9514, P-AUROC:0.8848, P-AP:0.6141, P-F1:0.6138, P-AUPRO:0.8173
pill: I-Auroc:0.9744, I-AP:0.9955, I-F1:0.9597, P-AUROC:0.9241, P-AP:0.5603, P-F1:0.5774, P-AUPRO:0.9320
screw: I-Auroc:0.7655, I-AP:0.9139, I-F1:0.8741, P-AUROC:0.9569, P-AP:0.3341, P-F1:0.3947, P-AUPRO:0.8413
toothbrush: I-Auroc:0.9722, I-AP:0.9912, I-F1:0.9667, P-AUROC:0.9889, P-AP:0.7008, P-F1:0.7027, P-AUPRO:0.9095
transistor: I-Auroc:0.9433, I-AP:0.9287, I-F1:0.8831, P-AUROC:0.8742, P-AP:0.4536, P-F1:0.4751, P-AUPRO:0.7471
zipper: I-Auroc:0.9680, I-AP:0.9901, I-F1:0.9752, P-AUROC:0.9479, P-AP:0.4538, P-F1:0.4888, P-AUPRO:0.8648
Mean: I-Auroc:0.9523, I-AP:0.9805, I-F1:0.9540, P-AUROC:0.9542, P-AP:0.5628, P-F1:0.5825, P-AUPRO:0.8874
cuda:2
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9936, P-AP:0.7547, P-F1:0.7148, P-AUPRO:0.9714
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9888, P-AP:0.4387, P-F1:0.4884, P-AUPRO:0.9555
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9945, P-AUROC:0.9879, P-AP:0.3524, P-F1:0.4457, P-AUPRO:0.9554
tile: I-Auroc:0.9881, I-AP:0.9966, I-F1:0.9940, P-AUROC:0.9709, P-AP:0.6803, P-F1:0.7168, P-AUPRO:0.8590
wood: I-Auroc:0.9737, I-AP:0.9919, I-F1:0.9667, P-AUROC:0.9635, P-AP:0.6844, P-F1:0.6677, P-AUPRO:0.8970
bottle: I-Auroc:0.9913, I-AP:0.9975, I-F1:0.9839, P-AUROC:0.9716, P-AP:0.7815, P-F1:0.7381, P-AUPRO:0.9287
cable: I-Auroc:0.9084, I-AP:0.9522, I-F1:0.8750, P-AUROC:0.9300, P-AP:0.5184, P-F1:0.5543, P-AUPRO:0.8351
capsule: I-Auroc:0.8664, I-AP:0.9675, I-F1:0.9304, P-AUROC:0.9709, P-AP:0.4750, P-F1:0.4712, P-AUPRO:0.9140
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9892, P-AP:0.7430, P-F1:0.7386, P-AUPRO:0.9504
metal_nut: I-Auroc:0.9878, I-AP:0.9971, I-F1:0.9787, P-AUROC:0.9171, P-AP:0.7024, P-F1:0.7019, P-AUPRO:0.8634
pill: I-Auroc:0.9779, I-AP:0.9961, I-F1:0.9720, P-AUROC:0.9319, P-AP:0.5768, P-F1:0.5894, P-AUPRO:0.9380
screw: I-Auroc:0.7686, I-AP:0.9068, I-F1:0.8821, P-AUROC:0.9699, P-AP:0.3724, P-F1:0.4149, P-AUPRO:0.8818
toothbrush: I-Auroc:0.9806, I-AP:0.9930, I-F1:0.9655, P-AUROC:0.9885, P-AP:0.6774, P-F1:0.6890, P-AUPRO:0.9170
transistor: I-Auroc:0.9604, I-AP:0.9430, I-F1:0.9024, P-AUROC:0.8887, P-AP:0.4792, P-F1:0.5058, P-AUPRO:0.7741
zipper: I-Auroc:0.9863, I-AP:0.9960, I-F1:0.9835, P-AUROC:0.9528, P-AP:0.4897, P-F1:0.5300, P-AUPRO:0.8726
Mean: I-Auroc:0.9584, I-AP:0.9822, I-F1:0.9610, P-AUROC:0.9610, P-AP:0.5817, P-F1:0.5978, P-AUPRO:0.9009
cuda:2
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7503, P-F1:0.7130, P-AUPRO:0.9695
grid: I-Auroc:0.9850, I-AP:0.9958, I-F1:0.9912, P-AUROC:0.9884, P-AP:0.4386, P-F1:0.4874, P-AUPRO:0.9557
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9883, P-AP:0.3688, P-F1:0.4414, P-AUPRO:0.9578
tile: I-Auroc:0.9921, I-AP:0.9975, I-F1:0.9940, P-AUROC:0.9706, P-AP:0.6747, P-F1:0.7157, P-AUPRO:0.8591
wood: I-Auroc:0.9711, I-AP:0.9914, I-F1:0.9587, P-AUROC:0.9636, P-AP:0.6800, P-F1:0.6700, P-AUPRO:0.8997
bottle: I-Auroc:0.9937, I-AP:0.9981, I-F1:0.9839, P-AUROC:0.9737, P-AP:0.7880, P-F1:0.7440, P-AUPRO:0.9332
cable: I-Auroc:0.9280, I-AP:0.9610, I-F1:0.8743, P-AUROC:0.9346, P-AP:0.5280, P-F1:0.5656, P-AUPRO:0.8512
capsule: I-Auroc:0.9246, I-AP:0.9824, I-F1:0.9469, P-AUROC:0.9770, P-AP:0.5297, P-F1:0.5268, P-AUPRO:0.9340
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9910, P-AP:0.7568, P-F1:0.7514, P-AUPRO:0.9553
metal_nut: I-Auroc:0.9927, I-AP:0.9983, I-F1:0.9840, P-AUROC:0.9237, P-AP:0.7254, P-F1:0.7229, P-AUPRO:0.8710
pill: I-Auroc:0.9806, I-AP:0.9966, I-F1:0.9753, P-AUROC:0.9361, P-AP:0.5822, P-F1:0.5925, P-AUPRO:0.9407
screw: I-Auroc:0.7655, I-AP:0.8963, I-F1:0.8915, P-AUROC:0.9718, P-AP:0.3578, P-F1:0.4122, P-AUPRO:0.8858
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9911, P-AP:0.6842, P-F1:0.6991, P-AUPRO:0.9386
transistor: I-Auroc:0.9779, I-AP:0.9642, I-F1:0.9500, P-AUROC:0.8943, P-AP:0.4884, P-F1:0.5104, P-AUPRO:0.7835
zipper: I-Auroc:0.9829, I-AP:0.9949, I-F1:0.9835, P-AUROC:0.9569, P-AP:0.4916, P-F1:0.5386, P-AUPRO:0.8814
Mean: I-Auroc:0.9661, I-AP:0.9850, I-F1:0.9674, P-AUROC:0.9636, P-AP:0.5896, P-F1:0.6061, P-AUPRO:0.9078



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14   (R256-C224)

cuda:3
shots: 1
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9927, P-AP:0.7451, P-F1:0.6902, P-AUPRO:0.9679
grid: I-Auroc:0.9908, I-AP:0.9972, I-F1:0.9912, P-AUROC:0.9893, P-AP:0.4311, P-F1:0.4960, P-AUPRO:0.9601
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9872, P-AP:0.3712, P-F1:0.4180, P-AUPRO:0.9565
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9940, P-AUROC:0.9709, P-AP:0.6831, P-F1:0.7072, P-AUPRO:0.8732
wood: I-Auroc:0.9816, I-AP:0.9946, I-F1:0.9661, P-AUROC:0.9600, P-AP:0.6364, P-F1:0.6314, P-AUPRO:0.8795
bottle: I-Auroc:0.9976, I-AP:0.9992, I-F1:0.9921, P-AUROC:0.9677, P-AP:0.7637, P-F1:0.7341, P-AUPRO:0.9243
cable: I-Auroc:0.8922, I-AP:0.9467, I-F1:0.8675, P-AUROC:0.9255, P-AP:0.5363, P-F1:0.5821, P-AUPRO:0.8163
capsule: I-Auroc:0.8899, I-AP:0.9748, I-F1:0.9427, P-AUROC:0.9752, P-AP:0.4875, P-F1:0.4848, P-AUPRO:0.9165
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9859, P-AUROC:0.9889, P-AP:0.7499, P-F1:0.7434, P-AUPRO:0.9405
metal_nut: I-Auroc:0.9570, I-AP:0.9906, I-F1:0.9492, P-AUROC:0.8878, P-AP:0.6235, P-F1:0.6266, P-AUPRO:0.8274
pill: I-Auroc:0.9689, I-AP:0.9946, I-F1:0.9609, P-AUROC:0.9166, P-AP:0.5451, P-F1:0.5617, P-AUPRO:0.9307
screw: I-Auroc:0.7803, I-AP:0.9172, I-F1:0.8812, P-AUROC:0.9570, P-AP:0.3557, P-F1:0.4047, P-AUPRO:0.8429
toothbrush: I-Auroc:0.9750, I-AP:0.9915, I-F1:0.9655, P-AUROC:0.9896, P-AP:0.7333, P-F1:0.7182, P-AUPRO:0.9128
transistor: I-Auroc:0.9642, I-AP:0.9511, I-F1:0.9024, P-AUROC:0.8522, P-AP:0.4151, P-F1:0.4344, P-AUPRO:0.7233
zipper: I-Auroc:0.9346, I-AP:0.9785, I-F1:0.9675, P-AUROC:0.9508, P-AP:0.4648, P-F1:0.5014, P-AUPRO:0.8727
Mean: I-Auroc:0.9553, I-AP:0.9823, I-F1:0.9574, P-AUROC:0.9541, P-AP:0.5695, P-F1:0.5823, P-AUPRO:0.8896
cuda:3
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9921, P-AP:0.7346, P-F1:0.6805, P-AUPRO:0.9656
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9890, P-AP:0.4301, P-F1:0.4907, P-AUPRO:0.9580
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9871, P-AP:0.3395, P-F1:0.4232, P-AUPRO:0.9548
tile: I-Auroc:0.9946, I-AP:0.9982, I-F1:0.9881, P-AUROC:0.9707, P-AP:0.6847, P-F1:0.7029, P-AUPRO:0.8562
wood: I-Auroc:0.9825, I-AP:0.9949, I-F1:0.9661, P-AUROC:0.9619, P-AP:0.6440, P-F1:0.6388, P-AUPRO:0.8886
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9738, P-AP:0.7802, P-F1:0.7458, P-AUPRO:0.9352
cable: I-Auroc:0.9136, I-AP:0.9543, I-F1:0.8652, P-AUROC:0.9380, P-AP:0.5639, P-F1:0.5979, P-AUPRO:0.8482
capsule: I-Auroc:0.8732, I-AP:0.9695, I-F1:0.9437, P-AUROC:0.9758, P-AP:0.4864, P-F1:0.4863, P-AUPRO:0.9259
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.7612, P-F1:0.7517, P-AUPRO:0.9485
metal_nut: I-Auroc:0.9819, I-AP:0.9957, I-F1:0.9684, P-AUROC:0.9167, P-AP:0.6936, P-F1:0.6948, P-AUPRO:0.8639
pill: I-Auroc:0.9684, I-AP:0.9944, I-F1:0.9677, P-AUROC:0.9250, P-AP:0.5613, P-F1:0.5765, P-AUPRO:0.9383
screw: I-Auroc:0.8258, I-AP:0.9301, I-F1:0.8906, P-AUROC:0.9671, P-AP:0.3858, P-F1:0.4305, P-AUPRO:0.8720
toothbrush: I-Auroc:0.9833, I-AP:0.9939, I-F1:0.9655, P-AUROC:0.9891, P-AP:0.6969, P-F1:0.7007, P-AUPRO:0.9201
transistor: I-Auroc:0.9783, I-AP:0.9645, I-F1:0.9176, P-AUROC:0.8766, P-AP:0.4546, P-F1:0.4691, P-AUPRO:0.7519
zipper: I-Auroc:0.9779, I-AP:0.9933, I-F1:0.9794, P-AUROC:0.9556, P-AP:0.4939, P-F1:0.5317, P-AUPRO:0.8823
Mean: I-Auroc:0.9647, I-AP:0.9857, I-F1:0.9625, P-AUROC:0.9606, P-AP:0.5807, P-F1:0.5947, P-AUPRO:0.9006
cuda:3
shots: 4
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9918, P-AP:0.7235, P-F1:0.6785, P-AUPRO:0.9624
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9885, P-AP:0.4257, P-F1:0.4886, P-AUPRO:0.9563
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9872, P-AP:0.3606, P-F1:0.4198, P-AUPRO:0.9543
tile: I-Auroc:0.9978, I-AP:0.9992, I-F1:0.9940, P-AUROC:0.9702, P-AP:0.6769, P-F1:0.7021, P-AUPRO:0.8565
wood: I-Auroc:0.9825, I-AP:0.9952, I-F1:0.9752, P-AUROC:0.9605, P-AP:0.6452, P-F1:0.6433, P-AUPRO:0.8911
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9758, P-AP:0.7862, P-F1:0.7523, P-AUPRO:0.9385
cable: I-Auroc:0.9254, I-AP:0.9593, I-F1:0.8706, P-AUROC:0.9431, P-AP:0.5730, P-F1:0.6079, P-AUPRO:0.8587
capsule: I-Auroc:0.9318, I-AP:0.9837, I-F1:0.9596, P-AUROC:0.9808, P-AP:0.5383, P-F1:0.5351, P-AUPRO:0.9404
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9916, P-AP:0.7771, P-F1:0.7647, P-AUPRO:0.9517
metal_nut: I-Auroc:0.9883, I-AP:0.9973, I-F1:0.9787, P-AUROC:0.9242, P-AP:0.7181, P-F1:0.7143, P-AUPRO:0.8703
pill: I-Auroc:0.9746, I-AP:0.9954, I-F1:0.9714, P-AUROC:0.9291, P-AP:0.5744, P-F1:0.5793, P-AUPRO:0.9409
screw: I-Auroc:0.7907, I-AP:0.9099, I-F1:0.8726, P-AUROC:0.9698, P-AP:0.3728, P-F1:0.4229, P-AUPRO:0.8766
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9915, P-AP:0.6955, P-F1:0.7048, P-AUPRO:0.9384
transistor: I-Auroc:0.9925, I-AP:0.9880, I-F1:0.9750, P-AUROC:0.8841, P-AP:0.4556, P-F1:0.4668, P-AUPRO:0.7603
zipper: I-Auroc:0.9790, I-AP:0.9934, I-F1:0.9793, P-AUROC:0.9606, P-AP:0.5065, P-F1:0.5450, P-AUPRO:0.8940
Mean: I-Auroc:0.9699, I-AP:0.9878, I-F1:0.9708, P-AUROC:0.9633, P-AP:0.5886, P-F1:0.6017, P-AUPRO:0.9060



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : beitv2_vit_base_16   (R256-C224)

cuda:3
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.6428, P-F1:0.6575, P-AUPRO:0.9569
grid: I-Auroc:0.9816, I-AP:0.9943, I-F1:0.9821, P-AUROC:0.9795, P-AP:0.3849, P-F1:0.4531, P-AUPRO:0.9376
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9878, P-AP:0.4067, P-F1:0.4542, P-AUPRO:0.9475
tile: I-Auroc:0.9971, I-AP:0.9989, I-F1:0.9880, P-AUROC:0.9769, P-AP:0.7642, P-F1:0.7627, P-AUPRO:0.9078
wood: I-Auroc:0.9667, I-AP:0.9896, I-F1:0.9449, P-AUROC:0.9575, P-AP:0.7211, P-F1:0.6795, P-AUPRO:0.9018
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9920, P-AUROC:0.9638, P-AP:0.7588, P-F1:0.7260, P-AUPRO:0.9111
cable: I-Auroc:0.9085, I-AP:0.9551, I-F1:0.8876, P-AUROC:0.9120, P-AP:0.4672, P-F1:0.5030, P-AUPRO:0.7860
capsule: I-Auroc:0.7355, I-AP:0.9339, I-F1:0.9160, P-AUROC:0.9328, P-AP:0.3716, P-F1:0.4035, P-AUPRO:0.7801
hazelnut: I-Auroc:0.9914, I-AP:0.9954, I-F1:0.9635, P-AUROC:0.9853, P-AP:0.7098, P-F1:0.7052, P-AUPRO:0.9321
metal_nut: I-Auroc:0.9858, I-AP:0.9969, I-F1:0.9785, P-AUROC:0.8868, P-AP:0.6468, P-F1:0.6235, P-AUPRO:0.8482
pill: I-Auroc:0.9634, I-AP:0.9934, I-F1:0.9556, P-AUROC:0.9448, P-AP:0.6631, P-F1:0.6530, P-AUPRO:0.9246
screw: I-Auroc:0.6594, I-AP:0.8701, I-F1:0.8530, P-AUROC:0.9103, P-AP:0.2467, P-F1:0.3127, P-AUPRO:0.7521
toothbrush: I-Auroc:0.9722, I-AP:0.9908, I-F1:0.9655, P-AUROC:0.9834, P-AP:0.7084, P-F1:0.6905, P-AUPRO:0.8400
transistor: I-Auroc:0.9225, I-AP:0.9084, I-F1:0.8571, P-AUROC:0.8104, P-AP:0.3460, P-F1:0.3792, P-AUPRO:0.6306
zipper: I-Auroc:0.9076, I-AP:0.9694, I-F1:0.9312, P-AUROC:0.9535, P-AP:0.4279, P-F1:0.4643, P-AUPRO:0.8695
Mean: I-Auroc:0.9326, I-AP:0.9730, I-F1:0.9477, P-AUROC:0.9450, P-AP:0.5511, P-F1:0.5645, P-AUPRO:0.8617
cuda:3
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.6519, P-F1:0.6618, P-AUPRO:0.9547
grid: I-Auroc:0.9825, I-AP:0.9946, I-F1:0.9821, P-AUROC:0.9803, P-AP:0.3910, P-F1:0.4555, P-AUPRO:0.9368
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9875, P-AP:0.3817, P-F1:0.4420, P-AUPRO:0.9451
tile: I-Auroc:0.9975, I-AP:0.9991, I-F1:0.9880, P-AUROC:0.9771, P-AP:0.7615, P-F1:0.7633, P-AUPRO:0.9068
wood: I-Auroc:0.9684, I-AP:0.9901, I-F1:0.9524, P-AUROC:0.9582, P-AP:0.7239, P-F1:0.6817, P-AUPRO:0.9039
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9692, P-AP:0.7719, P-F1:0.7334, P-AUPRO:0.9200
cable: I-Auroc:0.9245, I-AP:0.9605, I-F1:0.8927, P-AUROC:0.9271, P-AP:0.5036, P-F1:0.5374, P-AUPRO:0.8108
capsule: I-Auroc:0.7710, I-AP:0.9409, I-F1:0.9177, P-AUROC:0.9360, P-AP:0.3902, P-F1:0.4227, P-AUPRO:0.8007
hazelnut: I-Auroc:0.9982, I-AP:0.9990, I-F1:0.9859, P-AUROC:0.9874, P-AP:0.7320, P-F1:0.7334, P-AUPRO:0.9414
metal_nut: I-Auroc:0.9961, I-AP:0.9991, I-F1:0.9891, P-AUROC:0.9134, P-AP:0.7042, P-F1:0.6862, P-AUPRO:0.8761
pill: I-Auroc:0.9689, I-AP:0.9943, I-F1:0.9653, P-AUROC:0.9505, P-AP:0.6820, P-F1:0.6738, P-AUPRO:0.9342
screw: I-Auroc:0.5477, I-AP:0.8090, I-F1:0.8530, P-AUROC:0.9186, P-AP:0.2214, P-F1:0.2908, P-AUPRO:0.7541
toothbrush: I-Auroc:0.9583, I-AP:0.9847, I-F1:0.9310, P-AUROC:0.9841, P-AP:0.6623, P-F1:0.6546, P-AUPRO:0.8701
transistor: I-Auroc:0.9396, I-AP:0.9196, I-F1:0.8780, P-AUROC:0.8359, P-AP:0.3871, P-F1:0.4222, P-AUPRO:0.6646
zipper: I-Auroc:0.9160, I-AP:0.9710, I-F1:0.9402, P-AUROC:0.9565, P-AP:0.4501, P-F1:0.4825, P-AUPRO:0.8734
Mean: I-Auroc:0.9312, I-AP:0.9708, I-F1:0.9512, P-AUROC:0.9515, P-AP:0.5610, P-F1:0.5761, P-AUPRO:0.8728
cuda:3
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9904, P-AP:0.6552, P-F1:0.6629, P-AUPRO:0.9550
grid: I-Auroc:0.9799, I-AP:0.9940, I-F1:0.9821, P-AUROC:0.9794, P-AP:0.3923, P-F1:0.4520, P-AUPRO:0.9338
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9891, P-AP:0.4361, P-F1:0.4589, P-AUPRO:0.9533
tile: I-Auroc:0.9978, I-AP:0.9992, I-F1:0.9880, P-AUROC:0.9773, P-AP:0.7605, P-F1:0.7635, P-AUPRO:0.9077
wood: I-Auroc:0.9667, I-AP:0.9896, I-F1:0.9449, P-AUROC:0.9581, P-AP:0.7186, P-F1:0.6788, P-AUPRO:0.9047
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9717, P-AP:0.7758, P-F1:0.7374, P-AUPRO:0.9260
cable: I-Auroc:0.9346, I-AP:0.9654, I-F1:0.9011, P-AUROC:0.9326, P-AP:0.5194, P-F1:0.5543, P-AUPRO:0.8260
capsule: I-Auroc:0.8456, I-AP:0.9626, I-F1:0.9148, P-AUROC:0.9431, P-AP:0.4326, P-F1:0.4708, P-AUPRO:0.8114
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9906, P-AP:0.7554, P-F1:0.7626, P-AUPRO:0.9537
metal_nut: I-Auroc:0.9990, I-AP:0.9998, I-F1:0.9947, P-AUROC:0.9198, P-AP:0.7180, P-F1:0.7020, P-AUPRO:0.8833
pill: I-Auroc:0.9640, I-AP:0.9933, I-F1:0.9684, P-AUROC:0.9540, P-AP:0.6957, P-F1:0.6762, P-AUPRO:0.9353
screw: I-Auroc:0.5044, I-AP:0.7889, I-F1:0.8530, P-AUROC:0.9113, P-AP:0.1963, P-F1:0.2762, P-AUPRO:0.7399
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9902, P-AP:0.6930, P-F1:0.6916, P-AUPRO:0.9136
transistor: I-Auroc:0.9575, I-AP:0.9417, I-F1:0.8916, P-AUROC:0.8403, P-AP:0.3871, P-F1:0.4189, P-AUPRO:0.6733
zipper: I-Auroc:0.9275, I-AP:0.9749, I-F1:0.9469, P-AUROC:0.9574, P-AP:0.4512, P-F1:0.4849, P-AUPRO:0.8775
Mean: I-Auroc:0.9383, I-AP:0.9739, I-F1:0.9579, P-AUROC:0.9537, P-AP:0.5725, P-F1:0.5861, P-AUPRO:0.8796





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_base_14   默认：(R448-C392)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9922, P-AP:0.6939, P-F1:0.7010, P-AUPRO:0.9717
grid: I-Auroc:0.9858, I-AP:0.9958, I-F1:0.9825, P-AUROC:0.9864, P-AP:0.4257, P-F1:0.4545, P-AUPRO:0.9476
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.4209, P-F1:0.4330, P-AUPRO:0.9616
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9656, P-AP:0.6169, P-F1:0.6825, P-AUPRO:0.8755
wood: I-Auroc:0.9904, I-AP:0.9972, I-F1:0.9831, P-AUROC:0.9589, P-AP:0.6504, P-F1:0.6374, P-AUPRO:0.9154
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9844, P-AUROC:0.9688, P-AP:0.7776, P-F1:0.7516, P-AUPRO:0.9285
cable: I-Auroc:0.8951, I-AP:0.9444, I-F1:0.8539, P-AUROC:0.9232, P-AP:0.5167, P-F1:0.5301, P-AUPRO:0.8129
capsule: I-Auroc:0.8775, I-AP:0.9723, I-F1:0.9427, P-AUROC:0.9837, P-AP:0.5136, P-F1:0.4968, P-AUPRO:0.9586
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9878, P-AP:0.7217, P-F1:0.7003, P-AUPRO:0.9456
metal_nut: I-Auroc:0.9629, I-AP:0.9917, I-F1:0.9503, P-AUROC:0.9153, P-AP:0.6510, P-F1:0.6457, P-AUPRO:0.8566
pill: I-Auroc:0.9755, I-AP:0.9955, I-F1:0.9718, P-AUROC:0.9354, P-AP:0.6226, P-F1:0.6267, P-AUPRO:0.9488
screw: I-Auroc:0.7948, I-AP:0.9105, I-F1:0.8889, P-AUROC:0.9749, P-AP:0.3219, P-F1:0.3794, P-AUPRO:0.8978
toothbrush: I-Auroc:0.9639, I-AP:0.9879, I-F1:0.9508, P-AUROC:0.9896, P-AP:0.7475, P-F1:0.7259, P-AUPRO:0.8852
transistor: I-Auroc:0.9583, I-AP:0.9420, I-F1:0.8706, P-AUROC:0.8869, P-AP:0.4899, P-F1:0.4885, P-AUPRO:0.7822
zipper: I-Auroc:0.9832, I-AP:0.9948, I-F1:0.9874, P-AUROC:0.9587, P-AP:0.4282, P-F1:0.4499, P-AUPRO:0.8739
Mean: I-Auroc:0.9589, I-AP:0.9821, I-F1:0.9573, P-AUROC:0.9611, P-AP:0.5732, P-F1:0.5802, P-AUPRO:0.9041
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9919, P-AP:0.6815, P-F1:0.6914, P-AUPRO:0.9691
grid: I-Auroc:0.9799, I-AP:0.9944, I-F1:0.9739, P-AUROC:0.9867, P-AP:0.4304, P-F1:0.4579, P-AUPRO:0.9498
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9892, P-AP:0.3937, P-F1:0.4264, P-AUPRO:0.9597
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9660, P-AP:0.6189, P-F1:0.6818, P-AUPRO:0.8663
wood: I-Auroc:0.9939, I-AP:0.9982, I-F1:0.9831, P-AUROC:0.9615, P-AP:0.6485, P-F1:0.6334, P-AUPRO:0.9183
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9921, P-AUROC:0.9740, P-AP:0.7916, P-F1:0.7602, P-AUPRO:0.9364
cable: I-Auroc:0.9177, I-AP:0.9554, I-F1:0.8655, P-AUROC:0.9358, P-AP:0.5471, P-F1:0.5612, P-AUPRO:0.8345
capsule: I-Auroc:0.8879, I-AP:0.9744, I-F1:0.9515, P-AUROC:0.9832, P-AP:0.5197, P-F1:0.5020, P-AUPRO:0.9616
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.7395, P-F1:0.7384, P-AUPRO:0.9540
metal_nut: I-Auroc:0.9912, I-AP:0.9980, I-F1:0.9780, P-AUROC:0.9515, P-AP:0.7924, P-F1:0.7738, P-AUPRO:0.9071
pill: I-Auroc:0.9817, I-AP:0.9966, I-F1:0.9823, P-AUROC:0.9454, P-AP:0.6470, P-F1:0.6437, P-AUPRO:0.9572
screw: I-Auroc:0.8576, I-AP:0.9416, I-F1:0.9062, P-AUROC:0.9837, P-AP:0.4232, P-F1:0.4712, P-AUPRO:0.9374
toothbrush: I-Auroc:0.9694, I-AP:0.9890, I-F1:0.9474, P-AUROC:0.9897, P-AP:0.7106, P-F1:0.6979, P-AUPRO:0.9080
transistor: I-Auroc:0.9667, I-AP:0.9536, I-F1:0.9070, P-AUROC:0.8993, P-AP:0.5114, P-F1:0.5079, P-AUPRO:0.7851
zipper: I-Auroc:0.9766, I-AP:0.9931, I-F1:0.9750, P-AUROC:0.9585, P-AP:0.4332, P-F1:0.4586, P-AUPRO:0.8588
Mean: I-Auroc:0.9681, I-AP:0.9862, I-F1:0.9641, P-AUROC:0.9671, P-AP:0.5926, P-F1:0.6004, P-AUPRO:0.9136
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9918, P-AP:0.6767, P-F1:0.6879, P-AUPRO:0.9633
grid: I-Auroc:0.9816, I-AP:0.9946, I-F1:0.9735, P-AUROC:0.9866, P-AP:0.4336, P-F1:0.4578, P-AUPRO:0.9452
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9877, P-AP:0.3660, P-F1:0.4055, P-AUPRO:0.9462
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9658, P-AP:0.6152, P-F1:0.6815, P-AUPRO:0.8722
wood: I-Auroc:0.9930, I-AP:0.9979, I-F1:0.9748, P-AUROC:0.9609, P-AP:0.6397, P-F1:0.6291, P-AUPRO:0.9102
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9769, P-AP:0.8000, P-F1:0.7673, P-AUPRO:0.9411
cable: I-Auroc:0.9443, I-AP:0.9685, I-F1:0.8852, P-AUROC:0.9447, P-AP:0.5823, P-F1:0.5873, P-AUPRO:0.8628
capsule: I-Auroc:0.9481, I-AP:0.9887, I-F1:0.9515, P-AUROC:0.9874, P-AP:0.5882, P-F1:0.5692, P-AUPRO:0.9707
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9920, P-AP:0.7601, P-F1:0.7482, P-AUPRO:0.9660
metal_nut: I-Auroc:0.9971, I-AP:0.9993, I-F1:0.9841, P-AUROC:0.9551, P-AP:0.8116, P-F1:0.7927, P-AUPRO:0.9148
pill: I-Auroc:0.9855, I-AP:0.9975, I-F1:0.9823, P-AUROC:0.9485, P-AP:0.6514, P-F1:0.6492, P-AUPRO:0.9576
screw: I-Auroc:0.8280, I-AP:0.9222, I-F1:0.9040, P-AUROC:0.9835, P-AP:0.4114, P-F1:0.4669, P-AUPRO:0.9354
toothbrush: I-Auroc:0.9833, I-AP:0.9944, I-F1:0.9831, P-AUROC:0.9927, P-AP:0.7409, P-F1:0.7259, P-AUPRO:0.9353
transistor: I-Auroc:0.9854, I-AP:0.9802, I-F1:0.9268, P-AUROC:0.9038, P-AP:0.5227, P-F1:0.5147, P-AUPRO:0.7981
zipper: I-Auroc:0.9735, I-AP:0.9918, I-F1:0.9793, P-AUROC:0.9590, P-AP:0.4326, P-F1:0.4619, P-AUPRO:0.8670
Mean: I-Auroc:0.9747, I-AP:0.9890, I-F1:0.9696, P-AUROC:0.9691, P-AP:0.6022, P-F1:0.6097, P-AUPRO:0.9191







-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_small_14   默认：(R448-C392)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
cuda:4
shots: 2
cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.8000, P-F1:0.7524, P-AUPRO:0.9783
grid: I-Auroc:0.9683, I-AP:0.9899, I-F1:0.9649, P-AUROC:0.9855, P-AP:0.4661, P-F1:0.5096, P-AUPRO:0.9516
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9947, P-AP:0.5999, P-F1:0.5908, P-AUPRO:0.9817
tile: I-Auroc:0.9978, I-AP:0.9992, I-F1:0.9881, P-AUROC:0.9714, P-AP:0.6923, P-F1:0.7178, P-AUPRO:0.8901
wood: I-Auroc:0.9851, I-AP:0.9954, I-F1:0.9748, P-AUROC:0.9679, P-AP:0.7059, P-F1:0.6780, P-AUPRO:0.9240
bottle: I-Auroc:0.9944, I-AP:0.9982, I-F1:0.9844, P-AUROC:0.9728, P-AP:0.7893, P-F1:0.7516, P-AUPRO:0.9354
cable: I-Auroc:0.8686, I-AP:0.9305, I-F1:0.8352, P-AUROC:0.9268, P-AP:0.4846, P-F1:0.4855, P-AUPRO:0.7942
capsule: I-Auroc:0.8528, I-AP:0.9657, I-F1:0.9345, P-AUROC:0.9796, P-AP:0.4662, P-F1:0.4521, P-AUPRO:0.9471
hazelnut: I-Auroc:0.9821, I-AP:0.9905, I-F1:0.9517, P-AUROC:0.9848, P-AP:0.7027, P-F1:0.6668, P-AUPRO:0.9375
metal_nut: I-Auroc:0.9492, I-AP:0.9884, I-F1:0.9474, P-AUROC:0.8899, P-AP:0.5767, P-F1:0.5820, P-AUPRO:0.8245
pill: I-Auroc:0.9607, I-AP:0.9928, I-F1:0.9571, P-AUROC:0.9307, P-AP:0.6170, P-F1:0.6218, P-AUPRO:0.9457
screw: I-Auroc:0.7061, I-AP:0.8603, I-F1:0.8821, P-AUROC:0.9703, P-AP:0.2159, P-F1:0.2929, P-AUPRO:0.8782
toothbrush: I-Auroc:0.9722, I-AP:0.9912, I-F1:0.9667, P-AUROC:0.9890, P-AP:0.7323, P-F1:0.7281, P-AUPRO:0.8811
transistor: I-Auroc:0.9450, I-AP:0.9141, I-F1:0.8506, P-AUROC:0.8781, P-AP:0.4575, P-F1:0.4666, P-AUPRO:0.7655
zipper: I-Auroc:0.9651, I-AP:0.9902, I-F1:0.9590, P-AUROC:0.9586, P-AP:0.4539, P-F1:0.4603, P-AUPRO:0.8764
Mean: I-Auroc:0.9432, I-AP:0.9738, I-F1:0.9464, P-AUROC:0.9596, P-AP:0.5840, P-F1:0.5838, P-AUPRO:0.9008
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9938, P-AP:0.7882, P-F1:0.7455, P-AUPRO:0.9743
grid: I-Auroc:0.9716, I-AP:0.9913, I-F1:0.9649, P-AUROC:0.9855, P-AP:0.4660, P-F1:0.5121, P-AUPRO:0.9496
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9943, P-AP:0.5714, P-F1:0.5767, P-AUPRO:0.9818
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9880, P-AUROC:0.9715, P-AP:0.6933, P-F1:0.7159, P-AUPRO:0.8933
wood: I-Auroc:0.9904, I-AP:0.9971, I-F1:0.9833, P-AUROC:0.9694, P-AP:0.7106, P-F1:0.6787, P-AUPRO:0.9247
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9791, P-AP:0.8086, P-F1:0.7667, P-AUPRO:0.9461
cable: I-Auroc:0.9263, I-AP:0.9600, I-F1:0.8851, P-AUROC:0.9431, P-AP:0.5497, P-F1:0.5591, P-AUPRO:0.8375
capsule: I-Auroc:0.8468, I-AP:0.9632, I-F1:0.9469, P-AUROC:0.9794, P-AP:0.4633, P-F1:0.4550, P-AUPRO:0.9491
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9859, P-AUROC:0.9866, P-AP:0.7226, P-F1:0.7040, P-AUPRO:0.9511
metal_nut: I-Auroc:0.9902, I-AP:0.9978, I-F1:0.9735, P-AUROC:0.9361, P-AP:0.7467, P-F1:0.7151, P-AUPRO:0.8970
pill: I-Auroc:0.9613, I-AP:0.9930, I-F1:0.9531, P-AUROC:0.9377, P-AP:0.6287, P-F1:0.6286, P-AUPRO:0.9490
screw: I-Auroc:0.8018, I-AP:0.9155, I-F1:0.8933, P-AUROC:0.9791, P-AP:0.3769, P-F1:0.4356, P-AUPRO:0.9212
toothbrush: I-Auroc:0.9667, I-AP:0.9876, I-F1:0.9375, P-AUROC:0.9889, P-AP:0.6885, P-F1:0.6926, P-AUPRO:0.9037
transistor: I-Auroc:0.9567, I-AP:0.9299, I-F1:0.8941, P-AUROC:0.8935, P-AP:0.4941, P-F1:0.4993, P-AUPRO:0.8044
zipper: I-Auroc:0.9761, I-AP:0.9930, I-F1:0.9752, P-AUROC:0.9643, P-AP:0.4822, P-F1:0.4924, P-AUPRO:0.8770
Mean: I-Auroc:0.9589, I-AP:0.9818, I-F1:0.9582, P-AUROC:0.9668, P-AP:0.6127, P-F1:0.6118, P-AUPRO:0.9173
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7827, P-F1:0.7411, P-AUPRO:0.9770
grid: I-Auroc:0.9649, I-AP:0.9887, I-F1:0.9474, P-AUROC:0.9825, P-AP:0.4675, P-F1:0.5106, P-AUPRO:0.9449
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.5363, P-F1:0.5435, P-AUPRO:0.9733
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9714, P-AP:0.6894, P-F1:0.7146, P-AUPRO:0.8830
wood: I-Auroc:0.9877, I-AP:0.9962, I-F1:0.9752, P-AUROC:0.9694, P-AP:0.7019, P-F1:0.6754, P-AUPRO:0.9245
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9815, P-AP:0.8169, P-F1:0.7771, P-AUPRO:0.9498
cable: I-Auroc:0.9522, I-AP:0.9733, I-F1:0.9029, P-AUROC:0.9521, P-AP:0.5905, P-F1:0.5945, P-AUPRO:0.8656
capsule: I-Auroc:0.9374, I-AP:0.9859, I-F1:0.9515, P-AUROC:0.9852, P-AP:0.5622, P-F1:0.5566, P-AUPRO:0.9623
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9918, P-AP:0.7739, P-F1:0.7502, P-AUPRO:0.9652
metal_nut: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9892, P-AUROC:0.9424, P-AP:0.7756, P-F1:0.7410, P-AUPRO:0.9065
pill: I-Auroc:0.9651, I-AP:0.9939, I-F1:0.9534, P-AUROC:0.9414, P-AP:0.6350, P-F1:0.6344, P-AUPRO:0.9507
screw: I-Auroc:0.7903, I-AP:0.9003, I-F1:0.8864, P-AUROC:0.9799, P-AP:0.3729, P-F1:0.4393, P-AUPRO:0.9227
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9925, P-AP:0.7155, P-F1:0.7158, P-AUPRO:0.9381
transistor: I-Auroc:0.9637, I-AP:0.9389, I-F1:0.9024, P-AUROC:0.8969, P-AP:0.4963, P-F1:0.5005, P-AUPRO:0.8106
zipper: I-Auroc:0.9722, I-AP:0.9917, I-F1:0.9750, P-AUROC:0.9599, P-AP:0.4622, P-F1:0.4730, P-AUPRO:0.8752
Mean: I-Auroc:0.9685, I-AP:0.9845, I-F1:0.9641, P-AUROC:0.9689, P-AP:0.6253, P-F1:0.6245, P-AUPRO:0.9233







-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_large_14   默认：(R448-C392)
interested_layers = list(range(4, 19))

cuda:4
shots: 1
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9927, P-AP:0.7811, P-F1:0.7398, P-AUPRO:0.9754
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9915, P-AP:0.5138, P-F1:0.5410, P-AUPRO:0.9714
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9922, P-AP:0.4902, P-F1:0.4971, P-AUPRO:0.9732
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9765, P-AP:0.7159, P-F1:0.7488, P-AUPRO:0.9084
wood: I-Auroc:0.9965, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9638, P-AP:0.7216, P-F1:0.6871, P-AUPRO:0.9350
bottle: I-Auroc:0.9698, I-AP:0.9917, I-F1:0.9606, P-AUROC:0.9628, P-AP:0.7722, P-F1:0.7327, P-AUPRO:0.9229
cable: I-Auroc:0.8679, I-AP:0.9296, I-F1:0.8235, P-AUROC:0.9107, P-AP:0.4557, P-F1:0.4725, P-AUPRO:0.7977
capsule: I-Auroc:0.9027, I-AP:0.9787, I-F1:0.9437, P-AUROC:0.9779, P-AP:0.4944, P-F1:0.4762, P-AUPRO:0.9574
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9929, P-AUROC:0.9887, P-AP:0.7636, P-F1:0.7292, P-AUPRO:0.9584
metal_nut: I-Auroc:0.9633, I-AP:0.9916, I-F1:0.9583, P-AUROC:0.8857, P-AP:0.5727, P-F1:0.5803, P-AUPRO:0.8373
pill: I-Auroc:0.9806, I-AP:0.9965, I-F1:0.9787, P-AUROC:0.9246, P-AP:0.6015, P-F1:0.6117, P-AUPRO:0.9524
screw: I-Auroc:0.7364, I-AP:0.8770, I-F1:0.8846, P-AUROC:0.9727, P-AP:0.2624, P-F1:0.3136, P-AUPRO:0.8905
toothbrush: I-Auroc:0.9750, I-AP:0.9919, I-F1:0.9667, P-AUROC:0.9880, P-AP:0.6676, P-F1:0.6736, P-AUPRO:0.9146
transistor: I-Auroc:0.9742, I-AP:0.9663, I-F1:0.9048, P-AUROC:0.8907, P-AP:0.5091, P-F1:0.5013, P-AUPRO:0.8158
zipper: I-Auroc:0.9950, I-AP:0.9986, I-F1:0.9876, P-AUROC:0.9619, P-AP:0.5254, P-F1:0.5385, P-AUPRO:0.8954
Mean: I-Auroc:0.9569, I-AP:0.9812, I-F1:0.9580, P-AUROC:0.9587, P-AP:0.5898, P-F1:0.5896, P-AUPRO:0.9137
cuda:4
shots: 2
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9925, P-AP:0.7651, P-F1:0.7326, P-AUPRO:0.9758
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9920, P-AP:0.5185, P-F1:0.5468, P-AUPRO:0.9704
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9919, P-AP:0.4786, P-F1:0.4933, P-AUPRO:0.9730
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9767, P-AP:0.7189, P-F1:0.7483, P-AUPRO:0.9092
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9677, P-AP:0.7252, P-F1:0.6892, P-AUPRO:0.9388
bottle: I-Auroc:0.9857, I-AP:0.9960, I-F1:0.9839, P-AUROC:0.9714, P-AP:0.7949, P-F1:0.7503, P-AUPRO:0.9368
cable: I-Auroc:0.9352, I-AP:0.9647, I-F1:0.8824, P-AUROC:0.9286, P-AP:0.5336, P-F1:0.5518, P-AUPRO:0.8413
capsule: I-Auroc:0.8883, I-AP:0.9746, I-F1:0.9478, P-AUROC:0.9775, P-AP:0.4974, P-F1:0.4765, P-AUPRO:0.9595
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.7817, P-F1:0.7537, P-AUPRO:0.9607
metal_nut: I-Auroc:0.9961, I-AP:0.9991, I-F1:0.9841, P-AUROC:0.9353, P-AP:0.7418, P-F1:0.7173, P-AUPRO:0.9062
pill: I-Auroc:0.9823, I-AP:0.9969, I-F1:0.9789, P-AUROC:0.9330, P-AP:0.6206, P-F1:0.6281, P-AUPRO:0.9562
screw: I-Auroc:0.8325, I-AP:0.9351, I-F1:0.8898, P-AUROC:0.9833, P-AP:0.4518, P-F1:0.4875, P-AUPRO:0.9371
toothbrush: I-Auroc:0.9667, I-AP:0.9879, I-F1:0.9474, P-AUROC:0.9856, P-AP:0.6230, P-F1:0.6243, P-AUPRO:0.9246
transistor: I-Auroc:0.9812, I-AP:0.9736, I-F1:0.9286, P-AUROC:0.9021, P-AP:0.5331, P-F1:0.5267, P-AUPRO:0.8269
zipper: I-Auroc:0.9955, I-AP:0.9988, I-F1:0.9833, P-AUROC:0.9639, P-AP:0.5406, P-F1:0.5589, P-AUPRO:0.8910
Mean: I-Auroc:0.9700, I-AP:0.9882, I-F1:0.9664, P-AUROC:0.9661, P-AP:0.6217, P-F1:0.6190, P-AUPRO:0.9272
cuda:4
shots: 4
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9929, P-AP:0.7651, P-F1:0.7323, P-AUPRO:0.9728
grid: I-Auroc:0.9900, I-AP:0.9969, I-F1:0.9912, P-AUROC:0.9915, P-AP:0.5195, P-F1:0.5466, P-AUPRO:0.9679
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9916, P-AP:0.4717, P-F1:0.4807, P-AUPRO:0.9706
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9767, P-AP:0.7145, P-F1:0.7476, P-AUPRO:0.9148
wood: I-Auroc:0.9886, I-AP:0.9964, I-F1:0.9748, P-AUROC:0.9676, P-AP:0.7189, P-F1:0.6851, P-AUPRO:0.9329
bottle: I-Auroc:0.9913, I-AP:0.9975, I-F1:0.9839, P-AUROC:0.9749, P-AP:0.8079, P-F1:0.7613, P-AUPRO:0.9443
cable: I-Auroc:0.9582, I-AP:0.9758, I-F1:0.9029, P-AUROC:0.9354, P-AP:0.5624, P-F1:0.5787, P-AUPRO:0.8571
capsule: I-Auroc:0.9593, I-AP:0.9912, I-F1:0.9593, P-AUROC:0.9833, P-AP:0.5826, P-F1:0.5648, P-AUPRO:0.9706
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.8230, P-F1:0.7851, P-AUPRO:0.9739
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9444, P-AP:0.7800, P-F1:0.7564, P-AUPRO:0.9183
pill: I-Auroc:0.9845, I-AP:0.9973, I-F1:0.9823, P-AUROC:0.9365, P-AP:0.6268, P-F1:0.6336, P-AUPRO:0.9578
screw: I-Auroc:0.8264, I-AP:0.9259, I-F1:0.8968, P-AUROC:0.9851, P-AP:0.4579, P-F1:0.4937, P-AUPRO:0.9414
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9917, P-AP:0.6749, P-F1:0.6899, P-AUPRO:0.9520
transistor: I-Auroc:0.9925, I-AP:0.9898, I-F1:0.9500, P-AUROC:0.9046, P-AP:0.5330, P-F1:0.5273, P-AUPRO:0.8319
zipper: I-Auroc:0.9919, I-AP:0.9978, I-F1:0.9833, P-AUROC:0.9642, P-AP:0.5386, P-F1:0.5615, P-AUPRO:0.8954
Mean: I-Auroc:0.9782, I-AP:0.9910, I-F1:0.9735, P-AUROC:0.9689, P-AP:0.6384, P-F1:0.6363, P-AUPRO:0.9335





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_proteus_vit_base_14   默认：(R448-C392)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
carpet: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9889, P-AUROC:0.9890, P-AP:0.7994, P-F1:0.7598, P-AUPRO:0.9675
grid: I-Auroc:0.9900, I-AP:0.9969, I-F1:0.9912, P-AUROC:0.9806, P-AP:0.5100, P-F1:0.5240, P-AUPRO:0.9452
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9945, P-AUROC:0.9948, P-AP:0.6631, P-F1:0.6248, P-AUPRO:0.9860
tile: I-Auroc:0.9953, I-AP:0.9984, I-F1:0.9940, P-AUROC:0.9825, P-AP:0.7904, P-F1:0.7967, P-AUPRO:0.9198
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9700, P-AP:0.7422, P-F1:0.6961, P-AUPRO:0.9442
bottle: I-Auroc:0.9706, I-AP:0.9916, I-F1:0.9587, P-AUROC:0.9530, P-AP:0.7379, P-F1:0.7011, P-AUPRO:0.9051
cable: I-Auroc:0.8023, I-AP:0.8806, I-F1:0.8060, P-AUROC:0.9066, P-AP:0.3833, P-F1:0.4005, P-AUPRO:0.7459
capsule: I-Auroc:0.8057, I-AP:0.9501, I-F1:0.9427, P-AUROC:0.9714, P-AP:0.3688, P-F1:0.3923, P-AUPRO:0.9459
hazelnut: I-Auroc:0.9500, I-AP:0.9724, I-F1:0.9118, P-AUROC:0.9765, P-AP:0.6515, P-F1:0.6126, P-AUPRO:0.9474
metal_nut: I-Auroc:0.8460, I-AP:0.9613, I-F1:0.9154, P-AUROC:0.8705, P-AP:0.5118, P-F1:0.5530, P-AUPRO:0.7556
pill: I-Auroc:0.9640, I-AP:0.9934, I-F1:0.9583, P-AUROC:0.9343, P-AP:0.6168, P-F1:0.6179, P-AUPRO:0.9379
screw: I-Auroc:0.6118, I-AP:0.8091, I-F1:0.8750, P-AUROC:0.9547, P-AP:0.0713, P-F1:0.1257, P-AUPRO:0.8263
toothbrush: I-Auroc:0.8833, I-AP:0.9540, I-F1:0.9062, P-AUROC:0.9731, P-AP:0.5093, P-F1:0.5064, P-AUPRO:0.8335
transistor: I-Auroc:0.9408, I-AP:0.9255, I-F1:0.8451, P-AUROC:0.8505, P-AP:0.4043, P-F1:0.4162, P-AUPRO:0.7140
zipper: I-Auroc:0.9483, I-AP:0.9853, I-F1:0.9386, P-AUROC:0.9564, P-AP:0.5131, P-F1:0.5344, P-AUPRO:0.8834
Mean: I-Auroc:0.9137, I-AP:0.9612, I-F1:0.9345, P-AUROC:0.9509, P-AP:0.5516, P-F1:0.5508, P-AUPRO:0.8838
cuda:4
shots: 2
carpet: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9944, P-AUROC:0.9894, P-AP:0.7951, P-F1:0.7591, P-AUPRO:0.9695
grid: I-Auroc:0.9833, I-AP:0.9954, I-F1:0.9912, P-AUROC:0.9846, P-AP:0.5139, P-F1:0.5206, P-AUPRO:0.9490
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9945, P-AUROC:0.9948, P-AP:0.6599, P-F1:0.6231, P-AUPRO:0.9857
tile: I-Auroc:0.9949, I-AP:0.9982, I-F1:0.9880, P-AUROC:0.9820, P-AP:0.7883, P-F1:0.7899, P-AUPRO:0.9100
wood: I-Auroc:0.9991, I-AP:0.9997, I-F1:0.9917, P-AUROC:0.9723, P-AP:0.7468, P-F1:0.6988, P-AUPRO:0.9465
bottle: I-Auroc:0.9857, I-AP:0.9957, I-F1:0.9683, P-AUROC:0.9646, P-AP:0.7686, P-F1:0.7229, P-AUPRO:0.9244
cable: I-Auroc:0.9316, I-AP:0.9596, I-F1:0.8791, P-AUROC:0.9280, P-AP:0.4848, P-F1:0.4818, P-AUPRO:0.8012
capsule: I-Auroc:0.7822, I-AP:0.9406, I-F1:0.9422, P-AUROC:0.9678, P-AP:0.3552, P-F1:0.3866, P-AUPRO:0.9395
hazelnut: I-Auroc:0.9700, I-AP:0.9813, I-F1:0.9379, P-AUROC:0.9796, P-AP:0.6760, P-F1:0.6311, P-AUPRO:0.9526
metal_nut: I-Auroc:0.9668, I-AP:0.9922, I-F1:0.9534, P-AUROC:0.9185, P-AP:0.6911, P-F1:0.6655, P-AUPRO:0.8556
pill: I-Auroc:0.9610, I-AP:0.9929, I-F1:0.9547, P-AUROC:0.9421, P-AP:0.6393, P-F1:0.6295, P-AUPRO:0.9448
screw: I-Auroc:0.7190, I-AP:0.8538, I-F1:0.8722, P-AUROC:0.9729, P-AP:0.3051, P-F1:0.3776, P-AUPRO:0.8941
toothbrush: I-Auroc:0.8917, I-AP:0.9551, I-F1:0.9375, P-AUROC:0.9690, P-AP:0.4186, P-F1:0.4257, P-AUPRO:0.8540
transistor: I-Auroc:0.9325, I-AP:0.9152, I-F1:0.8108, P-AUROC:0.8647, P-AP:0.4338, P-F1:0.4461, P-AUPRO:0.7450
zipper: I-Auroc:0.9701, I-AP:0.9912, I-F1:0.9667, P-AUROC:0.9540, P-AP:0.5268, P-F1:0.5358, P-AUPRO:0.8708
Mean: I-Auroc:0.9391, I-AP:0.9714, I-F1:0.9455, P-AUROC:0.9589, P-AP:0.5869, P-F1:0.5796, P-AUPRO:0.9028
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9910, P-AP:0.8003, P-F1:0.7608, P-AUPRO:0.9746
grid: I-Auroc:0.9825, I-AP:0.9951, I-F1:0.9825, P-AUROC:0.9827, P-AP:0.5080, P-F1:0.5156, P-AUPRO:0.9434
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9954, P-AP:0.6603, P-F1:0.6226, P-AUPRO:0.9875
tile: I-Auroc:0.9968, I-AP:0.9988, I-F1:0.9880, P-AUROC:0.9829, P-AP:0.7888, P-F1:0.7943, P-AUPRO:0.9120
wood: I-Auroc:0.9956, I-AP:0.9987, I-F1:0.9833, P-AUROC:0.9743, P-AP:0.7603, P-F1:0.7101, P-AUPRO:0.9481
bottle: I-Auroc:0.9960, I-AP:0.9987, I-F1:0.9844, P-AUROC:0.9697, P-AP:0.7875, P-F1:0.7394, P-AUPRO:0.9323
cable: I-Auroc:0.9569, I-AP:0.9740, I-F1:0.9091, P-AUROC:0.9373, P-AP:0.5328, P-F1:0.5330, P-AUPRO:0.8349
capsule: I-Auroc:0.9031, I-AP:0.9763, I-F1:0.9511, P-AUROC:0.9764, P-AP:0.4809, P-F1:0.4826, P-AUPRO:0.9596
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9859, P-AUROC:0.9902, P-AP:0.7734, P-F1:0.7416, P-AUPRO:0.9672
metal_nut: I-Auroc:0.9848, I-AP:0.9965, I-F1:0.9735, P-AUROC:0.9304, P-AP:0.7430, P-F1:0.7007, P-AUPRO:0.8725
pill: I-Auroc:0.9599, I-AP:0.9926, I-F1:0.9553, P-AUROC:0.9456, P-AP:0.6476, P-F1:0.6407, P-AUPRO:0.9485
screw: I-Auroc:0.7286, I-AP:0.8682, I-F1:0.8782, P-AUROC:0.9765, P-AP:0.4115, P-F1:0.4593, P-AUPRO:0.9068
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9919, P-AP:0.7158, P-F1:0.7031, P-AUPRO:0.9500
transistor: I-Auroc:0.9329, I-AP:0.9209, I-F1:0.8235, P-AUROC:0.8664, P-AP:0.4216, P-F1:0.4323, P-AUPRO:0.7341
zipper: I-Auroc:0.9669, I-AP:0.9898, I-F1:0.9667, P-AUROC:0.9559, P-AP:0.5283, P-F1:0.5341, P-AUPRO:0.8800
Mean: I-Auroc:0.9600, I-AP:0.9805, I-F1:0.9577, P-AUROC:0.9644, P-AP:0.6373, P-F1:0.6247, P-AUPRO:0.9168





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : CLIP_proteus_vit_base_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
carpet: I-Auroc:0.4394, I-AP:0.7592, I-F1:0.8641, P-AUROC:0.8092, P-AP:0.1543, P-F1:0.2302, P-AUPRO:0.4913
grid: I-Auroc:0.2322, I-AP:0.6077, I-F1:0.8444, P-AUROC:0.6314, P-AP:0.0325, P-F1:0.0612, P-AUPRO:0.2874
leather: I-Auroc:0.6077, I-AP:0.8661, I-F1:0.8519, P-AUROC:0.7064, P-AP:0.1024, P-F1:0.1928, P-AUPRO:0.3214
tile: I-Auroc:0.7132, I-AP:0.8630, I-F1:0.8400, P-AUROC:0.5447, P-AP:0.2204, P-F1:0.2556, P-AUPRO:0.3043
wood: I-Auroc:0.9763, I-AP:0.9935, I-F1:0.9748, P-AUROC:0.8040, P-AP:0.2683, P-F1:0.2879, P-AUPRO:0.5361
bottle: I-Auroc:0.5579, I-AP:0.7983, I-F1:0.8630, P-AUROC:0.6323, P-AP:0.1471, P-F1:0.1883, P-AUPRO:0.3685
cable: I-Auroc:0.4447, I-AP:0.6105, I-F1:0.7603, P-AUROC:0.6658, P-AP:0.0742, P-F1:0.1478, P-AUPRO:0.2910
capsule: I-Auroc:0.5217, I-AP:0.8294, I-F1:0.9046, P-AUROC:0.8975, P-AP:0.1036, P-F1:0.1867, P-AUPRO:0.6886
hazelnut: I-Auroc:0.8107, I-AP:0.8884, I-F1:0.8415, P-AUROC:0.9321, P-AP:0.5011, P-F1:0.5120, P-AUPRO:0.8398
metal_nut: I-Auroc:0.6676, I-AP:0.8947, I-F1:0.9073, P-AUROC:0.6819, P-AP:0.2460, P-F1:0.3593, P-AUPRO:0.3108
pill: I-Auroc:0.7474, I-AP:0.9421, I-F1:0.9164, P-AUROC:0.8481, P-AP:0.2791, P-F1:0.3439, P-AUPRO:0.6581
screw: I-Auroc:0.6014, I-AP:0.8238, I-F1:0.8530, P-AUROC:0.9194, P-AP:0.0272, P-F1:0.0550, P-AUPRO:0.6975
toothbrush: I-Auroc:0.6000, I-AP:0.7784, I-F1:0.8657, P-AUROC:0.8634, P-AP:0.1067, P-F1:0.1644, P-AUPRO:0.5534
transistor: I-Auroc:0.4533, I-AP:0.4161, I-F1:0.5714, P-AUROC:0.6065, P-AP:0.1071, P-F1:0.1803, P-AUPRO:0.2992
zipper: I-Auroc:0.7072, I-AP:0.9104, I-F1:0.8815, P-AUROC:0.8043, P-AP:0.1572, P-F1:0.1935, P-AUPRO:0.4971
Mean: I-Auroc:0.6054, I-AP:0.7988, I-F1:0.8493, P-AUROC:0.7565, P-AP:0.1685, P-F1:0.2239, P-AUPRO:0.4763
cuda:4
shots: 2
carpet: I-Auroc:0.4145, I-AP:0.7546, I-F1:0.8641, P-AUROC:0.7476, P-AP:0.1306, P-F1:0.1990, P-AUPRO:0.4216
grid: I-Auroc:0.4545, I-AP:0.7203, I-F1:0.8507, P-AUROC:0.6830, P-AP:0.0486, P-F1:0.0834, P-AUPRO:0.3723
leather: I-Auroc:0.6090, I-AP:0.8668, I-F1:0.8519, P-AUROC:0.7065, P-AP:0.1025, P-F1:0.1928, P-AUPRO:0.3263
tile: I-Auroc:0.6187, I-AP:0.8429, I-F1:0.8394, P-AUROC:0.5360, P-AP:0.2168, P-F1:0.2397, P-AUPRO:0.2687
wood: I-Auroc:0.9781, I-AP:0.9940, I-F1:0.9667, P-AUROC:0.8123, P-AP:0.3201, P-F1:0.3362, P-AUPRO:0.5680
bottle: I-Auroc:0.6190, I-AP:0.8471, I-F1:0.8732, P-AUROC:0.6483, P-AP:0.1721, P-F1:0.2101, P-AUPRO:0.4024
cable: I-Auroc:0.4451, I-AP:0.6291, I-F1:0.7603, P-AUROC:0.5858, P-AP:0.0609, P-F1:0.1213, P-AUPRO:0.2550
capsule: I-Auroc:0.5265, I-AP:0.8314, I-F1:0.9083, P-AUROC:0.9037, P-AP:0.1059, P-F1:0.1922, P-AUPRO:0.7104
hazelnut: I-Auroc:0.8464, I-AP:0.9187, I-F1:0.8553, P-AUROC:0.9423, P-AP:0.5327, P-F1:0.5394, P-AUPRO:0.8467
metal_nut: I-Auroc:0.7136, I-AP:0.9088, I-F1:0.9118, P-AUROC:0.7150, P-AP:0.2641, P-F1:0.3827, P-AUPRO:0.3165
pill: I-Auroc:0.7657, I-AP:0.9436, I-F1:0.9215, P-AUROC:0.8718, P-AP:0.3157, P-F1:0.3803, P-AUPRO:0.7179
screw: I-Auroc:0.5757, I-AP:0.8060, I-F1:0.8530, P-AUROC:0.9234, P-AP:0.0304, P-F1:0.0594, P-AUPRO:0.7099
toothbrush: I-Auroc:0.6611, I-AP:0.7979, I-F1:0.8955, P-AUROC:0.8648, P-AP:0.0925, P-F1:0.1650, P-AUPRO:0.6038
transistor: I-Auroc:0.4517, I-AP:0.4181, I-F1:0.5714, P-AUROC:0.6305, P-AP:0.1145, P-F1:0.2031, P-AUPRO:0.3287
zipper: I-Auroc:0.7413, I-AP:0.9204, I-F1:0.8815, P-AUROC:0.8201, P-AP:0.1676, P-F1:0.2138, P-AUPRO:0.5051
Mean: I-Auroc:0.6281, I-AP:0.8133, I-F1:0.8536, P-AUROC:0.7594, P-AP:0.1783, P-F1:0.2346, P-AUPRO:0.4902
cuda:4
shots: 4
carpet: I-Auroc:0.3925, I-AP:0.7499, I-F1:0.8641, P-AUROC:0.7617, P-AP:0.1514, P-F1:0.2281, P-AUPRO:0.4513
grid: I-Auroc:0.3609, I-AP:0.6845, I-F1:0.8444, P-AUROC:0.6954, P-AP:0.0477, P-F1:0.0835, P-AUPRO:0.3467
leather: I-Auroc:0.6369, I-AP:0.8766, I-F1:0.8519, P-AUROC:0.7007, P-AP:0.1719, P-F1:0.2902, P-AUPRO:0.4078
tile: I-Auroc:0.7244, I-AP:0.8922, I-F1:0.8358, P-AUROC:0.5577, P-AP:0.2490, P-F1:0.2720, P-AUPRO:0.2944
wood: I-Auroc:0.9851, I-AP:0.9959, I-F1:0.9748, P-AUROC:0.8102, P-AP:0.3068, P-F1:0.3172, P-AUPRO:0.5885
bottle: I-Auroc:0.6437, I-AP:0.8600, I-F1:0.8652, P-AUROC:0.6670, P-AP:0.1845, P-F1:0.2234, P-AUPRO:0.4230
cable: I-Auroc:0.4333, I-AP:0.6288, I-F1:0.7603, P-AUROC:0.5464, P-AP:0.0574, P-F1:0.1197, P-AUPRO:0.2596
capsule: I-Auroc:0.5397, I-AP:0.8486, I-F1:0.9046, P-AUROC:0.9220, P-AP:0.1526, P-F1:0.2272, P-AUPRO:0.7093
hazelnut: I-Auroc:0.8429, I-AP:0.9120, I-F1:0.8535, P-AUROC:0.9406, P-AP:0.5042, P-F1:0.5069, P-AUPRO:0.8494
metal_nut: I-Auroc:0.6310, I-AP:0.8883, I-F1:0.8986, P-AUROC:0.7157, P-AP:0.2557, P-F1:0.3867, P-AUPRO:0.3034
pill: I-Auroc:0.7640, I-AP:0.9433, I-F1:0.9186, P-AUROC:0.8874, P-AP:0.3495, P-F1:0.4087, P-AUPRO:0.7424
screw: I-Auroc:0.5628, I-AP:0.7736, I-F1:0.8530, P-AUROC:0.9257, P-AP:0.0312, P-F1:0.0628, P-AUPRO:0.7069
toothbrush: I-Auroc:0.7222, I-AP:0.8657, I-F1:0.8696, P-AUROC:0.9000, P-AP:0.1539, P-F1:0.2147, P-AUPRO:0.6805
transistor: I-Auroc:0.4592, I-AP:0.4322, I-F1:0.5714, P-AUROC:0.6454, P-AP:0.1198, P-F1:0.2235, P-AUPRO:0.3256
zipper: I-Auroc:0.7479, I-AP:0.9308, I-F1:0.8815, P-AUROC:0.8443, P-AP:0.2135, P-F1:0.2429, P-AUPRO:0.5171
Mean: I-Auroc:0.6298, I-AP:0.8188, I-F1:0.8498, P-AUROC:0.7680, P-AP:0.1966, P-F1:0.2538, P-AUPRO:0.5070





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_proteus_vit_base_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9951, P-AP:0.8097, P-F1:0.7646, P-AUPRO:0.9826
grid: I-Auroc:0.9958, I-AP:0.9986, I-F1:0.9912, P-AUROC:0.9851, P-AP:0.4860, P-F1:0.5134, P-AUPRO:0.9555
leather: I-Auroc:0.9976, I-AP:0.9992, I-F1:0.9840, P-AUROC:0.9931, P-AP:0.6049, P-F1:0.5892, P-AUPRO:0.9786
tile: I-Auroc:0.9820, I-AP:0.9938, I-F1:0.9704, P-AUROC:0.9764, P-AP:0.7780, P-F1:0.7657, P-AUPRO:0.9014
wood: I-Auroc:0.9904, I-AP:0.9970, I-F1:0.9756, P-AUROC:0.9587, P-AP:0.6812, P-F1:0.6538, P-AUPRO:0.9080
bottle: I-Auroc:0.9881, I-AP:0.9966, I-F1:0.9839, P-AUROC:0.9680, P-AP:0.7856, P-F1:0.7402, P-AUPRO:0.9303
cable: I-Auroc:0.8559, I-AP:0.9218, I-F1:0.8290, P-AUROC:0.8992, P-AP:0.3947, P-F1:0.4145, P-AUPRO:0.7345
capsule: I-Auroc:0.8002, I-AP:0.9490, I-F1:0.9277, P-AUROC:0.9638, P-AP:0.3322, P-F1:0.3705, P-AUPRO:0.9005
hazelnut: I-Auroc:0.9321, I-AP:0.9645, I-F1:0.8971, P-AUROC:0.9772, P-AP:0.6410, P-F1:0.6078, P-AUPRO:0.9251
metal_nut: I-Auroc:0.8470, I-AP:0.9617, I-F1:0.9200, P-AUROC:0.8528, P-AP:0.5043, P-F1:0.5347, P-AUPRO:0.7081
pill: I-Auroc:0.9602, I-AP:0.9930, I-F1:0.9541, P-AUROC:0.9238, P-AP:0.6022, P-F1:0.6017, P-AUPRO:0.9112
screw: I-Auroc:0.6296, I-AP:0.8110, I-F1:0.8627, P-AUROC:0.9420, P-AP:0.0966, P-F1:0.1616, P-AUPRO:0.7799
toothbrush: I-Auroc:0.8889, I-AP:0.9566, I-F1:0.9206, P-AUROC:0.9760, P-AP:0.5477, P-F1:0.5508, P-AUPRO:0.8213
transistor: I-Auroc:0.9337, I-AP:0.9246, I-F1:0.8611, P-AUROC:0.8705, P-AP:0.4555, P-F1:0.4641, P-AUPRO:0.7462
zipper: I-Auroc:0.8453, I-AP:0.9515, I-F1:0.9015, P-AUROC:0.9540, P-AP:0.4317, P-F1:0.4826, P-AUPRO:0.8732
Mean: I-Auroc:0.9098, I-AP:0.9613, I-F1:0.9319, P-AUROC:0.9490, P-AP:0.5434, P-F1:0.5477, P-AUPRO:0.8704
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9951, P-AP:0.8080, P-F1:0.7670, P-AUPRO:0.9816
grid: I-Auroc:0.9883, I-AP:0.9964, I-F1:0.9825, P-AUROC:0.9864, P-AP:0.4856, P-F1:0.5163, P-AUPRO:0.9582
leather: I-Auroc:0.9976, I-AP:0.9992, I-F1:0.9840, P-AUROC:0.9933, P-AP:0.6079, P-F1:0.5905, P-AUPRO:0.9780
tile: I-Auroc:0.9776, I-AP:0.9921, I-F1:0.9708, P-AUROC:0.9776, P-AP:0.7818, P-F1:0.7686, P-AUPRO:0.8979
wood: I-Auroc:0.9868, I-AP:0.9961, I-F1:0.9748, P-AUROC:0.9598, P-AP:0.6801, P-F1:0.6517, P-AUPRO:0.9124
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9844, P-AUROC:0.9751, P-AP:0.8066, P-F1:0.7593, P-AUPRO:0.9434
cable: I-Auroc:0.9265, I-AP:0.9609, I-F1:0.8750, P-AUROC:0.9234, P-AP:0.4662, P-F1:0.4878, P-AUPRO:0.7957
capsule: I-Auroc:0.7894, I-AP:0.9436, I-F1:0.9339, P-AUROC:0.9631, P-AP:0.3357, P-F1:0.3701, P-AUPRO:0.9037
hazelnut: I-Auroc:0.9639, I-AP:0.9807, I-F1:0.9178, P-AUROC:0.9803, P-AP:0.6718, P-F1:0.6387, P-AUPRO:0.9355
metal_nut: I-Auroc:0.9589, I-AP:0.9904, I-F1:0.9442, P-AUROC:0.8994, P-AP:0.6704, P-F1:0.6389, P-AUPRO:0.8063
pill: I-Auroc:0.9648, I-AP:0.9937, I-F1:0.9645, P-AUROC:0.9329, P-AP:0.6179, P-F1:0.6098, P-AUPRO:0.9212
screw: I-Auroc:0.7442, I-AP:0.8812, I-F1:0.8640, P-AUROC:0.9620, P-AP:0.2881, P-F1:0.3418, P-AUPRO:0.8505
toothbrush: I-Auroc:0.8917, I-AP:0.9552, I-F1:0.9375, P-AUROC:0.9712, P-AP:0.4459, P-F1:0.4620, P-AUPRO:0.8394
transistor: I-Auroc:0.9329, I-AP:0.9249, I-F1:0.8608, P-AUROC:0.8829, P-AP:0.4862, P-F1:0.4927, P-AUPRO:0.7733
zipper: I-Auroc:0.9120, I-AP:0.9710, I-F1:0.9312, P-AUROC:0.9513, P-AP:0.4818, P-F1:0.5035, P-AUPRO:0.8645
Mean: I-Auroc:0.9355, I-AP:0.9723, I-F1:0.9417, P-AUROC:0.9569, P-AP:0.5756, P-F1:0.5732, P-AUPRO:0.8908
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9951, P-AP:0.8103, P-F1:0.7677, P-AUPRO:0.9809
grid: I-Auroc:0.9833, I-AP:0.9952, I-F1:0.9825, P-AUROC:0.9850, P-AP:0.4843, P-F1:0.5112, P-AUPRO:0.9570
leather: I-Auroc:0.9986, I-AP:0.9995, I-F1:0.9892, P-AUROC:0.9943, P-AP:0.6095, P-F1:0.5861, P-AUPRO:0.9801
tile: I-Auroc:0.9877, I-AP:0.9962, I-F1:0.9822, P-AUROC:0.9785, P-AP:0.7813, P-F1:0.7726, P-AUPRO:0.8985
wood: I-Auroc:0.9912, I-AP:0.9972, I-F1:0.9756, P-AUROC:0.9638, P-AP:0.7016, P-F1:0.6655, P-AUPRO:0.9172
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9779, P-AP:0.8169, P-F1:0.7696, P-AUPRO:0.9468
cable: I-Auroc:0.9427, I-AP:0.9697, I-F1:0.9006, P-AUROC:0.9347, P-AP:0.5131, P-F1:0.5314, P-AUPRO:0.8372
capsule: I-Auroc:0.9087, I-AP:0.9773, I-F1:0.9554, P-AUROC:0.9719, P-AP:0.4422, P-F1:0.4722, P-AUPRO:0.9250
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9929, P-AUROC:0.9875, P-AP:0.7385, P-F1:0.7270, P-AUPRO:0.9513
metal_nut: I-Auroc:0.9770, I-AP:0.9947, I-F1:0.9583, P-AUROC:0.9152, P-AP:0.7256, P-F1:0.6807, P-AUPRO:0.8309
pill: I-Auroc:0.9643, I-AP:0.9937, I-F1:0.9650, P-AUROC:0.9377, P-AP:0.6272, P-F1:0.6189, P-AUPRO:0.9273
screw: I-Auroc:0.7385, I-AP:0.8890, I-F1:0.8594, P-AUROC:0.9679, P-AP:0.3487, P-F1:0.3998, P-AUPRO:0.8692
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9918, P-AP:0.7237, P-F1:0.7171, P-AUPRO:0.9357
transistor: I-Auroc:0.9579, I-AP:0.9483, I-F1:0.8684, P-AUROC:0.8839, P-AP:0.4858, P-F1:0.4893, P-AUPRO:0.7750
zipper: I-Auroc:0.9118, I-AP:0.9709, I-F1:0.9350, P-AUROC:0.9562, P-AP:0.4867, P-F1:0.5044, P-AUPRO:0.8840
Mean: I-Auroc:0.9573, I-AP:0.9821, I-F1:0.9571, P-AUROC:0.9628, P-AP:0.6197, P-F1:0.6142, P-AUPRO:0.9077





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_small_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7340, P-F1:0.7254, P-AUPRO:0.9719
grid: I-Auroc:0.9841, I-AP:0.9948, I-F1:0.9739, P-AUROC:0.9868, P-AP:0.4714, P-F1:0.4968, P-AUPRO:0.9513
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9931, P-AP:0.5571, P-F1:0.5567, P-AUPRO:0.9765
tile: I-Auroc:0.9881, I-AP:0.9965, I-F1:0.9880, P-AUROC:0.9700, P-AP:0.6985, P-F1:0.7217, P-AUPRO:0.8568
wood: I-Auroc:0.9833, I-AP:0.9950, I-F1:0.9587, P-AUROC:0.9628, P-AP:0.6732, P-F1:0.6420, P-AUPRO:0.9030
bottle: I-Auroc:0.9952, I-AP:0.9985, I-F1:0.9839, P-AUROC:0.9669, P-AP:0.7627, P-F1:0.7361, P-AUPRO:0.9249
cable: I-Auroc:0.8836, I-AP:0.9422, I-F1:0.8606, P-AUROC:0.9301, P-AP:0.5062, P-F1:0.5349, P-AUPRO:0.8049
capsule: I-Auroc:0.8197, I-AP:0.9572, I-F1:0.9160, P-AUROC:0.9637, P-AP:0.3894, P-F1:0.3916, P-AUPRO:0.8600
hazelnut: I-Auroc:0.9721, I-AP:0.9853, I-F1:0.9496, P-AUROC:0.9837, P-AP:0.6866, P-F1:0.6782, P-AUPRO:0.9264
metal_nut: I-Auroc:0.9516, I-AP:0.9889, I-F1:0.9436, P-AUROC:0.8722, P-AP:0.5603, P-F1:0.5775, P-AUPRO:0.8043
pill: I-Auroc:0.9542, I-AP:0.9917, I-F1:0.9493, P-AUROC:0.9175, P-AP:0.5675, P-F1:0.5807, P-AUPRO:0.9149
screw: I-Auroc:0.7221, I-AP:0.8856, I-F1:0.8750, P-AUROC:0.9465, P-AP:0.2299, P-F1:0.2971, P-AUPRO:0.8062
toothbrush: I-Auroc:0.9750, I-AP:0.9919, I-F1:0.9667, P-AUROC:0.9873, P-AP:0.6999, P-F1:0.7092, P-AUPRO:0.8730
transistor: I-Auroc:0.8958, I-AP:0.8804, I-F1:0.7895, P-AUROC:0.8859, P-AP:0.4773, P-F1:0.4814, P-AUPRO:0.7782
zipper: I-Auroc:0.8860, I-AP:0.9648, I-F1:0.9154, P-AUROC:0.9346, P-AP:0.3731, P-F1:0.4099, P-AUPRO:0.8182
Mean: I-Auroc:0.9340, I-AP:0.9715, I-F1:0.9376, P-AUROC:0.9530, P-AP:0.5591, P-F1:0.5693, P-AUPRO:0.8780
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7333, P-F1:0.7225, P-AUPRO:0.9730
grid: I-Auroc:0.9850, I-AP:0.9957, I-F1:0.9825, P-AUROC:0.9873, P-AP:0.4676, P-F1:0.4947, P-AUPRO:0.9539
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9928, P-AP:0.5475, P-F1:0.5483, P-AUPRO:0.9757
tile: I-Auroc:0.9885, I-AP:0.9966, I-F1:0.9880, P-AUROC:0.9700, P-AP:0.6964, P-F1:0.7159, P-AUPRO:0.8633
wood: I-Auroc:0.9886, I-AP:0.9967, I-F1:0.9748, P-AUROC:0.9641, P-AP:0.6814, P-F1:0.6496, P-AUPRO:0.9105
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9745, P-AP:0.7834, P-F1:0.7505, P-AUPRO:0.9372
cable: I-Auroc:0.9048, I-AP:0.9486, I-F1:0.8485, P-AUROC:0.9430, P-AP:0.5437, P-F1:0.5671, P-AUPRO:0.8349
capsule: I-Auroc:0.8177, I-AP:0.9557, I-F1:0.9270, P-AUROC:0.9673, P-AP:0.3994, P-F1:0.4023, P-AUPRO:0.8793
hazelnut: I-Auroc:0.9964, I-AP:0.9981, I-F1:0.9855, P-AUROC:0.9867, P-AP:0.7094, P-F1:0.7159, P-AUPRO:0.9418
metal_nut: I-Auroc:0.9858, I-AP:0.9967, I-F1:0.9735, P-AUROC:0.9139, P-AP:0.6948, P-F1:0.6902, P-AUPRO:0.8579
pill: I-Auroc:0.9430, I-AP:0.9899, I-F1:0.9496, P-AUROC:0.9242, P-AP:0.5748, P-F1:0.5851, P-AUPRO:0.9202
screw: I-Auroc:0.7916, I-AP:0.9108, I-F1:0.8897, P-AUROC:0.9646, P-AP:0.3125, P-F1:0.3769, P-AUPRO:0.8573
toothbrush: I-Auroc:0.9750, I-AP:0.9912, I-F1:0.9655, P-AUROC:0.9882, P-AP:0.6712, P-F1:0.6844, P-AUPRO:0.8946
transistor: I-Auroc:0.9258, I-AP:0.9071, I-F1:0.8378, P-AUROC:0.9010, P-AP:0.5216, P-F1:0.5217, P-AUPRO:0.8048
zipper: I-Auroc:0.9028, I-AP:0.9686, I-F1:0.9237, P-AUROC:0.9295, P-AP:0.3843, P-F1:0.4203, P-AUPRO:0.8078
Mean: I-Auroc:0.9469, I-AP:0.9770, I-F1:0.9492, P-AUROC:0.9600, P-AP:0.5814, P-F1:0.5897, P-AUPRO:0.8941
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9935, P-AP:0.7300, P-F1:0.7206, P-AUPRO:0.9716
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9863, P-AP:0.4627, P-F1:0.4943, P-AUPRO:0.9523
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9925, P-AP:0.5385, P-F1:0.5313, P-AUPRO:0.9714
tile: I-Auroc:0.9888, I-AP:0.9967, I-F1:0.9881, P-AUROC:0.9710, P-AP:0.6965, P-F1:0.7226, P-AUPRO:0.8589
wood: I-Auroc:0.9860, I-AP:0.9959, I-F1:0.9667, P-AUROC:0.9656, P-AP:0.6917, P-F1:0.6642, P-AUPRO:0.9109
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9774, P-AP:0.7932, P-F1:0.7567, P-AUPRO:0.9402
cable: I-Auroc:0.9260, I-AP:0.9602, I-F1:0.8830, P-AUROC:0.9500, P-AP:0.5698, P-F1:0.5919, P-AUPRO:0.8588
capsule: I-Auroc:0.8807, I-AP:0.9714, I-F1:0.9386, P-AUROC:0.9759, P-AP:0.4883, P-F1:0.5025, P-AUPRO:0.9014
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9899, P-AP:0.7395, P-F1:0.7385, P-AUPRO:0.9536
metal_nut: I-Auroc:0.9956, I-AP:0.9990, I-F1:0.9894, P-AUROC:0.9241, P-AP:0.7276, P-F1:0.7183, P-AUPRO:0.8685
pill: I-Auroc:0.9471, I-AP:0.9906, I-F1:0.9531, P-AUROC:0.9276, P-AP:0.5779, P-F1:0.5834, P-AUPRO:0.9268
screw: I-Auroc:0.7934, I-AP:0.8943, I-F1:0.9062, P-AUROC:0.9677, P-AP:0.3069, P-F1:0.3875, P-AUPRO:0.8716
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9906, P-AP:0.6741, P-F1:0.6958, P-AUPRO:0.9202
transistor: I-Auroc:0.9342, I-AP:0.9107, I-F1:0.8378, P-AUROC:0.9044, P-AP:0.5247, P-F1:0.5275, P-AUPRO:0.8114
zipper: I-Auroc:0.9010, I-AP:0.9684, I-F1:0.9198, P-AUROC:0.9347, P-AP:0.3815, P-F1:0.4205, P-AUPRO:0.8276
Mean: I-Auroc:0.9558, I-AP:0.9788, I-F1:0.9572, P-AUROC:0.9634, P-AP:0.5935, P-F1:0.6037, P-AUPRO:0.9030





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_large_14   默认：(R256-C224)
interested_layers = list(range(4, 19))

cuda:3
shots: 1
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9944, P-AUROC:0.9944, P-AP:0.7817, P-F1:0.7417, P-AUPRO:0.9775
grid: I-Auroc:0.9891, I-AP:0.9967, I-F1:0.9912, P-AUROC:0.9901, P-AP:0.4999, P-F1:0.5102, P-AUPRO:0.9624
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9915, P-AP:0.4989, P-F1:0.5044, P-AUPRO:0.9755
tile: I-Auroc:0.9986, I-AP:0.9995, I-F1:0.9940, P-AUROC:0.9759, P-AP:0.7337, P-F1:0.7468, P-AUPRO:0.9083
wood: I-Auroc:0.9833, I-AP:0.9947, I-F1:0.9748, P-AUROC:0.9579, P-AP:0.6910, P-F1:0.6566, P-AUPRO:0.9114
bottle: I-Auroc:0.9921, I-AP:0.9977, I-F1:0.9839, P-AUROC:0.9682, P-AP:0.7729, P-F1:0.7367, P-AUPRO:0.9282
cable: I-Auroc:0.9063, I-AP:0.9540, I-F1:0.8876, P-AUROC:0.9166, P-AP:0.4825, P-F1:0.5103, P-AUPRO:0.8162
capsule: I-Auroc:0.8504, I-AP:0.9645, I-F1:0.9345, P-AUROC:0.9666, P-AP:0.4167, P-F1:0.4185, P-AUPRO:0.9032
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9878, P-AP:0.7364, P-F1:0.7348, P-AUPRO:0.9439
metal_nut: I-Auroc:0.9545, I-AP:0.9894, I-F1:0.9534, P-AUROC:0.8786, P-AP:0.5773, P-F1:0.5843, P-AUPRO:0.8086
pill: I-Auroc:0.9795, I-AP:0.9965, I-F1:0.9675, P-AUROC:0.9179, P-AP:0.5657, P-F1:0.5781, P-AUPRO:0.9389
screw: I-Auroc:0.7399, I-AP:0.8872, I-F1:0.8872, P-AUROC:0.9572, P-AP:0.2976, P-F1:0.3417, P-AUPRO:0.8364
toothbrush: I-Auroc:0.9667, I-AP:0.9889, I-F1:0.9655, P-AUROC:0.9868, P-AP:0.6684, P-F1:0.6974, P-AUPRO:0.8927
transistor: I-Auroc:0.9696, I-AP:0.9603, I-F1:0.9070, P-AUROC:0.8885, P-AP:0.5004, P-F1:0.5021, P-AUPRO:0.7814
zipper: I-Auroc:0.8923, I-AP:0.9615, I-F1:0.9469, P-AUROC:0.9619, P-AP:0.4847, P-F1:0.5268, P-AUPRO:0.8970
Mean: I-Auroc:0.9480, I-AP:0.9793, I-F1:0.9584, P-AUROC:0.9560, P-AP:0.5805, P-F1:0.5860, P-AUPRO:0.8988
cuda:3
shots: 2
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9943, P-AP:0.7819, P-F1:0.7382, P-AUPRO:0.9768
grid: I-Auroc:0.9891, I-AP:0.9967, I-F1:0.9912, P-AUROC:0.9898, P-AP:0.4969, P-F1:0.5097, P-AUPRO:0.9625
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9915, P-AP:0.4983, P-F1:0.5028, P-AUPRO:0.9746
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9940, P-AUROC:0.9756, P-AP:0.7267, P-F1:0.7447, P-AUPRO:0.8937
wood: I-Auroc:0.9851, I-AP:0.9952, I-F1:0.9672, P-AUROC:0.9609, P-AP:0.7044, P-F1:0.6672, P-AUPRO:0.9178
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9741, P-AP:0.7886, P-F1:0.7466, P-AUPRO:0.9382
cable: I-Auroc:0.9355, I-AP:0.9660, I-F1:0.8994, P-AUROC:0.9347, P-AP:0.5323, P-F1:0.5590, P-AUPRO:0.8519
capsule: I-Auroc:0.8468, I-AP:0.9608, I-F1:0.9381, P-AUROC:0.9681, P-AP:0.4294, P-F1:0.4315, P-AUPRO:0.9140
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9885, P-AP:0.7429, P-F1:0.7428, P-AUPRO:0.9502
metal_nut: I-Auroc:0.9922, I-AP:0.9981, I-F1:0.9840, P-AUROC:0.9240, P-AP:0.7171, P-F1:0.7028, P-AUPRO:0.8797
pill: I-Auroc:0.9820, I-AP:0.9969, I-F1:0.9787, P-AUROC:0.9264, P-AP:0.5817, P-F1:0.5919, P-AUPRO:0.9450
screw: I-Auroc:0.8284, I-AP:0.9366, I-F1:0.8872, P-AUROC:0.9734, P-AP:0.4135, P-F1:0.4532, P-AUPRO:0.8869
toothbrush: I-Auroc:0.9778, I-AP:0.9920, I-F1:0.9655, P-AUROC:0.9862, P-AP:0.6299, P-F1:0.6595, P-AUPRO:0.9067
transistor: I-Auroc:0.9825, I-AP:0.9753, I-F1:0.9383, P-AUROC:0.9005, P-AP:0.5282, P-F1:0.5307, P-AUPRO:0.8036
zipper: I-Auroc:0.9835, I-AP:0.9950, I-F1:0.9876, P-AUROC:0.9660, P-AP:0.5544, P-F1:0.5800, P-AUPRO:0.9099
Mean: I-Auroc:0.9666, I-AP:0.9874, I-F1:0.9678, P-AUROC:0.9636, P-AP:0.6084, P-F1:0.6107, P-AUPRO:0.9141
cuda:3
shots: 4
carpet: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9944, P-AUROC:0.9943, P-AP:0.7833, P-F1:0.7372, P-AUPRO:0.9778
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9894, P-AP:0.4916, P-F1:0.5042, P-AUPRO:0.9592
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9915, P-AP:0.4981, P-F1:0.5009, P-AUPRO:0.9740
tile: I-Auroc:0.9986, I-AP:0.9994, I-F1:0.9881, P-AUROC:0.9756, P-AP:0.7223, P-F1:0.7428, P-AUPRO:0.8957
wood: I-Auroc:0.9825, I-AP:0.9944, I-F1:0.9677, P-AUROC:0.9625, P-AP:0.7003, P-F1:0.6705, P-AUPRO:0.9247
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9765, P-AP:0.7954, P-F1:0.7533, P-AUPRO:0.9437
cable: I-Auroc:0.9440, I-AP:0.9695, I-F1:0.8941, P-AUROC:0.9413, P-AP:0.5573, P-F1:0.5830, P-AUPRO:0.8678
capsule: I-Auroc:0.9406, I-AP:0.9860, I-F1:0.9502, P-AUROC:0.9757, P-AP:0.5183, P-F1:0.5160, P-AUPRO:0.9396
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9914, P-AP:0.7737, P-F1:0.7642, P-AUPRO:0.9583
metal_nut: I-Auroc:0.9990, I-AP:0.9998, I-F1:0.9947, P-AUROC:0.9341, P-AP:0.7469, P-F1:0.7337, P-AUPRO:0.8873
pill: I-Auroc:0.9864, I-AP:0.9977, I-F1:0.9822, P-AUROC:0.9316, P-AP:0.5910, P-F1:0.5979, P-AUPRO:0.9476
screw: I-Auroc:0.8182, I-AP:0.9246, I-F1:0.8898, P-AUROC:0.9752, P-AP:0.4086, P-F1:0.4505, P-AUPRO:0.8914
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.6530, P-F1:0.6888, P-AUPRO:0.9362
transistor: I-Auroc:0.9904, I-AP:0.9856, I-F1:0.9630, P-AUROC:0.9050, P-AP:0.5304, P-F1:0.5294, P-AUPRO:0.8130
zipper: I-Auroc:0.9829, I-AP:0.9948, I-F1:0.9835, P-AUROC:0.9694, P-AP:0.5537, P-F1:0.5830, P-AUPRO:0.9148
Mean: I-Auroc:0.9752, I-AP:0.9898, I-F1:0.9733, P-AUROC:0.9669, P-AP:0.6216, P-F1:0.6237, P-AUPRO:0.9221









-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_base_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:3
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9920, P-AP:0.6742, P-F1:0.6896, P-AUPRO:0.9668
grid: I-Auroc:0.9883, I-AP:0.9965, I-F1:0.9912, P-AUROC:0.9871, P-AP:0.4407, P-F1:0.4736, P-AUPRO:0.9511
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.4120, P-F1:0.4665, P-AUPRO:0.9657
tile: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9940, P-AUROC:0.9703, P-AP:0.6741, P-F1:0.7158, P-AUPRO:0.8745
wood: I-Auroc:0.9921, I-AP:0.9977, I-F1:0.9831, P-AUROC:0.9566, P-AP:0.6498, P-F1:0.6304, P-AUPRO:0.9062
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9921, P-AUROC:0.9695, P-AP:0.7590, P-F1:0.7381, P-AUPRO:0.9279
cable: I-Auroc:0.9114, I-AP:0.9498, I-F1:0.8810, P-AUROC:0.9233, P-AP:0.5277, P-F1:0.5555, P-AUPRO:0.8087
capsule: I-Auroc:0.8341, I-AP:0.9592, I-F1:0.9258, P-AUROC:0.9719, P-AP:0.4332, P-F1:0.4271, P-AUPRO:0.9028
hazelnut: I-Auroc:0.9989, I-AP:0.9994, I-F1:0.9859, P-AUROC:0.9880, P-AP:0.7320, P-F1:0.7239, P-AUPRO:0.9401
metal_nut: I-Auroc:0.9609, I-AP:0.9912, I-F1:0.9474, P-AUROC:0.9104, P-AP:0.6594, P-F1:0.6552, P-AUPRO:0.8410
pill: I-Auroc:0.9785, I-AP:0.9963, I-F1:0.9747, P-AUROC:0.9262, P-AP:0.5640, P-F1:0.5787, P-AUPRO:0.9361
screw: I-Auroc:0.7249, I-AP:0.8941, I-F1:0.8655, P-AUROC:0.9539, P-AP:0.3028, P-F1:0.3589, P-AUPRO:0.8180
toothbrush: I-Auroc:0.9778, I-AP:0.9930, I-F1:0.9831, P-AUROC:0.9871, P-AP:0.7059, P-F1:0.7024, P-AUPRO:0.8714
transistor: I-Auroc:0.9704, I-AP:0.9470, I-F1:0.9286, P-AUROC:0.8780, P-AP:0.4679, P-F1:0.4740, P-AUPRO:0.7462
zipper: I-Auroc:0.9123, I-AP:0.9709, I-F1:0.9426, P-AUROC:0.9545, P-AP:0.4176, P-F1:0.4546, P-AUPRO:0.8751
Mean: I-Auroc:0.9495, I-AP:0.9795, I-F1:0.9597, P-AUROC:0.9572, P-AP:0.5614, P-F1:0.5763, P-AUPRO:0.8888
cuda:3
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9918, P-AP:0.6679, P-F1:0.6828, P-AUPRO:0.9661
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9873, P-AP:0.4378, P-F1:0.4716, P-AUPRO:0.9522
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9895, P-AP:0.3914, P-F1:0.4624, P-AUPRO:0.9629
tile: I-Auroc:0.9935, I-AP:0.9979, I-F1:0.9940, P-AUROC:0.9701, P-AP:0.6696, P-F1:0.7136, P-AUPRO:0.8636
wood: I-Auroc:0.9895, I-AP:0.9971, I-F1:0.9831, P-AUROC:0.9579, P-AP:0.6526, P-F1:0.6328, P-AUPRO:0.9135
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9755, P-AP:0.7731, P-F1:0.7481, P-AUPRO:0.9364
cable: I-Auroc:0.9265, I-AP:0.9559, I-F1:0.8791, P-AUROC:0.9361, P-AP:0.5502, P-F1:0.5681, P-AUPRO:0.8387
capsule: I-Auroc:0.8285, I-AP:0.9565, I-F1:0.9304, P-AUROC:0.9729, P-AP:0.4375, P-F1:0.4351, P-AUPRO:0.9047
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9892, P-AP:0.7318, P-F1:0.7372, P-AUPRO:0.9470
metal_nut: I-Auroc:0.9868, I-AP:0.9968, I-F1:0.9735, P-AUROC:0.9374, P-AP:0.7491, P-F1:0.7370, P-AUPRO:0.8817
pill: I-Auroc:0.9817, I-AP:0.9968, I-F1:0.9751, P-AUROC:0.9352, P-AP:0.5798, P-F1:0.5938, P-AUPRO:0.9418
screw: I-Auroc:0.8469, I-AP:0.9410, I-F1:0.8803, P-AUROC:0.9698, P-AP:0.3560, P-F1:0.4101, P-AUPRO:0.8723
toothbrush: I-Auroc:0.9778, I-AP:0.9920, I-F1:0.9655, P-AUROC:0.9877, P-AP:0.6818, P-F1:0.6854, P-AUPRO:0.8904
transistor: I-Auroc:0.9646, I-AP:0.9388, I-F1:0.9024, P-AUROC:0.8951, P-AP:0.5058, P-F1:0.5128, P-AUPRO:0.7754
zipper: I-Auroc:0.9617, I-AP:0.9884, I-F1:0.9627, P-AUROC:0.9565, P-AP:0.4591, P-F1:0.4988, P-AUPRO:0.8830
Mean: I-Auroc:0.9630, I-AP:0.9838, I-F1:0.9625, P-AUROC:0.9635, P-AP:0.5762, P-F1:0.5926, P-AUPRO:0.9020
cuda:3
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9916, P-AP:0.6609, P-F1:0.6785, P-AUPRO:0.9615
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9871, P-AP:0.4367, P-F1:0.4700, P-AUPRO:0.9498
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9890, P-AP:0.4052, P-F1:0.4538, P-AUPRO:0.9591
tile: I-Auroc:0.9964, I-AP:0.9987, I-F1:0.9940, P-AUROC:0.9703, P-AP:0.6680, P-F1:0.7130, P-AUPRO:0.8723
wood: I-Auroc:0.9860, I-AP:0.9959, I-F1:0.9744, P-AUROC:0.9589, P-AP:0.6503, P-F1:0.6361, P-AUPRO:0.9145
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9777, P-AP:0.7793, P-F1:0.7544, P-AUPRO:0.9375
cable: I-Auroc:0.9331, I-AP:0.9633, I-F1:0.8865, P-AUROC:0.9425, P-AP:0.5716, P-F1:0.5879, P-AUPRO:0.8551
capsule: I-Auroc:0.9186, I-AP:0.9822, I-F1:0.9358, P-AUROC:0.9805, P-AP:0.5210, P-F1:0.5144, P-AUPRO:0.9353
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9909, P-AP:0.7492, P-F1:0.7476, P-AUPRO:0.9538
metal_nut: I-Auroc:0.9932, I-AP:0.9984, I-F1:0.9789, P-AUROC:0.9446, P-AP:0.7702, P-F1:0.7617, P-AUPRO:0.8888
pill: I-Auroc:0.9834, I-AP:0.9971, I-F1:0.9753, P-AUROC:0.9401, P-AP:0.5925, P-F1:0.6021, P-AUPRO:0.9424
screw: I-Auroc:0.8215, I-AP:0.9272, I-F1:0.8863, P-AUROC:0.9729, P-AP:0.3435, P-F1:0.4020, P-AUPRO:0.8834
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.6807, P-F1:0.6864, P-AUPRO:0.9176
transistor: I-Auroc:0.9817, I-AP:0.9667, I-F1:0.9412, P-AUROC:0.9009, P-AP:0.5188, P-F1:0.5171, P-AUPRO:0.7871
zipper: I-Auroc:0.9611, I-AP:0.9882, I-F1:0.9630, P-AUROC:0.9595, P-AP:0.4573, P-F1:0.4985, P-AUPRO:0.8825
Mean: I-Auroc:0.9708, I-AP:0.9876, I-F1:0.9684, P-AUROC:0.9664, P-AP:0.5870, P-F1:0.6016, P-AUPRO:0.9094






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_vit_base_16   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9951, P-AP:0.8132, P-F1:0.7617, P-AUPRO:0.9818
grid: I-Auroc:0.9908, I-AP:0.9972, I-F1:0.9912, P-AUROC:0.9877, P-AP:0.4917, P-F1:0.5064, P-AUPRO:0.9545
leather: I-Auroc:0.9993, I-AP:0.9998, I-F1:0.9946, P-AUROC:0.9942, P-AP:0.5950, P-F1:0.5915, P-AUPRO:0.9800
tile: I-Auroc:0.9935, I-AP:0.9975, I-F1:0.9820, P-AUROC:0.9810, P-AP:0.7869, P-F1:0.7782, P-AUPRO:0.9314
wood: I-Auroc:0.9886, I-AP:0.9965, I-F1:0.9677, P-AUROC:0.9658, P-AP:0.7145, P-F1:0.6608, P-AUPRO:0.9065
bottle: I-Auroc:0.9913, I-AP:0.9974, I-F1:0.9760, P-AUROC:0.9714, P-AP:0.7920, P-F1:0.7410, P-AUPRO:0.9328
cable: I-Auroc:0.8636, I-AP:0.9318, I-F1:0.8302, P-AUROC:0.9172, P-AP:0.4806, P-F1:0.4973, P-AUPRO:0.7495
capsule: I-Auroc:0.8468, I-AP:0.9648, I-F1:0.9316, P-AUROC:0.9713, P-AP:0.3907, P-F1:0.4153, P-AUPRO:0.8971
hazelnut: I-Auroc:0.9579, I-AP:0.9777, I-F1:0.9091, P-AUROC:0.9829, P-AP:0.7050, P-F1:0.6907, P-AUPRO:0.9280
metal_nut: I-Auroc:0.9057, I-AP:0.9777, I-F1:0.9278, P-AUROC:0.8609, P-AP:0.5391, P-F1:0.5550, P-AUPRO:0.7501
pill: I-Auroc:0.9501, I-AP:0.9911, I-F1:0.9452, P-AUROC:0.9477, P-AP:0.6666, P-F1:0.6420, P-AUPRO:0.9262
screw: I-Auroc:0.6575, I-AP:0.8423, I-F1:0.8613, P-AUROC:0.9461, P-AP:0.1985, P-F1:0.2679, P-AUPRO:0.7990
toothbrush: I-Auroc:0.9528, I-AP:0.9831, I-F1:0.9310, P-AUROC:0.9854, P-AP:0.7176, P-F1:0.7002, P-AUPRO:0.8566
transistor: I-Auroc:0.9312, I-AP:0.9270, I-F1:0.8608, P-AUROC:0.8769, P-AP:0.4718, P-F1:0.4807, P-AUPRO:0.7315
zipper: I-Auroc:0.8364, I-AP:0.9461, I-F1:0.9015, P-AUROC:0.9423, P-AP:0.4203, P-F1:0.4647, P-AUPRO:0.8471
Mean: I-Auroc:0.9244, I-AP:0.9687, I-F1:0.9340, P-AUROC:0.9551, P-AP:0.5856, P-F1:0.5836, P-AUPRO:0.8782
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9950, P-AP:0.8079, P-F1:0.7585, P-AUPRO:0.9814
grid: I-Auroc:0.9858, I-AP:0.9958, I-F1:0.9825, P-AUROC:0.9875, P-AP:0.4886, P-F1:0.4964, P-AUPRO:0.9535
leather: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9946, P-AUROC:0.9942, P-AP:0.5935, P-F1:0.5898, P-AUPRO:0.9785
tile: I-Auroc:0.9957, I-AP:0.9983, I-F1:0.9822, P-AUROC:0.9817, P-AP:0.7872, P-F1:0.7805, P-AUPRO:0.9251
wood: I-Auroc:0.9860, I-AP:0.9958, I-F1:0.9655, P-AUROC:0.9663, P-AP:0.7131, P-F1:0.6583, P-AUPRO:0.9084
bottle: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9921, P-AUROC:0.9774, P-AP:0.8112, P-F1:0.7570, P-AUPRO:0.9431
cable: I-Auroc:0.9230, I-AP:0.9576, I-F1:0.8654, P-AUROC:0.9377, P-AP:0.5244, P-F1:0.5480, P-AUPRO:0.8085
capsule: I-Auroc:0.8257, I-AP:0.9575, I-F1:0.9391, P-AUROC:0.9703, P-AP:0.3839, P-F1:0.4041, P-AUPRO:0.8969
hazelnut: I-Auroc:0.9800, I-AP:0.9893, I-F1:0.9371, P-AUROC:0.9851, P-AP:0.7407, P-F1:0.7135, P-AUPRO:0.9345
metal_nut: I-Auroc:0.9785, I-AP:0.9951, I-F1:0.9674, P-AUROC:0.9027, P-AP:0.6784, P-F1:0.6538, P-AUPRO:0.8290
pill: I-Auroc:0.9468, I-AP:0.9904, I-F1:0.9510, P-AUROC:0.9539, P-AP:0.6722, P-F1:0.6451, P-AUPRO:0.9339
screw: I-Auroc:0.7299, I-AP:0.8826, I-F1:0.8819, P-AUROC:0.9646, P-AP:0.3143, P-F1:0.3759, P-AUPRO:0.8655
toothbrush: I-Auroc:0.9472, I-AP:0.9793, I-F1:0.9375, P-AUROC:0.9826, P-AP:0.6560, P-F1:0.6465, P-AUPRO:0.8668
transistor: I-Auroc:0.9542, I-AP:0.9420, I-F1:0.8831, P-AUROC:0.8940, P-AP:0.5037, P-F1:0.5120, P-AUPRO:0.7652
zipper: I-Auroc:0.8485, I-AP:0.9491, I-F1:0.9049, P-AUROC:0.9408, P-AP:0.4399, P-F1:0.4714, P-AUPRO:0.8321
Mean: I-Auroc:0.9400, I-AP:0.9755, I-F1:0.9456, P-AUROC:0.9623, P-AP:0.6077, P-F1:0.6007, P-AUPRO:0.8948
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9950, P-AP:0.8108, P-F1:0.7585, P-AUPRO:0.9805
grid: I-Auroc:0.9825, I-AP:0.9950, I-F1:0.9825, P-AUROC:0.9860, P-AP:0.4873, P-F1:0.4962, P-AUPRO:0.9456
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9942, P-AP:0.5837, P-F1:0.5860, P-AUPRO:0.9806
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9820, P-AP:0.7822, P-F1:0.7823, P-AUPRO:0.9252
wood: I-Auroc:0.9833, I-AP:0.9949, I-F1:0.9593, P-AUROC:0.9677, P-AP:0.7179, P-F1:0.6694, P-AUPRO:0.9114
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9800, P-AP:0.8194, P-F1:0.7641, P-AUPRO:0.9471
cable: I-Auroc:0.9466, I-AP:0.9701, I-F1:0.8889, P-AUROC:0.9469, P-AP:0.5552, P-F1:0.5828, P-AUPRO:0.8426
capsule: I-Auroc:0.8975, I-AP:0.9773, I-F1:0.9381, P-AUROC:0.9774, P-AP:0.4618, P-F1:0.4967, P-AUPRO:0.9189
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.7798, P-F1:0.7594, P-AUPRO:0.9536
metal_nut: I-Auroc:0.9863, I-AP:0.9969, I-F1:0.9681, P-AUROC:0.9164, P-AP:0.7212, P-F1:0.6909, P-AUPRO:0.8491
pill: I-Auroc:0.9495, I-AP:0.9910, I-F1:0.9507, P-AUROC:0.9569, P-AP:0.6742, P-F1:0.6435, P-AUPRO:0.9362
screw: I-Auroc:0.7329, I-AP:0.8783, I-F1:0.8740, P-AUROC:0.9632, P-AP:0.3114, P-F1:0.3790, P-AUPRO:0.8550
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9912, P-AP:0.7147, P-F1:0.6986, P-AUPRO:0.9275
transistor: I-Auroc:0.9692, I-AP:0.9660, I-F1:0.8974, P-AUROC:0.8996, P-AP:0.5111, P-F1:0.5148, P-AUPRO:0.7747
zipper: I-Auroc:0.8485, I-AP:0.9501, I-F1:0.9049, P-AUROC:0.9461, P-AP:0.4444, P-F1:0.4720, P-AUPRO:0.8444
Mean: I-Auroc:0.9531, I-AP:0.9813, I-F1:0.9572, P-AUROC:0.9662, P-AP:0.6250, P-F1:0.6196, P-AUPRO:0.9062






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_vit_base_16   默认：(R448-C384)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9909, P-AP:0.7965, P-F1:0.7598, P-AUPRO:0.9725
grid: I-Auroc:0.9891, I-AP:0.9964, I-F1:0.9821, P-AUROC:0.9835, P-AP:0.5134, P-F1:0.5268, P-AUPRO:0.9528
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9953, P-AP:0.6560, P-F1:0.6261, P-AUPRO:0.9826
tile: I-Auroc:0.9935, I-AP:0.9979, I-F1:0.9940, P-AUROC:0.9848, P-AP:0.8085, P-F1:0.8052, P-AUPRO:0.9292
wood: I-Auroc:0.9982, I-AP:0.9994, I-F1:0.9917, P-AUROC:0.9756, P-AP:0.7680, P-F1:0.7050, P-AUPRO:0.9365
bottle: I-Auroc:0.9802, I-AP:0.9943, I-F1:0.9672, P-AUROC:0.9510, P-AP:0.7459, P-F1:0.7029, P-AUPRO:0.8951
cable: I-Auroc:0.8111, I-AP:0.8938, I-F1:0.8182, P-AUROC:0.9216, P-AP:0.4573, P-F1:0.4590, P-AUPRO:0.7452
capsule: I-Auroc:0.8460, I-AP:0.9621, I-F1:0.9292, P-AUROC:0.9775, P-AP:0.4084, P-F1:0.4146, P-AUPRO:0.9438
hazelnut: I-Auroc:0.9289, I-AP:0.9613, I-F1:0.8986, P-AUROC:0.9809, P-AP:0.6924, P-F1:0.6543, P-AUPRO:0.9252
metal_nut: I-Auroc:0.8788, I-AP:0.9707, I-F1:0.9163, P-AUROC:0.8757, P-AP:0.5481, P-F1:0.5733, P-AUPRO:0.7607
pill: I-Auroc:0.9468, I-AP:0.9899, I-F1:0.9517, P-AUROC:0.9518, P-AP:0.6759, P-F1:0.6543, P-AUPRO:0.9433
screw: I-Auroc:0.6339, I-AP:0.8233, I-F1:0.8773, P-AUROC:0.9542, P-AP:0.1285, P-F1:0.1812, P-AUPRO:0.8210
toothbrush: I-Auroc:0.9028, I-AP:0.9641, I-F1:0.8923, P-AUROC:0.9798, P-AP:0.6341, P-F1:0.6042, P-AUPRO:0.8347
transistor: I-Auroc:0.9725, I-AP:0.9647, I-F1:0.9000, P-AUROC:0.8688, P-AP:0.4491, P-F1:0.4526, P-AUPRO:0.7195
zipper: I-Auroc:0.9454, I-AP:0.9854, I-F1:0.9388, P-AUROC:0.9443, P-AP:0.4680, P-F1:0.4555, P-AUPRO:0.8440
Mean: I-Auroc:0.9218, I-AP:0.9669, I-F1:0.9372, P-AUROC:0.9557, P-AP:0.5833, P-F1:0.5716, P-AUPRO:0.8804
cuda:4
shots: 2
carpet: I-Auroc:0.9972, I-AP:0.9992, I-F1:0.9888, P-AUROC:0.9909, P-AP:0.7891, P-F1:0.7569, P-AUPRO:0.9722
grid: I-Auroc:0.9833, I-AP:0.9950, I-F1:0.9821, P-AUROC:0.9838, P-AP:0.5104, P-F1:0.5214, P-AUPRO:0.9422
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9953, P-AP:0.6566, P-F1:0.6265, P-AUPRO:0.9830
tile: I-Auroc:0.9885, I-AP:0.9965, I-F1:0.9880, P-AUROC:0.9846, P-AP:0.8128, P-F1:0.7987, P-AUPRO:0.9224
wood: I-Auroc:0.9982, I-AP:0.9994, I-F1:0.9917, P-AUROC:0.9770, P-AP:0.7693, P-F1:0.7009, P-AUPRO:0.9398
bottle: I-Auroc:0.9929, I-AP:0.9980, I-F1:0.9841, P-AUROC:0.9637, P-AP:0.7770, P-F1:0.7251, P-AUPRO:0.9160
cable: I-Auroc:0.9213, I-AP:0.9566, I-F1:0.8614, P-AUROC:0.9431, P-AP:0.5655, P-F1:0.5567, P-AUPRO:0.8117
capsule: I-Auroc:0.8404, I-AP:0.9599, I-F1:0.9339, P-AUROC:0.9755, P-AP:0.4026, P-F1:0.4119, P-AUPRO:0.9407
hazelnut: I-Auroc:0.9661, I-AP:0.9816, I-F1:0.9286, P-AUROC:0.9842, P-AP:0.7381, P-F1:0.6832, P-AUPRO:0.9304
metal_nut: I-Auroc:0.9677, I-AP:0.9927, I-F1:0.9462, P-AUROC:0.9209, P-AP:0.7192, P-F1:0.6812, P-AUPRO:0.8458
pill: I-Auroc:0.9389, I-AP:0.9885, I-F1:0.9477, P-AUROC:0.9572, P-AP:0.6900, P-F1:0.6608, P-AUPRO:0.9501
screw: I-Auroc:0.7141, I-AP:0.8762, I-F1:0.8726, P-AUROC:0.9715, P-AP:0.3718, P-F1:0.4078, P-AUPRO:0.8912
toothbrush: I-Auroc:0.8972, I-AP:0.9589, I-F1:0.9231, P-AUROC:0.9755, P-AP:0.5343, P-F1:0.5174, P-AUPRO:0.8579
transistor: I-Auroc:0.9692, I-AP:0.9608, I-F1:0.8767, P-AUROC:0.8861, P-AP:0.4908, P-F1:0.4888, P-AUPRO:0.7582
zipper: I-Auroc:0.9751, I-AP:0.9933, I-F1:0.9669, P-AUROC:0.9418, P-AP:0.4988, P-F1:0.4845, P-AUPRO:0.8350
Mean: I-Auroc:0.9433, I-AP:0.9771, I-F1:0.9461, P-AUROC:0.9634, P-AP:0.6218, P-F1:0.6015, P-AUPRO:0.8998
cuda:4
shots: 4
carpet: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9889, P-AUROC:0.9914, P-AP:0.7921, P-F1:0.7583, P-AUPRO:0.9737
grid: I-Auroc:0.9799, I-AP:0.9937, I-F1:0.9649, P-AUROC:0.9823, P-AP:0.5038, P-F1:0.5178, P-AUPRO:0.9389
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9956, P-AP:0.6559, P-F1:0.6286, P-AUPRO:0.9849
tile: I-Auroc:0.9924, I-AP:0.9976, I-F1:0.9881, P-AUROC:0.9850, P-AP:0.8123, P-F1:0.8007, P-AUPRO:0.9281
wood: I-Auroc:0.9974, I-AP:0.9992, I-F1:0.9916, P-AUROC:0.9775, P-AP:0.7727, P-F1:0.7105, P-AUPRO:0.9370
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9920, P-AUROC:0.9692, P-AP:0.7935, P-F1:0.7386, P-AUPRO:0.9289
cable: I-Auroc:0.9436, I-AP:0.9690, I-F1:0.8977, P-AUROC:0.9507, P-AP:0.6095, P-F1:0.5981, P-AUPRO:0.8411
capsule: I-Auroc:0.9290, I-AP:0.9842, I-F1:0.9515, P-AUROC:0.9827, P-AP:0.5038, P-F1:0.5047, P-AUPRO:0.9579
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9917, P-AP:0.8020, P-F1:0.7802, P-AUPRO:0.9507
metal_nut: I-Auroc:0.9804, I-AP:0.9956, I-F1:0.9617, P-AUROC:0.9311, P-AP:0.7628, P-F1:0.7157, P-AUPRO:0.8578
pill: I-Auroc:0.9476, I-AP:0.9898, I-F1:0.9544, P-AUROC:0.9602, P-AP:0.7002, P-F1:0.6731, P-AUPRO:0.9523
screw: I-Auroc:0.7282, I-AP:0.8653, I-F1:0.8830, P-AUROC:0.9764, P-AP:0.4075, P-F1:0.4505, P-AUPRO:0.9039
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9922, P-AP:0.7271, P-F1:0.7201, P-AUPRO:0.9354
transistor: I-Auroc:0.9667, I-AP:0.9570, I-F1:0.8861, P-AUROC:0.8938, P-AP:0.4947, P-F1:0.4907, P-AUPRO:0.7524
zipper: I-Auroc:0.9693, I-AP:0.9918, I-F1:0.9669, P-AUROC:0.9415, P-AP:0.5052, P-F1:0.4910, P-AUPRO:0.8321
Mean: I-Auroc:0.9619, I-AP:0.9827, I-F1:0.9607, P-AUROC:0.9681, P-AP:0.6562, P-F1:0.6386, P-AUPRO:0.9117




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone 为 dinov2reg_vit_large_14，结果如下：
shot=8; 更换 --seed 

cuda:2
shots: 8
seed: 114514
carpet: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9944, P-AUROC:0.9933, P-AP:0.7313, P-F1:0.6991, P-AUPRO:0.9752
grid: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9946, P-AP:0.5754, P-F1:0.5958, P-AUPRO:0.9794
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9893, P-AP:0.4029, P-F1:0.4365, P-AUPRO:0.9640
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9758, P-AP:0.7202, P-F1:0.7417, P-AUPRO:0.9090
wood: I-Auroc:0.9921, I-AP:0.9974, I-F1:0.9917, P-AUROC:0.9736, P-AP:0.7269, P-F1:0.6883, P-AUPRO:0.9522
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9774, P-AP:0.8238, P-F1:0.7697, P-AUPRO:0.9505
cable: I-Auroc:0.9477, I-AP:0.9735, I-F1:0.9249, P-AUROC:0.9433, P-AP:0.6049, P-F1:0.6321, P-AUPRO:0.8787
capsule: I-Auroc:0.9765, I-AP:0.9950, I-F1:0.9686, P-AUROC:0.9828, P-AP:0.6009, P-F1:0.5789, P-AUPRO:0.9728
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9952, P-AP:0.8627, P-F1:0.8066, P-AUPRO:0.9738
metal_nut: I-Auroc:0.9897, I-AP:0.9976, I-F1:0.9787, P-AUROC:0.9423, P-AP:0.7361, P-F1:0.7323, P-AUPRO:0.9090
pill: I-Auroc:0.9877, I-AP:0.9979, I-F1:0.9823, P-AUROC:0.9295, P-AP:0.5566, P-F1:0.5694, P-AUPRO:0.9589
screw: I-Auroc:0.9078, I-AP:0.9678, I-F1:0.9098, P-AUROC:0.9915, P-AP:0.5935, P-F1:0.5887, P-AUPRO:0.9673
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.7226, P-F1:0.6979, P-AUPRO:0.9700
transistor: I-Auroc:0.9962, I-AP:0.9939, I-F1:0.9877, P-AUROC:0.9006, P-AP:0.4767, P-F1:0.4810, P-AUPRO:0.7882
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9793, P-AP:0.6493, P-F1:0.6513, P-AUPRO:0.9441
Mean: I-Auroc:0.9865, I-AP:0.9949, I-F1:0.9825, P-AUROC:0.9708, P-AP:0.6523, P-F1:0.6446, P-AUPRO:0.9395
cuda:2
shots: 8
seed: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9931, P-AP:0.7208, P-F1:0.6990, P-AUPRO:0.9764
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9941, P-AP:0.5601, P-F1:0.5795, P-AUPRO:0.9787
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9902, P-AP:0.4338, P-F1:0.4606, P-AUPRO:0.9642
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9762, P-AP:0.7252, P-F1:0.7429, P-AUPRO:0.8980
wood: I-Auroc:0.9912, I-AP:0.9970, I-F1:0.9917, P-AUROC:0.9743, P-AP:0.7175, P-F1:0.6854, P-AUPRO:0.9480
bottle: I-Auroc:0.9968, I-AP:0.9990, I-F1:0.9841, P-AUROC:0.9779, P-AP:0.8250, P-F1:0.7670, P-AUPRO:0.9500
cable: I-Auroc:0.9535, I-AP:0.9759, I-F1:0.9302, P-AUROC:0.9459, P-AP:0.6017, P-F1:0.6280, P-AUPRO:0.8823
capsule: I-Auroc:0.9725, I-AP:0.9936, I-F1:0.9732, P-AUROC:0.9813, P-AP:0.5839, P-F1:0.5675, P-AUPRO:0.9712
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9944, P-AP:0.8370, P-F1:0.7857, P-AUPRO:0.9692
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9458, P-AP:0.7536, P-F1:0.7568, P-AUPRO:0.9169
pill: I-Auroc:0.9839, I-AP:0.9972, I-F1:0.9857, P-AUROC:0.9269, P-AP:0.5591, P-F1:0.5732, P-AUPRO:0.9572
screw: I-Auroc:0.9287, I-AP:0.9759, I-F1:0.9112, P-AUROC:0.9920, P-AP:0.6297, P-F1:0.5983, P-AUPRO:0.9701
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.7543, P-F1:0.7288, P-AUPRO:0.9715
transistor: I-Auroc:0.9992, I-AP:0.9988, I-F1:0.9873, P-AUROC:0.9060, P-AP:0.4931, P-F1:0.4948, P-AUPRO:0.7912
zipper: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9958, P-AUROC:0.9781, P-AP:0.6454, P-F1:0.6405, P-AUPRO:0.9390
Mean: I-Auroc:0.9881, I-AP:0.9958, I-F1:0.9825, P-AUROC:0.9714, P-AP:0.6560, P-F1:0.6472, P-AUPRO:0.9389
cuda:2
shots: 8
seed: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7332, P-F1:0.7089, P-AUPRO:0.9777
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9943, P-AP:0.5653, P-F1:0.5855, P-AUPRO:0.9790
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9896, P-AP:0.4208, P-F1:0.4448, P-AUPRO:0.9634
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9756, P-AP:0.7175, P-F1:0.7423, P-AUPRO:0.9031
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9917, P-AUROC:0.9741, P-AP:0.7377, P-F1:0.6937, P-AUPRO:0.9525
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9778, P-AP:0.8244, P-F1:0.7671, P-AUPRO:0.9490
cable: I-Auroc:0.9591, I-AP:0.9791, I-F1:0.9213, P-AUROC:0.9473, P-AP:0.5984, P-F1:0.6262, P-AUPRO:0.8813
capsule: I-Auroc:0.9733, I-AP:0.9939, I-F1:0.9732, P-AUROC:0.9822, P-AP:0.5803, P-F1:0.5671, P-AUPRO:0.9726
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9942, P-AP:0.8253, P-F1:0.7854, P-AUPRO:0.9697
metal_nut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9416, P-AP:0.7344, P-F1:0.7311, P-AUPRO:0.9110
pill: I-Auroc:0.9910, I-AP:0.9985, I-F1:0.9859, P-AUROC:0.9267, P-AP:0.5470, P-F1:0.5665, P-AUPRO:0.9612
screw: I-Auroc:0.9520, I-AP:0.9844, I-F1:0.9310, P-AUROC:0.9932, P-AP:0.6424, P-F1:0.6067, P-AUPRO:0.9727
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.7366, P-F1:0.7063, P-AUPRO:0.9702
transistor: I-Auroc:0.9996, I-AP:0.9994, I-F1:0.9877, P-AUROC:0.9019, P-AP:0.4834, P-F1:0.4862, P-AUPRO:0.7936
zipper: I-Auroc:0.9984, I-AP:0.9996, I-F1:0.9916, P-AUROC:0.9782, P-AP:0.6343, P-F1:0.6379, P-AUPRO:0.9399
Mean: I-Auroc:0.9912, I-AP:0.9969, I-F1:0.9849, P-AUROC:0.9709, P-AP:0.6521, P-F1:0.6437, P-AUPRO:0.9398
cuda:2
shots: 8
seed: 3407
carpet: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9944, P-AUROC:0.9944, P-AP:0.7954, P-F1:0.7339, P-AUPRO:0.9742
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9943, P-AP:0.5646, P-F1:0.5863, P-AUPRO:0.9778
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9906, P-AP:0.4597, P-F1:0.4681, P-AUPRO:0.9670
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9761, P-AP:0.7268, P-F1:0.7432, P-AUPRO:0.8996
wood: I-Auroc:0.9886, I-AP:0.9962, I-F1:0.9836, P-AUROC:0.9698, P-AP:0.7182, P-F1:0.6791, P-AUPRO:0.9473
bottle: I-Auroc:0.9929, I-AP:0.9979, I-F1:0.9764, P-AUROC:0.9777, P-AP:0.8246, P-F1:0.7687, P-AUPRO:0.9498
cable: I-Auroc:0.9442, I-AP:0.9731, I-F1:0.9240, P-AUROC:0.9406, P-AP:0.5881, P-F1:0.6192, P-AUPRO:0.8701
capsule: I-Auroc:0.9701, I-AP:0.9931, I-F1:0.9686, P-AUROC:0.9818, P-AP:0.5992, P-F1:0.5752, P-AUPRO:0.9735
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9945, P-AP:0.8320, P-F1:0.7878, P-AUPRO:0.9737
metal_nut: I-Auroc:0.9985, I-AP:0.9997, I-F1:0.9946, P-AUROC:0.9439, P-AP:0.7463, P-F1:0.7467, P-AUPRO:0.9126
pill: I-Auroc:0.9834, I-AP:0.9970, I-F1:0.9821, P-AUROC:0.9285, P-AP:0.5479, P-F1:0.5633, P-AUPRO:0.9597
screw: I-Auroc:0.9373, I-AP:0.9801, I-F1:0.9120, P-AUROC:0.9910, P-AP:0.6063, P-F1:0.5918, P-AUPRO:0.9661
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9933, P-AP:0.7270, P-F1:0.7098, P-AUPRO:0.9681
transistor: I-Auroc:0.9996, I-AP:0.9994, I-F1:0.9877, P-AUROC:0.9091, P-AP:0.4984, P-F1:0.5008, P-AUPRO:0.8009
zipper: I-Auroc:0.9987, I-AP:0.9996, I-F1:0.9958, P-AUROC:0.9786, P-AP:0.6381, P-F1:0.6419, P-AUPRO:0.9440
Mean: I-Auroc:0.9872, I-AP:0.9956, I-F1:0.9792, P-AUROC:0.9710, P-AP:0.6582, P-F1:0.6477, P-AUPRO:0.9390
cuda:2
shots: 8
seed: 3
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.7262, P-F1:0.7048, P-AUPRO:0.9749
grid: I-Auroc:0.9967, I-AP:0.9988, I-F1:0.9912, P-AUROC:0.9939, P-AP:0.5529, P-F1:0.5748, P-AUPRO:0.9766
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9908, P-AP:0.4424, P-F1:0.4692, P-AUPRO:0.9712
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9760, P-AP:0.7228, P-F1:0.7419, P-AUPRO:0.9041
wood: I-Auroc:0.9921, I-AP:0.9974, I-F1:0.9836, P-AUROC:0.9752, P-AP:0.7705, P-F1:0.7163, P-AUPRO:0.9552
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9775, P-AP:0.8274, P-F1:0.7714, P-AUPRO:0.9465
cable: I-Auroc:0.9704, I-AP:0.9849, I-F1:0.9392, P-AUROC:0.9468, P-AP:0.6108, P-F1:0.6361, P-AUPRO:0.8809
capsule: I-Auroc:0.9828, I-AP:0.9963, I-F1:0.9776, P-AUROC:0.9843, P-AP:0.6081, P-F1:0.5847, P-AUPRO:0.9752
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9946, P-AP:0.8345, P-F1:0.7904, P-AUPRO:0.9723
metal_nut: I-Auroc:0.9961, I-AP:0.9991, I-F1:0.9841, P-AUROC:0.9479, P-AP:0.7562, P-F1:0.7582, P-AUPRO:0.9172
pill: I-Auroc:0.9896, I-AP:0.9983, I-F1:0.9857, P-AUROC:0.9268, P-AP:0.5490, P-F1:0.5701, P-AUPRO:0.9577
screw: I-Auroc:0.9430, I-AP:0.9811, I-F1:0.9218, P-AUROC:0.9916, P-AP:0.6242, P-F1:0.5920, P-AUPRO:0.9686
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9929, P-AP:0.7259, P-F1:0.7013, P-AUPRO:0.9681
transistor: I-Auroc:0.9987, I-AP:0.9981, I-F1:0.9877, P-AUROC:0.9163, P-AP:0.5206, P-F1:0.5175, P-AUPRO:0.8062
zipper: I-Auroc:0.9987, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9801, P-AP:0.6476, P-F1:0.6486, P-AUPRO:0.9430
Mean: I-Auroc:0.9908, I-AP:0.9968, I-F1:0.9829, P-AUROC:0.9725, P-AP:0.6613, P-F1:0.6518, P-AUPRO:0.9412
