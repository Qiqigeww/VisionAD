

-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 1(原始种子 1 )

cuda:4
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.7479, P-F1:0.7256, P-AUPRO:0.9799
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5670, P-F1:0.5819, P-AUPRO:0.9784
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9906, P-AP:0.4353, P-F1:0.4635, P-AUPRO:0.9754
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9753, P-AP:0.7198, P-F1:0.7411, P-AUPRO:0.9038
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9694, P-AP:0.7104, P-F1:0.6881, P-AUPRO:0.9352
bottle: I-Auroc:0.9683, I-AP:0.9914, I-F1:0.9600, P-AUROC:0.9666, P-AP:0.7913, P-F1:0.7434, P-AUPRO:0.9330
cable: I-Auroc:0.9198, I-AP:0.9607, I-F1:0.8889, P-AUROC:0.9281, P-AP:0.5487, P-F1:0.5786, P-AUPRO:0.8445
capsule: I-Auroc:0.9326, I-AP:0.9855, I-F1:0.9391, P-AUROC:0.9757, P-AP:0.5212, P-F1:0.5125, P-AUPRO:0.9616
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9915, P-AP:0.7881, P-F1:0.7554, P-AUPRO:0.9643
metal_nut: I-Auroc:0.9726, I-AP:0.9937, I-F1:0.9588, P-AUROC:0.9099, P-AP:0.6535, P-F1:0.6443, P-AUPRO:0.8725
pill: I-Auroc:0.9820, I-AP:0.9968, I-F1:0.9784, P-AUROC:0.9098, P-AP:0.5254, P-F1:0.5385, P-AUPRO:0.9501
screw: I-Auroc:0.9065, I-AP:0.9666, I-F1:0.9129, P-AUROC:0.9891, P-AP:0.5504, P-F1:0.5498, P-AUPRO:0.9522
toothbrush: I-Auroc:0.9889, I-AP:0.9961, I-F1:0.9831, P-AUROC:0.9921, P-AP:0.7448, P-F1:0.7096, P-AUPRO:0.9512
transistor: I-Auroc:0.9942, I-AP:0.9909, I-F1:0.9630, P-AUROC:0.8705, P-AP:0.4282, P-F1:0.4408, P-AUPRO:0.7492
zipper: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9958, P-AUROC:0.9744, P-AP:0.6270, P-F1:0.6291, P-AUPRO:0.9358
Mean: I-Auroc:0.9768, I-AP:0.9918, I-F1:0.9703, P-AUROC:0.9621, P-AP:0.6240, P-F1:0.6202, P-AUPRO:0.9258
cuda:4
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.7288, P-F1:0.7055, P-AUPRO:0.9788
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5568, P-F1:0.5711, P-AUPRO:0.9760
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4254, P-F1:0.4565, P-AUPRO:0.9734
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9756, P-AP:0.7207, P-F1:0.7416, P-AUPRO:0.9002
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9917, P-AUROC:0.9740, P-AP:0.7173, P-F1:0.6878, P-AUPRO:0.9454
bottle: I-Auroc:0.9825, I-AP:0.9949, I-F1:0.9677, P-AUROC:0.9734, P-AP:0.8099, P-F1:0.7545, P-AUPRO:0.9448
cable: I-Auroc:0.9563, I-AP:0.9777, I-F1:0.9231, P-AUROC:0.9422, P-AP:0.5977, P-F1:0.6247, P-AUPRO:0.8731
capsule: I-Auroc:0.9314, I-AP:0.9848, I-F1:0.9478, P-AUROC:0.9755, P-AP:0.5320, P-F1:0.5196, P-AUPRO:0.9656
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9921, P-AP:0.8027, P-F1:0.7656, P-AUPRO:0.9672
metal_nut: I-Auroc:0.9951, I-AP:0.9988, I-F1:0.9841, P-AUROC:0.9328, P-AP:0.7245, P-F1:0.7227, P-AUPRO:0.9036
pill: I-Auroc:0.9825, I-AP:0.9970, I-F1:0.9784, P-AUROC:0.9174, P-AP:0.5376, P-F1:0.5487, P-AUPRO:0.9553
screw: I-Auroc:0.9180, I-AP:0.9731, I-F1:0.9061, P-AUROC:0.9915, P-AP:0.5873, P-F1:0.5726, P-AUPRO:0.9660
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9913, P-AP:0.7266, P-F1:0.6863, P-AUPRO:0.9618
transistor: I-Auroc:0.9933, I-AP:0.9900, I-F1:0.9620, P-AUROC:0.8842, P-AP:0.4482, P-F1:0.4591, P-AUPRO:0.7651
zipper: I-Auroc:0.9989, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9756, P-AP:0.6411, P-F1:0.6388, P-AUPRO:0.9347
Mean: I-Auroc:0.9826, I-AP:0.9940, I-F1:0.9754, P-AUROC:0.9669, P-AP:0.6371, P-F1:0.6303, P-AUPRO:0.9341
cuda:4
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.7280, P-F1:0.7067, P-AUPRO:0.9783
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9938, P-AP:0.5559, P-F1:0.5693, P-AUPRO:0.9752
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9899, P-AP:0.4152, P-F1:0.4436, P-AUPRO:0.9672
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9758, P-AP:0.7217, P-F1:0.7419, P-AUPRO:0.9021
wood: I-Auroc:0.9904, I-AP:0.9967, I-F1:0.9917, P-AUROC:0.9735, P-AP:0.7172, P-F1:0.6897, P-AUPRO:0.9432
bottle: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9920, P-AUROC:0.9764, P-AP:0.8214, P-F1:0.7635, P-AUPRO:0.9495
cable: I-Auroc:0.9620, I-AP:0.9798, I-F1:0.9371, P-AUROC:0.9454, P-AP:0.6036, P-F1:0.6308, P-AUPRO:0.8786
capsule: I-Auroc:0.9697, I-AP:0.9931, I-F1:0.9689, P-AUROC:0.9788, P-AP:0.5706, P-F1:0.5623, P-AUPRO:0.9703
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.8191, P-F1:0.7749, P-AUPRO:0.9727
metal_nut: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9947, P-AUROC:0.9386, P-AP:0.7470, P-F1:0.7477, P-AUPRO:0.9083
pill: I-Auroc:0.9823, I-AP:0.9969, I-F1:0.9784, P-AUROC:0.9205, P-AP:0.5405, P-F1:0.5550, P-AUPRO:0.9561
screw: I-Auroc:0.9166, I-AP:0.9710, I-F1:0.9163, P-AUROC:0.9919, P-AP:0.5983, P-F1:0.5792, P-AUPRO:0.9659
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9935, P-AP:0.7397, P-F1:0.7156, P-AUPRO:0.9696
transistor: I-Auroc:0.9979, I-AP:0.9970, I-F1:0.9750, P-AUROC:0.8905, P-AP:0.4547, P-F1:0.4638, P-AUPRO:0.7783
zipper: I-Auroc:0.9976, I-AP:0.9993, I-F1:0.9958, P-AUROC:0.9773, P-AP:0.6388, P-F1:0.6368, P-AUPRO:0.9391
Mean: I-Auroc:0.9872, I-AP:0.9954, I-F1:0.9827, P-AUROC:0.9689, P-AP:0.6448, P-F1:0.6387, P-AUPRO:0.9370








-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 111

cuda:5
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.7511, P-F1:0.7260, P-AUPRO:0.9805
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9931, P-AP:0.5327, P-F1:0.5591, P-AUPRO:0.9658
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9913, P-AP:0.4700, P-F1:0.4847, P-AUPRO:0.9776
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9882, P-AUROC:0.9756, P-AP:0.7232, P-F1:0.7466, P-AUPRO:0.9076
wood: I-Auroc:0.9886, I-AP:0.9961, I-F1:0.9836, P-AUROC:0.9687, P-AP:0.6967, P-F1:0.6723, P-AUPRO:0.9444
bottle: I-Auroc:0.9825, I-AP:0.9950, I-F1:0.9756, P-AUROC:0.9700, P-AP:0.8020, P-F1:0.7511, P-AUPRO:0.9372
cable: I-Auroc:0.9481, I-AP:0.9744, I-F1:0.9180, P-AUROC:0.9387, P-AP:0.5393, P-F1:0.5592, P-AUPRO:0.8528
capsule: I-Auroc:0.9589, I-AP:0.9910, I-F1:0.9636, P-AUROC:0.9752, P-AP:0.5555, P-F1:0.5467, P-AUPRO:0.9626
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.8046, P-F1:0.7763, P-AUPRO:0.9718
metal_nut: I-Auroc:0.9726, I-AP:0.9940, I-F1:0.9565, P-AUROC:0.9082, P-AP:0.6244, P-F1:0.6151, P-AUPRO:0.8652
pill: I-Auroc:0.9815, I-AP:0.9968, I-F1:0.9751, P-AUROC:0.9184, P-AP:0.5309, P-F1:0.5397, P-AUPRO:0.9544
screw: I-Auroc:0.7397, I-AP:0.9034, I-F1:0.8623, P-AUROC:0.9760, P-AP:0.4102, P-F1:0.4716, P-AUPRO:0.9123
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9918, P-AP:0.7072, P-F1:0.6954, P-AUPRO:0.9617
transistor: I-Auroc:0.9867, I-AP:0.9806, I-F1:0.9268, P-AUROC:0.8577, P-AP:0.4284, P-F1:0.4455, P-AUPRO:0.7266
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9799, P-AP:0.6588, P-F1:0.6573, P-AUPRO:0.9465
Mean: I-Auroc:0.9699, I-AP:0.9885, I-F1:0.9683, P-AUROC:0.9621, P-AP:0.6157, P-F1:0.6164, P-AUPRO:0.9245
cuda:5
shots: 2
carpet: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9944, P-AUROC:0.9941, P-AP:0.7525, P-F1:0.7257, P-AUPRO:0.9793
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5522, P-F1:0.5708, P-AUPRO:0.9718
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9907, P-AP:0.4502, P-F1:0.4717, P-AUPRO:0.9714
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9755, P-AP:0.7221, P-F1:0.7437, P-AUPRO:0.9060
wood: I-Auroc:0.9860, I-AP:0.9950, I-F1:0.9917, P-AUROC:0.9702, P-AP:0.6946, P-F1:0.6662, P-AUPRO:0.9419
bottle: I-Auroc:0.9929, I-AP:0.9978, I-F1:0.9767, P-AUROC:0.9740, P-AP:0.8109, P-F1:0.7581, P-AUPRO:0.9433
cable: I-Auroc:0.9548, I-AP:0.9766, I-F1:0.9239, P-AUROC:0.9434, P-AP:0.5767, P-F1:0.6018, P-AUPRO:0.8704
capsule: I-Auroc:0.9601, I-AP:0.9914, I-F1:0.9581, P-AUROC:0.9738, P-AP:0.5599, P-F1:0.5565, P-AUPRO:0.9648
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.8124, P-F1:0.7787, P-AUPRO:0.9752
metal_nut: I-Auroc:0.9726, I-AP:0.9940, I-F1:0.9613, P-AUROC:0.9177, P-AP:0.6603, P-F1:0.6476, P-AUPRO:0.8717
pill: I-Auroc:0.9809, I-AP:0.9967, I-F1:0.9754, P-AUROC:0.9209, P-AP:0.5334, P-F1:0.5477, P-AUPRO:0.9556
screw: I-Auroc:0.8897, I-AP:0.9646, I-F1:0.8870, P-AUROC:0.9892, P-AP:0.5768, P-F1:0.5696, P-AUPRO:0.9524
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9909, P-AP:0.6935, P-F1:0.6705, P-AUPRO:0.9659
transistor: I-Auroc:0.9867, I-AP:0.9794, I-F1:0.9383, P-AUROC:0.8824, P-AP:0.4596, P-F1:0.4690, P-AUPRO:0.7650
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9794, P-AP:0.6463, P-F1:0.6491, P-AUPRO:0.9460
Mean: I-Auroc:0.9811, I-AP:0.9929, I-F1:0.9728, P-AUROC:0.9660, P-AP:0.6334, P-F1:0.6285, P-AUPRO:0.9320
cuda:5
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9939, P-AP:0.7478, P-F1:0.7184, P-AUPRO:0.9789
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5529, P-F1:0.5664, P-AUPRO:0.9706
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4377, P-F1:0.4597, P-AUPRO:0.9687
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9757, P-AP:0.7237, P-F1:0.7437, P-AUPRO:0.9011
wood: I-Auroc:0.9912, I-AP:0.9971, I-F1:0.9836, P-AUROC:0.9740, P-AP:0.7244, P-F1:0.6863, P-AUPRO:0.9533
bottle: I-Auroc:0.9929, I-AP:0.9978, I-F1:0.9767, P-AUROC:0.9756, P-AP:0.8180, P-F1:0.7627, P-AUPRO:0.9473
cable: I-Auroc:0.9681, I-AP:0.9838, I-F1:0.9348, P-AUROC:0.9457, P-AP:0.5778, P-F1:0.6048, P-AUPRO:0.8716
capsule: I-Auroc:0.9633, I-AP:0.9923, I-F1:0.9561, P-AUROC:0.9777, P-AP:0.5786, P-F1:0.5665, P-AUPRO:0.9667
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.8099, P-F1:0.7779, P-AUPRO:0.9733
metal_nut: I-Auroc:0.9819, I-AP:0.9959, I-F1:0.9670, P-AUROC:0.9202, P-AP:0.6679, P-F1:0.6631, P-AUPRO:0.8822
pill: I-Auroc:0.9869, I-AP:0.9978, I-F1:0.9787, P-AUROC:0.9272, P-AP:0.5503, P-F1:0.5599, P-AUPRO:0.9577
screw: I-Auroc:0.9233, I-AP:0.9760, I-F1:0.9099, P-AUROC:0.9915, P-AP:0.5976, P-F1:0.5829, P-AUPRO:0.9647
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9922, P-AP:0.7032, P-F1:0.6828, P-AUPRO:0.9710
transistor: I-Auroc:0.9983, I-AP:0.9975, I-F1:0.9877, P-AUROC:0.8825, P-AP:0.4523, P-F1:0.4585, P-AUPRO:0.7760
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9786, P-AP:0.6411, P-F1:0.6433, P-AUPRO:0.9408
Mean: I-Auroc:0.9867, I-AP:0.9957, I-F1:0.9787, P-AUROC:0.9675, P-AP:0.6389, P-F1:0.6318, P-AUPRO:0.9349




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 0

cuda:5
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7449, P-F1:0.7158, P-AUPRO:0.9787
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9940, P-AP:0.5594, P-F1:0.5769, P-AUPRO:0.9758
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9918, P-AP:0.4692, P-F1:0.4965, P-AUPRO:0.9788
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9755, P-AP:0.7204, P-F1:0.7430, P-AUPRO:0.9133
wood: I-Auroc:0.9798, I-AP:0.9931, I-F1:0.9752, P-AUROC:0.9694, P-AP:0.7516, P-F1:0.6940, P-AUPRO:0.9533
bottle: I-Auroc:0.9706, I-AP:0.9918, I-F1:0.9600, P-AUROC:0.9650, P-AP:0.7825, P-F1:0.7317, P-AUPRO:0.9281
cable: I-Auroc:0.9432, I-AP:0.9722, I-F1:0.9171, P-AUROC:0.9376, P-AP:0.5639, P-F1:0.5770, P-AUPRO:0.8659
capsule: I-Auroc:0.9342, I-AP:0.9851, I-F1:0.9478, P-AUROC:0.9734, P-AP:0.5282, P-F1:0.5228, P-AUPRO:0.9609
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9929, P-AP:0.8071, P-F1:0.7705, P-AUPRO:0.9627
metal_nut: I-Auroc:0.9457, I-AP:0.9875, I-F1:0.9412, P-AUROC:0.8502, P-AP:0.5015, P-F1:0.5087, P-AUPRO:0.8176
pill: I-Auroc:0.9768, I-AP:0.9959, I-F1:0.9650, P-AUROC:0.9210, P-AP:0.5149, P-F1:0.5281, P-AUPRO:0.9536
screw: I-Auroc:0.7389, I-AP:0.8991, I-F1:0.8755, P-AUROC:0.9726, P-AP:0.4463, P-F1:0.4985, P-AUPRO:0.9063
toothbrush: I-Auroc:0.9833, I-AP:0.9938, I-F1:0.9655, P-AUROC:0.9896, P-AP:0.7019, P-F1:0.6670, P-AUPRO:0.9596
transistor: I-Auroc:0.9958, I-AP:0.9933, I-F1:0.9756, P-AUROC:0.8798, P-AP:0.4336, P-F1:0.4405, P-AUPRO:0.7360
zipper: I-Auroc:0.9680, I-AP:0.9891, I-F1:0.9794, P-AUROC:0.9721, P-AP:0.5787, P-F1:0.5830, P-AUPRO:0.9267
Mean: I-Auroc:0.9615, I-AP:0.9865, I-F1:0.9658, P-AUROC:0.9586, P-AP:0.6069, P-F1:0.6036, P-AUPRO:0.9211
cuda:5
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7437, P-F1:0.7135, P-AUPRO:0.9783
grid: I-Auroc:0.9883, I-AP:0.9965, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5594, P-F1:0.5776, P-AUPRO:0.9767
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9910, P-AP:0.4344, P-F1:0.4743, P-AUPRO:0.9750
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9751, P-AP:0.7151, P-F1:0.7388, P-AUPRO:0.9051
wood: I-Auroc:0.9789, I-AP:0.9928, I-F1:0.9756, P-AUROC:0.9704, P-AP:0.7425, P-F1:0.6889, P-AUPRO:0.9493
bottle: I-Auroc:0.9802, I-AP:0.9943, I-F1:0.9683, P-AUROC:0.9703, P-AP:0.7983, P-F1:0.7437, P-AUPRO:0.9372
cable: I-Auroc:0.9378, I-AP:0.9702, I-F1:0.9249, P-AUROC:0.9401, P-AP:0.6011, P-F1:0.6227, P-AUPRO:0.8794
capsule: I-Auroc:0.9406, I-AP:0.9869, I-F1:0.9561, P-AUROC:0.9752, P-AP:0.5407, P-F1:0.5221, P-AUPRO:0.9638
hazelnut: I-Auroc:0.9996, I-AP:0.9998, I-F1:0.9929, P-AUROC:0.9933, P-AP:0.8117, P-F1:0.7741, P-AUPRO:0.9676
metal_nut: I-Auroc:0.9756, I-AP:0.9947, I-F1:0.9617, P-AUROC:0.9092, P-AP:0.6347, P-F1:0.6269, P-AUPRO:0.8754
pill: I-Auroc:0.9834, I-AP:0.9972, I-F1:0.9747, P-AUROC:0.9250, P-AP:0.5347, P-F1:0.5544, P-AUPRO:0.9579
screw: I-Auroc:0.8887, I-AP:0.9604, I-F1:0.9084, P-AUROC:0.9862, P-AP:0.5601, P-F1:0.5603, P-AUPRO:0.9525
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9919, P-AP:0.7034, P-F1:0.6929, P-AUPRO:0.9643
transistor: I-Auroc:0.9983, I-AP:0.9976, I-F1:0.9750, P-AUROC:0.8946, P-AP:0.4609, P-F1:0.4637, P-AUPRO:0.7672
zipper: I-Auroc:0.9656, I-AP:0.9881, I-F1:0.9794, P-AUROC:0.9734, P-AP:0.5881, P-F1:0.5903, P-AUPRO:0.9259
Mean: I-Auroc:0.9757, I-AP:0.9919, I-F1:0.9735, P-AUROC:0.9656, P-AP:0.6286, P-F1:0.6229, P-AUPRO:0.9317
cuda:5
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9938, P-AP:0.7493, P-F1:0.7140, P-AUPRO:0.9768
grid: I-Auroc:0.9900, I-AP:0.9969, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5633, P-F1:0.5781, P-AUPRO:0.9791
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4297, P-F1:0.4616, P-AUPRO:0.9656
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9749, P-AP:0.7135, P-F1:0.7382, P-AUPRO:0.9004
wood: I-Auroc:0.9833, I-AP:0.9943, I-F1:0.9836, P-AUROC:0.9712, P-AP:0.7402, P-F1:0.6903, P-AUPRO:0.9517
bottle: I-Auroc:0.9937, I-AP:0.9980, I-F1:0.9764, P-AUROC:0.9739, P-AP:0.8103, P-F1:0.7546, P-AUPRO:0.9428
cable: I-Auroc:0.9442, I-AP:0.9731, I-F1:0.9310, P-AUROC:0.9433, P-AP:0.6040, P-F1:0.6299, P-AUPRO:0.8765
capsule: I-Auroc:0.9761, I-AP:0.9946, I-F1:0.9776, P-AUROC:0.9801, P-AP:0.5844, P-F1:0.5648, P-AUPRO:0.9700
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9944, P-AP:0.8320, P-F1:0.7869, P-AUPRO:0.9679
metal_nut: I-Auroc:0.9873, I-AP:0.9971, I-F1:0.9684, P-AUROC:0.9311, P-AP:0.6960, P-F1:0.6953, P-AUPRO:0.9014
pill: I-Auroc:0.9875, I-AP:0.9979, I-F1:0.9823, P-AUROC:0.9244, P-AP:0.5421, P-F1:0.5583, P-AUPRO:0.9570
screw: I-Auroc:0.9641, I-AP:0.9889, I-F1:0.9378, P-AUROC:0.9905, P-AP:0.6077, P-F1:0.5835, P-AUPRO:0.9653
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9918, P-AP:0.7043, P-F1:0.6914, P-AUPRO:0.9681
transistor: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9009, P-AP:0.4796, P-F1:0.4816, P-AUPRO:0.7787
zipper: I-Auroc:0.9761, I-AP:0.9923, I-F1:0.9793, P-AUROC:0.9729, P-AP:0.5850, P-F1:0.5942, P-AUPRO:0.9278
Mean: I-Auroc:0.9868, I-AP:0.9955, I-F1:0.9814, P-AUROC:0.9685, P-AP:0.6428, P-F1:0.6349, P-AUPRO:0.9353




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 1234

cuda:5
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7385, P-F1:0.7164, P-AUPRO:0.9804
grid: I-Auroc:0.9908, I-AP:0.9972, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5631, P-F1:0.5865, P-AUPRO:0.9784
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4346, P-F1:0.4609, P-AUPRO:0.9685
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9755, P-AP:0.7212, P-F1:0.7430, P-AUPRO:0.9151
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9617, P-AP:0.6814, P-F1:0.6703, P-AUPRO:0.9451
bottle: I-Auroc:0.9817, I-AP:0.9947, I-F1:0.9672, P-AUROC:0.9650, P-AP:0.7898, P-F1:0.7404, P-AUPRO:0.9329
cable: I-Auroc:0.9297, I-AP:0.9662, I-F1:0.9112, P-AUROC:0.9367, P-AP:0.5520, P-F1:0.5658, P-AUPRO:0.8557
capsule: I-Auroc:0.9294, I-AP:0.9852, I-F1:0.9352, P-AUROC:0.9721, P-AP:0.4999, P-F1:0.4945, P-AUPRO:0.9561
hazelnut: I-Auroc:0.9261, I-AP:0.9624, I-F1:0.8921, P-AUROC:0.9855, P-AP:0.7206, P-F1:0.6681, P-AUPRO:0.9158
metal_nut: I-Auroc:0.9780, I-AP:0.9952, I-F1:0.9617, P-AUROC:0.8998, P-AP:0.6277, P-F1:0.6092, P-AUPRO:0.8663
pill: I-Auroc:0.9774, I-AP:0.9962, I-F1:0.9712, P-AUROC:0.9024, P-AP:0.5009, P-F1:0.5252, P-AUPRO:0.9517
screw: I-Auroc:0.7426, I-AP:0.9069, I-F1:0.8592, P-AUROC:0.9788, P-AP:0.4754, P-F1:0.5105, P-AUPRO:0.9194
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9917, P-AP:0.6949, P-F1:0.6974, P-AUPRO:0.9592
transistor: I-Auroc:0.9888, I-AP:0.9837, I-F1:0.9487, P-AUROC:0.8241, P-AP:0.3432, P-F1:0.3734, P-AUPRO:0.6937
zipper: I-Auroc:0.9987, I-AP:0.9996, I-F1:0.9958, P-AUROC:0.9793, P-AP:0.6431, P-F1:0.6468, P-AUPRO:0.9448
Mean: I-Auroc:0.9626, I-AP:0.9857, I-F1:0.9608, P-AUROC:0.9567, P-AP:0.5991, P-F1:0.6006, P-AUPRO:0.9189
cuda:5
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.7492, P-F1:0.7218, P-AUPRO:0.9794
grid: I-Auroc:0.9958, I-AP:0.9986, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5504, P-F1:0.5797, P-AUPRO:0.9772
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9898, P-AP:0.4120, P-F1:0.4444, P-AUPRO:0.9651
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9753, P-AP:0.7200, P-F1:0.7419, P-AUPRO:0.9032
wood: I-Auroc:0.9947, I-AP:0.9983, I-F1:0.9836, P-AUROC:0.9666, P-AP:0.6937, P-F1:0.6729, P-AUPRO:0.9465
bottle: I-Auroc:0.9897, I-AP:0.9969, I-F1:0.9756, P-AUROC:0.9713, P-AP:0.8059, P-F1:0.7537, P-AUPRO:0.9403
cable: I-Auroc:0.9400, I-AP:0.9725, I-F1:0.9318, P-AUROC:0.9383, P-AP:0.5754, P-F1:0.5969, P-AUPRO:0.8616
capsule: I-Auroc:0.9258, I-AP:0.9836, I-F1:0.9478, P-AUROC:0.9774, P-AP:0.5307, P-F1:0.5119, P-AUPRO:0.9623
hazelnut: I-Auroc:0.9968, I-AP:0.9983, I-F1:0.9855, P-AUROC:0.9929, P-AP:0.8276, P-F1:0.7789, P-AUPRO:0.9552
metal_nut: I-Auroc:0.9761, I-AP:0.9946, I-F1:0.9565, P-AUROC:0.9100, P-AP:0.6415, P-F1:0.6296, P-AUPRO:0.8736
pill: I-Auroc:0.9787, I-AP:0.9963, I-F1:0.9680, P-AUROC:0.9130, P-AP:0.5222, P-F1:0.5413, P-AUPRO:0.9549
screw: I-Auroc:0.8254, I-AP:0.9390, I-F1:0.8735, P-AUROC:0.9861, P-AP:0.5371, P-F1:0.5460, P-AUPRO:0.9452
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9920, P-AP:0.7061, P-F1:0.6929, P-AUPRO:0.9698
transistor: I-Auroc:0.9921, I-AP:0.9865, I-F1:0.9630, P-AUROC:0.8552, P-AP:0.3806, P-F1:0.4039, P-AUPRO:0.7190
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9958, P-AUROC:0.9766, P-AP:0.6312, P-F1:0.6363, P-AUPRO:0.9369
Mean: I-Auroc:0.9743, I-AP:0.9910, I-F1:0.9711, P-AUROC:0.9622, P-AP:0.6189, P-F1:0.6168, P-AUPRO:0.9260
cuda:5
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9938, P-AP:0.7409, P-F1:0.7151, P-AUPRO:0.9785
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9945, P-AP:0.5680, P-F1:0.5933, P-AUPRO:0.9790
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9889, P-AP:0.4352, P-F1:0.4496, P-AUPRO:0.9521
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9762, P-AP:0.7290, P-F1:0.7439, P-AUPRO:0.9076
wood: I-Auroc:0.9939, I-AP:0.9980, I-F1:0.9917, P-AUROC:0.9716, P-AP:0.6958, P-F1:0.6740, P-AUPRO:0.9477
bottle: I-Auroc:0.9929, I-AP:0.9979, I-F1:0.9764, P-AUROC:0.9747, P-AP:0.8146, P-F1:0.7594, P-AUPRO:0.9444
cable: I-Auroc:0.9734, I-AP:0.9858, I-F1:0.9438, P-AUROC:0.9454, P-AP:0.5997, P-F1:0.6284, P-AUPRO:0.8795
capsule: I-Auroc:0.9705, I-AP:0.9935, I-F1:0.9689, P-AUROC:0.9824, P-AP:0.5879, P-F1:0.5680, P-AUPRO:0.9740
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9943, P-AP:0.8356, P-F1:0.7901, P-AUPRO:0.9697
metal_nut: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9894, P-AUROC:0.9447, P-AP:0.7499, P-F1:0.7532, P-AUPRO:0.9135
pill: I-Auroc:0.9834, I-AP:0.9971, I-F1:0.9751, P-AUROC:0.9216, P-AP:0.5380, P-F1:0.5553, P-AUPRO:0.9553
screw: I-Auroc:0.8303, I-AP:0.9396, I-F1:0.8788, P-AUROC:0.9854, P-AP:0.5314, P-F1:0.5454, P-AUPRO:0.9441
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.7232, P-F1:0.6960, P-AUPRO:0.9698
transistor: I-Auroc:0.9938, I-AP:0.9891, I-F1:0.9756, P-AUROC:0.8855, P-AP:0.4574, P-F1:0.4681, P-AUPRO:0.7654
zipper: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9788, P-AP:0.6476, P-F1:0.6487, P-AUPRO:0.9423
Mean: I-Auroc:0.9819, I-AP:0.9932, I-F1:0.9783, P-AUROC:0.9687, P-AP:0.6436, P-F1:0.6392, P-AUPRO:0.9349






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 42

cuda:0
shots: 1
carpet: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9944, P-AUROC:0.9937, P-AP:0.7428, P-F1:0.7194, P-AUPRO:0.9778
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9919, P-AP:0.5315, P-F1:0.5462, P-AUPRO:0.9682
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4310, P-F1:0.4563, P-AUPRO:0.9676
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9940, P-AUROC:0.9764, P-AP:0.7275, P-F1:0.7456, P-AUPRO:0.9125
wood: I-Auroc:0.9763, I-AP:0.9910, I-F1:0.9756, P-AUROC:0.9637, P-AP:0.6847, P-F1:0.6629, P-AUPRO:0.9402
bottle: I-Auroc:0.9897, I-AP:0.9968, I-F1:0.9692, P-AUROC:0.9700, P-AP:0.7999, P-F1:0.7538, P-AUPRO:0.9367
cable: I-Auroc:0.9310, I-AP:0.9656, I-F1:0.8977, P-AUROC:0.9347, P-AP:0.5817, P-F1:0.6111, P-AUPRO:0.8658
capsule: I-Auroc:0.9346, I-AP:0.9859, I-F1:0.9439, P-AUROC:0.9683, P-AP:0.5228, P-F1:0.5247, P-AUPRO:0.9553
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9926, P-AP:0.7935, P-F1:0.7562, P-AUPRO:0.9723
metal_nut: I-Auroc:0.9599, I-AP:0.9910, I-F1:0.9462, P-AUROC:0.9082, P-AP:0.6197, P-F1:0.6218, P-AUPRO:0.8665
pill: I-Auroc:0.9825, I-AP:0.9970, I-F1:0.9786, P-AUROC:0.9222, P-AP:0.5334, P-F1:0.5460, P-AUPRO:0.9544
screw: I-Auroc:0.8553, I-AP:0.9503, I-F1:0.8779, P-AUROC:0.9883, P-AP:0.5610, P-F1:0.5572, P-AUPRO:0.9507
toothbrush: I-Auroc:0.9917, I-AP:0.9967, I-F1:0.9836, P-AUROC:0.9853, P-AP:0.5955, P-F1:0.6201, P-AUPRO:0.9487
transistor: I-Auroc:0.9733, I-AP:0.9417, I-F1:0.9195, P-AUROC:0.8624, P-AP:0.4046, P-F1:0.4281, P-AUPRO:0.7425
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9779, P-AP:0.6584, P-F1:0.6583, P-AUPRO:0.9425
Mean: I-Auroc:0.9719, I-AP:0.9874, I-F1:0.9648, P-AUROC:0.9617, P-AP:0.6125, P-F1:0.6138, P-AUPRO:0.9268
cuda:0
shots: 2
carpet: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9944, P-AUROC:0.9937, P-AP:0.7533, P-F1:0.7130, P-AUPRO:0.9780
grid: I-Auroc:0.9858, I-AP:0.9960, I-F1:0.9912, P-AUROC:0.9936, P-AP:0.5520, P-F1:0.5627, P-AUPRO:0.9745
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4285, P-F1:0.4566, P-AUPRO:0.9661
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9882, P-AUROC:0.9762, P-AP:0.7223, P-F1:0.7443, P-AUPRO:0.9098
wood: I-Auroc:0.9904, I-AP:0.9969, I-F1:0.9756, P-AUROC:0.9680, P-AP:0.7070, P-F1:0.6768, P-AUPRO:0.9450
bottle: I-Auroc:0.9937, I-AP:0.9980, I-F1:0.9767, P-AUROC:0.9743, P-AP:0.8128, P-F1:0.7621, P-AUPRO:0.9432
cable: I-Auroc:0.9567, I-AP:0.9777, I-F1:0.9266, P-AUROC:0.9415, P-AP:0.5928, P-F1:0.6203, P-AUPRO:0.8771
capsule: I-Auroc:0.9238, I-AP:0.9824, I-F1:0.9478, P-AUROC:0.9746, P-AP:0.5403, P-F1:0.5264, P-AUPRO:0.9629
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.8278, P-F1:0.7759, P-AUPRO:0.9694
metal_nut: I-Auroc:0.9692, I-AP:0.9932, I-F1:0.9551, P-AUROC:0.9224, P-AP:0.6663, P-F1:0.6640, P-AUPRO:0.8877
pill: I-Auroc:0.9779, I-AP:0.9962, I-F1:0.9786, P-AUROC:0.9260, P-AP:0.5452, P-F1:0.5574, P-AUPRO:0.9575
screw: I-Auroc:0.8707, I-AP:0.9558, I-F1:0.8828, P-AUROC:0.9891, P-AP:0.5699, P-F1:0.5661, P-AUPRO:0.9500
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.6576, P-F1:0.6695, P-AUPRO:0.9580
transistor: I-Auroc:0.9937, I-AP:0.9888, I-F1:0.9877, P-AUROC:0.8550, P-AP:0.3912, P-F1:0.4092, P-AUPRO:0.7333
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9790, P-AP:0.6543, P-F1:0.6540, P-AUPRO:0.9437
Mean: I-Auroc:0.9773, I-AP:0.9923, I-F1:0.9736, P-AUROC:0.9645, P-AP:0.6281, P-F1:0.6239, P-AUPRO:0.9304
cuda:0
shots: 4
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9944, P-AUROC:0.9938, P-AP:0.7489, P-F1:0.7131, P-AUPRO:0.9765
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5515, P-F1:0.5624, P-AUPRO:0.9743
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9902, P-AP:0.4279, P-F1:0.4614, P-AUPRO:0.9688
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9882, P-AUROC:0.9781, P-AP:0.7590, P-F1:0.7497, P-AUPRO:0.9063
wood: I-Auroc:0.9895, I-AP:0.9965, I-F1:0.9836, P-AUROC:0.9701, P-AP:0.7179, P-F1:0.6838, P-AUPRO:0.9487
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9773, P-AP:0.8235, P-F1:0.7727, P-AUPRO:0.9483
cable: I-Auroc:0.9605, I-AP:0.9796, I-F1:0.9371, P-AUROC:0.9434, P-AP:0.5989, P-F1:0.6213, P-AUPRO:0.8769
capsule: I-Auroc:0.9649, I-AP:0.9919, I-F1:0.9643, P-AUROC:0.9799, P-AP:0.5796, P-F1:0.5623, P-AUPRO:0.9704
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.8302, P-F1:0.7733, P-AUPRO:0.9672
metal_nut: I-Auroc:0.9848, I-AP:0.9966, I-F1:0.9727, P-AUROC:0.9377, P-AP:0.7145, P-F1:0.7141, P-AUPRO:0.9056
pill: I-Auroc:0.9809, I-AP:0.9967, I-F1:0.9751, P-AUROC:0.9273, P-AP:0.5440, P-F1:0.5573, P-AUPRO:0.9580
screw: I-Auroc:0.9010, I-AP:0.9660, I-F1:0.9032, P-AUROC:0.9910, P-AP:0.5927, P-F1:0.5807, P-AUPRO:0.9590
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9923, P-AP:0.7013, P-F1:0.6997, P-AUPRO:0.9618
transistor: I-Auroc:0.9967, I-AP:0.9950, I-F1:0.9750, P-AUROC:0.8728, P-AP:0.4228, P-F1:0.4367, P-AUPRO:0.7492
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9809, P-AP:0.6649, P-F1:0.6605, P-AUPRO:0.9504
Mean: I-Auroc:0.9836, I-AP:0.9943, I-F1:0.9779, P-AUROC:0.9681, P-AP:0.6452, P-F1:0.6366, P-AUPRO:0.9348




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 4

cuda:0
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9932, P-AP:0.7427, P-F1:0.7046, P-AUPRO:0.9778
grid: I-Auroc:0.9950, I-AP:0.9983, I-F1:0.9912, P-AUROC:0.9940, P-AP:0.5528, P-F1:0.5742, P-AUPRO:0.9777
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9892, P-AP:0.4208, P-F1:0.4365, P-AUPRO:0.9589
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9882, P-AUROC:0.9757, P-AP:0.7240, P-F1:0.7434, P-AUPRO:0.9108
wood: I-Auroc:0.9798, I-AP:0.9933, I-F1:0.9752, P-AUROC:0.9714, P-AP:0.7695, P-F1:0.7135, P-AUPRO:0.9466
bottle: I-Auroc:0.9921, I-AP:0.9976, I-F1:0.9756, P-AUROC:0.9713, P-AP:0.8053, P-F1:0.7558, P-AUPRO:0.9346
cable: I-Auroc:0.9245, I-AP:0.9619, I-F1:0.8916, P-AUROC:0.9322, P-AP:0.5315, P-F1:0.5497, P-AUPRO:0.8463
capsule: I-Auroc:0.9685, I-AP:0.9931, I-F1:0.9646, P-AUROC:0.9747, P-AP:0.5476, P-F1:0.5445, P-AUPRO:0.9647
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9916, P-AP:0.8096, P-F1:0.7663, P-AUPRO:0.9609
metal_nut: I-Auroc:0.9526, I-AP:0.9894, I-F1:0.9341, P-AUROC:0.9026, P-AP:0.6129, P-F1:0.6100, P-AUPRO:0.8629
pill: I-Auroc:0.9771, I-AP:0.9961, I-F1:0.9677, P-AUROC:0.9162, P-AP:0.5157, P-F1:0.5377, P-AUPRO:0.9523
screw: I-Auroc:0.7950, I-AP:0.9283, I-F1:0.8708, P-AUROC:0.9815, P-AP:0.4969, P-F1:0.5231, P-AUPRO:0.9301
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9906, P-AP:0.7063, P-F1:0.6745, P-AUPRO:0.9590
transistor: I-Auroc:0.9829, I-AP:0.9809, I-F1:0.9383, P-AUROC:0.8663, P-AP:0.4102, P-F1:0.4331, P-AUPRO:0.7163
zipper: I-Auroc:0.9968, I-AP:0.9991, I-F1:0.9916, P-AUROC:0.9736, P-AP:0.6204, P-F1:0.6169, P-AUPRO:0.9311
Mean: I-Auroc:0.9703, I-AP:0.9890, I-F1:0.9648, P-AUROC:0.9616, P-AP:0.6178, P-F1:0.6123, P-AUPRO:0.9220
cuda:0
shots: 2
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7433, P-F1:0.7097, P-AUPRO:0.9767
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9937, P-AP:0.5472, P-F1:0.5677, P-AUPRO:0.9756
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9904, P-AP:0.4370, P-F1:0.4643, P-AUPRO:0.9649
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9758, P-AP:0.7216, P-F1:0.7450, P-AUPRO:0.9029
wood: I-Auroc:0.9816, I-AP:0.9938, I-F1:0.9677, P-AUROC:0.9712, P-AP:0.7653, P-F1:0.7156, P-AUPRO:0.9492
bottle: I-Auroc:0.9937, I-AP:0.9981, I-F1:0.9764, P-AUROC:0.9748, P-AP:0.8146, P-F1:0.7612, P-AUPRO:0.9434
cable: I-Auroc:0.9325, I-AP:0.9657, I-F1:0.8994, P-AUROC:0.9375, P-AP:0.5765, P-F1:0.6064, P-AUPRO:0.8662
capsule: I-Auroc:0.9769, I-AP:0.9948, I-F1:0.9776, P-AUROC:0.9801, P-AP:0.5801, P-F1:0.5637, P-AUPRO:0.9701
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.8236, P-F1:0.7811, P-AUPRO:0.9714
metal_nut: I-Auroc:0.9707, I-AP:0.9935, I-F1:0.9551, P-AUROC:0.9267, P-AP:0.6826, P-F1:0.6820, P-AUPRO:0.8907
pill: I-Auroc:0.9839, I-AP:0.9973, I-F1:0.9783, P-AUROC:0.9166, P-AP:0.5257, P-F1:0.5438, P-AUPRO:0.9533
screw: I-Auroc:0.9231, I-AP:0.9752, I-F1:0.9091, P-AUROC:0.9898, P-AP:0.5717, P-F1:0.5671, P-AUPRO:0.9588
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9905, P-AP:0.6970, P-F1:0.6770, P-AUPRO:0.9615
transistor: I-Auroc:0.9896, I-AP:0.9869, I-F1:0.9512, P-AUROC:0.8982, P-AP:0.4608, P-F1:0.4728, P-AUPRO:0.7580
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9958, P-AUROC:0.9791, P-AP:0.6512, P-F1:0.6534, P-AUPRO:0.9415
Mean: I-Auroc:0.9823, I-AP:0.9933, I-F1:0.9715, P-AUROC:0.9674, P-AP:0.6399, P-F1:0.6341, P-AUPRO:0.9323
cuda:0
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7385, P-F1:0.7091, P-AUPRO:0.9759
grid: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9941, P-AP:0.5583, P-F1:0.5760, P-AUPRO:0.9788
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4338, P-F1:0.4554, P-AUPRO:0.9640
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9767, P-AP:0.7324, P-F1:0.7473, P-AUPRO:0.9068
wood: I-Auroc:0.9895, I-AP:0.9966, I-F1:0.9836, P-AUROC:0.9717, P-AP:0.7544, P-F1:0.7085, P-AUPRO:0.9531
bottle: I-Auroc:0.9937, I-AP:0.9981, I-F1:0.9839, P-AUROC:0.9757, P-AP:0.8211, P-F1:0.7630, P-AUPRO:0.9452
cable: I-Auroc:0.9355, I-AP:0.9678, I-F1:0.9143, P-AUROC:0.9387, P-AP:0.5855, P-F1:0.6103, P-AUPRO:0.8696
capsule: I-Auroc:0.9749, I-AP:0.9944, I-F1:0.9732, P-AUROC:0.9814, P-AP:0.5890, P-F1:0.5722, P-AUPRO:0.9724
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9938, P-AP:0.8182, P-F1:0.7827, P-AUPRO:0.9721
metal_nut: I-Auroc:0.9853, I-AP:0.9969, I-F1:0.9785, P-AUROC:0.9326, P-AP:0.7068, P-F1:0.6991, P-AUPRO:0.8956
pill: I-Auroc:0.9831, I-AP:0.9972, I-F1:0.9745, P-AUROC:0.9241, P-AP:0.5366, P-F1:0.5504, P-AUPRO:0.9530
screw: I-Auroc:0.9338, I-AP:0.9780, I-F1:0.9280, P-AUROC:0.9924, P-AP:0.6062, P-F1:0.5852, P-AUPRO:0.9693
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9912, P-AP:0.7103, P-F1:0.6782, P-AUPRO:0.9662
transistor: I-Auroc:0.9908, I-AP:0.9865, I-F1:0.9620, P-AUROC:0.8942, P-AP:0.4478, P-F1:0.4590, P-AUPRO:0.7704
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9789, P-AP:0.6453, P-F1:0.6504, P-AUPRO:0.9441
Mean: I-Auroc:0.9854, I-AP:0.9942, I-F1:0.9784, P-AUROC:0.9686, P-AP:0.6456, P-F1:0.6365, P-AUPRO:0.9358




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 114514

cuda:0
shots: 1
carpet: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9944, P-AUROC:0.9926, P-AP:0.7095, P-F1:0.7040, P-AUPRO:0.9780
grid: I-Auroc:0.9866, I-AP:0.9962, I-F1:0.9912, P-AUROC:0.9928, P-AP:0.5275, P-F1:0.5557, P-AUPRO:0.9694
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9913, P-AP:0.4599, P-F1:0.4776, P-AUPRO:0.9800
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9881, P-AUROC:0.9756, P-AP:0.7215, P-F1:0.7436, P-AUPRO:0.9132
wood: I-Auroc:0.9895, I-AP:0.9966, I-F1:0.9756, P-AUROC:0.9649, P-AP:0.6727, P-F1:0.6641, P-AUPRO:0.9432
bottle: I-Auroc:0.9754, I-AP:0.9933, I-F1:0.9756, P-AUROC:0.9664, P-AP:0.7961, P-F1:0.7472, P-AUPRO:0.9333
cable: I-Auroc:0.9391, I-AP:0.9689, I-F1:0.9080, P-AUROC:0.9382, P-AP:0.5872, P-F1:0.6101, P-AUPRO:0.8754
capsule: I-Auroc:0.9326, I-AP:0.9851, I-F1:0.9474, P-AUROC:0.9771, P-AP:0.5375, P-F1:0.5160, P-AUPRO:0.9625
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9932, P-AP:0.7944, P-F1:0.7712, P-AUPRO:0.9713
metal_nut: I-Auroc:0.9570, I-AP:0.9904, I-F1:0.9385, P-AUROC:0.9127, P-AP:0.6449, P-F1:0.6418, P-AUPRO:0.8691
pill: I-Auroc:0.9801, I-AP:0.9965, I-F1:0.9714, P-AUROC:0.9222, P-AP:0.5234, P-F1:0.5336, P-AUPRO:0.9570
screw: I-Auroc:0.8879, I-AP:0.9601, I-F1:0.9004, P-AUROC:0.9878, P-AP:0.4887, P-F1:0.5149, P-AUPRO:0.9523
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9922, P-AP:0.7053, P-F1:0.7006, P-AUPRO:0.9580
transistor: I-Auroc:0.9946, I-AP:0.9920, I-F1:0.9630, P-AUROC:0.8919, P-AP:0.4587, P-F1:0.4599, P-AUPRO:0.7644
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9730, P-AP:0.6121, P-F1:0.6151, P-AUPRO:0.9280
Mean: I-Auroc:0.9760, I-AP:0.9919, I-F1:0.9702, P-AUROC:0.9648, P-AP:0.6160, P-F1:0.6170, P-AUPRO:0.9303
cuda:0
shots: 2
carpet: I-Auroc:0.9988, I-AP:0.9996, I-F1:0.9889, P-AUROC:0.9934, P-AP:0.7392, P-F1:0.7107, P-AUPRO:0.9742
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9939, P-AP:0.5494, P-F1:0.5724, P-AUPRO:0.9762
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9911, P-AP:0.4444, P-F1:0.4743, P-AUPRO:0.9733
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9880, P-AUROC:0.9759, P-AP:0.7251, P-F1:0.7423, P-AUPRO:0.9098
wood: I-Auroc:0.9939, I-AP:0.9980, I-F1:0.9836, P-AUROC:0.9731, P-AP:0.7245, P-F1:0.6897, P-AUPRO:0.9518
bottle: I-Auroc:0.9944, I-AP:0.9983, I-F1:0.9767, P-AUROC:0.9720, P-AP:0.8120, P-F1:0.7623, P-AUPRO:0.9424
cable: I-Auroc:0.9550, I-AP:0.9767, I-F1:0.9176, P-AUROC:0.9426, P-AP:0.5958, P-F1:0.6198, P-AUPRO:0.8760
capsule: I-Auroc:0.9326, I-AP:0.9848, I-F1:0.9520, P-AUROC:0.9791, P-AP:0.5530, P-F1:0.5325, P-AUPRO:0.9660
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9931, P-AP:0.7975, P-F1:0.7706, P-AUPRO:0.9707
metal_nut: I-Auroc:0.9858, I-AP:0.9967, I-F1:0.9684, P-AUROC:0.9329, P-AP:0.7170, P-F1:0.7042, P-AUPRO:0.8961
pill: I-Auroc:0.9858, I-AP:0.9974, I-F1:0.9821, P-AUROC:0.9232, P-AP:0.5390, P-F1:0.5553, P-AUPRO:0.9561
screw: I-Auroc:0.9086, I-AP:0.9702, I-F1:0.8926, P-AUROC:0.9903, P-AP:0.5735, P-F1:0.5788, P-AUPRO:0.9623
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9929, P-AP:0.7121, P-F1:0.7020, P-AUPRO:0.9671
transistor: I-Auroc:0.9958, I-AP:0.9937, I-F1:0.9639, P-AUROC:0.8941, P-AP:0.4632, P-F1:0.4695, P-AUPRO:0.7680
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9766, P-AP:0.6398, P-F1:0.6381, P-AUPRO:0.9349
Mean: I-Auroc:0.9824, I-AP:0.9940, I-F1:0.9722, P-AUROC:0.9683, P-AP:0.6390, P-F1:0.6348, P-AUPRO:0.9350
cuda:0
shots: 4
carpet: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9944, P-AUROC:0.9935, P-AP:0.7347, P-F1:0.7094, P-AUPRO:0.9743
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9942, P-AP:0.5591, P-F1:0.5829, P-AUPRO:0.9778
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9895, P-AP:0.3970, P-F1:0.4412, P-AUPRO:0.9642
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9760, P-AP:0.7213, P-F1:0.7433, P-AUPRO:0.9118
wood: I-Auroc:0.9939, I-AP:0.9980, I-F1:0.9917, P-AUROC:0.9743, P-AP:0.7193, P-F1:0.6851, P-AUPRO:0.9516
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9921, P-AUROC:0.9748, P-AP:0.8163, P-F1:0.7645, P-AUPRO:0.9465
cable: I-Auroc:0.9425, I-AP:0.9704, I-F1:0.9080, P-AUROC:0.9420, P-AP:0.5966, P-F1:0.6226, P-AUPRO:0.8769
capsule: I-Auroc:0.9629, I-AP:0.9922, I-F1:0.9558, P-AUROC:0.9814, P-AP:0.5864, P-F1:0.5680, P-AUPRO:0.9694
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9941, P-AP:0.8387, P-F1:0.7889, P-AUPRO:0.9728
metal_nut: I-Auroc:0.9888, I-AP:0.9973, I-F1:0.9789, P-AUROC:0.9398, P-AP:0.7250, P-F1:0.7191, P-AUPRO:0.9042
pill: I-Auroc:0.9853, I-AP:0.9974, I-F1:0.9789, P-AUROC:0.9271, P-AP:0.5508, P-F1:0.5646, P-AUPRO:0.9589
screw: I-Auroc:0.9065, I-AP:0.9695, I-F1:0.8966, P-AUROC:0.9909, P-AP:0.5866, P-F1:0.5863, P-AUPRO:0.9659
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9922, P-AP:0.7053, P-F1:0.6877, P-AUPRO:0.9654
transistor: I-Auroc:0.9942, I-AP:0.9897, I-F1:0.9877, P-AUROC:0.8997, P-AP:0.4655, P-F1:0.4747, P-AUPRO:0.7778
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9767, P-AP:0.6419, P-F1:0.6446, P-AUPRO:0.9395
Mean: I-Auroc:0.9845, I-AP:0.9942, I-F1:0.9769, P-AUROC:0.9697, P-AP:0.6430, P-F1:0.6389, P-AUPRO:0.9371






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 333

cuda:5
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.7238, P-F1:0.6898, P-AUPRO:0.9778
grid: I-Auroc:0.9875, I-AP:0.9963, I-F1:0.9912, P-AUROC:0.9927, P-AP:0.5386, P-F1:0.5502, P-AUPRO:0.9662
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9909, P-AP:0.4389, P-F1:0.4711, P-AUPRO:0.9709
tile: I-Auroc:0.9982, I-AP:0.9993, I-F1:0.9881, P-AUROC:0.9770, P-AP:0.7386, P-F1:0.7462, P-AUPRO:0.9140
wood: I-Auroc:0.9912, I-AP:0.9972, I-F1:0.9836, P-AUROC:0.9646, P-AP:0.6903, P-F1:0.6496, P-AUPRO:0.9496
bottle: I-Auroc:0.9905, I-AP:0.9971, I-F1:0.9692, P-AUROC:0.9711, P-AP:0.8100, P-F1:0.7589, P-AUPRO:0.9415
cable: I-Auroc:0.9256, I-AP:0.9625, I-F1:0.8953, P-AUROC:0.9339, P-AP:0.5381, P-F1:0.5502, P-AUPRO:0.8524
capsule: I-Auroc:0.9270, I-AP:0.9839, I-F1:0.9437, P-AUROC:0.9750, P-AP:0.5181, P-F1:0.5098, P-AUPRO:0.9618
hazelnut: I-Auroc:0.9671, I-AP:0.9828, I-F1:0.9371, P-AUROC:0.9887, P-AP:0.7689, P-F1:0.7207, P-AUPRO:0.9420
metal_nut: I-Auroc:0.9575, I-AP:0.9906, I-F1:0.9438, P-AUROC:0.8880, P-AP:0.5748, P-F1:0.5706, P-AUPRO:0.8483
pill: I-Auroc:0.9812, I-AP:0.9968, I-F1:0.9858, P-AUROC:0.9133, P-AP:0.5045, P-F1:0.5300, P-AUPRO:0.9529
screw: I-Auroc:0.7807, I-AP:0.9165, I-F1:0.8815, P-AUROC:0.9816, P-AP:0.5112, P-F1:0.5356, P-AUPRO:0.9299
toothbrush: I-Auroc:0.9833, I-AP:0.9944, I-F1:0.9831, P-AUROC:0.9918, P-AP:0.7227, P-F1:0.6996, P-AUPRO:0.9476
transistor: I-Auroc:0.9888, I-AP:0.9837, I-F1:0.9487, P-AUROC:0.8241, P-AP:0.3432, P-F1:0.3734, P-AUPRO:0.6937
zipper: I-Auroc:0.9989, I-AP:0.9997, I-F1:0.9958, P-AUROC:0.9799, P-AP:0.6573, P-F1:0.6543, P-AUPRO:0.9419
Mean: I-Auroc:0.9652, I-AP:0.9867, I-F1:0.9631, P-AUROC:0.9577, P-AP:0.6053, P-F1:0.6007, P-AUPRO:0.9194
cuda:5
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9931, P-AP:0.7243, P-F1:0.6926, P-AUPRO:0.9770
grid: I-Auroc:0.9900, I-AP:0.9969, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5571, P-F1:0.5803, P-AUPRO:0.9762
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9908, P-AP:0.4377, P-F1:0.4693, P-AUPRO:0.9727
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9760, P-AP:0.7299, P-F1:0.7418, P-AUPRO:0.9094
wood: I-Auroc:0.9877, I-AP:0.9962, I-F1:0.9752, P-AUROC:0.9635, P-AP:0.6903, P-F1:0.6509, P-AUPRO:0.9436
bottle: I-Auroc:0.9881, I-AP:0.9964, I-F1:0.9677, P-AUROC:0.9732, P-AP:0.8130, P-F1:0.7600, P-AUPRO:0.9428
cable: I-Auroc:0.9415, I-AP:0.9699, I-F1:0.9101, P-AUROC:0.9406, P-AP:0.5631, P-F1:0.5885, P-AUPRO:0.8660
capsule: I-Auroc:0.9541, I-AP:0.9891, I-F1:0.9689, P-AUROC:0.9803, P-AP:0.5727, P-F1:0.5573, P-AUPRO:0.9677
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.8225, P-F1:0.7823, P-AUPRO:0.9710
metal_nut: I-Auroc:0.9585, I-AP:0.9909, I-F1:0.9438, P-AUROC:0.9208, P-AP:0.6567, P-F1:0.6615, P-AUPRO:0.8828
pill: I-Auroc:0.9853, I-AP:0.9976, I-F1:0.9857, P-AUROC:0.9117, P-AP:0.5094, P-F1:0.5355, P-AUPRO:0.9541
screw: I-Auroc:0.8149, I-AP:0.9280, I-F1:0.8931, P-AUROC:0.9849, P-AP:0.5393, P-F1:0.5481, P-AUPRO:0.9420
toothbrush: I-Auroc:0.9889, I-AP:0.9961, I-F1:0.9831, P-AUROC:0.9922, P-AP:0.7355, P-F1:0.6977, P-AUPRO:0.9582
transistor: I-Auroc:0.9958, I-AP:0.9931, I-F1:0.9877, P-AUROC:0.8671, P-AP:0.4093, P-F1:0.4262, P-AUPRO:0.7377
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9820, P-AP:0.6661, P-F1:0.6671, P-AUPRO:0.9507
Mean: I-Auroc:0.9736, I-AP:0.9902, I-F1:0.9731, P-AUROC:0.9643, P-AP:0.6285, P-F1:0.6239, P-AUPRO:0.9301
cuda:5
shots: 4
carpet: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9944, P-AUROC:0.9934, P-AP:0.7348, P-F1:0.6983, P-AUPRO:0.9778
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5620, P-F1:0.5841, P-AUPRO:0.9767
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4365, P-F1:0.4669, P-AUPRO:0.9653
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9940, P-AUROC:0.9759, P-AP:0.7276, P-F1:0.7416, P-AUPRO:0.9049
wood: I-Auroc:0.9904, I-AP:0.9968, I-F1:0.9836, P-AUROC:0.9669, P-AP:0.6988, P-F1:0.6602, P-AUPRO:0.9476
bottle: I-Auroc:0.9952, I-AP:0.9985, I-F1:0.9844, P-AUROC:0.9755, P-AP:0.8192, P-F1:0.7646, P-AUPRO:0.9431
cable: I-Auroc:0.9406, I-AP:0.9696, I-F1:0.9123, P-AUROC:0.9418, P-AP:0.5795, P-F1:0.6064, P-AUPRO:0.8731
capsule: I-Auroc:0.9617, I-AP:0.9910, I-F1:0.9730, P-AUROC:0.9815, P-AP:0.5801, P-F1:0.5631, P-AUPRO:0.9705
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.8259, P-F1:0.7831, P-AUPRO:0.9718
metal_nut: I-Auroc:0.9844, I-AP:0.9963, I-F1:0.9687, P-AUROC:0.9339, P-AP:0.7117, P-F1:0.7020, P-AUPRO:0.8985
pill: I-Auroc:0.9872, I-AP:0.9978, I-F1:0.9857, P-AUROC:0.9193, P-AP:0.5260, P-F1:0.5486, P-AUPRO:0.9589
screw: I-Auroc:0.8926, I-AP:0.9640, I-F1:0.8980, P-AUROC:0.9903, P-AP:0.6036, P-F1:0.5823, P-AUPRO:0.9601
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9936, P-AP:0.7444, P-F1:0.7189, P-AUPRO:0.9673
transistor: I-Auroc:0.9946, I-AP:0.9906, I-F1:0.9877, P-AUROC:0.8777, P-AP:0.4333, P-F1:0.4463, P-AUPRO:0.7496
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9808, P-AP:0.6575, P-F1:0.6597, P-AUPRO:0.9450
Mean: I-Auroc:0.9823, I-AP:0.9934, I-F1:0.9771, P-AUROC:0.9673, P-AP:0.6427, P-F1:0.6351, P-AUPRO:0.9340




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 2

cuda:5
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.7525, P-F1:0.7217, P-AUPRO:0.9800
grid: I-Auroc:0.9908, I-AP:0.9972, I-F1:0.9912, P-AUROC:0.9943, P-AP:0.5709, P-F1:0.5918, P-AUPRO:0.9774
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4355, P-F1:0.4634, P-AUPRO:0.9652
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9754, P-AP:0.7249, P-F1:0.7427, P-AUPRO:0.9130
wood: I-Auroc:0.9842, I-AP:0.9943, I-F1:0.9836, P-AUROC:0.9735, P-AP:0.7321, P-F1:0.6896, P-AUPRO:0.9499
bottle: I-Auroc:0.9778, I-AP:0.9938, I-F1:0.9677, P-AUROC:0.9661, P-AP:0.7883, P-F1:0.7408, P-AUPRO:0.9328
cable: I-Auroc:0.9372, I-AP:0.9674, I-F1:0.9040, P-AUROC:0.9353, P-AP:0.5496, P-F1:0.5744, P-AUPRO:0.8507
capsule: I-Auroc:0.9753, I-AP:0.9947, I-F1:0.9640, P-AUROC:0.9757, P-AP:0.5420, P-F1:0.5366, P-AUPRO:0.9665
hazelnut: I-Auroc:0.9896, I-AP:0.9944, I-F1:0.9571, P-AUROC:0.9920, P-AP:0.7917, P-F1:0.7412, P-AUPRO:0.9440
metal_nut: I-Auroc:0.9790, I-AP:0.9953, I-F1:0.9634, P-AUROC:0.8987, P-AP:0.6165, P-F1:0.6096, P-AUPRO:0.8599
pill: I-Auroc:0.9785, I-AP:0.9962, I-F1:0.9686, P-AUROC:0.9167, P-AP:0.5123, P-F1:0.5277, P-AUPRO:0.9560
screw: I-Auroc:0.9012, I-AP:0.9651, I-F1:0.9076, P-AUROC:0.9888, P-AP:0.5397, P-F1:0.5503, P-AUPRO:0.9579
toothbrush: I-Auroc:0.9778, I-AP:0.9920, I-F1:0.9655, P-AUROC:0.9850, P-AP:0.6448, P-F1:0.6234, P-AUPRO:0.9552
transistor: I-Auroc:0.9758, I-AP:0.9800, I-F1:0.9500, P-AUROC:0.8066, P-AP:0.3175, P-F1:0.3361, P-AUPRO:0.6904
zipper: I-Auroc:0.9827, I-AP:0.9945, I-F1:0.9876, P-AUROC:0.9716, P-AP:0.5852, P-F1:0.5918, P-AUPRO:0.9231
Mean: I-Auroc:0.9766, I-AP:0.9910, I-F1:0.9670, P-AUROC:0.9576, P-AP:0.6069, P-F1:0.6027, P-AUPRO:0.9215
cuda:5
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.7504, P-F1:0.7204, P-AUPRO:0.9784
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9939, P-AP:0.5540, P-F1:0.5743, P-AUPRO:0.9777
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9901, P-AP:0.4452, P-F1:0.4650, P-AUPRO:0.9637
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9756, P-AP:0.7242, P-F1:0.7419, P-AUPRO:0.9081
wood: I-Auroc:0.9895, I-AP:0.9964, I-F1:0.9917, P-AUROC:0.9735, P-AP:0.7439, P-F1:0.6921, P-AUPRO:0.9463
bottle: I-Auroc:0.9857, I-AP:0.9958, I-F1:0.9683, P-AUROC:0.9727, P-AP:0.8065, P-F1:0.7561, P-AUPRO:0.9444
cable: I-Auroc:0.9412, I-AP:0.9698, I-F1:0.9133, P-AUROC:0.9421, P-AP:0.5858, P-F1:0.6079, P-AUPRO:0.8708
capsule: I-Auroc:0.9717, I-AP:0.9937, I-F1:0.9643, P-AUROC:0.9791, P-AP:0.5513, P-F1:0.5426, P-AUPRO:0.9701
hazelnut: I-Auroc:0.9993, I-AP:0.9996, I-F1:0.9928, P-AUROC:0.9935, P-AP:0.8179, P-F1:0.7764, P-AUPRO:0.9600
metal_nut: I-Auroc:0.9917, I-AP:0.9981, I-F1:0.9787, P-AUROC:0.9122, P-AP:0.6500, P-F1:0.6388, P-AUPRO:0.8821
pill: I-Auroc:0.9825, I-AP:0.9970, I-F1:0.9749, P-AUROC:0.9245, P-AP:0.5374, P-F1:0.5499, P-AUPRO:0.9571
screw: I-Auroc:0.9190, I-AP:0.9723, I-F1:0.9083, P-AUROC:0.9911, P-AP:0.6016, P-F1:0.5792, P-AUPRO:0.9682
toothbrush: I-Auroc:0.9778, I-AP:0.9920, I-F1:0.9655, P-AUROC:0.9864, P-AP:0.6537, P-F1:0.6301, P-AUPRO:0.9589
transistor: I-Auroc:0.9917, I-AP:0.9891, I-F1:0.9620, P-AUROC:0.8602, P-AP:0.3944, P-F1:0.4108, P-AUPRO:0.7307
zipper: I-Auroc:0.9766, I-AP:0.9925, I-F1:0.9833, P-AUROC:0.9742, P-AP:0.5982, P-F1:0.6014, P-AUPRO:0.9308
Mean: I-Auroc:0.9814, I-AP:0.9930, I-F1:0.9730, P-AUROC:0.9642, P-AP:0.6276, P-F1:0.6191, P-AUPRO:0.9298
cuda:5
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9937, P-AP:0.7351, P-F1:0.7164, P-AUPRO:0.9791
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9940, P-AP:0.5605, P-F1:0.5778, P-AUPRO:0.9771
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9900, P-AP:0.4331, P-F1:0.4601, P-AUPRO:0.9623
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9756, P-AP:0.7203, P-F1:0.7412, P-AUPRO:0.9083
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9836, P-AUROC:0.9752, P-AP:0.7380, P-F1:0.6973, P-AUPRO:0.9534
bottle: I-Auroc:0.9929, I-AP:0.9978, I-F1:0.9767, P-AUROC:0.9753, P-AP:0.8123, P-F1:0.7611, P-AUPRO:0.9419
cable: I-Auroc:0.9359, I-AP:0.9688, I-F1:0.9171, P-AUROC:0.9402, P-AP:0.5905, P-F1:0.6170, P-AUPRO:0.8721
capsule: I-Auroc:0.9701, I-AP:0.9933, I-F1:0.9776, P-AUROC:0.9817, P-AP:0.5735, P-F1:0.5590, P-AUPRO:0.9723
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.8172, P-F1:0.7832, P-AUPRO:0.9664
metal_nut: I-Auroc:0.9927, I-AP:0.9983, I-F1:0.9789, P-AUROC:0.9211, P-AP:0.6701, P-F1:0.6585, P-AUPRO:0.8909
pill: I-Auroc:0.9872, I-AP:0.9978, I-F1:0.9825, P-AUROC:0.9284, P-AP:0.5484, P-F1:0.5638, P-AUPRO:0.9595
screw: I-Auroc:0.9342, I-AP:0.9772, I-F1:0.9250, P-AUROC:0.9928, P-AP:0.6090, P-F1:0.5851, P-AUPRO:0.9705
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9917, P-AP:0.7057, P-F1:0.6864, P-AUPRO:0.9700
transistor: I-Auroc:0.9958, I-AP:0.9942, I-F1:0.9610, P-AUROC:0.8917, P-AP:0.4609, P-F1:0.4668, P-AUPRO:0.7771
zipper: I-Auroc:0.9987, I-AP:0.9996, I-F1:0.9917, P-AUROC:0.9780, P-AP:0.6410, P-F1:0.6422, P-AUPRO:0.9431
Mean: I-Auroc:0.9864, I-AP:0.9949, I-F1:0.9790, P-AUROC:0.9682, P-AP:0.6410, P-F1:0.6344, P-AUPRO:0.9363




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 7

cuda:5
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.7343, P-F1:0.7107, P-AUPRO:0.9790
grid: I-Auroc:0.9942, I-AP:0.9981, I-F1:0.9912, P-AUROC:0.9944, P-AP:0.5703, P-F1:0.5875, P-AUPRO:0.9782
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4346, P-F1:0.4568, P-AUPRO:0.9701
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9785, P-AP:0.7489, P-F1:0.7590, P-AUPRO:0.9238
wood: I-Auroc:0.9947, I-AP:0.9983, I-F1:0.9917, P-AUROC:0.9695, P-AP:0.7470, P-F1:0.7050, P-AUPRO:0.9519
bottle: I-Auroc:0.9762, I-AP:0.9936, I-F1:0.9683, P-AUROC:0.9669, P-AP:0.7959, P-F1:0.7490, P-AUPRO:0.9339
cable: I-Auroc:0.9217, I-AP:0.9617, I-F1:0.9006, P-AUROC:0.9361, P-AP:0.5494, P-F1:0.5702, P-AUPRO:0.8509
capsule: I-Auroc:0.9414, I-AP:0.9873, I-F1:0.9444, P-AUROC:0.9735, P-AP:0.5265, P-F1:0.5201, P-AUPRO:0.9603
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.8065, P-F1:0.7791, P-AUPRO:0.9674
metal_nut: I-Auroc:0.9814, I-AP:0.9960, I-F1:0.9727, P-AUROC:0.9044, P-AP:0.6406, P-F1:0.6249, P-AUPRO:0.8647
pill: I-Auroc:0.9765, I-AP:0.9959, I-F1:0.9680, P-AUROC:0.9136, P-AP:0.5085, P-F1:0.5330, P-AUPRO:0.9492
screw: I-Auroc:0.7413, I-AP:0.8969, I-F1:0.8686, P-AUROC:0.9821, P-AP:0.5015, P-F1:0.5112, P-AUPRO:0.9288
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9914, P-AP:0.7083, P-F1:0.6910, P-AUPRO:0.9522
transistor: I-Auroc:0.9829, I-AP:0.9809, I-F1:0.9383, P-AUROC:0.8663, P-AP:0.4102, P-F1:0.4331, P-AUPRO:0.7163
zipper: I-Auroc:0.9735, I-AP:0.9914, I-F1:0.9794, P-AUROC:0.9732, P-AP:0.5976, P-F1:0.5933, P-AUPRO:0.9258
Mean: I-Auroc:0.9655, I-AP:0.9867, I-F1:0.9678, P-AUROC:0.9618, P-AP:0.6187, P-F1:0.6149, P-AUPRO:0.9235
cuda:5
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7382, P-F1:0.7137, P-AUPRO:0.9775
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9944, P-AP:0.5665, P-F1:0.5923, P-AUPRO:0.9786
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9903, P-AP:0.4332, P-F1:0.4614, P-AUPRO:0.9692
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9941, P-AUROC:0.9783, P-AP:0.7490, P-F1:0.7562, P-AUPRO:0.9153
wood: I-Auroc:0.9939, I-AP:0.9980, I-F1:0.9917, P-AUROC:0.9718, P-AP:0.7432, P-F1:0.6928, P-AUPRO:0.9515
bottle: I-Auroc:0.9873, I-AP:0.9963, I-F1:0.9760, P-AUROC:0.9713, P-AP:0.8026, P-F1:0.7523, P-AUPRO:0.9397
cable: I-Auroc:0.9160, I-AP:0.9584, I-F1:0.8994, P-AUROC:0.9386, P-AP:0.5721, P-F1:0.5919, P-AUPRO:0.8636
capsule: I-Auroc:0.9729, I-AP:0.9942, I-F1:0.9640, P-AUROC:0.9776, P-AP:0.5646, P-F1:0.5537, P-AUPRO:0.9679
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.8067, P-F1:0.7806, P-AUPRO:0.9690
metal_nut: I-Auroc:0.9951, I-AP:0.9989, I-F1:0.9841, P-AUROC:0.9261, P-AP:0.6918, P-F1:0.6815, P-AUPRO:0.8950
pill: I-Auroc:0.9853, I-AP:0.9975, I-F1:0.9823, P-AUROC:0.9118, P-AP:0.5174, P-F1:0.5405, P-AUPRO:0.9513
screw: I-Auroc:0.7971, I-AP:0.9246, I-F1:0.8760, P-AUROC:0.9858, P-AP:0.5467, P-F1:0.5435, P-AUPRO:0.9456
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9920, P-AP:0.7115, P-F1:0.7053, P-AUPRO:0.9559
transistor: I-Auroc:0.9863, I-AP:0.9787, I-F1:0.9383, P-AUROC:0.8756, P-AP:0.4213, P-F1:0.4398, P-AUPRO:0.7353
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9736, P-AP:0.6217, P-F1:0.6229, P-AUPRO:0.9322
Mean: I-Auroc:0.9752, I-AP:0.9896, I-F1:0.9718, P-AUROC:0.9650, P-AP:0.6324, P-F1:0.6286, P-AUPRO:0.9298
cuda:5
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9935, P-AP:0.7370, P-F1:0.7113, P-AUPRO:0.9787
grid: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9943, P-AP:0.5677, P-F1:0.5853, P-AUPRO:0.9759
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9902, P-AP:0.4252, P-F1:0.4560, P-AUPRO:0.9704
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9777, P-AP:0.7424, P-F1:0.7529, P-AUPRO:0.9120
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9917, P-AUROC:0.9730, P-AP:0.7397, P-F1:0.6944, P-AUPRO:0.9551
bottle: I-Auroc:0.9921, I-AP:0.9977, I-F1:0.9841, P-AUROC:0.9741, P-AP:0.8106, P-F1:0.7575, P-AUPRO:0.9463
cable: I-Auroc:0.9335, I-AP:0.9658, I-F1:0.9006, P-AUROC:0.9406, P-AP:0.5774, P-F1:0.6031, P-AUPRO:0.8707
capsule: I-Auroc:0.9649, I-AP:0.9921, I-F1:0.9686, P-AUROC:0.9810, P-AP:0.5946, P-F1:0.5765, P-AUPRO:0.9711
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9940, P-AP:0.8163, P-F1:0.7849, P-AUPRO:0.9716
metal_nut: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9894, P-AUROC:0.9319, P-AP:0.7047, P-F1:0.6988, P-AUPRO:0.9021
pill: I-Auroc:0.9825, I-AP:0.9970, I-F1:0.9787, P-AUROC:0.9156, P-AP:0.5286, P-F1:0.5541, P-AUPRO:0.9545
screw: I-Auroc:0.9440, I-AP:0.9818, I-F1:0.9180, P-AUROC:0.9925, P-AP:0.6219, P-F1:0.5913, P-AUPRO:0.9677
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9928, P-AP:0.7180, P-F1:0.7083, P-AUPRO:0.9671
transistor: I-Auroc:0.9904, I-AP:0.9836, I-F1:0.9630, P-AUROC:0.9002, P-AP:0.4700, P-F1:0.4760, P-AUPRO:0.7801
zipper: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9775, P-AP:0.6438, P-F1:0.6472, P-AUPRO:0.9391
Mean: I-Auroc:0.9867, I-AP:0.9944, I-F1:0.9792, P-AUROC:0.9686, P-AP:0.6465, P-F1:0.6398, P-AUPRO:0.9375





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 999

cuda:0
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7529, P-F1:0.7157, P-AUPRO:0.9790
grid: I-Auroc:0.9900, I-AP:0.9969, I-F1:0.9912, P-AUROC:0.9925, P-AP:0.5394, P-F1:0.5462, P-AUPRO:0.9663
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9906, P-AP:0.4469, P-F1:0.4641, P-AUPRO:0.9665
tile: I-Auroc:0.9986, I-AP:0.9994, I-F1:0.9881, P-AUROC:0.9775, P-AP:0.7449, P-F1:0.7513, P-AUPRO:0.9132
wood: I-Auroc:0.9965, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9687, P-AP:0.6990, P-F1:0.6804, P-AUPRO:0.9484
bottle: I-Auroc:0.9825, I-AP:0.9950, I-F1:0.9677, P-AUROC:0.9674, P-AP:0.7983, P-F1:0.7532, P-AUPRO:0.9355
cable: I-Auroc:0.9663, I-AP:0.9819, I-F1:0.9310, P-AUROC:0.9378, P-AP:0.5910, P-F1:0.6197, P-AUPRO:0.8708
capsule: I-Auroc:0.9286, I-AP:0.9841, I-F1:0.9391, P-AUROC:0.9714, P-AP:0.5389, P-F1:0.5297, P-AUPRO:0.9598
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9925, P-AP:0.8142, P-F1:0.7693, P-AUPRO:0.9621
metal_nut: I-Auroc:0.9555, I-AP:0.9903, I-F1:0.9503, P-AUROC:0.9103, P-AP:0.6218, P-F1:0.6294, P-AUPRO:0.8690
pill: I-Auroc:0.9446, I-AP:0.9898, I-F1:0.9514, P-AUROC:0.9153, P-AP:0.4934, P-F1:0.5122, P-AUPRO:0.9392
screw: I-Auroc:0.8535, I-AP:0.9470, I-F1:0.8915, P-AUROC:0.9827, P-AP:0.5104, P-F1:0.5382, P-AUPRO:0.9226
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9892, P-AP:0.6692, P-F1:0.6629, P-AUPRO:0.9610
transistor: I-Auroc:0.9738, I-AP:0.9628, I-F1:0.9070, P-AUROC:0.8159, P-AP:0.3176, P-F1:0.3694, P-AUPRO:0.6827
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9917, P-AUROC:0.9779, P-AP:0.6389, P-F1:0.6361, P-AUPRO:0.9397
Mean: I-Auroc:0.9720, I-AP:0.9895, I-F1:0.9650, P-AUROC:0.9589, P-AP:0.6118, P-F1:0.6119, P-AUPRO:0.9210
cuda:0
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9936, P-AP:0.7432, P-F1:0.7149, P-AUPRO:0.9796
grid: I-Auroc:0.9908, I-AP:0.9972, I-F1:0.9912, P-AUROC:0.9941, P-AP:0.5582, P-F1:0.5790, P-AUPRO:0.9767
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9905, P-AP:0.4426, P-F1:0.4614, P-AUPRO:0.9665
tile: I-Auroc:0.9989, I-AP:0.9996, I-F1:0.9882, P-AUROC:0.9774, P-AP:0.7417, P-F1:0.7488, P-AUPRO:0.9098
wood: I-Auroc:0.9956, I-AP:0.9986, I-F1:0.9917, P-AUROC:0.9734, P-AP:0.7101, P-F1:0.6855, P-AUPRO:0.9507
bottle: I-Auroc:0.9929, I-AP:0.9978, I-F1:0.9756, P-AUROC:0.9722, P-AP:0.8122, P-F1:0.7616, P-AUPRO:0.9409
cable: I-Auroc:0.9728, I-AP:0.9846, I-F1:0.9282, P-AUROC:0.9429, P-AP:0.6076, P-F1:0.6331, P-AUPRO:0.8837
capsule: I-Auroc:0.9517, I-AP:0.9892, I-F1:0.9561, P-AUROC:0.9762, P-AP:0.5622, P-F1:0.5522, P-AUPRO:0.9652
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9938, P-AP:0.8272, P-F1:0.7806, P-AUPRO:0.9682
metal_nut: I-Auroc:0.9858, I-AP:0.9969, I-F1:0.9785, P-AUROC:0.9366, P-AP:0.7063, P-F1:0.7074, P-AUPRO:0.9009
pill: I-Auroc:0.9763, I-AP:0.9958, I-F1:0.9650, P-AUROC:0.9218, P-AP:0.5250, P-F1:0.5413, P-AUPRO:0.9502
screw: I-Auroc:0.9156, I-AP:0.9725, I-F1:0.9143, P-AUROC:0.9904, P-AP:0.5822, P-F1:0.5752, P-AUPRO:0.9554
toothbrush: I-Auroc:0.9861, I-AP:0.9952, I-F1:0.9831, P-AUROC:0.9911, P-AP:0.7078, P-F1:0.6915, P-AUPRO:0.9611
transistor: I-Auroc:0.9883, I-AP:0.9817, I-F1:0.9412, P-AUROC:0.8370, P-AP:0.3780, P-F1:0.3986, P-AUPRO:0.7169
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9917, P-AUROC:0.9773, P-AP:0.6333, P-F1:0.6306, P-AUPRO:0.9371
Mean: I-Auroc:0.9836, I-AP:0.9939, I-F1:0.9737, P-AUROC:0.9646, P-AP:0.6358, P-F1:0.6308, P-AUPRO:0.9309
cuda:0
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9935, P-AP:0.7342, P-F1:0.7105, P-AUPRO:0.9770
grid: I-Auroc:0.9916, I-AP:0.9974, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5570, P-F1:0.5842, P-AUPRO:0.9775
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9917, P-AP:0.4996, P-F1:0.5018, P-AUPRO:0.9657
tile: I-Auroc:0.9993, I-AP:0.9997, I-F1:0.9941, P-AUROC:0.9771, P-AP:0.7397, P-F1:0.7466, P-AUPRO:0.9082
wood: I-Auroc:0.9939, I-AP:0.9980, I-F1:0.9917, P-AUROC:0.9722, P-AP:0.7036, P-F1:0.6774, P-AUPRO:0.9500
bottle: I-Auroc:0.9952, I-AP:0.9985, I-F1:0.9844, P-AUROC:0.9753, P-AP:0.8194, P-F1:0.7648, P-AUPRO:0.9466
cable: I-Auroc:0.9740, I-AP:0.9854, I-F1:0.9399, P-AUROC:0.9474, P-AP:0.6211, P-F1:0.6483, P-AUPRO:0.8869
capsule: I-Auroc:0.9613, I-AP:0.9910, I-F1:0.9732, P-AUROC:0.9819, P-AP:0.5956, P-F1:0.5779, P-AUPRO:0.9724
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9942, P-AP:0.8252, P-F1:0.7815, P-AUPRO:0.9733
metal_nut: I-Auroc:0.9844, I-AP:0.9965, I-F1:0.9677, P-AUROC:0.9403, P-AP:0.7191, P-F1:0.7182, P-AUPRO:0.9028
pill: I-Auroc:0.9866, I-AP:0.9976, I-F1:0.9822, P-AUROC:0.9263, P-AP:0.5427, P-F1:0.5572, P-AUPRO:0.9552
screw: I-Auroc:0.9262, I-AP:0.9760, I-F1:0.9145, P-AUROC:0.9928, P-AP:0.6034, P-F1:0.5871, P-AUPRO:0.9674
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9925, P-AP:0.7165, P-F1:0.7064, P-AUPRO:0.9642
transistor: I-Auroc:0.9917, I-AP:0.9846, I-F1:0.9756, P-AUROC:0.8689, P-AP:0.4240, P-F1:0.4342, P-AUPRO:0.7505
zipper: I-Auroc:0.9997, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9776, P-AP:0.6431, P-F1:0.6400, P-AUPRO:0.9387
Mean: I-Auroc:0.9867, I-AP:0.9949, I-F1:0.9796, P-AUROC:0.9684, P-AP:0.6496, P-F1:0.6424, P-AUPRO:0.9358




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 3

cuda:0
shots: 1
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9930, P-AP:0.7313, P-F1:0.7105, P-AUPRO:0.9766
grid: I-Auroc:0.9933, I-AP:0.9978, I-F1:0.9912, P-AUROC:0.9936, P-AP:0.5534, P-F1:0.5629, P-AUPRO:0.9774
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9907, P-AP:0.4498, P-F1:0.4714, P-AUPRO:0.9720
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9746, P-AP:0.7162, P-F1:0.7403, P-AUPRO:0.9112
wood: I-Auroc:0.9912, I-AP:0.9971, I-F1:0.9836, P-AUROC:0.9701, P-AP:0.7339, P-F1:0.6859, P-AUPRO:0.9379
bottle: I-Auroc:0.9746, I-AP:0.9928, I-F1:0.9600, P-AUROC:0.9659, P-AP:0.7932, P-F1:0.7446, P-AUPRO:0.9350
cable: I-Auroc:0.9267, I-AP:0.9634, I-F1:0.8916, P-AUROC:0.9364, P-AP:0.5535, P-F1:0.5840, P-AUPRO:0.8498
capsule: I-Auroc:0.9685, I-AP:0.9934, I-F1:0.9643, P-AUROC:0.9729, P-AP:0.5266, P-F1:0.5259, P-AUPRO:0.9596
hazelnut: I-Auroc:0.9936, I-AP:0.9965, I-F1:0.9784, P-AUROC:0.9941, P-AP:0.8324, P-F1:0.7827, P-AUPRO:0.9664
metal_nut: I-Auroc:0.9638, I-AP:0.9919, I-F1:0.9519, P-AUROC:0.8963, P-AP:0.5998, P-F1:0.5892, P-AUPRO:0.8509
pill: I-Auroc:0.9834, I-AP:0.9972, I-F1:0.9786, P-AUROC:0.9192, P-AP:0.5246, P-F1:0.5445, P-AUPRO:0.9531
screw: I-Auroc:0.8000, I-AP:0.9277, I-F1:0.8881, P-AUROC:0.9806, P-AP:0.5050, P-F1:0.5339, P-AUPRO:0.9305
toothbrush: I-Auroc:0.9833, I-AP:0.9944, I-F1:0.9831, P-AUROC:0.9923, P-AP:0.7420, P-F1:0.7070, P-AUPRO:0.9565
transistor: I-Auroc:0.9900, I-AP:0.9846, I-F1:0.9524, P-AUROC:0.8713, P-AP:0.3821, P-F1:0.4153, P-AUPRO:0.7232
zipper: I-Auroc:0.9955, I-AP:0.9988, I-F1:0.9876, P-AUROC:0.9782, P-AP:0.6493, P-F1:0.6479, P-AUPRO:0.9443
Mean: I-Auroc:0.9709, I-AP:0.9890, I-F1:0.9670, P-AUROC:0.9619, P-AP:0.6195, P-F1:0.6164, P-AUPRO:0.9230
cuda:0
shots: 2
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.7300, P-F1:0.7095, P-AUPRO:0.9785
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9935, P-AP:0.5552, P-F1:0.5624, P-AUPRO:0.9766
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9912, P-AP:0.4584, P-F1:0.4777, P-AUPRO:0.9731
tile: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9749, P-AP:0.7132, P-F1:0.7397, P-AUPRO:0.9012
wood: I-Auroc:0.9877, I-AP:0.9960, I-F1:0.9833, P-AUROC:0.9730, P-AP:0.7713, P-F1:0.7138, P-AUPRO:0.9462
bottle: I-Auroc:0.9984, I-AP:0.9995, I-F1:0.9920, P-AUROC:0.9725, P-AP:0.8131, P-F1:0.7616, P-AUPRO:0.9444
cable: I-Auroc:0.9428, I-AP:0.9705, I-F1:0.9040, P-AUROC:0.9411, P-AP:0.5838, P-F1:0.6150, P-AUPRO:0.8695
capsule: I-Auroc:0.9649, I-AP:0.9923, I-F1:0.9630, P-AUROC:0.9770, P-AP:0.5630, P-F1:0.5530, P-AUPRO:0.9664
hazelnut: I-Auroc:0.9982, I-AP:0.9990, I-F1:0.9857, P-AUROC:0.9940, P-AP:0.8357, P-F1:0.7814, P-AUPRO:0.9685
metal_nut: I-Auroc:0.9922, I-AP:0.9982, I-F1:0.9787, P-AUROC:0.9306, P-AP:0.7075, P-F1:0.6992, P-AUPRO:0.8972
pill: I-Auroc:0.9845, I-AP:0.9973, I-F1:0.9787, P-AUROC:0.9197, P-AP:0.5340, P-F1:0.5543, P-AUPRO:0.9538
screw: I-Auroc:0.7936, I-AP:0.9249, I-F1:0.8764, P-AUROC:0.9795, P-AP:0.4952, P-F1:0.5311, P-AUPRO:0.9270
toothbrush: I-Auroc:0.9833, I-AP:0.9944, I-F1:0.9831, P-AUROC:0.9932, P-AP:0.7591, P-F1:0.7247, P-AUPRO:0.9558
transistor: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.8801, P-AP:0.4212, P-F1:0.4390, P-AUPRO:0.7432
zipper: I-Auroc:0.9968, I-AP:0.9992, I-F1:0.9833, P-AUROC:0.9782, P-AP:0.6361, P-F1:0.6435, P-AUPRO:0.9417
Mean: I-Auroc:0.9757, I-AP:0.9913, I-F1:0.9746, P-AUROC:0.9661, P-AP:0.6384, P-F1:0.6337, P-AUPRO:0.9295
cuda:0
shots: 4
carpet: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9934, P-AP:0.7264, P-F1:0.7068, P-AUPRO:0.9755
grid: I-Auroc:0.9925, I-AP:0.9976, I-F1:0.9912, P-AUROC:0.9936, P-AP:0.5462, P-F1:0.5661, P-AUPRO:0.9741
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9914, P-AP:0.4556, P-F1:0.4863, P-AUPRO:0.9761
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9755, P-AP:0.7177, P-F1:0.7414, P-AUPRO:0.8989
wood: I-Auroc:0.9833, I-AP:0.9941, I-F1:0.9833, P-AUROC:0.9735, P-AP:0.7655, P-F1:0.7110, P-AUPRO:0.9484
bottle: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9757, P-AP:0.8212, P-F1:0.7676, P-AUPRO:0.9471
cable: I-Auroc:0.9700, I-AP:0.9836, I-F1:0.9274, P-AUROC:0.9453, P-AP:0.6060, P-F1:0.6305, P-AUPRO:0.8793
capsule: I-Auroc:0.9713, I-AP:0.9932, I-F1:0.9725, P-AUROC:0.9808, P-AP:0.5855, P-F1:0.5732, P-AUPRO:0.9721
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9942, P-AP:0.8157, P-F1:0.7817, P-AUPRO:0.9727
metal_nut: I-Auroc:0.9927, I-AP:0.9983, I-F1:0.9789, P-AUROC:0.9394, P-AP:0.7333, P-F1:0.7313, P-AUPRO:0.9079
pill: I-Auroc:0.9872, I-AP:0.9978, I-F1:0.9823, P-AUROC:0.9254, P-AP:0.5464, P-F1:0.5654, P-AUPRO:0.9583
screw: I-Auroc:0.9309, I-AP:0.9769, I-F1:0.9157, P-AUROC:0.9898, P-AP:0.6054, P-F1:0.5806, P-AUPRO:0.9614
toothbrush: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9929, P-AP:0.7318, P-F1:0.7085, P-AUPRO:0.9676
transistor: I-Auroc:0.9996, I-AP:0.9994, I-F1:0.9877, P-AUROC:0.9033, P-AP:0.4876, P-F1:0.4929, P-AUPRO:0.7875
zipper: I-Auroc:0.9976, I-AP:0.9994, I-F1:0.9916, P-AUROC:0.9797, P-AP:0.6481, P-F1:0.6525, P-AUPRO:0.9457
Mean: I-Auroc:0.9883, I-AP:0.9960, I-F1:0.9816, P-AUROC:0.9703, P-AP:0.6528, P-F1:0.6464, P-AUPRO:0.9382




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 3407

cuda:0
shots: 1
carpet: I-Auroc:0.9948, I-AP:0.9984, I-F1:0.9831, P-AUROC:0.9942, P-AP:0.8139, P-F1:0.7444, P-AUPRO:0.9689
grid: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9945, P-AP:0.5766, P-F1:0.5917, P-AUPRO:0.9790
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9910, P-AP:0.4820, P-F1:0.4831, P-AUPRO:0.9634
tile: I-Auroc:0.9986, I-AP:0.9994, I-F1:0.9881, P-AUROC:0.9775, P-AP:0.7449, P-F1:0.7513, P-AUPRO:0.9132
wood: I-Auroc:0.9930, I-AP:0.9978, I-F1:0.9836, P-AUROC:0.9609, P-AP:0.6925, P-F1:0.6741, P-AUPRO:0.9432
bottle: I-Auroc:0.9714, I-AP:0.9922, I-F1:0.9672, P-AUROC:0.9655, P-AP:0.7868, P-F1:0.7377, P-AUPRO:0.9317
cable: I-Auroc:0.9310, I-AP:0.9638, I-F1:0.8852, P-AUROC:0.9298, P-AP:0.5662, P-F1:0.5950, P-AUPRO:0.8515
capsule: I-Auroc:0.9609, I-AP:0.9913, I-F1:0.9633, P-AUROC:0.9715, P-AP:0.5322, P-F1:0.5287, P-AUPRO:0.9611
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9933, P-AP:0.8091, P-F1:0.7746, P-AUPRO:0.9714
metal_nut: I-Auroc:0.9863, I-AP:0.9971, I-F1:0.9838, P-AUROC:0.9018, P-AP:0.6350, P-F1:0.6178, P-AUPRO:0.8705
pill: I-Auroc:0.9768, I-AP:0.9959, I-F1:0.9648, P-AUROC:0.9146, P-AP:0.5041, P-F1:0.5258, P-AUPRO:0.9523
screw: I-Auroc:0.7258, I-AP:0.8911, I-F1:0.8821, P-AUROC:0.9780, P-AP:0.4367, P-F1:0.4790, P-AUPRO:0.9177
toothbrush: I-Auroc:0.9917, I-AP:0.9970, I-F1:0.9831, P-AUROC:0.9906, P-AP:0.7063, P-F1:0.6745, P-AUPRO:0.9590
transistor: I-Auroc:0.9854, I-AP:0.9790, I-F1:0.9512, P-AUROC:0.8947, P-AP:0.4471, P-F1:0.4621, P-AUPRO:0.7492
zipper: I-Auroc:0.9958, I-AP:0.9988, I-F1:0.9917, P-AUROC:0.9725, P-AP:0.6037, P-F1:0.6085, P-AUPRO:0.9258
Mean: I-Auroc:0.9674, I-AP:0.9868, I-F1:0.9685, P-AUROC:0.9620, P-AP:0.6225, P-F1:0.6165, P-AUPRO:0.9239
cuda:0
shots: 2
carpet: I-Auroc:0.9976, I-AP:0.9992, I-F1:0.9889, P-AUROC:0.9945, P-AP:0.8116, P-F1:0.7444, P-AUPRO:0.9726
grid: I-Auroc:0.9992, I-AP:0.9997, I-F1:0.9913, P-AUROC:0.9943, P-AP:0.5647, P-F1:0.5876, P-AUPRO:0.9780
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9914, P-AP:0.4797, P-F1:0.4929, P-AUPRO:0.9690
tile: I-Auroc:0.9986, I-AP:0.9994, I-F1:0.9881, P-AUROC:0.9770, P-AP:0.7377, P-F1:0.7479, P-AUPRO:0.9074
wood: I-Auroc:0.9930, I-AP:0.9978, I-F1:0.9836, P-AUROC:0.9621, P-AP:0.6966, P-F1:0.6710, P-AUPRO:0.9450
bottle: I-Auroc:0.9722, I-AP:0.9926, I-F1:0.9672, P-AUROC:0.9697, P-AP:0.7999, P-F1:0.7484, P-AUPRO:0.9391
cable: I-Auroc:0.9404, I-AP:0.9703, I-F1:0.9081, P-AUROC:0.9301, P-AP:0.5882, P-F1:0.6158, P-AUPRO:0.8564
capsule: I-Auroc:0.9705, I-AP:0.9932, I-F1:0.9722, P-AUROC:0.9760, P-AP:0.5645, P-F1:0.5468, P-AUPRO:0.9654
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9939, P-AP:0.8266, P-F1:0.7855, P-AUPRO:0.9698
metal_nut: I-Auroc:0.9951, I-AP:0.9989, I-F1:0.9892, P-AUROC:0.9343, P-AP:0.7351, P-F1:0.7331, P-AUPRO:0.9042
pill: I-Auroc:0.9812, I-AP:0.9967, I-F1:0.9821, P-AUROC:0.9222, P-AP:0.5283, P-F1:0.5442, P-AUPRO:0.9568
screw: I-Auroc:0.9037, I-AP:0.9679, I-F1:0.8984, P-AUROC:0.9896, P-AP:0.5624, P-F1:0.5591, P-AUPRO:0.9580
toothbrush: I-Auroc:0.9972, I-AP:0.9989, I-F1:0.9836, P-AUROC:0.9924, P-AP:0.7151, P-F1:0.6933, P-AUPRO:0.9628
transistor: I-Auroc:0.9908, I-AP:0.9869, I-F1:0.9487, P-AUROC:0.8995, P-AP:0.4816, P-F1:0.4902, P-AUPRO:0.7642
zipper: I-Auroc:0.9995, I-AP:0.9999, I-F1:0.9958, P-AUROC:0.9767, P-AP:0.6330, P-F1:0.6358, P-AUPRO:0.9364
Mean: I-Auroc:0.9826, I-AP:0.9934, I-F1:0.9732, P-AUROC:0.9669, P-AP:0.6483, P-F1:0.6397, P-AUPRO:0.9323
cuda:0
shots: 4
carpet: I-Auroc:0.9980, I-AP:0.9994, I-F1:0.9944, P-AUROC:0.9943, P-AP:0.7974, P-F1:0.7319, P-AUPRO:0.9743
grid: I-Auroc:0.9983, I-AP:0.9994, I-F1:0.9912, P-AUROC:0.9942, P-AP:0.5611, P-F1:0.5833, P-AUPRO:0.9778
leather: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9910, P-AP:0.4711, P-F1:0.4790, P-AUPRO:0.9675
tile: I-Auroc:0.9996, I-AP:0.9999, I-F1:0.9941, P-AUROC:0.9761, P-AP:0.7264, P-F1:0.7432, P-AUPRO:0.9011
wood: I-Auroc:0.9895, I-AP:0.9966, I-F1:0.9836, P-AUROC:0.9680, P-AP:0.7003, P-F1:0.6732, P-AUPRO:0.9472
bottle: I-Auroc:0.9770, I-AP:0.9936, I-F1:0.9672, P-AUROC:0.9746, P-AP:0.8127, P-F1:0.7574, P-AUPRO:0.9459
cable: I-Auroc:0.9316, I-AP:0.9678, I-F1:0.9153, P-AUROC:0.9350, P-AP:0.6020, P-F1:0.6298, P-AUPRO:0.8659
capsule: I-Auroc:0.9697, I-AP:0.9933, I-F1:0.9683, P-AUROC:0.9793, P-AP:0.5932, P-F1:0.5698, P-AUPRO:0.9721
hazelnut: I-Auroc:1.0000, I-AP:1.0000, I-F1:1.0000, P-AUROC:0.9942, P-AP:0.8262, P-F1:0.7848, P-AUPRO:0.9726
metal_nut: I-Auroc:0.9976, I-AP:0.9995, I-F1:0.9946, P-AUROC:0.9401, P-AP:0.7424, P-F1:0.7406, P-AUPRO:0.9094
pill: I-Auroc:0.9801, I-AP:0.9964, I-F1:0.9784, P-AUROC:0.9275, P-AP:0.5450, P-F1:0.5582, P-AUPRO:0.9588
screw: I-Auroc:0.9274, I-AP:0.9773, I-F1:0.9114, P-AUROC:0.9905, P-AP:0.5695, P-F1:0.5611, P-AUPRO:0.9607
toothbrush: I-Auroc:0.9944, I-AP:0.9979, I-F1:0.9831, P-AUROC:0.9929, P-AP:0.7235, P-F1:0.7073, P-AUPRO:0.9617
transistor: I-Auroc:0.9938, I-AP:0.9898, I-F1:0.9750, P-AUROC:0.9021, P-AP:0.4815, P-F1:0.4902, P-AUPRO:0.7931
zipper: I-Auroc:0.9992, I-AP:0.9998, I-F1:0.9958, P-AUROC:0.9773, P-AP:0.6365, P-F1:0.6369, P-AUPRO:0.9359
Mean: I-Auroc:0.9837, I-AP:0.9940, I-F1:0.9768, P-AUROC:0.9691, P-AP:0.6526, P-F1:0.6431, P-AUPRO:0.9363
