下面是正确的(k=i+1)实验结果：
cuda:4
candle: I-Auroc:0.9333, I-AP:0.9425, I-F1:0.8763, P-AUROC:0.9837, P-AP:0.4326, P-F1:0.4897, P-AUPRO:0.9220
capsules: I-Auroc:0.9690, I-AP:0.9810, I-F1:0.9447, P-AUROC:0.9745, P-AP:0.4157, P-F1:0.4738, P-AUPRO:0.9422
cashew: I-Auroc:0.9336, I-AP:0.9688, I-F1:0.9128, P-AUROC:0.9369, P-AP:0.4106, P-F1:0.4572, P-AUPRO:0.9050
chewinggum: I-Auroc:0.9908, I-AP:0.9956, I-F1:0.9648, P-AUROC:0.9862, P-AP:0.6201, P-F1:0.6703, P-AUPRO:0.8725
fryum: I-Auroc:0.9678, I-AP:0.9858, I-F1:0.9381, P-AUROC:0.9180, P-AP:0.3513, P-F1:0.3927, P-AUPRO:0.8951
macaroni1: I-Auroc:0.6982, I-AP:0.6956, I-F1:0.7452, P-AUROC:0.9839, P-AP:0.1153, P-F1:0.2328, P-AUPRO:0.8954
macaroni2: I-Auroc:0.7117, I-AP:0.6399, I-F1:0.7168, P-AUROC:0.9792, P-AP:0.1406, P-F1:0.2371, P-AUPRO:0.9105
pcb1: I-Auroc:0.8708, I-AP:0.8594, I-F1:0.8442, P-AUROC:0.9870, P-AP:0.6177, P-F1:0.6058, P-AUPRO:0.8913
pcb2: I-Auroc:0.8930, I-AP:0.8547, I-F1:0.8293, P-AUROC:0.9604, P-AP:0.3672, P-F1:0.4715, P-AUPRO:0.8087
pcb3: I-Auroc:0.9037, I-AP:0.9066, I-F1:0.8387, P-AUROC:0.9513, P-AP:0.3903, P-F1:0.4467, P-AUPRO:0.8365
pcb4: I-Auroc:0.9925, I-AP:0.9919, I-F1:0.9569, P-AUROC:0.9261, P-AP:0.2307, P-F1:0.2986, P-AUPRO:0.7913
pipe_fryum: I-Auroc:0.9634, I-AP:0.9822, I-F1:0.9458, P-AUROC:0.9783, P-AP:0.4204, P-F1:0.5092, P-AUPRO:0.9404
Mean: I-Auroc:0.9023, I-AP:0.9003, I-F1:0.8762, P-AUROC:0.9638, P-AP:0.3761, P-F1:0.4404, P-AUPRO:0.8843
cuda:4
candle: I-Auroc:0.9436, I-AP:0.9507, I-F1:0.8878, P-AUROC:0.9844, P-AP:0.4468, P-F1:0.4972, P-AUPRO:0.9139
capsules: I-Auroc:0.9732, I-AP:0.9827, I-F1:0.9490, P-AUROC:0.9788, P-AP:0.4486, P-F1:0.4953, P-AUPRO:0.9452
cashew: I-Auroc:0.9418, I-AP:0.9720, I-F1:0.9275, P-AUROC:0.9308, P-AP:0.4027, P-F1:0.4556, P-AUPRO:0.9096
chewinggum: I-Auroc:0.9892, I-AP:0.9949, I-F1:0.9596, P-AUROC:0.9854, P-AP:0.6136, P-F1:0.6692, P-AUPRO:0.8677
fryum: I-Auroc:0.9766, I-AP:0.9892, I-F1:0.9490, P-AUROC:0.9220, P-AP:0.3621, P-F1:0.4026, P-AUPRO:0.8875
macaroni1: I-Auroc:0.8627, I-AP:0.8631, I-F1:0.7941, P-AUROC:0.9832, P-AP:0.1489, P-F1:0.2715, P-AUPRO:0.8845
macaroni2: I-Auroc:0.6730, I-AP:0.5990, I-F1:0.7280, P-AUROC:0.9804, P-AP:0.0908, P-F1:0.1710, P-AUPRO:0.9132
pcb1: I-Auroc:0.8659, I-AP:0.8464, I-F1:0.8351, P-AUROC:0.9882, P-AP:0.6379, P-F1:0.6282, P-AUPRO:0.8922
pcb2: I-Auroc:0.9131, I-AP:0.8648, I-F1:0.8545, P-AUROC:0.9643, P-AP:0.3819, P-F1:0.4892, P-AUPRO:0.8355
pcb3: I-Auroc:0.9142, I-AP:0.9201, I-F1:0.8442, P-AUROC:0.9590, P-AP:0.4531, P-F1:0.4982, P-AUPRO:0.8373
pcb4: I-Auroc:0.9924, I-AP:0.9913, I-F1:0.9756, P-AUROC:0.9371, P-AP:0.2527, P-F1:0.3154, P-AUPRO:0.8099
pipe_fryum: I-Auroc:0.9726, I-AP:0.9875, I-F1:0.9505, P-AUROC:0.9803, P-AP:0.4297, P-F1:0.5200, P-AUPRO:0.9482
Mean: I-Auroc:0.9182, I-AP:0.9135, I-F1:0.8879, P-AUROC:0.9662, P-AP:0.3891, P-F1:0.4511, P-AUPRO:0.8870
cuda:4
candle: I-Auroc:0.9565, I-AP:0.9580, I-F1:0.8945, P-AUROC:0.9865, P-AP:0.4599, P-F1:0.4979, P-AUPRO:0.9189
capsules: I-Auroc:0.9690, I-AP:0.9807, I-F1:0.9490, P-AUROC:0.9842, P-AP:0.5438, P-F1:0.5608, P-AUPRO:0.9586
cashew: I-Auroc:0.9576, I-AP:0.9810, I-F1:0.9353, P-AUROC:0.9349, P-AP:0.4224, P-F1:0.4703, P-AUPRO:0.9149
chewinggum: I-Auroc:0.9868, I-AP:0.9942, I-F1:0.9655, P-AUROC:0.9851, P-AP:0.6387, P-F1:0.6726, P-AUPRO:0.8620
fryum: I-Auroc:0.9852, I-AP:0.9929, I-F1:0.9596, P-AUROC:0.9306, P-AP:0.3832, P-F1:0.4230, P-AUPRO:0.8964
macaroni1: I-Auroc:0.8544, I-AP:0.8532, I-F1:0.8056, P-AUROC:0.9839, P-AP:0.1717, P-F1:0.2986, P-AUPRO:0.8951
macaroni2: I-Auroc:0.7515, I-AP:0.7048, I-F1:0.7565, P-AUROC:0.9855, P-AP:0.1730, P-F1:0.2754, P-AUPRO:0.9296
pcb1: I-Auroc:0.8794, I-AP:0.8493, I-F1:0.8544, P-AUROC:0.9899, P-AP:0.6587, P-F1:0.6523, P-AUPRO:0.9029
pcb2: I-Auroc:0.9283, I-AP:0.8841, I-F1:0.8868, P-AUROC:0.9674, P-AP:0.4037, P-F1:0.5093, P-AUPRO:0.8471
pcb3: I-Auroc:0.9247, I-AP:0.9391, I-F1:0.8696, P-AUROC:0.9658, P-AP:0.4762, P-F1:0.5233, P-AUPRO:0.8616
pcb4: I-Auroc:0.9926, I-AP:0.9920, I-F1:0.9662, P-AUROC:0.9512, P-AP:0.3258, P-F1:0.3858, P-AUPRO:0.8530
pipe_fryum: I-Auroc:0.9798, I-AP:0.9911, I-F1:0.9596, P-AUROC:0.9826, P-AP:0.4356, P-F1:0.5318, P-AUPRO:0.9506
Mean: I-Auroc:0.9305, I-AP:0.9267, I-F1:0.9002, P-AUROC:0.9706, P-AP:0.4244, P-F1:0.4834, P-AUPRO:0.8992

-------------------------------------------------------------------------------------------------------------------------------------

# 以下变换后的检测；brightness=1.1, contrast=1.1, saturation=1.1
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug

cuda:4
candle: I-Auroc:0.9636, I-AP:0.9695, I-F1:0.9020, P-AUROC:0.9903, P-AP:0.4535, P-F1:0.5040, P-AUPRO:0.9495
capsules: I-Auroc:0.9567, I-AP:0.9745, I-F1:0.9293, P-AUROC:0.9784, P-AP:0.4869, P-F1:0.5278, P-AUPRO:0.9457
cashew: I-Auroc:0.9366, I-AP:0.9700, I-F1:0.9082, P-AUROC:0.9750, P-AP:0.5340, P-F1:0.5509, P-AUPRO:0.9378
chewinggum: I-Auroc:0.9892, I-AP:0.9953, I-F1:0.9749, P-AUROC:0.9906, P-AP:0.6337, P-F1:0.6319, P-AUPRO:0.9033
fryum: I-Auroc:0.9236, I-AP:0.9660, I-F1:0.8879, P-AUROC:0.9179, P-AP:0.3493, P-F1:0.3908, P-AUPRO:0.8935
macaroni1: I-Auroc:0.8636, I-AP:0.8786, I-F1:0.7860, P-AUROC:0.9919, P-AP:0.2502, P-F1:0.3414, P-AUPRO:0.9419
macaroni2: I-Auroc:0.5874, I-AP:0.5476, I-F1:0.6739, P-AUROC:0.9718, P-AP:0.0719, P-F1:0.1606, P-AUPRO:0.8905
pcb1: I-Auroc:0.5156, I-AP:0.5991, I-F1:0.7021, P-AUROC:0.9654, P-AP:0.4121, P-F1:0.4443, P-AUPRO:0.7599
pcb2: I-Auroc:0.9091, I-AP:0.9215, I-F1:0.8485, P-AUROC:0.9603, P-AP:0.4491, P-F1:0.4831, P-AUPRO:0.8149
pcb3: I-Auroc:0.9212, I-AP:0.9171, I-F1:0.8720, P-AUROC:0.9690, P-AP:0.4216, P-F1:0.4666, P-AUPRO:0.8566
pcb4: I-Auroc:0.9931, I-AP:0.9928, I-F1:0.9569, P-AUROC:0.9438, P-AP:0.2563, P-F1:0.3242, P-AUPRO:0.8089
pipe_fryum: I-Auroc:0.9386, I-AP:0.9714, I-F1:0.9137, P-AUROC:0.9835, P-AP:0.4443, P-F1:0.5200, P-AUPRO:0.9563
Mean: I-Auroc:0.8749, I-AP:0.8919, I-F1:0.8630, P-AUROC:0.9698, P-AP:0.3969, P-F1:0.4455, P-AUPRO:0.8882
cuda:4
candle: I-Auroc:0.9736, I-AP:0.9772, I-F1:0.9146, P-AUROC:0.9908, P-AP:0.4640, P-F1:0.5077, P-AUPRO:0.9455
capsules: I-Auroc:0.9613, I-AP:0.9766, I-F1:0.9360, P-AUROC:0.9816, P-AP:0.5058, P-F1:0.5409, P-AUPRO:0.9510
cashew: I-Auroc:0.9418, I-AP:0.9717, I-F1:0.9179, P-AUROC:0.9756, P-AP:0.5315, P-F1:0.5531, P-AUPRO:0.9508
chewinggum: I-Auroc:0.9922, I-AP:0.9964, I-F1:0.9749, P-AUROC:0.9905, P-AP:0.6243, P-F1:0.6324, P-AUPRO:0.8994
fryum: I-Auroc:0.9346, I-AP:0.9693, I-F1:0.8976, P-AUROC:0.9202, P-AP:0.3545, P-F1:0.3959, P-AUPRO:0.8822
macaroni1: I-Auroc:0.9189, I-AP:0.9260, I-F1:0.8407, P-AUROC:0.9922, P-AP:0.2703, P-F1:0.3593, P-AUPRO:0.9373
macaroni2: I-Auroc:0.5975, I-AP:0.5663, I-F1:0.6715, P-AUROC:0.9714, P-AP:0.0565, P-F1:0.1368, P-AUPRO:0.8880
pcb1: I-Auroc:0.4962, I-AP:0.5656, I-F1:0.7071, P-AUROC:0.9647, P-AP:0.3946, P-F1:0.4313, P-AUPRO:0.7568
pcb2: I-Auroc:0.9231, I-AP:0.9180, I-F1:0.8497, P-AUROC:0.9682, P-AP:0.4640, P-F1:0.4983, P-AUPRO:0.8457
pcb3: I-Auroc:0.9359, I-AP:0.9375, I-F1:0.8826, P-AUROC:0.9733, P-AP:0.4646, P-F1:0.4998, P-AUPRO:0.8535
pcb4: I-Auroc:0.9905, I-AP:0.9892, I-F1:0.9615, P-AUROC:0.9536, P-AP:0.2656, P-F1:0.3296, P-AUPRO:0.8354
pipe_fryum: I-Auroc:0.9528, I-AP:0.9776, I-F1:0.9223, P-AUROC:0.9851, P-AP:0.4596, P-F1:0.5367, P-AUPRO:0.9621
Mean: I-Auroc:0.8849, I-AP:0.8976, I-F1:0.8730, P-AUROC:0.9723, P-AP:0.4046, P-F1:0.4518, P-AUPRO:0.8923
cuda:4
candle: I-Auroc:0.9767, I-AP:0.9795, I-F1:0.9254, P-AUROC:0.9918, P-AP:0.4707, P-F1:0.5145, P-AUPRO:0.9499
capsules: I-Auroc:0.9573, I-AP:0.9748, I-F1:0.9495, P-AUROC:0.9865, P-AP:0.5866, P-F1:0.5939, P-AUPRO:0.9595
cashew: I-Auroc:0.9596, I-AP:0.9804, I-F1:0.9231, P-AUROC:0.9775, P-AP:0.5509, P-F1:0.5772, P-AUPRO:0.9561
chewinggum: I-Auroc:0.9938, I-AP:0.9971, I-F1:0.9798, P-AUROC:0.9902, P-AP:0.6455, P-F1:0.6422, P-AUPRO:0.9018
fryum: I-Auroc:0.9690, I-AP:0.9835, I-F1:0.9423, P-AUROC:0.9313, P-AP:0.3815, P-F1:0.4262, P-AUPRO:0.8992
macaroni1: I-Auroc:0.9643, I-AP:0.9639, I-F1:0.9187, P-AUROC:0.9934, P-AP:0.3026, P-F1:0.3881, P-AUPRO:0.9499
macaroni2: I-Auroc:0.6768, I-AP:0.6258, I-F1:0.7011, P-AUROC:0.9801, P-AP:0.1169, P-F1:0.2046, P-AUPRO:0.9167
pcb1: I-Auroc:0.8450, I-AP:0.8366, I-F1:0.8169, P-AUROC:0.9868, P-AP:0.6271, P-F1:0.6372, P-AUPRO:0.8791
pcb2: I-Auroc:0.9481, I-AP:0.9311, I-F1:0.9135, P-AUROC:0.9704, P-AP:0.4773, P-F1:0.5123, P-AUPRO:0.8594
pcb3: I-Auroc:0.9473, I-AP:0.9548, I-F1:0.8958, P-AUROC:0.9763, P-AP:0.4855, P-F1:0.5174, P-AUPRO:0.8730
pcb4: I-Auroc:0.9916, I-AP:0.9909, I-F1:0.9662, P-AUROC:0.9666, P-AP:0.3610, P-F1:0.4199, P-AUPRO:0.8811
pipe_fryum: I-Auroc:0.9658, I-AP:0.9831, I-F1:0.9406, P-AUROC:0.9858, P-AP:0.4688, P-F1:0.5512, P-AUPRO:0.9628
Mean: I-Auroc:0.9329, I-AP:0.9335, I-F1:0.9061, P-AUROC:0.9781, P-AP:0.4562, P-F1:0.4987, P-AUPRO:0.9157

-------------------------------------------------------------------------------------------------------------------------------------

# 以下变换后的检测；brightness=1.2, contrast=1.2, saturation=1.2
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug

cuda:4
shots: 1
candle: I-Auroc:0.9628, I-AP:0.9688, I-F1:0.8973, P-AUROC:0.9905, P-AP:0.4481, P-F1:0.4919, P-AUPRO:0.9487
capsules: I-Auroc:0.9560, I-AP:0.9744, I-F1:0.9293, P-AUROC:0.9789, P-AP:0.4899, P-F1:0.5305, P-AUPRO:0.9451
cashew: I-Auroc:0.9364, I-AP:0.9701, I-F1:0.9091, P-AUROC:0.9755, P-AP:0.5361, P-F1:0.5514, P-AUPRO:0.9406
chewinggum: I-Auroc:0.9876, I-AP:0.9948, I-F1:0.9749, P-AUROC:0.9903, P-AP:0.6267, P-F1:0.6320, P-AUPRO:0.9054
fryum: I-Auroc:0.9288, I-AP:0.9681, I-F1:0.8962, P-AUROC:0.9163, P-AP:0.3488, P-F1:0.3897, P-AUPRO:0.8883
macaroni1: I-Auroc:0.8580, I-AP:0.8737, I-F1:0.7870, P-AUROC:0.9914, P-AP:0.2561, P-F1:0.3414, P-AUPRO:0.9439
macaroni2: I-Auroc:0.5758, I-AP:0.5375, I-F1:0.6689, P-AUROC:0.9704, P-AP:0.0619, P-F1:0.1440, P-AUPRO:0.8881
pcb1: I-Auroc:0.5087, I-AP:0.5940, I-F1:0.7029, P-AUROC:0.9648, P-AP:0.4008, P-F1:0.4335, P-AUPRO:0.7589
pcb2: I-Auroc:0.9125, I-AP:0.9235, I-F1:0.8528, P-AUROC:0.9602, P-AP:0.4499, P-F1:0.4855, P-AUPRO:0.8113
pcb3: I-Auroc:0.9215, I-AP:0.9155, I-F1:0.8720, P-AUROC:0.9690, P-AP:0.4186, P-F1:0.4635, P-AUPRO:0.8553
pcb4: I-Auroc:0.9931, I-AP:0.9928, I-F1:0.9662, P-AUROC:0.9475, P-AP:0.2670, P-F1:0.3323, P-AUPRO:0.8150
pipe_fryum: I-Auroc:0.9374, I-AP:0.9706, I-F1:0.9091, P-AUROC:0.9835, P-AP:0.4465, P-F1:0.5222, P-AUPRO:0.9558
Mean: I-Auroc:0.8732, I-AP:0.8903, I-F1:0.8638, P-AUROC:0.9699, P-AP:0.3959, P-F1:0.4432, P-AUPRO:0.8880
cuda:4
shots: 2
candle: I-Auroc:0.9742, I-AP:0.9780, I-F1:0.9175, P-AUROC:0.9915, P-AP:0.4610, P-F1:0.4979, P-AUPRO:0.9513
capsules: I-Auroc:0.9610, I-AP:0.9763, I-F1:0.9314, P-AUROC:0.9820, P-AP:0.5068, P-F1:0.5417, P-AUPRO:0.9508
cashew: I-Auroc:0.9450, I-AP:0.9728, I-F1:0.9171, P-AUROC:0.9759, P-AP:0.5328, P-F1:0.5536, P-AUPRO:0.9528
chewinggum: I-Auroc:0.9914, I-AP:0.9960, I-F1:0.9749, P-AUROC:0.9903, P-AP:0.6193, P-F1:0.6338, P-AUPRO:0.8974
fryum: I-Auroc:0.9332, I-AP:0.9691, I-F1:0.9082, P-AUROC:0.9190, P-AP:0.3538, P-F1:0.3952, P-AUPRO:0.8812
macaroni1: I-Auroc:0.9080, I-AP:0.9161, I-F1:0.8340, P-AUROC:0.9918, P-AP:0.2699, P-F1:0.3531, P-AUPRO:0.9350
macaroni2: I-Auroc:0.5882, I-AP:0.5565, I-F1:0.6787, P-AUROC:0.9698, P-AP:0.0514, P-F1:0.1251, P-AUPRO:0.8822
pcb1: I-Auroc:0.4887, I-AP:0.5607, I-F1:0.7046, P-AUROC:0.9642, P-AP:0.3866, P-F1:0.4244, P-AUPRO:0.7535
pcb2: I-Auroc:0.9292, I-AP:0.9221, I-F1:0.8599, P-AUROC:0.9680, P-AP:0.4642, P-F1:0.4977, P-AUPRO:0.8474
pcb3: I-Auroc:0.9354, I-AP:0.9372, I-F1:0.8868, P-AUROC:0.9733, P-AP:0.4640, P-F1:0.5004, P-AUPRO:0.8527
pcb4: I-Auroc:0.9904, I-AP:0.9892, I-F1:0.9608, P-AUROC:0.9553, P-AP:0.2712, P-F1:0.3327, P-AUPRO:0.8292
pipe_fryum: I-Auroc:0.9544, I-AP:0.9780, I-F1:0.9314, P-AUROC:0.9852, P-AP:0.4623, P-F1:0.5385, P-AUPRO:0.9616
Mean: I-Auroc:0.8833, I-AP:0.8960, I-F1:0.8754, P-AUROC:0.9722, P-AP:0.4036, P-F1:0.4495, P-AUPRO:0.8913
cuda:4
shots: 4
candle: I-Auroc:0.9765, I-AP:0.9795, I-F1:0.9263, P-AUROC:0.9924, P-AP:0.4609, P-F1:0.5087, P-AUPRO:0.9546
capsules: I-Auroc:0.9588, I-AP:0.9752, I-F1:0.9458, P-AUROC:0.9868, P-AP:0.5865, P-F1:0.5952, P-AUPRO:0.9571
cashew: I-Auroc:0.9616, I-AP:0.9809, I-F1:0.9239, P-AUROC:0.9779, P-AP:0.5498, P-F1:0.5745, P-AUPRO:0.9540
chewinggum: I-Auroc:0.9910, I-AP:0.9962, I-F1:0.9798, P-AUROC:0.9901, P-AP:0.6402, P-F1:0.6443, P-AUPRO:0.9008
fryum: I-Auroc:0.9694, I-AP:0.9839, I-F1:0.9447, P-AUROC:0.9296, P-AP:0.3806, P-F1:0.4263, P-AUPRO:0.8958
macaroni1: I-Auroc:0.9610, I-AP:0.9597, I-F1:0.9194, P-AUROC:0.9933, P-AP:0.3058, P-F1:0.3814, P-AUPRO:0.9498
macaroni2: I-Auroc:0.6644, I-AP:0.6112, I-F1:0.6960, P-AUROC:0.9789, P-AP:0.1076, P-F1:0.1880, P-AUPRO:0.9115
pcb1: I-Auroc:0.8437, I-AP:0.8332, I-F1:0.8208, P-AUROC:0.9867, P-AP:0.6256, P-F1:0.6373, P-AUPRO:0.8819
pcb2: I-Auroc:0.9490, I-AP:0.9318, I-F1:0.9179, P-AUROC:0.9701, P-AP:0.4757, P-F1:0.5109, P-AUPRO:0.8563
pcb3: I-Auroc:0.9484, I-AP:0.9552, I-F1:0.8923, P-AUROC:0.9763, P-AP:0.4839, P-F1:0.5157, P-AUPRO:0.8761
pcb4: I-Auroc:0.9912, I-AP:0.9905, I-F1:0.9662, P-AUROC:0.9671, P-AP:0.3648, P-F1:0.4232, P-AUPRO:0.8780
pipe_fryum: I-Auroc:0.9670, I-AP:0.9840, I-F1:0.9453, P-AUROC:0.9859, P-AP:0.4696, P-F1:0.5530, P-AUPRO:0.9618
Mean: I-Auroc:0.9318, I-AP:0.9318, I-F1:0.9065, P-AUROC:0.9779, P-AP:0.4543, P-F1:0.4965, P-AUPRO:0.9148

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=1.1, contrast=1.1, saturation=1.1
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
5:5
不行的！
cuda:4
shots: 1
candle: I-Auroc:0.9549, I-AP:0.9621, I-F1:0.8800, P-AUROC:0.9913, P-AP:0.4470, P-F1:0.4923, P-AUPRO:0.9550
capsules: I-Auroc:0.9508, I-AP:0.9714, I-F1:0.9163, P-AUROC:0.9794, P-AP:0.4998, P-F1:0.5506, P-AUPRO:0.9370
cashew: I-Auroc:0.9260, I-AP:0.9646, I-F1:0.9100, P-AUROC:0.9811, P-AP:0.5522, P-F1:0.5621, P-AUPRO:0.9417
chewinggum: I-Auroc:0.9774, I-AP:0.9893, I-F1:0.9548, P-AUROC:0.9905, P-AP:0.5872, P-F1:0.5840, P-AUPRO:0.9080
fryum: I-Auroc:0.9172, I-AP:0.9634, I-F1:0.8952, P-AUROC:0.9138, P-AP:0.3487, P-F1:0.3898, P-AUPRO:0.8858
macaroni1: I-Auroc:0.8300, I-AP:0.8269, I-F1:0.7818, P-AUROC:0.9915, P-AP:0.2379, P-F1:0.3458, P-AUPRO:0.9434
macaroni2: I-Auroc:0.5470, I-AP:0.5223, I-F1:0.6689, P-AUROC:0.9640, P-AP:0.0500, P-F1:0.1293, P-AUPRO:0.8681
pcb1: I-Auroc:0.5113, I-AP:0.6009, I-F1:0.7050, P-AUROC:0.9624, P-AP:0.3695, P-F1:0.4175, P-AUPRO:0.7559
pcb2: I-Auroc:0.9113, I-AP:0.9331, I-F1:0.8488, P-AUROC:0.9575, P-AP:0.4526, P-F1:0.4866, P-AUPRO:0.8088
pcb3: I-Auroc:0.9136, I-AP:0.9060, I-F1:0.8624, P-AUROC:0.9699, P-AP:0.4195, P-F1:0.4643, P-AUPRO:0.8654
pcb4: I-Auroc:0.9873, I-AP:0.9861, I-F1:0.9490, P-AUROC:0.9462, P-AP:0.2478, P-F1:0.3171, P-AUPRO:0.8083
pipe_fryum: I-Auroc:0.9260, I-AP:0.9652, I-F1:0.9038, P-AUROC:0.9841, P-AP:0.4480, P-F1:0.5225, P-AUPRO:0.9572
Mean: I-Auroc:0.8627, I-AP:0.8826, I-F1:0.8563, P-AUROC:0.9693, P-AP:0.3884, P-F1:0.4385, P-AUPRO:0.8862

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug

cuda:4
shots: 1
candle: I-Auroc:0.9540, I-AP:0.9631, I-F1:0.9072, P-AUROC:0.9903, P-AP:0.4427, P-F1:0.5049, P-AUPRO:0.9496
capsules: I-Auroc:0.9555, I-AP:0.9729, I-F1:0.9293, P-AUROC:0.9776, P-AP:0.4941, P-F1:0.5311, P-AUPRO:0.9432
cashew: I-Auroc:0.9354, I-AP:0.9690, I-F1:0.9062, P-AUROC:0.9729, P-AP:0.5134, P-F1:0.5324, P-AUPRO:0.9372
chewinggum: I-Auroc:0.9928, I-AP:0.9967, I-F1:0.9746, P-AUROC:0.9909, P-AP:0.6450, P-F1:0.6367, P-AUPRO:0.9050
fryum: I-Auroc:0.9288, I-AP:0.9687, I-F1:0.8913, P-AUROC:0.9204, P-AP:0.3506, P-F1:0.3926, P-AUPRO:0.8923
macaroni1: I-Auroc:0.8764, I-AP:0.8863, I-F1:0.8158, P-AUROC:0.9919, P-AP:0.2531, P-F1:0.3511, P-AUPRO:0.9432
macaroni2: I-Auroc:0.6102, I-AP:0.5692, I-F1:0.6836, P-AUROC:0.9737, P-AP:0.0904, P-F1:0.1858, P-AUPRO:0.8958
pcb1: I-Auroc:0.5382, I-AP:0.6143, I-F1:0.7025, P-AUROC:0.9662, P-AP:0.4268, P-F1:0.4528, P-AUPRO:0.7679
pcb2: I-Auroc:0.9124, I-AP:0.9237, I-F1:0.8426, P-AUROC:0.9603, P-AP:0.4465, P-F1:0.4831, P-AUPRO:0.8066
pcb3: I-Auroc:0.9238, I-AP:0.9200, I-F1:0.8774, P-AUROC:0.9687, P-AP:0.4264, P-F1:0.4726, P-AUPRO:0.8587
pcb4: I-Auroc:0.9937, I-AP:0.9935, I-F1:0.9615, P-AUROC:0.9415, P-AP:0.2542, P-F1:0.3250, P-AUPRO:0.8137
pipe_fryum: I-Auroc:0.9432, I-AP:0.9737, I-F1:0.9109, P-AUROC:0.9831, P-AP:0.4405, P-F1:0.5176, P-AUPRO:0.9574
Mean: I-Auroc:0.8804, I-AP:0.8959, I-F1:0.8669, P-AUROC:0.9698, P-AP:0.3986, P-F1:0.4488, P-AUPRO:0.8892
cuda:4
shots: 2
candle: I-Auroc:0.9663, I-AP:0.9723, I-F1:0.9167, P-AUROC:0.9907, P-AP:0.4592, P-F1:0.5090, P-AUPRO:0.9466
capsules: I-Auroc:0.9618, I-AP:0.9760, I-F1:0.9360, P-AUROC:0.9809, P-AP:0.5115, P-F1:0.5424, P-AUPRO:0.9482
cashew: I-Auroc:0.9436, I-AP:0.9720, I-F1:0.9194, P-AUROC:0.9733, P-AP:0.5125, P-F1:0.5337, P-AUPRO:0.9490
chewinggum: I-Auroc:0.9946, I-AP:0.9975, I-F1:0.9800, P-AUROC:0.9908, P-AP:0.6321, P-F1:0.6316, P-AUPRO:0.8993
fryum: I-Auroc:0.9368, I-AP:0.9709, I-F1:0.9064, P-AUROC:0.9238, P-AP:0.3589, P-F1:0.3991, P-AUPRO:0.8870
macaroni1: I-Auroc:0.9321, I-AP:0.9379, I-F1:0.8482, P-AUROC:0.9926, P-AP:0.2730, P-F1:0.3668, P-AUPRO:0.9387
macaroni2: I-Auroc:0.6201, I-AP:0.5885, I-F1:0.6745, P-AUROC:0.9738, P-AP:0.0699, P-F1:0.1570, P-AUPRO:0.8968
pcb1: I-Auroc:0.5159, I-AP:0.5794, I-F1:0.7097, P-AUROC:0.9651, P-AP:0.4044, P-F1:0.4372, P-AUPRO:0.7561
pcb2: I-Auroc:0.9218, I-AP:0.9187, I-F1:0.8476, P-AUROC:0.9682, P-AP:0.4616, P-F1:0.4965, P-AUPRO:0.8482
pcb3: I-Auroc:0.9389, I-AP:0.9412, I-F1:0.8910, P-AUROC:0.9734, P-AP:0.4679, P-F1:0.5037, P-AUPRO:0.8541
pcb4: I-Auroc:0.9911, I-AP:0.9899, I-F1:0.9659, P-AUROC:0.9517, P-AP:0.2637, P-F1:0.3302, P-AUPRO:0.8337
pipe_fryum: I-Auroc:0.9588, I-AP:0.9805, I-F1:0.9293, P-AUROC:0.9847, P-AP:0.4563, P-F1:0.5343, P-AUPRO:0.9626
Mean: I-Auroc:0.8902, I-AP:0.9021, I-F1:0.8771, P-AUROC:0.9724, P-AP:0.4059, P-F1:0.4534, P-AUPRO:0.8934
cuda:4
shots: 4
candle: I-Auroc:0.9787, I-AP:0.9811, I-F1:0.9246, P-AUROC:0.9912, P-AP:0.4682, P-F1:0.5110, P-AUPRO:0.9498
capsules: I-Auroc:0.9583, I-AP:0.9750, I-F1:0.9453, P-AUROC:0.9860, P-AP:0.5875, P-F1:0.5930, P-AUPRO:0.9573
cashew: I-Auroc:0.9624, I-AP:0.9819, I-F1:0.9289, P-AUROC:0.9757, P-AP:0.5356, P-F1:0.5593, P-AUPRO:0.9532
chewinggum: I-Auroc:0.9956, I-AP:0.9979, I-F1:0.9751, P-AUROC:0.9905, P-AP:0.6533, P-F1:0.6385, P-AUPRO:0.9013
fryum: I-Auroc:0.9710, I-AP:0.9844, I-F1:0.9500, P-AUROC:0.9346, P-AP:0.3870, P-F1:0.4308, P-AUPRO:0.9081
macaroni1: I-Auroc:0.9704, I-AP:0.9699, I-F1:0.9327, P-AUROC:0.9935, P-AP:0.3015, P-F1:0.3941, P-AUPRO:0.9489
macaroni2: I-Auroc:0.6997, I-AP:0.6591, I-F1:0.7085, P-AUROC:0.9821, P-AP:0.1427, P-F1:0.2299, P-AUPRO:0.9207
pcb1: I-Auroc:0.8485, I-AP:0.8391, I-F1:0.8246, P-AUROC:0.9867, P-AP:0.6306, P-F1:0.6367, P-AUPRO:0.8843
pcb2: I-Auroc:0.9472, I-AP:0.9319, I-F1:0.9073, P-AUROC:0.9706, P-AP:0.4773, P-F1:0.5124, P-AUPRO:0.8581
pcb3: I-Auroc:0.9462, I-AP:0.9554, I-F1:0.8969, P-AUROC:0.9762, P-AP:0.4885, P-F1:0.5205, P-AUPRO:0.8796
pcb4: I-Auroc:0.9927, I-AP:0.9918, I-F1:0.9709, P-AUROC:0.9655, P-AP:0.3585, P-F1:0.4183, P-AUPRO:0.8816
pipe_fryum: I-Auroc:0.9692, I-AP:0.9850, I-F1:0.9505, P-AUROC:0.9856, P-AP:0.4662, P-F1:0.5493, P-AUPRO:0.9635
Mean: I-Auroc:0.9367, I-AP:0.9377, I-F1:0.9096, P-AUROC:0.9782, P-AP:0.4581, P-F1:0.4995, P-AUPRO:0.9172

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = anomaly_map_ori + anomaly_map_aug

cuda:4
shots: 1
candle: I-Auroc:0.9551, I-AP:0.9649, I-F1:0.9043, P-AUROC:0.9917, P-AP:0.4376, P-F1:0.4987, P-AUPRO:0.9522
capsules: I-Auroc:0.9500, I-AP:0.9695, I-F1:0.9216, P-AUROC:0.9785, P-AP:0.5147, P-F1:0.5566, P-AUPRO:0.9356
cashew: I-Auroc:0.9298, I-AP:0.9653, I-F1:0.9010, P-AUROC:0.9784, P-AP:0.5196, P-F1:0.5330, P-AUPRO:0.9386
chewinggum: I-Auroc:0.9868, I-AP:0.9938, I-F1:0.9592, P-AUROC:0.9913, P-AP:0.6175, P-F1:0.6183, P-AUPRO:0.9118
fryum: I-Auroc:0.9284, I-AP:0.9690, I-F1:0.8930, P-AUROC:0.9199, P-AP:0.3542, P-F1:0.3977, P-AUPRO:0.8933
macaroni1: I-Auroc:0.8410, I-AP:0.8310, I-F1:0.7837, P-AUROC:0.9927, P-AP:0.2479, P-F1:0.3590, P-AUPRO:0.9485
macaroni2: I-Auroc:0.5786, I-AP:0.5538, I-F1:0.6715, P-AUROC:0.9692, P-AP:0.0711, P-F1:0.1532, P-AUPRO:0.8855
pcb1: I-Auroc:0.5356, I-AP:0.6214, I-F1:0.7050, P-AUROC:0.9640, P-AP:0.4011, P-F1:0.4377, P-AUPRO:0.7628
pcb2: I-Auroc:0.9173, I-AP:0.9374, I-F1:0.8485, P-AUROC:0.9575, P-AP:0.4477, P-F1:0.4870, P-AUPRO:0.8021
pcb3: I-Auroc:0.9176, I-AP:0.9121, I-F1:0.8756, P-AUROC:0.9692, P-AP:0.4274, P-F1:0.4724, P-AUPRO:0.8603
pcb4: I-Auroc:0.9902, I-AP:0.9893, I-F1:0.9557, P-AUROC:0.9434, P-AP:0.2446, P-F1:0.3180, P-AUPRO:0.8147
pipe_fryum: I-Auroc:0.9340, I-AP:0.9692, I-F1:0.9100, P-AUROC:0.9835, P-AP:0.4426, P-F1:0.5186, P-AUPRO:0.9594
Mean: I-Auroc:0.8720, I-AP:0.8897, I-F1:0.8607, P-AUROC:0.9699, P-AP:0.3938, P-F1:0.4459, P-AUPRO:0.8887
cuda:4
shots: 2
candle: I-Auroc:0.9636, I-AP:0.9714, I-F1:0.9189, P-AUROC:0.9919, P-AP:0.4524, P-F1:0.5074, P-AUPRO:0.9502
capsules: I-Auroc:0.9543, I-AP:0.9722, I-F1:0.9163, P-AUROC:0.9812, P-AP:0.5243, P-F1:0.5638, P-AUPRO:0.9408
cashew: I-Auroc:0.9348, I-AP:0.9668, I-F1:0.9143, P-AUROC:0.9800, P-AP:0.5258, P-F1:0.5393, P-AUPRO:0.9506
chewinggum: I-Auroc:0.9926, I-AP:0.9966, I-F1:0.9749, P-AUROC:0.9916, P-AP:0.6070, P-F1:0.6106, P-AUPRO:0.9085
fryum: I-Auroc:0.9326, I-AP:0.9696, I-F1:0.8980, P-AUROC:0.9241, P-AP:0.3628, P-F1:0.4049, P-AUPRO:0.8891
macaroni1: I-Auroc:0.9264, I-AP:0.9313, I-F1:0.8545, P-AUROC:0.9951, P-AP:0.3064, P-F1:0.4122, P-AUPRO:0.9586
macaroni2: I-Auroc:0.6056, I-AP:0.5795, I-F1:0.6764, P-AUROC:0.9683, P-AP:0.0667, P-F1:0.1553, P-AUPRO:0.8741
pcb1: I-Auroc:0.5041, I-AP:0.5752, I-F1:0.7071, P-AUROC:0.9626, P-AP:0.3757, P-F1:0.4171, P-AUPRO:0.7584
pcb2: I-Auroc:0.9304, I-AP:0.9407, I-F1:0.8482, P-AUROC:0.9645, P-AP:0.4702, P-F1:0.5016, P-AUPRO:0.8366
pcb3: I-Auroc:0.9330, I-AP:0.9354, I-F1:0.8785, P-AUROC:0.9738, P-AP:0.4672, P-F1:0.5039, P-AUPRO:0.8574
pcb4: I-Auroc:0.9871, I-AP:0.9845, I-F1:0.9569, P-AUROC:0.9537, P-AP:0.2491, P-F1:0.3210, P-AUPRO:0.8372
pipe_fryum: I-Auroc:0.9514, I-AP:0.9770, I-F1:0.9293, P-AUROC:0.9853, P-AP:0.4600, P-F1:0.5369, P-AUPRO:0.9644
Mean: I-Auroc:0.8847, I-AP:0.9000, I-F1:0.8728, P-AUROC:0.9727, P-AP:0.4056, P-F1:0.4562, P-AUPRO:0.8938
cuda:4
shots: 4
candle: I-Auroc:0.9764, I-AP:0.9800, I-F1:0.9271, P-AUROC:0.9922, P-AP:0.4540, P-F1:0.5052, P-AUPRO:0.9544
capsules: I-Auroc:0.9530, I-AP:0.9725, I-F1:0.9293, P-AUROC:0.9862, P-AP:0.5930, P-F1:0.6028, P-AUPRO:0.9441
cashew: I-Auroc:0.9526, I-AP:0.9770, I-F1:0.9118, P-AUROC:0.9818, P-AP:0.5511, P-F1:0.5639, P-AUPRO:0.9518
chewinggum: I-Auroc:0.9928, I-AP:0.9966, I-F1:0.9694, P-AUROC:0.9915, P-AP:0.6229, P-F1:0.6159, P-AUPRO:0.9121
fryum: I-Auroc:0.9696, I-AP:0.9842, I-F1:0.9417, P-AUROC:0.9341, P-AP:0.3899, P-F1:0.4339, P-AUPRO:0.9064
macaroni1: I-Auroc:0.9867, I-AP:0.9856, I-F1:0.9505, P-AUROC:0.9960, P-AP:0.3284, P-F1:0.4222, P-AUPRO:0.9684
macaroni2: I-Auroc:0.6645, I-AP:0.6181, I-F1:0.6934, P-AUROC:0.9773, P-AP:0.1150, P-F1:0.1889, P-AUPRO:0.9032
pcb1: I-Auroc:0.8578, I-AP:0.8575, I-F1:0.8269, P-AUROC:0.9848, P-AP:0.6094, P-F1:0.6262, P-AUPRO:0.8722
pcb2: I-Auroc:0.9606, I-AP:0.9615, I-F1:0.8966, P-AUROC:0.9668, P-AP:0.4906, P-F1:0.5201, P-AUPRO:0.8516
pcb3: I-Auroc:0.9470, I-AP:0.9550, I-F1:0.8923, P-AUROC:0.9761, P-AP:0.4936, P-F1:0.5306, P-AUPRO:0.8779
pcb4: I-Auroc:0.9864, I-AP:0.9849, I-F1:0.9569, P-AUROC:0.9675, P-AP:0.3517, P-F1:0.4179, P-AUPRO:0.8845
pipe_fryum: I-Auroc:0.9634, I-AP:0.9821, I-F1:0.9347, P-AUROC:0.9859, P-AP:0.4700, P-F1:0.5527, P-AUPRO:0.9648
Mean: I-Auroc:0.9342, I-AP:0.9379, I-F1:0.9025, P-AUROC:0.9783, P-AP:0.4558, P-F1:0.4983, P-AUPRO:0.9160

-------------------------------------------------------------------------------------------------------------------------------------
img_aug1 = color_jitter_batch(img, 0.9)
supports_aug1 =color_jitter_batch(supports, 0.9)
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)

img_aug2 = color_jitter_batch(img, 1.1)
supports_aug2 =color_jitter_batch(supports, 1.1)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2)   

img_aug3 = color_jitter_batch(img, 1.2)
supports_aug3 =color_jitter_batch(supports, 1.2)
anomaly_map_aug3 = model(img_aug3, supports_aug3, memorize_supports, use_memory, aug=3)  

anomaly_map = 0.7 * anomaly_map_ori + 0.1 * anomaly_map_aug1 + 0.1 * anomaly_map_aug2 + 0.1 * anomaly_map_aug3

cuda:4
shots: 1
candle: I-Auroc:0.9626, I-AP:0.9698, I-F1:0.8980, P-AUROC:0.9907, P-AP:0.4526, P-F1:0.5049, P-AUPRO:0.9495
capsules: I-Auroc:0.9563, I-AP:0.9743, I-F1:0.9293, P-AUROC:0.9784, P-AP:0.4913, P-F1:0.5303, P-AUPRO:0.9448
cashew: I-Auroc:0.9364, I-AP:0.9699, I-F1:0.9082, P-AUROC:0.9747, P-AP:0.5297, P-F1:0.5469, P-AUPRO:0.9375
chewinggum: I-Auroc:0.9888, I-AP:0.9952, I-F1:0.9744, P-AUROC:0.9907, P-AP:0.6369, P-F1:0.6377, P-AUPRO:0.9029
fryum: I-Auroc:0.9272, I-AP:0.9676, I-F1:0.8889, P-AUROC:0.9188, P-AP:0.3507, P-F1:0.3924, P-AUPRO:0.8941
macaroni1: I-Auroc:0.8663, I-AP:0.8791, I-F1:0.7928, P-AUROC:0.9920, P-AP:0.2571, P-F1:0.3450, P-AUPRO:0.9417
macaroni2: I-Auroc:0.5912, I-AP:0.5506, I-F1:0.6763, P-AUROC:0.9723, P-AP:0.0735, P-F1:0.1642, P-AUPRO:0.8947
pcb1: I-Auroc:0.5209, I-AP:0.6033, I-F1:0.7029, P-AUROC:0.9656, P-AP:0.4147, P-F1:0.4452, P-AUPRO:0.7593
pcb2: I-Auroc:0.9117, I-AP:0.9234, I-F1:0.8528, P-AUROC:0.9604, P-AP:0.4500, P-F1:0.4841, P-AUPRO:0.8139
pcb3: I-Auroc:0.9212, I-AP:0.9166, I-F1:0.8732, P-AUROC:0.9690, P-AP:0.4235, P-F1:0.4686, P-AUPRO:0.8593
pcb4: I-Auroc:0.9935, I-AP:0.9932, I-F1:0.9612, P-AUROC:0.9447, P-AP:0.2595, P-F1:0.3275, P-AUPRO:0.8118
pipe_fryum: I-Auroc:0.9406, I-AP:0.9723, I-F1:0.9109, P-AUROC:0.9834, P-AP:0.4442, P-F1:0.5201, P-AUPRO:0.9567
Mean: I-Auroc:0.8764, I-AP:0.8929, I-F1:0.8641, P-AUROC:0.9701, P-AP:0.3986, P-F1:0.4472, P-AUPRO:0.8888
cuda:4
shots: 2
candle: I-Auroc:0.9732, I-AP:0.9778, I-F1:0.9263, P-AUROC:0.9912, P-AP:0.4646, P-F1:0.5085, P-AUPRO:0.9504
capsules: I-Auroc:0.9617, I-AP:0.9765, I-F1:0.9314, P-AUROC:0.9816, P-AP:0.5089, P-F1:0.5421, P-AUPRO:0.9514
cashew: I-Auroc:0.9442, I-AP:0.9725, I-F1:0.9187, P-AUROC:0.9753, P-AP:0.5273, P-F1:0.5481, P-AUPRO:0.9507
chewinggum: I-Auroc:0.9922, I-AP:0.9964, I-F1:0.9749, P-AUROC:0.9906, P-AP:0.6271, P-F1:0.6365, P-AUPRO:0.9008
fryum: I-Auroc:0.9354, I-AP:0.9700, I-F1:0.9020, P-AUROC:0.9215, P-AP:0.3567, P-F1:0.3986, P-AUPRO:0.8840
macaroni1: I-Auroc:0.9209, I-AP:0.9276, I-F1:0.8421, P-AUROC:0.9924, P-AP:0.2745, P-F1:0.3632, P-AUPRO:0.9363
macaroni2: I-Auroc:0.6010, I-AP:0.5690, I-F1:0.6763, P-AUROC:0.9721, P-AP:0.0585, P-F1:0.1388, P-AUPRO:0.8912
pcb1: I-Auroc:0.5014, I-AP:0.5693, I-F1:0.7071, P-AUROC:0.9647, P-AP:0.3964, P-F1:0.4317, P-AUPRO:0.7561
pcb2: I-Auroc:0.9256, I-AP:0.9198, I-F1:0.8502, P-AUROC:0.9682, P-AP:0.4643, P-F1:0.4981, P-AUPRO:0.8457
pcb3: I-Auroc:0.9357, I-AP:0.9378, I-F1:0.8868, P-AUROC:0.9735, P-AP:0.4664, P-F1:0.5017, P-AUPRO:0.8542
pcb4: I-Auroc:0.9906, I-AP:0.9893, I-F1:0.9615, P-AUROC:0.9538, P-AP:0.2672, P-F1:0.3307, P-AUPRO:0.8353
pipe_fryum: I-Auroc:0.9550, I-AP:0.9785, I-F1:0.9293, P-AUROC:0.9850, P-AP:0.4598, P-F1:0.5368, P-AUPRO:0.9622
Mean: I-Auroc:0.8864, I-AP:0.8987, I-F1:0.8755, P-AUROC:0.9725, P-AP:0.4060, P-F1:0.4529, P-AUPRO:0.8932
cuda:4
shots: 4
candle: I-Auroc:0.9778, I-AP:0.9806, I-F1:0.9231, P-AUROC:0.9921, P-AP:0.4692, P-F1:0.5153, P-AUPRO:0.9515
capsules: I-Auroc:0.9585, I-AP:0.9751, I-F1:0.9495, P-AUROC:0.9865, P-AP:0.5876, P-F1:0.5953, P-AUPRO:0.9584
cashew: I-Auroc:0.9626, I-AP:0.9818, I-F1:0.9246, P-AUROC:0.9773, P-AP:0.5469, P-F1:0.5721, P-AUPRO:0.9560
chewinggum: I-Auroc:0.9938, I-AP:0.9972, I-F1:0.9798, P-AUROC:0.9903, P-AP:0.6481, P-F1:0.6454, P-AUPRO:0.9035
fryum: I-Auroc:0.9704, I-AP:0.9842, I-F1:0.9463, P-AUROC:0.9325, P-AP:0.3843, P-F1:0.4293, P-AUPRO:0.9006
macaroni1: I-Auroc:0.9659, I-AP:0.9651, I-F1:0.9275, P-AUROC:0.9935, P-AP:0.3065, P-F1:0.3911, P-AUPRO:0.9524
macaroni2: I-Auroc:0.6807, I-AP:0.6291, I-F1:0.6989, P-AUROC:0.9807, P-AP:0.1227, P-F1:0.2087, P-AUPRO:0.9185
pcb1: I-Auroc:0.8454, I-AP:0.8360, I-F1:0.8208, P-AUROC:0.9868, P-AP:0.6288, P-F1:0.6379, P-AUPRO:0.8800
pcb2: I-Auroc:0.9480, I-AP:0.9312, I-F1:0.9135, P-AUROC:0.9704, P-AP:0.4776, P-F1:0.5123, P-AUPRO:0.8584
pcb3: I-Auroc:0.9478, I-AP:0.9554, I-F1:0.8958, P-AUROC:0.9764, P-AP:0.4868, P-F1:0.5186, P-AUPRO:0.8755
pcb4: I-Auroc:0.9921, I-AP:0.9913, I-F1:0.9709, P-AUROC:0.9666, P-AP:0.3622, P-F1:0.4210, P-AUPRO:0.8796
pipe_fryum: I-Auroc:0.9678, I-AP:0.9843, I-F1:0.9406, P-AUROC:0.9858, P-AP:0.4686, P-F1:0.5517, P-AUPRO:0.9631
Mean: I-Auroc:0.9342, I-AP:0.9343, I-F1:0.9076, P-AUROC:0.9782, P-AP:0.4574, P-F1:0.4999, P-AUPRO:0.9165

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
cuda:4
shots: 1
candle: I-Auroc:0.9494, I-AP:0.9611, I-F1:0.9110, P-AUROC:0.9896, P-AP:0.4563, P-F1:0.5108, P-AUPRO:0.9471
capsules: I-Auroc:0.9663, I-AP:0.9802, I-F1:0.9347, P-AUROC:0.9784, P-AP:0.4807, P-F1:0.5189, P-AUPRO:0.9468
cashew: I-Auroc:0.9346, I-AP:0.9680, I-F1:0.9137, P-AUROC:0.9717, P-AP:0.4797, P-F1:0.4993, P-AUPRO:0.9360
chewinggum: I-Auroc:0.9938, I-AP:0.9971, I-F1:0.9746, P-AUROC:0.9914, P-AP:0.6368, P-F1:0.6312, P-AUPRO:0.9110
fryum: I-Auroc:0.9662, I-AP:0.9851, I-F1:0.9394, P-AUROC:0.9243, P-AP:0.3702, P-F1:0.4108, P-AUPRO:0.9076
macaroni1: I-Auroc:0.8783, I-AP:0.8886, I-F1:0.8111, P-AUROC:0.9928, P-AP:0.2675, P-F1:0.3619, P-AUPRO:0.9473
macaroni2: I-Auroc:0.6804, I-AP:0.6066, I-F1:0.7227, P-AUROC:0.9788, P-AP:0.1206, P-F1:0.2146, P-AUPRO:0.9131
pcb1: I-Auroc:0.8933, I-AP:0.8921, I-F1:0.8627, P-AUROC:0.9871, P-AP:0.6288, P-F1:0.6269, P-AUPRO:0.8934
pcb2: I-Auroc:0.9108, I-AP:0.9239, I-F1:0.8500, P-AUROC:0.9584, P-AP:0.4520, P-F1:0.4993, P-AUPRO:0.8235
pcb3: I-Auroc:0.9062, I-AP:0.9021, I-F1:0.8531, P-AUROC:0.9568, P-AP:0.4437, P-F1:0.4874, P-AUPRO:0.8603
pcb4: I-Auroc:0.9928, I-AP:0.9921, I-F1:0.9662, P-AUROC:0.9381, P-AP:0.2498, P-F1:0.3216, P-AUPRO:0.8197
pipe_fryum: I-Auroc:0.9598, I-AP:0.9809, I-F1:0.9453, P-AUROC:0.9840, P-AP:0.4471, P-F1:0.5287, P-AUPRO:0.9595
Mean: I-Auroc:0.9193, I-AP:0.9232, I-F1:0.8904, P-AUROC:0.9709, P-AP:0.4194, P-F1:0.4676, P-AUPRO:0.9054
cuda:4
shots: 2
candle: I-Auroc:0.9585, I-AP:0.9662, I-F1:0.9110, P-AUROC:0.9899, P-AP:0.4665, P-F1:0.5191, P-AUPRO:0.9446
capsules: I-Auroc:0.9692, I-AP:0.9818, I-F1:0.9436, P-AUROC:0.9815, P-AP:0.5015, P-F1:0.5363, P-AUPRO:0.9498
cashew: I-Auroc:0.9400, I-AP:0.9695, I-F1:0.9179, P-AUROC:0.9723, P-AP:0.4847, P-F1:0.5070, P-AUPRO:0.9481
chewinggum: I-Auroc:0.9944, I-AP:0.9974, I-F1:0.9746, P-AUROC:0.9913, P-AP:0.6279, P-F1:0.6281, P-AUPRO:0.9097
fryum: I-Auroc:0.9684, I-AP:0.9854, I-F1:0.9340, P-AUROC:0.9284, P-AP:0.3793, P-F1:0.4173, P-AUPRO:0.8995
macaroni1: I-Auroc:0.9287, I-AP:0.9344, I-F1:0.8468, P-AUROC:0.9932, P-AP:0.2859, P-F1:0.3866, P-AUPRO:0.9431
macaroni2: I-Auroc:0.6740, I-AP:0.5952, I-F1:0.7265, P-AUROC:0.9795, P-AP:0.0995, P-F1:0.1766, P-AUPRO:0.9103
pcb1: I-Auroc:0.8890, I-AP:0.8817, I-F1:0.8515, P-AUROC:0.9883, P-AP:0.6430, P-F1:0.6430, P-AUPRO:0.8950
pcb2: I-Auroc:0.9272, I-AP:0.9298, I-F1:0.8586, P-AUROC:0.9618, P-AP:0.4703, P-F1:0.5129, P-AUPRO:0.8512
pcb3: I-Auroc:0.9179, I-AP:0.9223, I-F1:0.8696, P-AUROC:0.9639, P-AP:0.4868, P-F1:0.5226, P-AUPRO:0.8594
pcb4: I-Auroc:0.9902, I-AP:0.9886, I-F1:0.9615, P-AUROC:0.9479, P-AP:0.2606, P-F1:0.3288, P-AUPRO:0.8398
pipe_fryum: I-Auroc:0.9720, I-AP:0.9871, I-F1:0.9485, P-AUROC:0.9851, P-AP:0.4574, P-F1:0.5402, P-AUPRO:0.9623
Mean: I-Auroc:0.9275, I-AP:0.9283, I-F1:0.8953, P-AUROC:0.9736, P-AP:0.4303, P-F1:0.4766, P-AUPRO:0.9094
cuda:4
shots: 4
candle: I-Auroc:0.9713, I-AP:0.9746, I-F1:0.9110, P-AUROC:0.9906, P-AP:0.4727, P-F1:0.5197, P-AUPRO:0.9444
capsules: I-Auroc:0.9618, I-AP:0.9787, I-F1:0.9347, P-AUROC:0.9866, P-AP:0.5919, P-F1:0.5941, P-AUPRO:0.9610
cashew: I-Auroc:0.9596, I-AP:0.9805, I-F1:0.9209, P-AUROC:0.9744, P-AP:0.5103, P-F1:0.5286, P-AUPRO:0.9500
chewinggum: I-Auroc:0.9956, I-AP:0.9979, I-F1:0.9796, P-AUROC:0.9909, P-AP:0.6418, P-F1:0.6333, P-AUPRO:0.9056
fryum: I-Auroc:0.9844, I-AP:0.9922, I-F1:0.9608, P-AUROC:0.9365, P-AP:0.4015, P-F1:0.4413, P-AUPRO:0.9074
macaroni1: I-Auroc:0.9770, I-AP:0.9763, I-F1:0.9327, P-AUROC:0.9939, P-AP:0.3043, P-F1:0.3988, P-AUPRO:0.9542
macaroni2: I-Auroc:0.7184, I-AP:0.6577, I-F1:0.7354, P-AUROC:0.9845, P-AP:0.1585, P-F1:0.2408, P-AUPRO:0.9293
pcb1: I-Auroc:0.9026, I-AP:0.8857, I-F1:0.8586, P-AUROC:0.9899, P-AP:0.6644, P-F1:0.6631, P-AUPRO:0.9040
pcb2: I-Auroc:0.9500, I-AP:0.9479, I-F1:0.9020, P-AUROC:0.9638, P-AP:0.4921, P-F1:0.5394, P-AUPRO:0.8628
pcb3: I-Auroc:0.9341, I-AP:0.9451, I-F1:0.8830, P-AUROC:0.9699, P-AP:0.5141, P-F1:0.5550, P-AUPRO:0.8842
pcb4: I-Auroc:0.9930, I-AP:0.9921, I-F1:0.9756, P-AUROC:0.9608, P-AP:0.3498, P-F1:0.4153, P-AUPRO:0.8839
pipe_fryum: I-Auroc:0.9822, I-AP:0.9923, I-F1:0.9596, P-AUROC:0.9859, P-AP:0.4611, P-F1:0.5542, P-AUPRO:0.9640
Mean: I-Auroc:0.9442, I-AP:0.9434, I-F1:0.9128, P-AUROC:0.9773, P-AP:0.4635, P-F1:0.5070, P-AUPRO:0.9209

-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_small

cuda:4
shots: 1
candle: I-Auroc:0.9455, I-AP:0.9536, I-F1:0.8832, P-AUROC:0.9867, P-AP:0.4246, P-F1:0.4783, P-AUPRO:0.9257
capsules: I-Auroc:0.9457, I-AP:0.9692, I-F1:0.9175, P-AUROC:0.9624, P-AP:0.3713, P-F1:0.4676, P-AUPRO:0.8884
cashew: I-Auroc:0.9324, I-AP:0.9654, I-F1:0.9118, P-AUROC:0.9502, P-AP:0.4680, P-F1:0.4927, P-AUPRO:0.9324
chewinggum: I-Auroc:0.9646, I-AP:0.9859, I-F1:0.9538, P-AUROC:0.9859, P-AP:0.6461, P-F1:0.6508, P-AUPRO:0.8576
fryum: I-Auroc:0.9544, I-AP:0.9803, I-F1:0.9495, P-AUROC:0.9188, P-AP:0.3446, P-F1:0.3977, P-AUPRO:0.9110
macaroni1: I-Auroc:0.9125, I-AP:0.9223, I-F1:0.8333, P-AUROC:0.9900, P-AP:0.2886, P-F1:0.3701, P-AUPRO:0.9413
macaroni2: I-Auroc:0.5523, I-AP:0.5066, I-F1:0.6838, P-AUROC:0.9633, P-AP:0.0482, P-F1:0.1263, P-AUPRO:0.8758
pcb1: I-Auroc:0.8593, I-AP:0.8498, I-F1:0.8113, P-AUROC:0.9860, P-AP:0.5165, P-F1:0.5708, P-AUPRO:0.8903
pcb2: I-Auroc:0.8859, I-AP:0.9001, I-F1:0.8186, P-AUROC:0.9555, P-AP:0.4051, P-F1:0.4648, P-AUPRO:0.7914
pcb3: I-Auroc:0.9065, I-AP:0.9063, I-F1:0.8465, P-AUROC:0.9490, P-AP:0.4351, P-F1:0.4810, P-AUPRO:0.8435
pcb4: I-Auroc:0.9830, I-AP:0.9797, I-F1:0.9524, P-AUROC:0.9404, P-AP:0.2252, P-F1:0.3061, P-AUPRO:0.8224
pipe_fryum: I-Auroc:0.9850, I-AP:0.9925, I-F1:0.9648, P-AUROC:0.9860, P-AP:0.4861, P-F1:0.5725, P-AUPRO:0.9604
Mean: I-Auroc:0.9023, I-AP:0.9093, I-F1:0.8772, P-AUROC:0.9645, P-AP:0.3883, P-F1:0.4482, P-AUPRO:0.8867
cuda:4
shots: 2
candle: I-Auroc:0.9509, I-AP:0.9574, I-F1:0.8936, P-AUROC:0.9864, P-AP:0.4413, P-F1:0.4905, P-AUPRO:0.9228
capsules: I-Auroc:0.9552, I-AP:0.9748, I-F1:0.9268, P-AUROC:0.9697, P-AP:0.3991, P-F1:0.4834, P-AUPRO:0.9118
cashew: I-Auroc:0.9480, I-AP:0.9735, I-F1:0.9154, P-AUROC:0.9507, P-AP:0.4795, P-F1:0.5056, P-AUPRO:0.9372
chewinggum: I-Auroc:0.9724, I-AP:0.9889, I-F1:0.9641, P-AUROC:0.9856, P-AP:0.6410, P-F1:0.6501, P-AUPRO:0.8473
fryum: I-Auroc:0.9588, I-AP:0.9816, I-F1:0.9333, P-AUROC:0.9202, P-AP:0.3469, P-F1:0.3992, P-AUPRO:0.9029
macaroni1: I-Auroc:0.9355, I-AP:0.9392, I-F1:0.8571, P-AUROC:0.9902, P-AP:0.3168, P-F1:0.3955, P-AUPRO:0.9393
macaroni2: I-Auroc:0.5780, I-AP:0.5238, I-F1:0.6739, P-AUROC:0.9632, P-AP:0.0569, P-F1:0.1319, P-AUPRO:0.8601
pcb1: I-Auroc:0.8761, I-AP:0.8503, I-F1:0.8473, P-AUROC:0.9885, P-AP:0.5785, P-F1:0.6224, P-AUPRO:0.8998
pcb2: I-Auroc:0.9143, I-AP:0.9173, I-F1:0.8531, P-AUROC:0.9620, P-AP:0.4394, P-F1:0.4960, P-AUPRO:0.8304
pcb3: I-Auroc:0.9038, I-AP:0.9162, I-F1:0.8543, P-AUROC:0.9586, P-AP:0.4842, P-F1:0.5296, P-AUPRO:0.8419
pcb4: I-Auroc:0.9827, I-AP:0.9790, I-F1:0.9524, P-AUROC:0.9484, P-AP:0.2480, P-F1:0.3229, P-AUPRO:0.8319
pipe_fryum: I-Auroc:0.9872, I-AP:0.9936, I-F1:0.9652, P-AUROC:0.9871, P-AP:0.4982, P-F1:0.5885, P-AUPRO:0.9654
Mean: I-Auroc:0.9136, I-AP:0.9163, I-F1:0.8864, P-AUROC:0.9675, P-AP:0.4108, P-F1:0.4680, P-AUPRO:0.8909
cuda:4
shots: 4
candle: I-Auroc:0.9744, I-AP:0.9752, I-F1:0.9261, P-AUROC:0.9877, P-AP:0.4565, P-F1:0.5047, P-AUPRO:0.9296
capsules: I-Auroc:0.9413, I-AP:0.9687, I-F1:0.9146, P-AUROC:0.9781, P-AP:0.5044, P-F1:0.5380, P-AUPRO:0.9134
cashew: I-Auroc:0.9726, I-AP:0.9870, I-F1:0.9320, P-AUROC:0.9547, P-AP:0.5039, P-F1:0.5279, P-AUPRO:0.9359
chewinggum: I-Auroc:0.9784, I-AP:0.9910, I-F1:0.9592, P-AUROC:0.9851, P-AP:0.6450, P-F1:0.6499, P-AUPRO:0.8463
fryum: I-Auroc:0.9792, I-AP:0.9903, I-F1:0.9495, P-AUROC:0.9269, P-AP:0.3624, P-F1:0.4132, P-AUPRO:0.9040
macaroni1: I-Auroc:0.9655, I-AP:0.9645, I-F1:0.9005, P-AUROC:0.9915, P-AP:0.3453, P-F1:0.4170, P-AUPRO:0.9481
macaroni2: I-Auroc:0.6270, I-AP:0.5560, I-F1:0.6932, P-AUROC:0.9696, P-AP:0.0694, P-F1:0.1480, P-AUPRO:0.8826
pcb1: I-Auroc:0.9024, I-AP:0.8649, I-F1:0.8610, P-AUROC:0.9905, P-AP:0.6123, P-F1:0.6562, P-AUPRO:0.9099
pcb2: I-Auroc:0.9337, I-AP:0.9379, I-F1:0.8543, P-AUROC:0.9646, P-AP:0.4681, P-F1:0.5247, P-AUPRO:0.8462
pcb3: I-Auroc:0.9250, I-AP:0.9376, I-F1:0.8844, P-AUROC:0.9652, P-AP:0.5093, P-F1:0.5598, P-AUPRO:0.8746
pcb4: I-Auroc:0.9877, I-AP:0.9857, I-F1:0.9565, P-AUROC:0.9606, P-AP:0.3386, P-F1:0.4110, P-AUPRO:0.8841
pipe_fryum: I-Auroc:0.9906, I-AP:0.9957, I-F1:0.9700, P-AUROC:0.9872, P-AP:0.4927, P-F1:0.5921, P-AUPRO:0.9637
Mean: I-Auroc:0.9315, I-AP:0.9295, I-F1:0.9001, P-AUROC:0.9718, P-AP:0.4423, P-F1:0.4952, P-AUPRO:0.9032



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_large

cuda:4
shots: 1
candle: I-Auroc:0.9457, I-AP:0.9485, I-F1:0.8756, P-AUROC:0.9740, P-AP:0.2502, P-F1:0.3308, P-AUPRO:0.9031
capsules: I-Auroc:0.7853, I-AP:0.8594, I-F1:0.8108, P-AUROC:0.9453, P-AP:0.2115, P-F1:0.2906, P-AUPRO:0.8290
cashew: I-Auroc:0.9636, I-AP:0.9824, I-F1:0.9412, P-AUROC:0.6950, P-AP:0.1414, P-F1:0.2165, P-AUPRO:0.6834
chewinggum: I-Auroc:0.9308, I-AP:0.9696, I-F1:0.9110, P-AUROC:0.9345, P-AP:0.5792, P-F1:0.5913, P-AUPRO:0.7156
fryum: I-Auroc:0.8854, I-AP:0.9511, I-F1:0.8646, P-AUROC:0.8980, P-AP:0.2843, P-F1:0.3235, P-AUPRO:0.8610
macaroni1: I-Auroc:0.7476, I-AP:0.7344, I-F1:0.7429, P-AUROC:0.9830, P-AP:0.1608, P-F1:0.2493, P-AUPRO:0.9058
macaroni2: I-Auroc:0.6159, I-AP:0.6037, I-F1:0.6766, P-AUROC:0.9637, P-AP:0.0552, P-F1:0.1243, P-AUPRO:0.8516
pcb1: I-Auroc:0.5467, I-AP:0.5333, I-F1:0.6757, P-AUROC:0.9331, P-AP:0.1534, P-F1:0.2319, P-AUPRO:0.7079
pcb2: I-Auroc:0.7338, I-AP:0.7737, I-F1:0.7054, P-AUROC:0.9219, P-AP:0.2094, P-F1:0.2738, P-AUPRO:0.6962
pcb3: I-Auroc:0.6931, I-AP:0.6930, I-F1:0.7013, P-AUROC:0.9135, P-AP:0.1666, P-F1:0.2297, P-AUPRO:0.8106
pcb4: I-Auroc:0.8216, I-AP:0.8071, I-F1:0.7834, P-AUROC:0.8871, P-AP:0.0799, P-F1:0.1324, P-AUPRO:0.6403
pipe_fryum: I-Auroc:0.9524, I-AP:0.9682, I-F1:0.9519, P-AUROC:0.9835, P-AP:0.5601, P-F1:0.5693, P-AUPRO:0.9581
Mean: I-Auroc:0.8018, I-AP:0.8187, I-F1:0.8034, P-AUROC:0.9194, P-AP:0.2377, P-F1:0.2969, P-AUPRO:0.7969
cuda:4
shots: 2
candle: I-Auroc:0.9467, I-AP:0.9532, I-F1:0.8912, P-AUROC:0.9726, P-AP:0.2871, P-F1:0.3640, P-AUPRO:0.9102
capsules: I-Auroc:0.8315, I-AP:0.8976, I-F1:0.8304, P-AUROC:0.9563, P-AP:0.3241, P-F1:0.3909, P-AUPRO:0.8602
cashew: I-Auroc:0.9820, I-AP:0.9913, I-F1:0.9608, P-AUROC:0.6900, P-AP:0.1597, P-F1:0.2375, P-AUPRO:0.6891
chewinggum: I-Auroc:0.9392, I-AP:0.9738, I-F1:0.9175, P-AUROC:0.9344, P-AP:0.5883, P-F1:0.5967, P-AUPRO:0.7084
fryum: I-Auroc:0.8860, I-AP:0.9508, I-F1:0.8571, P-AUROC:0.8992, P-AP:0.2878, P-F1:0.3305, P-AUPRO:0.8633
macaroni1: I-Auroc:0.7743, I-AP:0.7576, I-F1:0.7652, P-AUROC:0.9863, P-AP:0.2000, P-F1:0.2857, P-AUPRO:0.9222
macaroni2: I-Auroc:0.6649, I-AP:0.6597, I-F1:0.6941, P-AUROC:0.9654, P-AP:0.0723, P-F1:0.1503, P-AUPRO:0.8565
pcb1: I-Auroc:0.6207, I-AP:0.5935, I-F1:0.7171, P-AUROC:0.9426, P-AP:0.2520, P-F1:0.3241, P-AUPRO:0.7359
pcb2: I-Auroc:0.7949, I-AP:0.8120, I-F1:0.7397, P-AUROC:0.9342, P-AP:0.3285, P-F1:0.3841, P-AUPRO:0.7667
pcb3: I-Auroc:0.6772, I-AP:0.7150, I-F1:0.6860, P-AUROC:0.9193, P-AP:0.2056, P-F1:0.2767, P-AUPRO:0.7712
pcb4: I-Auroc:0.8275, I-AP:0.7964, I-F1:0.8087, P-AUROC:0.9085, P-AP:0.0974, P-F1:0.1585, P-AUPRO:0.6974
pipe_fryum: I-Auroc:0.9626, I-AP:0.9743, I-F1:0.9510, P-AUROC:0.9846, P-AP:0.5705, P-F1:0.5766, P-AUPRO:0.9596
Mean: I-Auroc:0.8256, I-AP:0.8396, I-F1:0.8182, P-AUROC:0.9245, P-AP:0.2811, P-F1:0.3396, P-AUPRO:0.8117
cuda:4
shots: 4
candle: I-Auroc:0.9366, I-AP:0.9426, I-F1:0.8718, P-AUROC:0.9719, P-AP:0.3051, P-F1:0.3789, P-AUPRO:0.9175
capsules: I-Auroc:0.8237, I-AP:0.9056, I-F1:0.8033, P-AUROC:0.9680, P-AP:0.4028, P-F1:0.4494, P-AUPRO:0.8751
cashew: I-Auroc:0.9842, I-AP:0.9924, I-F1:0.9561, P-AUROC:0.6920, P-AP:0.1736, P-F1:0.2533, P-AUPRO:0.6962
chewinggum: I-Auroc:0.9472, I-AP:0.9768, I-F1:0.9271, P-AUROC:0.9286, P-AP:0.6040, P-F1:0.6205, P-AUPRO:0.6815
fryum: I-Auroc:0.9574, I-AP:0.9811, I-F1:0.9192, P-AUROC:0.9033, P-AP:0.3237, P-F1:0.3679, P-AUPRO:0.8789
macaroni1: I-Auroc:0.8618, I-AP:0.8574, I-F1:0.8111, P-AUROC:0.9904, P-AP:0.3000, P-F1:0.3872, P-AUPRO:0.9448
macaroni2: I-Auroc:0.7032, I-AP:0.7025, I-F1:0.7184, P-AUROC:0.9733, P-AP:0.0945, P-F1:0.1770, P-AUPRO:0.8899
pcb1: I-Auroc:0.8375, I-AP:0.8530, I-F1:0.7739, P-AUROC:0.9548, P-AP:0.4607, P-F1:0.4879, P-AUPRO:0.7953
pcb2: I-Auroc:0.8688, I-AP:0.8895, I-F1:0.7917, P-AUROC:0.9401, P-AP:0.3882, P-F1:0.4508, P-AUPRO:0.8045
pcb3: I-Auroc:0.7437, I-AP:0.7583, I-F1:0.7164, P-AUROC:0.9295, P-AP:0.3208, P-F1:0.3742, P-AUPRO:0.8101
pcb4: I-Auroc:0.9095, I-AP:0.9092, I-F1:0.8407, P-AUROC:0.9307, P-AP:0.1704, P-F1:0.2276, P-AUPRO:0.7832
pipe_fryum: I-Auroc:0.9706, I-AP:0.9836, I-F1:0.9648, P-AUROC:0.9863, P-AP:0.6002, P-F1:0.6197, P-AUPRO:0.9675
Mean: I-Auroc:0.8787, I-AP:0.8960, I-F1:0.8412, P-AUROC:0.9307, P-AP:0.3453, P-F1:0.3995, P-AUPRO:0.8371



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 320
crop_size = 280

cuda:4
shots: 1
candle: I-Auroc:0.9447, I-AP:0.9514, I-F1:0.8679, P-AUROC:0.9866, P-AP:0.4065, P-F1:0.4769, P-AUPRO:0.9084
capsules: I-Auroc:0.9455, I-AP:0.9669, I-F1:0.9293, P-AUROC:0.9741, P-AP:0.3894, P-F1:0.4634, P-AUPRO:0.9068
cashew: I-Auroc:0.8896, I-AP:0.9435, I-F1:0.8846, P-AUROC:0.9767, P-AP:0.5066, P-F1:0.5111, P-AUPRO:0.9334
chewinggum: I-Auroc:0.9790, I-AP:0.9911, I-F1:0.9583, P-AUROC:0.9894, P-AP:0.5969, P-F1:0.6159, P-AUPRO:0.8958
fryum: I-Auroc:0.9540, I-AP:0.9789, I-F1:0.9293, P-AUROC:0.9164, P-AP:0.3653, P-F1:0.4110, P-AUPRO:0.8689
macaroni1: I-Auroc:0.8523, I-AP:0.8648, I-F1:0.7801, P-AUROC:0.9848, P-AP:0.2296, P-F1:0.3146, P-AUPRO:0.8973
macaroni2: I-Auroc:0.6356, I-AP:0.5606, I-F1:0.7104, P-AUROC:0.9526, P-AP:0.0608, P-F1:0.1487, P-AUPRO:0.8541
pcb1: I-Auroc:0.8681, I-AP:0.8629, I-F1:0.8333, P-AUROC:0.9791, P-AP:0.5797, P-F1:0.5868, P-AUPRO:0.8103
pcb2: I-Auroc:0.8856, I-AP:0.9048, I-F1:0.8259, P-AUROC:0.9520, P-AP:0.4214, P-F1:0.4852, P-AUPRO:0.7556
pcb3: I-Auroc:0.8991, I-AP:0.9054, I-F1:0.8230, P-AUROC:0.9584, P-AP:0.3628, P-F1:0.4371, P-AUPRO:0.8063
pcb4: I-Auroc:0.9785, I-AP:0.9759, I-F1:0.9569, P-AUROC:0.9435, P-AP:0.2231, P-F1:0.2952, P-AUPRO:0.7987
pipe_fryum: I-Auroc:0.9720, I-AP:0.9867, I-F1:0.9548, P-AUROC:0.9841, P-AP:0.4709, P-F1:0.5430, P-AUPRO:0.9546
Mean: I-Auroc:0.9003, I-AP:0.9078, I-F1:0.8712, P-AUROC:0.9665, P-AP:0.3844, P-F1:0.4407, P-AUPRO:0.8659
cuda:4
shots: 2
candle: I-Auroc:0.9574, I-AP:0.9631, I-F1:0.8934, P-AUROC:0.9868, P-AP:0.4073, P-F1:0.4733, P-AUPRO:0.9156
capsules: I-Auroc:0.9505, I-AP:0.9689, I-F1:0.9254, P-AUROC:0.9779, P-AP:0.4198, P-F1:0.4795, P-AUPRO:0.9204
cashew: I-Auroc:0.9080, I-AP:0.9529, I-F1:0.9048, P-AUROC:0.9787, P-AP:0.5182, P-F1:0.5185, P-AUPRO:0.9426
chewinggum: I-Auroc:0.9860, I-AP:0.9939, I-F1:0.9655, P-AUROC:0.9895, P-AP:0.6070, P-F1:0.6205, P-AUPRO:0.8981
fryum: I-Auroc:0.9562, I-AP:0.9796, I-F1:0.9307, P-AUROC:0.9219, P-AP:0.3740, P-F1:0.4185, P-AUPRO:0.8683
macaroni1: I-Auroc:0.8905, I-AP:0.8934, I-F1:0.8297, P-AUROC:0.9860, P-AP:0.2498, P-F1:0.3332, P-AUPRO:0.9000
macaroni2: I-Auroc:0.6139, I-AP:0.5459, I-F1:0.6868, P-AUROC:0.9423, P-AP:0.0380, P-F1:0.1033, P-AUPRO:0.8058
pcb1: I-Auroc:0.8873, I-AP:0.8713, I-F1:0.8558, P-AUROC:0.9824, P-AP:0.6047, P-F1:0.6056, P-AUPRO:0.8271
pcb2: I-Auroc:0.9047, I-AP:0.9105, I-F1:0.8526, P-AUROC:0.9574, P-AP:0.4154, P-F1:0.4933, P-AUPRO:0.7904
pcb3: I-Auroc:0.9032, I-AP:0.9121, I-F1:0.8210, P-AUROC:0.9684, P-AP:0.4070, P-F1:0.4693, P-AUPRO:0.8417
pcb4: I-Auroc:0.9794, I-AP:0.9771, I-F1:0.9524, P-AUROC:0.9487, P-AP:0.2252, P-F1:0.2989, P-AUPRO:0.8038
pipe_fryum: I-Auroc:0.9838, I-AP:0.9923, I-F1:0.9697, P-AUROC:0.9856, P-AP:0.4789, P-F1:0.5539, P-AUPRO:0.9595
Mean: I-Auroc:0.9101, I-AP:0.9134, I-F1:0.8823, P-AUROC:0.9688, P-AP:0.3954, P-F1:0.4473, P-AUPRO:0.8728
cuda:4
shots: 4
candle: I-Auroc:0.9708, I-AP:0.9746, I-F1:0.9239, P-AUROC:0.9879, P-AP:0.4120, P-F1:0.4746, P-AUPRO:0.9134
capsules: I-Auroc:0.9260, I-AP:0.9569, I-F1:0.8912, P-AUROC:0.9827, P-AP:0.5340, P-F1:0.5613, P-AUPRO:0.9337
cashew: I-Auroc:0.9374, I-AP:0.9695, I-F1:0.9261, P-AUROC:0.9807, P-AP:0.5396, P-F1:0.5363, P-AUPRO:0.9459
chewinggum: I-Auroc:0.9884, I-AP:0.9951, I-F1:0.9749, P-AUROC:0.9895, P-AP:0.6173, P-F1:0.6231, P-AUPRO:0.8990
fryum: I-Auroc:0.9674, I-AP:0.9846, I-F1:0.9447, P-AUROC:0.9283, P-AP:0.3863, P-F1:0.4312, P-AUPRO:0.8776
macaroni1: I-Auroc:0.9561, I-AP:0.9492, I-F1:0.9074, P-AUROC:0.9888, P-AP:0.2943, P-F1:0.3667, P-AUPRO:0.9176
macaroni2: I-Auroc:0.6555, I-AP:0.5754, I-F1:0.7043, P-AUROC:0.9550, P-AP:0.0507, P-F1:0.1264, P-AUPRO:0.8479
pcb1: I-Auroc:0.8985, I-AP:0.8722, I-F1:0.8585, P-AUROC:0.9864, P-AP:0.6219, P-F1:0.6241, P-AUPRO:0.8528
pcb2: I-Auroc:0.9195, I-AP:0.9212, I-F1:0.8670, P-AUROC:0.9609, P-AP:0.4328, P-F1:0.5165, P-AUPRO:0.8017
pcb3: I-Auroc:0.9233, I-AP:0.9344, I-F1:0.8532, P-AUROC:0.9754, P-AP:0.4278, P-F1:0.4959, P-AUPRO:0.8657
pcb4: I-Auroc:0.9812, I-AP:0.9827, I-F1:0.9495, P-AUROC:0.9590, P-AP:0.3121, P-F1:0.3821, P-AUPRO:0.8319
pipe_fryum: I-Auroc:0.9882, I-AP:0.9948, I-F1:0.9691, P-AUROC:0.9860, P-AP:0.4769, P-F1:0.5675, P-AUPRO:0.9589
Mean: I-Auroc:0.9260, I-AP:0.9259, I-F1:0.8975, P-AUROC:0.9734, P-AP:0.4255, P-F1:0.4755, P-AUPRO:0.8872



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 384
crop_size = 336

cuda:4
shots: 1
candle: I-Auroc:0.9464, I-AP:0.9549, I-F1:0.8865, P-AUROC:0.9885, P-AP:0.4334, P-F1:0.4968, P-AUPRO:0.9240
capsules: I-Auroc:0.9483, I-AP:0.9683, I-F1:0.9135, P-AUROC:0.9760, P-AP:0.4461, P-F1:0.5016, P-AUPRO:0.9255
cashew: I-Auroc:0.9152, I-AP:0.9570, I-F1:0.8932, P-AUROC:0.9761, P-AP:0.4769, P-F1:0.4916, P-AUPRO:0.9276
chewinggum: I-Auroc:0.9906, I-AP:0.9958, I-F1:0.9700, P-AUROC:0.9901, P-AP:0.6290, P-F1:0.6396, P-AUPRO:0.8989
fryum: I-Auroc:0.9404, I-AP:0.9736, I-F1:0.9026, P-AUROC:0.9195, P-AP:0.3593, P-F1:0.3973, P-AUPRO:0.8822
macaroni1: I-Auroc:0.8818, I-AP:0.8992, I-F1:0.7903, P-AUROC:0.9893, P-AP:0.2451, P-F1:0.3403, P-AUPRO:0.9212
macaroni2: I-Auroc:0.6151, I-AP:0.5498, I-F1:0.7019, P-AUROC:0.9682, P-AP:0.0575, P-F1:0.1357, P-AUPRO:0.9029
pcb1: I-Auroc:0.8878, I-AP:0.8791, I-F1:0.8491, P-AUROC:0.9859, P-AP:0.6048, P-F1:0.6025, P-AUPRO:0.8723
pcb2: I-Auroc:0.8789, I-AP:0.9006, I-F1:0.8108, P-AUROC:0.9571, P-AP:0.4317, P-F1:0.4784, P-AUPRO:0.8100
pcb3: I-Auroc:0.8891, I-AP:0.8813, I-F1:0.8240, P-AUROC:0.9582, P-AP:0.4102, P-F1:0.4558, P-AUPRO:0.8373
pcb4: I-Auroc:0.9815, I-AP:0.9781, I-F1:0.9505, P-AUROC:0.9449, P-AP:0.2483, P-F1:0.3195, P-AUPRO:0.8296
pipe_fryum: I-Auroc:0.9690, I-AP:0.9850, I-F1:0.9458, P-AUROC:0.9846, P-AP:0.4578, P-F1:0.5344, P-AUPRO:0.9623
Mean: I-Auroc:0.9037, I-AP:0.9102, I-F1:0.8698, P-AUROC:0.9699, P-AP:0.4000, P-F1:0.4495, P-AUPRO:0.8912
cuda:4
shots: 2
candle: I-Auroc:0.9617, I-AP:0.9671, I-F1:0.8973, P-AUROC:0.9889, P-AP:0.4471, P-F1:0.5078, P-AUPRO:0.9331
capsules: I-Auroc:0.9628, I-AP:0.9783, I-F1:0.9412, P-AUROC:0.9780, P-AP:0.4732, P-F1:0.5226, P-AUPRO:0.9363
cashew: I-Auroc:0.9356, I-AP:0.9663, I-F1:0.9116, P-AUROC:0.9764, P-AP:0.4954, P-F1:0.5102, P-AUPRO:0.9382
chewinggum: I-Auroc:0.9928, I-AP:0.9967, I-F1:0.9751, P-AUROC:0.9894, P-AP:0.6290, P-F1:0.6365, P-AUPRO:0.8855
fryum: I-Auroc:0.9492, I-AP:0.9771, I-F1:0.9126, P-AUROC:0.9225, P-AP:0.3678, P-F1:0.4082, P-AUPRO:0.8868
macaroni1: I-Auroc:0.9208, I-AP:0.9274, I-F1:0.8421, P-AUROC:0.9911, P-AP:0.2742, P-F1:0.3740, P-AUPRO:0.9223
macaroni2: I-Auroc:0.6452, I-AP:0.5754, I-F1:0.7068, P-AUROC:0.9671, P-AP:0.0710, P-F1:0.1472, P-AUPRO:0.8963
pcb1: I-Auroc:0.8891, I-AP:0.8673, I-F1:0.8544, P-AUROC:0.9872, P-AP:0.6141, P-F1:0.6170, P-AUPRO:0.8616
pcb2: I-Auroc:0.9044, I-AP:0.9103, I-F1:0.8673, P-AUROC:0.9599, P-AP:0.4580, P-F1:0.5082, P-AUPRO:0.8344
pcb3: I-Auroc:0.8999, I-AP:0.9049, I-F1:0.8288, P-AUROC:0.9654, P-AP:0.4597, P-F1:0.5046, P-AUPRO:0.8515
pcb4: I-Auroc:0.9838, I-AP:0.9804, I-F1:0.9561, P-AUROC:0.9503, P-AP:0.2502, P-F1:0.3261, P-AUPRO:0.8278
pipe_fryum: I-Auroc:0.9792, I-AP:0.9903, I-F1:0.9596, P-AUROC:0.9858, P-AP:0.4691, P-F1:0.5470, P-AUPRO:0.9635
Mean: I-Auroc:0.9187, I-AP:0.9201, I-F1:0.8877, P-AUROC:0.9718, P-AP:0.4174, P-F1:0.4674, P-AUPRO:0.8948
cuda:4
shots: 4
candle: I-Auroc:0.9729, I-AP:0.9763, I-F1:0.9208, P-AUROC:0.9898, P-AP:0.4475, P-F1:0.5057, P-AUPRO:0.9318
capsules: I-Auroc:0.9553, I-AP:0.9738, I-F1:0.9300, P-AUROC:0.9841, P-AP:0.5689, P-F1:0.5845, P-AUPRO:0.9428
cashew: I-Auroc:0.9516, I-AP:0.9753, I-F1:0.9282, P-AUROC:0.9777, P-AP:0.5154, P-F1:0.5283, P-AUPRO:0.9396
chewinggum: I-Auroc:0.9942, I-AP:0.9973, I-F1:0.9751, P-AUROC:0.9895, P-AP:0.6440, P-F1:0.6367, P-AUPRO:0.8882
fryum: I-Auroc:0.9702, I-AP:0.9862, I-F1:0.9453, P-AUROC:0.9329, P-AP:0.3948, P-F1:0.4321, P-AUPRO:0.8969
macaroni1: I-Auroc:0.9648, I-AP:0.9665, I-F1:0.9032, P-AUROC:0.9926, P-AP:0.3005, P-F1:0.3931, P-AUPRO:0.9343
macaroni2: I-Auroc:0.6641, I-AP:0.5954, I-F1:0.7257, P-AUROC:0.9763, P-AP:0.0943, P-F1:0.1651, P-AUPRO:0.9237
pcb1: I-Auroc:0.9032, I-AP:0.8728, I-F1:0.8657, P-AUROC:0.9884, P-AP:0.6536, P-F1:0.6537, P-AUPRO:0.8731
pcb2: I-Auroc:0.9311, I-AP:0.9310, I-F1:0.8800, P-AUROC:0.9623, P-AP:0.4815, P-F1:0.5336, P-AUPRO:0.8487
pcb3: I-Auroc:0.9350, I-AP:0.9448, I-F1:0.8783, P-AUROC:0.9729, P-AP:0.4915, P-F1:0.5335, P-AUPRO:0.8795
pcb4: I-Auroc:0.9890, I-AP:0.9882, I-F1:0.9648, P-AUROC:0.9631, P-AP:0.3363, P-F1:0.4104, P-AUPRO:0.8704
pipe_fryum: I-Auroc:0.9852, I-AP:0.9937, I-F1:0.9659, P-AUROC:0.9858, P-AP:0.4655, P-F1:0.5591, P-AUPRO:0.9631
Mean: I-Auroc:0.9347, I-AP:0.9335, I-F1:0.9069, P-AUROC:0.9763, P-AP:0.4495, P-F1:0.4946, P-AUPRO:0.9077



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 512
crop_size = 448

cuda:4
shots: 1
candle: I-Auroc:0.9502, I-AP:0.9569, I-F1:0.8900, P-AUROC:0.9905, P-AP:0.4722, P-F1:0.5243, P-AUPRO:0.9453
capsules: I-Auroc:0.9842, I-AP:0.9903, I-F1:0.9552, P-AUROC:0.9812, P-AP:0.5029, P-F1:0.5346, P-AUPRO:0.9455
cashew: I-Auroc:0.9350, I-AP:0.9685, I-F1:0.9091, P-AUROC:0.9731, P-AP:0.4822, P-F1:0.5009, P-AUPRO:0.9384
chewinggum: I-Auroc:0.9938, I-AP:0.9972, I-F1:0.9800, P-AUROC:0.9925, P-AP:0.6522, P-F1:0.6505, P-AUPRO:0.9167
fryum: I-Auroc:0.9438, I-AP:0.9762, I-F1:0.9154, P-AUROC:0.9260, P-AP:0.3683, P-F1:0.4059, P-AUPRO:0.8996
macaroni1: I-Auroc:0.9055, I-AP:0.9148, I-F1:0.8279, P-AUROC:0.9935, P-AP:0.3127, P-F1:0.4052, P-AUPRO:0.9552
macaroni2: I-Auroc:0.7148, I-AP:0.6460, I-F1:0.7333, P-AUROC:0.9848, P-AP:0.1860, P-F1:0.2770, P-AUPRO:0.9423
pcb1: I-Auroc:0.8935, I-AP:0.8840, I-F1:0.8500, P-AUROC:0.9871, P-AP:0.6630, P-F1:0.6639, P-AUPRO:0.9026
pcb2: I-Auroc:0.9190, I-AP:0.9263, I-F1:0.8700, P-AUROC:0.9573, P-AP:0.4600, P-F1:0.5058, P-AUPRO:0.8606
pcb3: I-Auroc:0.9178, I-AP:0.9097, I-F1:0.8649, P-AUROC:0.9535, P-AP:0.4420, P-F1:0.4859, P-AUPRO:0.8646
pcb4: I-Auroc:0.9919, I-AP:0.9913, I-F1:0.9703, P-AUROC:0.9380, P-AP:0.2763, P-F1:0.3431, P-AUPRO:0.8270
pipe_fryum: I-Auroc:0.9666, I-AP:0.9836, I-F1:0.9412, P-AUROC:0.9846, P-AP:0.4519, P-F1:0.5334, P-AUPRO:0.9649
Mean: I-Auroc:0.9263, I-AP:0.9287, I-F1:0.8923, P-AUROC:0.9718, P-AP:0.4391, P-F1:0.4859, P-AUPRO:0.9136
cuda:4
shots: 2
candle: I-Auroc:0.9505, I-AP:0.9562, I-F1:0.8889, P-AUROC:0.9905, P-AP:0.4676, P-F1:0.5234, P-AUPRO:0.9429
capsules: I-Auroc:0.9813, I-AP:0.9884, I-F1:0.9474, P-AUROC:0.9809, P-AP:0.5166, P-F1:0.5463, P-AUPRO:0.9552
cashew: I-Auroc:0.9452, I-AP:0.9729, I-F1:0.9360, P-AUROC:0.9740, P-AP:0.4981, P-F1:0.5173, P-AUPRO:0.9463
chewinggum: I-Auroc:0.9942, I-AP:0.9973, I-F1:0.9800, P-AUROC:0.9927, P-AP:0.6399, P-F1:0.6442, P-AUPRO:0.9152
fryum: I-Auroc:0.9526, I-AP:0.9792, I-F1:0.9158, P-AUROC:0.9311, P-AP:0.3798, P-F1:0.4160, P-AUPRO:0.9058
macaroni1: I-Auroc:0.9356, I-AP:0.9362, I-F1:0.8661, P-AUROC:0.9953, P-AP:0.3147, P-F1:0.3986, P-AUPRO:0.9625
macaroni2: I-Auroc:0.7135, I-AP:0.6392, I-F1:0.7583, P-AUROC:0.9871, P-AP:0.1465, P-F1:0.2440, P-AUPRO:0.9460
pcb1: I-Auroc:0.9058, I-AP:0.8911, I-F1:0.8713, P-AUROC:0.9886, P-AP:0.6751, P-F1:0.6703, P-AUPRO:0.9140
pcb2: I-Auroc:0.9324, I-AP:0.9306, I-F1:0.8812, P-AUROC:0.9597, P-AP:0.4880, P-F1:0.5294, P-AUPRO:0.8760
pcb3: I-Auroc:0.9304, I-AP:0.9323, I-F1:0.8762, P-AUROC:0.9644, P-AP:0.5124, P-F1:0.5398, P-AUPRO:0.8769
pcb4: I-Auroc:0.9890, I-AP:0.9878, I-F1:0.9655, P-AUROC:0.9460, P-AP:0.2848, P-F1:0.3485, P-AUPRO:0.8385
pipe_fryum: I-Auroc:0.9744, I-AP:0.9872, I-F1:0.9557, P-AUROC:0.9856, P-AP:0.4584, P-F1:0.5414, P-AUPRO:0.9673
Mean: I-Auroc:0.9337, I-AP:0.9332, I-F1:0.9035, P-AUROC:0.9747, P-AP:0.4485, P-F1:0.4933, P-AUPRO:0.9206
cuda:4
shots: 4
candle: I-Auroc:0.9707, I-AP:0.9725, I-F1:0.9143, P-AUROC:0.9915, P-AP:0.4750, P-F1:0.5339, P-AUPRO:0.9462
capsules: I-Auroc:0.9852, I-AP:0.9910, I-F1:0.9557, P-AUROC:0.9856, P-AP:0.5865, P-F1:0.5920, P-AUPRO:0.9596
cashew: I-Auroc:0.9582, I-AP:0.9800, I-F1:0.9300, P-AUROC:0.9755, P-AP:0.5211, P-F1:0.5362, P-AUPRO:0.9503
chewinggum: I-Auroc:0.9950, I-AP:0.9977, I-F1:0.9800, P-AUROC:0.9919, P-AP:0.6373, P-F1:0.6447, P-AUPRO:0.9150
fryum: I-Auroc:0.9798, I-AP:0.9906, I-F1:0.9458, P-AUROC:0.9385, P-AP:0.4031, P-F1:0.4375, P-AUPRO:0.9136
macaroni1: I-Auroc:0.9839, I-AP:0.9823, I-F1:0.9423, P-AUROC:0.9960, P-AP:0.3302, P-F1:0.4103, P-AUPRO:0.9640
macaroni2: I-Auroc:0.7795, I-AP:0.7343, I-F1:0.7768, P-AUROC:0.9908, P-AP:0.2230, P-F1:0.3238, P-AUPRO:0.9603
pcb1: I-Auroc:0.9204, I-AP:0.8985, I-F1:0.8889, P-AUROC:0.9896, P-AP:0.6948, P-F1:0.6921, P-AUPRO:0.9187
pcb2: I-Auroc:0.9477, I-AP:0.9454, I-F1:0.8995, P-AUROC:0.9614, P-AP:0.5040, P-F1:0.5506, P-AUPRO:0.8781
pcb3: I-Auroc:0.9575, I-AP:0.9604, I-F1:0.8830, P-AUROC:0.9717, P-AP:0.5457, P-F1:0.5767, P-AUPRO:0.9043
pcb4: I-Auroc:0.9912, I-AP:0.9901, I-F1:0.9709, P-AUROC:0.9592, P-AP:0.3600, P-F1:0.4228, P-AUPRO:0.8847
pipe_fryum: I-Auroc:0.9792, I-AP:0.9898, I-F1:0.9700, P-AUROC:0.9864, P-AP:0.4667, P-F1:0.5629, P-AUPRO:0.9687
Mean: I-Auroc:0.9540, I-AP:0.9527, I-F1:0.9214, P-AUROC:0.9782, P-AP:0.4790, P-F1:0.5236, P-AUPRO:0.9303



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9, contrast=0.9, saturation=0.9
augmented_image = TF.adjust_brightness(tensor_image, brightness)
augmented_image = TF.adjust_contrast(augmented_image, contrast)
augmented_image = TF.adjust_saturation(augmented_image, saturation)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug
3次旋转
vit_base
image_size = 256
crop_size = 224

cuda:4
shots: 1
candle: I-Auroc:0.9593, I-AP:0.9617, I-F1:0.8878, P-AUROC:0.9860, P-AP:0.3938, P-F1:0.4784, P-AUPRO:0.9062
capsules: I-Auroc:0.8658, I-AP:0.9181, I-F1:0.8488, P-AUROC:0.9595, P-AP:0.3020, P-F1:0.3962, P-AUPRO:0.7789
cashew: I-Auroc:0.8818, I-AP:0.9399, I-F1:0.8900, P-AUROC:0.9804, P-AP:0.5237, P-F1:0.5216, P-AUPRO:0.9102
chewinggum: I-Auroc:0.9530, I-AP:0.9803, I-F1:0.9293, P-AUROC:0.9842, P-AP:0.5529, P-F1:0.5857, P-AUPRO:0.8610
fryum: I-Auroc:0.9118, I-AP:0.9615, I-F1:0.8969, P-AUROC:0.9079, P-AP:0.3354, P-F1:0.3892, P-AUPRO:0.7714
macaroni1: I-Auroc:0.8538, I-AP:0.8895, I-F1:0.7849, P-AUROC:0.9646, P-AP:0.2099, P-F1:0.3089, P-AUPRO:0.8519
macaroni2: I-Auroc:0.6238, I-AP:0.5699, I-F1:0.6794, P-AUROC:0.9221, P-AP:0.0611, P-F1:0.1419, P-AUPRO:0.8120
pcb1: I-Auroc:0.7285, I-AP:0.7179, I-F1:0.7160, P-AUROC:0.9688, P-AP:0.4751, P-F1:0.4960, P-AUPRO:0.7403
pcb2: I-Auroc:0.8675, I-AP:0.8869, I-F1:0.8105, P-AUROC:0.9433, P-AP:0.3176, P-F1:0.4030, P-AUPRO:0.6779
pcb3: I-Auroc:0.8654, I-AP:0.8822, I-F1:0.7831, P-AUROC:0.9494, P-AP:0.3263, P-F1:0.4118, P-AUPRO:0.7235
pcb4: I-Auroc:0.9577, I-AP:0.9485, I-F1:0.9083, P-AUROC:0.9460, P-AP:0.2034, P-F1:0.2768, P-AUPRO:0.8008
pipe_fryum: I-Auroc:0.9648, I-AP:0.9825, I-F1:0.9463, P-AUROC:0.9837, P-AP:0.4887, P-F1:0.5407, P-AUPRO:0.9460
Mean: I-Auroc:0.8694, I-AP:0.8866, I-F1:0.8401, P-AUROC:0.9580, P-AP:0.3492, P-F1:0.4125, P-AUPRO:0.8150
cuda:4
shots: 2
candle: I-Auroc:0.9575, I-AP:0.9609, I-F1:0.8911, P-AUROC:0.9867, P-AP:0.4036, P-F1:0.4816, P-AUPRO:0.9090
capsules: I-Auroc:0.8797, I-AP:0.9307, I-F1:0.8599, P-AUROC:0.9649, P-AP:0.3457, P-F1:0.4288, P-AUPRO:0.7904
cashew: I-Auroc:0.9036, I-AP:0.9514, I-F1:0.9109, P-AUROC:0.9814, P-AP:0.5420, P-F1:0.5394, P-AUPRO:0.9176
chewinggum: I-Auroc:0.9780, I-AP:0.9910, I-F1:0.9641, P-AUROC:0.9850, P-AP:0.5889, P-F1:0.6076, P-AUPRO:0.8665
fryum: I-Auroc:0.9102, I-AP:0.9622, I-F1:0.9053, P-AUROC:0.9146, P-AP:0.3437, P-F1:0.3953, P-AUPRO:0.7750
macaroni1: I-Auroc:0.8977, I-AP:0.9157, I-F1:0.8173, P-AUROC:0.9714, P-AP:0.2221, P-F1:0.3274, P-AUPRO:0.8594
macaroni2: I-Auroc:0.5702, I-AP:0.5191, I-F1:0.6762, P-AUROC:0.8932, P-AP:0.0255, P-F1:0.0781, P-AUPRO:0.7182
pcb1: I-Auroc:0.7769, I-AP:0.7663, I-F1:0.7385, P-AUROC:0.9758, P-AP:0.5255, P-F1:0.5354, P-AUPRO:0.7866
pcb2: I-Auroc:0.9082, I-AP:0.9067, I-F1:0.8390, P-AUROC:0.9525, P-AP:0.3375, P-F1:0.4323, P-AUPRO:0.7274
pcb3: I-Auroc:0.9104, I-AP:0.9182, I-F1:0.8396, P-AUROC:0.9626, P-AP:0.3694, P-F1:0.4537, P-AUPRO:0.7773
pcb4: I-Auroc:0.9655, I-AP:0.9561, I-F1:0.9296, P-AUROC:0.9467, P-AP:0.2260, P-F1:0.2936, P-AUPRO:0.8026
pipe_fryum: I-Auroc:0.9758, I-AP:0.9867, I-F1:0.9703, P-AUROC:0.9858, P-AP:0.5007, P-F1:0.5548, P-AUPRO:0.9502
Mean: I-Auroc:0.8861, I-AP:0.8971, I-F1:0.8618, P-AUROC:0.9600, P-AP:0.3692, P-F1:0.4273, P-AUPRO:0.8234
cuda:4
shots: 4
candle: I-Auroc:0.9757, I-AP:0.9773, I-F1:0.9372, P-AUROC:0.9882, P-AP:0.4055, P-F1:0.4897, P-AUPRO:0.9158
capsules: I-Auroc:0.8210, I-AP:0.9035, I-F1:0.8119, P-AUROC:0.9717, P-AP:0.4635, P-F1:0.5151, P-AUPRO:0.7939
cashew: I-Auroc:0.9302, I-AP:0.9656, I-F1:0.9146, P-AUROC:0.9827, P-AP:0.5636, P-F1:0.5580, P-AUPRO:0.9237
chewinggum: I-Auroc:0.9872, I-AP:0.9943, I-F1:0.9641, P-AUROC:0.9858, P-AP:0.5862, P-F1:0.6054, P-AUPRO:0.8682
fryum: I-Auroc:0.9332, I-AP:0.9708, I-F1:0.9215, P-AUROC:0.9216, P-AP:0.3588, P-F1:0.4174, P-AUPRO:0.7601
macaroni1: I-Auroc:0.9282, I-AP:0.9394, I-F1:0.8657, P-AUROC:0.9749, P-AP:0.2394, P-F1:0.3318, P-AUPRO:0.8868
macaroni2: I-Auroc:0.5904, I-AP:0.5422, I-F1:0.6781, P-AUROC:0.9078, P-AP:0.0353, P-F1:0.0943, P-AUPRO:0.7501
pcb1: I-Auroc:0.8416, I-AP:0.8106, I-F1:0.8060, P-AUROC:0.9832, P-AP:0.5839, P-F1:0.5895, P-AUPRO:0.8136
pcb2: I-Auroc:0.9028, I-AP:0.9024, I-F1:0.8316, P-AUROC:0.9553, P-AP:0.3418, P-F1:0.4404, P-AUPRO:0.7355
pcb3: I-Auroc:0.9347, I-AP:0.9451, I-F1:0.8750, P-AUROC:0.9705, P-AP:0.3841, P-F1:0.4744, P-AUPRO:0.8138
pcb4: I-Auroc:0.9623, I-AP:0.9612, I-F1:0.9023, P-AUROC:0.9589, P-AP:0.2996, P-F1:0.3667, P-AUPRO:0.8334
pipe_fryum: I-Auroc:0.9860, I-AP:0.9944, I-F1:0.9703, P-AUROC:0.9867, P-AP:0.5013, P-F1:0.5670, P-AUPRO:0.9507
Mean: I-Auroc:0.8994, I-AP:0.9089, I-F1:0.8732, P-AUROC:0.9656, P-AP:0.3969, P-F1:0.4541, P-AUPRO:0.8371



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9
augmented_image = TF.adjust_brightness(tensor_image_batch, brightness)

cuda:4
shots: 1
candle: I-Auroc:0.9522, I-AP:0.9614, I-F1:0.9016, P-AUROC:0.9902, P-AP:0.4434, P-F1:0.5058, P-AUPRO:0.9474
capsules: I-Auroc:0.9555, I-AP:0.9730, I-F1:0.9293, P-AUROC:0.9776, P-AP:0.4959, P-F1:0.5320, P-AUPRO:0.9459
cashew: I-Auroc:0.9352, I-AP:0.9689, I-F1:0.9072, P-AUROC:0.9726, P-AP:0.5140, P-F1:0.5328, P-AUPRO:0.9336
chewinggum: I-Auroc:0.9930, I-AP:0.9968, I-F1:0.9746, P-AUROC:0.9909, P-AP:0.6458, P-F1:0.6389, P-AUPRO:0.9060
fryum: I-Auroc:0.9306, I-AP:0.9695, I-F1:0.8955, P-AUROC:0.9201, P-AP:0.3503, P-F1:0.3925, P-AUPRO:0.8925
macaroni1: I-Auroc:0.8760, I-AP:0.8863, I-F1:0.8106, P-AUROC:0.9918, P-AP:0.2523, P-F1:0.3495, P-AUPRO:0.9395
macaroni2: I-Auroc:0.6082, I-AP:0.5661, I-F1:0.6838, P-AUROC:0.9738, P-AP:0.0903, P-F1:0.1854, P-AUPRO:0.8970
pcb1: I-Auroc:0.5351, I-AP:0.6122, I-F1:0.7004, P-AUROC:0.9661, P-AP:0.4267, P-F1:0.4522, P-AUPRO:0.7663
pcb2: I-Auroc:0.9118, I-AP:0.9226, I-F1:0.8416, P-AUROC:0.9603, P-AP:0.4459, P-F1:0.4827, P-AUPRO:0.8061
pcb3: I-Auroc:0.9230, I-AP:0.9187, I-F1:0.8774, P-AUROC:0.9688, P-AP:0.4275, P-F1:0.4734, P-AUPRO:0.8585
pcb4: I-Auroc:0.9934, I-AP:0.9931, I-F1:0.9615, P-AUROC:0.9415, P-AP:0.2544, P-F1:0.3251, P-AUPRO:0.8141
pipe_fryum: I-Auroc:0.9422, I-AP:0.9731, I-F1:0.9109, P-AUROC:0.9830, P-AP:0.4405, P-F1:0.5178, P-AUPRO:0.9575
Mean: I-Auroc:0.8797, I-AP:0.8951, I-F1:0.8662, P-AUROC:0.9697, P-AP:0.3989, P-F1:0.4490, P-AUPRO:0.8887
cuda:4
shots: 2
candle: I-Auroc:0.9651, I-AP:0.9713, I-F1:0.9167, P-AUROC:0.9907, P-AP:0.4599, P-F1:0.5099, P-AUPRO:0.9473
capsules: I-Auroc:0.9622, I-AP:0.9763, I-F1:0.9360, P-AUROC:0.9809, P-AP:0.5140, P-F1:0.5440, P-AUPRO:0.9474
cashew: I-Auroc:0.9438, I-AP:0.9722, I-F1:0.9194, P-AUROC:0.9730, P-AP:0.5131, P-F1:0.5346, P-AUPRO:0.9497
chewinggum: I-Auroc:0.9944, I-AP:0.9974, I-F1:0.9800, P-AUROC:0.9909, P-AP:0.6329, P-F1:0.6324, P-AUPRO:0.9009
fryum: I-Auroc:0.9366, I-AP:0.9710, I-F1:0.8990, P-AUROC:0.9233, P-AP:0.3584, P-F1:0.3988, P-AUPRO:0.8866
macaroni1: I-Auroc:0.9308, I-AP:0.9368, I-F1:0.8458, P-AUROC:0.9926, P-AP:0.2725, P-F1:0.3665, P-AUPRO:0.9386
macaroni2: I-Auroc:0.6186, I-AP:0.5863, I-F1:0.6719, P-AUROC:0.9738, P-AP:0.0689, P-F1:0.1549, P-AUPRO:0.8966
pcb1: I-Auroc:0.5135, I-AP:0.5751, I-F1:0.7097, P-AUROC:0.9650, P-AP:0.4049, P-F1:0.4369, P-AUPRO:0.7548
pcb2: I-Auroc:0.9215, I-AP:0.9175, I-F1:0.8502, P-AUROC:0.9683, P-AP:0.4613, P-F1:0.4965, P-AUPRO:0.8482
pcb3: I-Auroc:0.9369, I-AP:0.9396, I-F1:0.8826, P-AUROC:0.9734, P-AP:0.4671, P-F1:0.5030, P-AUPRO:0.8534
pcb4: I-Auroc:0.9910, I-AP:0.9898, I-F1:0.9659, P-AUROC:0.9516, P-AP:0.2646, P-F1:0.3310, P-AUPRO:0.8340
pipe_fryum: I-Auroc:0.9584, I-AP:0.9804, I-F1:0.9293, P-AUROC:0.9847, P-AP:0.4563, P-F1:0.5344, P-AUPRO:0.9628
Mean: I-Auroc:0.8894, I-AP:0.9011, I-F1:0.8755, P-AUROC:0.9723, P-AP:0.4061, P-F1:0.4536, P-AUPRO:0.8934
cuda:4
shots: 4
candle: I-Auroc:0.9777, I-AP:0.9800, I-F1:0.9254, P-AUROC:0.9913, P-AP:0.4703, P-F1:0.5118, P-AUPRO:0.9512
capsules: I-Auroc:0.9583, I-AP:0.9748, I-F1:0.9453, P-AUROC:0.9859, P-AP:0.5872, P-F1:0.5936, P-AUPRO:0.9562
cashew: I-Auroc:0.9624, I-AP:0.9819, I-F1:0.9289, P-AUROC:0.9754, P-AP:0.5357, P-F1:0.5602, P-AUPRO:0.9500
chewinggum: I-Auroc:0.9956, I-AP:0.9979, I-F1:0.9751, P-AUROC:0.9905, P-AP:0.6538, P-F1:0.6396, P-AUPRO:0.9027
fryum: I-Auroc:0.9710, I-AP:0.9845, I-F1:0.9500, P-AUROC:0.9341, P-AP:0.3864, P-F1:0.4302, P-AUPRO:0.9042
macaroni1: I-Auroc:0.9696, I-AP:0.9690, I-F1:0.9327, P-AUROC:0.9934, P-AP:0.3013, P-F1:0.3941, P-AUPRO:0.9485
macaroni2: I-Auroc:0.6990, I-AP:0.6585, I-F1:0.7059, P-AUROC:0.9822, P-AP:0.1425, P-F1:0.2294, P-AUPRO:0.9217
pcb1: I-Auroc:0.8487, I-AP:0.8398, I-F1:0.8246, P-AUROC:0.9867, P-AP:0.6316, P-F1:0.6366, P-AUPRO:0.8840
pcb2: I-Auroc:0.9473, I-AP:0.9317, I-F1:0.9118, P-AUROC:0.9706, P-AP:0.4769, P-F1:0.5122, P-AUPRO:0.8587
pcb3: I-Auroc:0.9465, I-AP:0.9551, I-F1:0.8958, P-AUROC:0.9763, P-AP:0.4875, P-F1:0.5194, P-AUPRO:0.8723
pcb4: I-Auroc:0.9930, I-AP:0.9922, I-F1:0.9754, P-AUROC:0.9654, P-AP:0.3589, P-F1:0.4189, P-AUPRO:0.8819
pipe_fryum: I-Auroc:0.9690, I-AP:0.9849, I-F1:0.9505, P-AUROC:0.9856, P-AP:0.4662, P-F1:0.5494, P-AUPRO:0.9637
Mean: I-Auroc:0.9365, I-AP:0.9375, I-F1:0.9101, P-AUROC:0.9781, P-AP:0.4582, P-F1:0.4996, P-AUPRO:0.9162



-------------------------------------------------------------------------------------------------------------------------------------
# 以下变换后的检测；brightness=0.9
augmented_image = TF.adjust_saturation(augmented_image, saturation)

cuda:4
shots: 1
candle: I-Auroc:0.9649, I-AP:0.9707, I-F1:0.9128, P-AUROC:0.9899, P-AP:0.4463, P-F1:0.5017, P-AUPRO:0.9479
capsules: I-Auroc:0.9557, I-AP:0.9738, I-F1:0.9347, P-AUROC:0.9777, P-AP:0.4844, P-F1:0.5263, P-AUPRO:0.9448
cashew: I-Auroc:0.9324, I-AP:0.9677, I-F1:0.8980, P-AUROC:0.9732, P-AP:0.5157, P-F1:0.5338, P-AUPRO:0.9339
chewinggum: I-Auroc:0.9908, I-AP:0.9959, I-F1:0.9744, P-AUROC:0.9908, P-AP:0.6419, P-F1:0.6325, P-AUPRO:0.9066
fryum: I-Auroc:0.9272, I-AP:0.9676, I-F1:0.8925, P-AUROC:0.9195, P-AP:0.3521, P-F1:0.3935, P-AUPRO:0.8941
macaroni1: I-Auroc:0.8701, I-AP:0.8829, I-F1:0.7982, P-AUROC:0.9918, P-AP:0.2518, P-F1:0.3458, P-AUPRO:0.9417
macaroni2: I-Auroc:0.5905, I-AP:0.5508, I-F1:0.6718, P-AUROC:0.9728, P-AP:0.0751, P-F1:0.1672, P-AUPRO:0.8941
pcb1: I-Auroc:0.5301, I-AP:0.6104, I-F1:0.7004, P-AUROC:0.9660, P-AP:0.4204, P-F1:0.4493, P-AUPRO:0.7644
pcb2: I-Auroc:0.9086, I-AP:0.9215, I-F1:0.8400, P-AUROC:0.9601, P-AP:0.4473, P-F1:0.4831, P-AUPRO:0.8084
pcb3: I-Auroc:0.9262, I-AP:0.9218, I-F1:0.8774, P-AUROC:0.9681, P-AP:0.4290, P-F1:0.4745, P-AUPRO:0.8547
pcb4: I-Auroc:0.9936, I-AP:0.9933, I-F1:0.9615, P-AUROC:0.9430, P-AP:0.2566, P-F1:0.3255, P-AUPRO:0.8141
pipe_fryum: I-Auroc:0.9420, I-AP:0.9732, I-F1:0.9146, P-AUROC:0.9831, P-AP:0.4410, P-F1:0.5180, P-AUPRO:0.9576
Mean: I-Auroc:0.8777, I-AP:0.8941, I-F1:0.8647, P-AUROC:0.9697, P-AP:0.3968, P-F1:0.4459, P-AUPRO:0.8885
cuda:4
shots: 2
candle: I-Auroc:0.9749, I-AP:0.9791, I-F1:0.9184, P-AUROC:0.9902, P-AP:0.4594, P-F1:0.5063, P-AUPRO:0.9437
capsules: I-Auroc:0.9608, I-AP:0.9760, I-F1:0.9271, P-AUROC:0.9810, P-AP:0.5077, P-F1:0.5412, P-AUPRO:0.9461
cashew: I-Auroc:0.9392, I-AP:0.9704, I-F1:0.9179, P-AUROC:0.9733, P-AP:0.5139, P-F1:0.5375, P-AUPRO:0.9472
chewinggum: I-Auroc:0.9930, I-AP:0.9968, I-F1:0.9749, P-AUROC:0.9907, P-AP:0.6310, P-F1:0.6315, P-AUPRO:0.8988
fryum: I-Auroc:0.9350, I-AP:0.9698, I-F1:0.8995, P-AUROC:0.9220, P-AP:0.3576, P-F1:0.3995, P-AUPRO:0.8846
macaroni1: I-Auroc:0.9271, I-AP:0.9338, I-F1:0.8364, P-AUROC:0.9925, P-AP:0.2736, P-F1:0.3657, P-AUPRO:0.9378
macaroni2: I-Auroc:0.6056, I-AP:0.5777, I-F1:0.6738, P-AUROC:0.9726, P-AP:0.0589, P-F1:0.1423, P-AUPRO:0.8899
pcb1: I-Auroc:0.5076, I-AP:0.5745, I-F1:0.7097, P-AUROC:0.9650, P-AP:0.4010, P-F1:0.4353, P-AUPRO:0.7554
pcb2: I-Auroc:0.9212, I-AP:0.9193, I-F1:0.8410, P-AUROC:0.9680, P-AP:0.4628, P-F1:0.4975, P-AUPRO:0.8429
pcb3: I-Auroc:0.9377, I-AP:0.9400, I-F1:0.8826, P-AUROC:0.9724, P-AP:0.4712, P-F1:0.5070, P-AUPRO:0.8557
pcb4: I-Auroc:0.9906, I-AP:0.9893, I-F1:0.9615, P-AUROC:0.9533, P-AP:0.2661, P-F1:0.3311, P-AUPRO:0.8360
pipe_fryum: I-Auroc:0.9556, I-AP:0.9791, I-F1:0.9246, P-AUROC:0.9848, P-AP:0.4568, P-F1:0.5349, P-AUPRO:0.9632
Mean: I-Auroc:0.8874, I-AP:0.9005, I-F1:0.8723, P-AUROC:0.9722, P-AP:0.4050, P-F1:0.4525, P-AUPRO:0.8918
cuda:4
shots: 4
candle: I-Auroc:0.9776, I-AP:0.9806, I-F1:0.9300, P-AUROC:0.9914, P-AP:0.4679, P-F1:0.5112, P-AUPRO:0.9500
capsules: I-Auroc:0.9572, I-AP:0.9744, I-F1:0.9453, P-AUROC:0.9860, P-AP:0.5864, P-F1:0.5925, P-AUPRO:0.9576
cashew: I-Auroc:0.9598, I-AP:0.9808, I-F1:0.9254, P-AUROC:0.9756, P-AP:0.5364, P-F1:0.5619, P-AUPRO:0.9512
chewinggum: I-Auroc:0.9948, I-AP:0.9976, I-F1:0.9798, P-AUROC:0.9904, P-AP:0.6512, P-F1:0.6397, P-AUPRO:0.9014
fryum: I-Auroc:0.9700, I-AP:0.9839, I-F1:0.9442, P-AUROC:0.9331, P-AP:0.3852, P-F1:0.4299, P-AUPRO:0.9047
macaroni1: I-Auroc:0.9689, I-AP:0.9681, I-F1:0.9275, P-AUROC:0.9933, P-AP:0.3016, P-F1:0.3921, P-AUPRO:0.9471
macaroni2: I-Auroc:0.6873, I-AP:0.6453, I-F1:0.7085, P-AUROC:0.9813, P-AP:0.1233, P-F1:0.2104, P-AUPRO:0.9162
pcb1: I-Auroc:0.8462, I-AP:0.8369, I-F1:0.8169, P-AUROC:0.9866, P-AP:0.6282, P-F1:0.6359, P-AUPRO:0.8854
pcb2: I-Auroc:0.9463, I-AP:0.9312, I-F1:0.9118, P-AUROC:0.9704, P-AP:0.4779, P-F1:0.5124, P-AUPRO:0.8583
pcb3: I-Auroc:0.9486, I-AP:0.9568, I-F1:0.8969, P-AUROC:0.9750, P-AP:0.4921, P-F1:0.5246, P-AUPRO:0.8747
pcb4: I-Auroc:0.9928, I-AP:0.9919, I-F1:0.9709, P-AUROC:0.9664, P-AP:0.3615, P-F1:0.4202, P-AUPRO:0.8825
pipe_fryum: I-Auroc:0.9664, I-AP:0.9837, I-F1:0.9400, P-AUROC:0.9856, P-AP:0.4666, P-F1:0.5497, P-AUPRO:0.9641
Mean: I-Auroc:0.9347, I-AP:0.9359, I-F1:0.9081, P-AUROC:0.9779, P-AP:0.4565, P-F1:0.4984, P-AUPRO:0.9161



-------------------------------------------------------------------------------------------------------------------------------------
# Baseline

cuda:4
shots: 1
candle: I-Auroc:0.9440, I-AP:0.9498, I-F1:0.8889, P-AUROC:0.9843, P-AP:0.4175, P-F1:0.4817, P-AUPRO:0.9214
capsules: I-Auroc:0.9605, I-AP:0.9749, I-F1:0.9353, P-AUROC:0.9736, P-AP:0.4251, P-F1:0.4809, P-AUPRO:0.9427
cashew: I-Auroc:0.9296, I-AP:0.9662, I-F1:0.9192, P-AUROC:0.9407, P-AP:0.4412, P-F1:0.4817, P-AUPRO:0.9039
chewinggum: I-Auroc:0.9886, I-AP:0.9949, I-F1:0.9700, P-AUROC:0.9859, P-AP:0.6316, P-F1:0.6719, P-AUPRO:0.8695
fryum: I-Auroc:0.9296, I-AP:0.9687, I-F1:0.9026, P-AUROC:0.9145, P-AP:0.3323, P-F1:0.3751, P-AUPRO:0.8821
macaroni1: I-Auroc:0.7120, I-AP:0.7154, I-F1:0.7385, P-AUROC:0.9810, P-AP:0.1091, P-F1:0.2203, P-AUPRO:0.8848
macaroni2: I-Auroc:0.6511, I-AP:0.5924, I-F1:0.6885, P-AUROC:0.9750, P-AP:0.1149, P-F1:0.2252, P-AUPRO:0.8975
pcb1: I-Auroc:0.5423, I-AP:0.6089, I-F1:0.6863, P-AUROC:0.9663, P-AP:0.4295, P-F1:0.4636, P-AUPRO:0.7613
pcb2: I-Auroc:0.8926, I-AP:0.8497, I-F1:0.8365, P-AUROC:0.9588, P-AP:0.3570, P-F1:0.4580, P-AUPRO:0.7883
pcb3: I-Auroc:0.9224, I-AP:0.9225, I-F1:0.8611, P-AUROC:0.9637, P-AP:0.3811, P-F1:0.4329, P-AUPRO:0.8375
pcb4: I-Auroc:0.9940, I-AP:0.9939, I-F1:0.9655, P-AUROC:0.9285, P-AP:0.2326, P-F1:0.3009, P-AUPRO:0.7833
pipe_fryum: I-Auroc:0.9508, I-AP:0.9771, I-F1:0.9353, P-AUROC:0.9761, P-AP:0.4105, P-F1:0.4960, P-AUPRO:0.9367
Mean: I-Auroc:0.8681, I-AP:0.8762, I-F1:0.8606, P-AUROC:0.9624, P-AP:0.3569, P-F1:0.4240, P-AUPRO:0.8674
cuda:4
shots: 2
candle: I-Auroc:0.9575, I-AP:0.9607, I-F1:0.8878, P-AUROC:0.9855, P-AP:0.4392, P-F1:0.4903, P-AUPRO:0.9183
capsules: I-Auroc:0.9658, I-AP:0.9774, I-F1:0.9372, P-AUROC:0.9782, P-AP:0.4537, P-F1:0.5004, P-AUPRO:0.9460
cashew: I-Auroc:0.9372, I-AP:0.9700, I-F1:0.9239, P-AUROC:0.9352, P-AP:0.4297, P-F1:0.4777, P-AUPRO:0.9166
chewinggum: I-Auroc:0.9896, I-AP:0.9951, I-F1:0.9608, P-AUROC:0.9853, P-AP:0.6172, P-F1:0.6674, P-AUPRO:0.8667
fryum: I-Auroc:0.9402, I-AP:0.9717, I-F1:0.9036, P-AUROC:0.9175, P-AP:0.3411, P-F1:0.3807, P-AUPRO:0.8774
macaroni1: I-Auroc:0.8557, I-AP:0.8533, I-F1:0.8000, P-AUROC:0.9813, P-AP:0.1289, P-F1:0.2450, P-AUPRO:0.8761
macaroni2: I-Auroc:0.6322, I-AP:0.5913, I-F1:0.6790, P-AUROC:0.9758, P-AP:0.0681, P-F1:0.1500, P-AUPRO:0.9040
pcb1: I-Auroc:0.5141, I-AP:0.5811, I-F1:0.7046, P-AUROC:0.9653, P-AP:0.4131, P-F1:0.4553, P-AUPRO:0.7543
pcb2: I-Auroc:0.9070, I-AP:0.8522, I-F1:0.8558, P-AUROC:0.9689, P-AP:0.3688, P-F1:0.4711, P-AUPRO:0.8301
pcb3: I-Auroc:0.9350, I-AP:0.9398, I-F1:0.8667, P-AUROC:0.9695, P-AP:0.4375, P-F1:0.4761, P-AUPRO:0.8321
pcb4: I-Auroc:0.9937, I-AP:0.9930, I-F1:0.9804, P-AUROC:0.9395, P-AP:0.2554, P-F1:0.3147, P-AUPRO:0.8036
pipe_fryum: I-Auroc:0.9618, I-AP:0.9824, I-F1:0.9293, P-AUROC:0.9794, P-AP:0.4265, P-F1:0.5119, P-AUPRO:0.9458
Mean: I-Auroc:0.8825, I-AP:0.8890, I-F1:0.8691, P-AUROC:0.9651, P-AP:0.3649, P-F1:0.4284, P-AUPRO:0.8726
cuda:5
shots: 4
candle: I-Auroc:0.9676, I-AP:0.9669, I-F1:0.9143, P-AUROC:0.9871, P-AP:0.4555, P-F1:0.4943, P-AUPRO:0.9264
capsules: I-Auroc:0.9645, I-AP:0.9763, I-F1:0.9552, P-AUROC:0.9836, P-AP:0.5408, P-F1:0.5614, P-AUPRO:0.9561
cashew: I-Auroc:0.9554, I-AP:0.9790, I-F1:0.9381, P-AUROC:0.9394, P-AP:0.4478, P-F1:0.4934, P-AUPRO:0.9189
chewinggum: I-Auroc:0.9856, I-AP:0.9939, I-F1:0.9648, P-AUROC:0.9848, P-AP:0.6572, P-F1:0.6797, P-AUPRO:0.8619
fryum: I-Auroc:0.9626, I-AP:0.9801, I-F1:0.9417, P-AUROC:0.9283, P-AP:0.3662, P-F1:0.4106, P-AUPRO:0.8956
macaroni1: I-Auroc:0.8467, I-AP:0.8493, I-F1:0.8000, P-AUROC:0.9828, P-AP:0.1732, P-F1:0.2884, P-AUPRO:0.8889
macaroni2: I-Auroc:0.7409, I-AP:0.7287, I-F1:0.7173, P-AUROC:0.9837, P-AP:0.1603, P-F1:0.2686, P-AUPRO:0.9263
pcb1: I-Auroc:0.8229, I-AP:0.8096, I-F1:0.7980, P-AUROC:0.9872, P-AP:0.6212, P-F1:0.6244, P-AUPRO:0.8847
pcb2: I-Auroc:0.9245, I-AP:0.8676, I-F1:0.9005, P-AUROC:0.9716, P-AP:0.3849, P-F1:0.4886, P-AUPRO:0.8398
pcb3: I-Auroc:0.9396, I-AP:0.9501, I-F1:0.8947, P-AUROC:0.9731, P-AP:0.4541, P-F1:0.4910, P-AUPRO:0.8553
pcb4: I-Auroc:0.9927, I-AP:0.9923, I-F1:0.9706, P-AUROC:0.9543, P-AP:0.3303, P-F1:0.3867, P-AUPRO:0.8508
pipe_fryum: I-Auroc:0.9706, I-AP:0.9861, I-F1:0.9458, P-AUROC:0.9821, P-AP:0.4396, P-F1:0.5291, P-AUPRO:0.9507
Mean: I-Auroc:0.9228, I-AP:0.9233, I-F1:0.8951, P-AUROC:0.9715, P-AP:0.4193, P-F1:0.4764, P-AUPRO:0.8963


-------------------------------------------------------------------------------------------------------------------------------------
# Baseline + 3次旋转 + 水平翻转 + 垂直翻转

cuda:4
shots: 1
candle: I-Auroc:0.9341, I-AP:0.9431, I-F1:0.8718, P-AUROC:0.9831, P-AP:0.4336, P-F1:0.4919, P-AUPRO:0.9204
capsules: I-Auroc:0.9703, I-AP:0.9813, I-F1:0.9436, P-AUROC:0.9742, P-AP:0.4133, P-F1:0.4686, P-AUPRO:0.9440
cashew: I-Auroc:0.9330, I-AP:0.9685, I-F1:0.9146, P-AUROC:0.9372, P-AP:0.4111, P-F1:0.4546, P-AUPRO:0.9025
chewinggum: I-Auroc:0.9894, I-AP:0.9951, I-F1:0.9648, P-AUROC:0.9858, P-AP:0.6256, P-F1:0.6745, P-AUPRO:0.8697
fryum: I-Auroc:0.9674, I-AP:0.9857, I-F1:0.9388, P-AUROC:0.9176, P-AP:0.3500, P-F1:0.3929, P-AUPRO:0.8944
macaroni1: I-Auroc:0.6972, I-AP:0.6959, I-F1:0.7405, P-AUROC:0.9831, P-AP:0.1138, P-F1:0.2348, P-AUPRO:0.8981
macaroni2: I-Auroc:0.7093, I-AP:0.6339, I-F1:0.7240, P-AUROC:0.9796, P-AP:0.1333, P-F1:0.2342, P-AUPRO:0.9106
pcb1: I-Auroc:0.8688, I-AP:0.8584, I-F1:0.8421, P-AUROC:0.9875, P-AP:0.6161, P-F1:0.6070, P-AUPRO:0.8967
pcb2: I-Auroc:0.8959, I-AP:0.8572, I-F1:0.8341, P-AUROC:0.9583, P-AP:0.3713, P-F1:0.4738, P-AUPRO:0.8026
pcb3: I-Auroc:0.8970, I-AP:0.9011, I-F1:0.8421, P-AUROC:0.9529, P-AP:0.3918, P-F1:0.4457, P-AUPRO:0.8364
pcb4: I-Auroc:0.9924, I-AP:0.9920, I-F1:0.9569, P-AUROC:0.9258, P-AP:0.2312, P-F1:0.2988, P-AUPRO:0.7864
pipe_fryum: I-Auroc:0.9650, I-AP:0.9830, I-F1:0.9458, P-AUROC:0.9778, P-AP:0.4202, P-F1:0.5095, P-AUPRO:0.9411
Mean: I-Auroc:0.9017, I-AP:0.8996, I-F1:0.8766, P-AUROC:0.9636, P-AP:0.3759, P-F1:0.4405, P-AUPRO:0.8836
cuda:4
shots: 2
candle: I-Auroc:0.9494, I-AP:0.9546, I-F1:0.8923, P-AUROC:0.9847, P-AP:0.4476, P-F1:0.4976, P-AUPRO:0.9169
capsules: I-Auroc:0.9743, I-AP:0.9842, I-F1:0.9548, P-AUROC:0.9792, P-AP:0.4467, P-F1:0.4925, P-AUPRO:0.9465
cashew: I-Auroc:0.9402, I-AP:0.9713, I-F1:0.9261, P-AUROC:0.9311, P-AP:0.4022, P-F1:0.4548, P-AUPRO:0.9121
chewinggum: I-Auroc:0.9866, I-AP:0.9940, I-F1:0.9608, P-AUROC:0.9850, P-AP:0.6165, P-F1:0.6704, P-AUPRO:0.8632
fryum: I-Auroc:0.9734, I-AP:0.9880, I-F1:0.9453, P-AUROC:0.9222, P-AP:0.3622, P-F1:0.4032, P-AUPRO:0.8896
macaroni1: I-Auroc:0.8653, I-AP:0.8618, I-F1:0.8069, P-AUROC:0.9828, P-AP:0.1466, P-F1:0.2712, P-AUPRO:0.8838
macaroni2: I-Auroc:0.6818, I-AP:0.6005, I-F1:0.7419, P-AUROC:0.9816, P-AP:0.0919, P-F1:0.1716, P-AUPRO:0.9151
pcb1: I-Auroc:0.8697, I-AP:0.8495, I-F1:0.8367, P-AUROC:0.9881, P-AP:0.6379, P-F1:0.6300, P-AUPRO:0.8887
pcb2: I-Auroc:0.9105, I-AP:0.8629, I-F1:0.8598, P-AUROC:0.9630, P-AP:0.3809, P-F1:0.4867, P-AUPRO:0.8273
pcb3: I-Auroc:0.9118, I-AP:0.9177, I-F1:0.8381, P-AUROC:0.9605, P-AP:0.4522, P-F1:0.4973, P-AUPRO:0.8385
pcb4: I-Auroc:0.9930, I-AP:0.9920, I-F1:0.9756, P-AUROC:0.9367, P-AP:0.2512, P-F1:0.3157, P-AUPRO:0.8091
pipe_fryum: I-Auroc:0.9756, I-AP:0.9886, I-F1:0.9552, P-AUROC:0.9799, P-AP:0.4298, P-F1:0.5215, P-AUPRO:0.9501
Mean: I-Auroc:0.9193, I-AP:0.9138, I-F1:0.8911, P-AUROC:0.9662, P-AP:0.3888, P-F1:0.4510, P-AUPRO:0.8867
cuda:4
shots: 4
candle: I-Auroc:0.9555, I-AP:0.9572, I-F1:0.8986, P-AUROC:0.9868, P-AP:0.4627, P-F1:0.4993, P-AUPRO:0.9224
capsules: I-Auroc:0.9742, I-AP:0.9834, I-F1:0.9604, P-AUROC:0.9846, P-AP:0.5424, P-F1:0.5580, P-AUPRO:0.9570
cashew: I-Auroc:0.9538, I-AP:0.9793, I-F1:0.9254, P-AUROC:0.9355, P-AP:0.4195, P-F1:0.4668, P-AUPRO:0.9171
chewinggum: I-Auroc:0.9876, I-AP:0.9944, I-F1:0.9648, P-AUROC:0.9848, P-AP:0.6401, P-F1:0.6740, P-AUPRO:0.8601
fryum: I-Auroc:0.9800, I-AP:0.9907, I-F1:0.9485, P-AUROC:0.9313, P-AP:0.3839, P-F1:0.4238, P-AUPRO:0.8946
macaroni1: I-Auroc:0.8613, I-AP:0.8585, I-F1:0.8203, P-AUROC:0.9837, P-AP:0.1699, P-F1:0.2994, P-AUPRO:0.8950
macaroni2: I-Auroc:0.7527, I-AP:0.7051, I-F1:0.7623, P-AUROC:0.9866, P-AP:0.1785, P-F1:0.2742, P-AUPRO:0.9375
pcb1: I-Auroc:0.8795, I-AP:0.8481, I-F1:0.8571, P-AUROC:0.9897, P-AP:0.6573, P-F1:0.6525, P-AUPRO:0.9000
pcb2: I-Auroc:0.9251, I-AP:0.8799, I-F1:0.8995, P-AUROC:0.9667, P-AP:0.4046, P-F1:0.5101, P-AUPRO:0.8414
pcb3: I-Auroc:0.9222, I-AP:0.9374, I-F1:0.8737, P-AUROC:0.9669, P-AP:0.4782, P-F1:0.5250, P-AUPRO:0.8644
pcb4: I-Auroc:0.9927, I-AP:0.9922, I-F1:0.9615, P-AUROC:0.9508, P-AP:0.3247, P-F1:0.3836, P-AUPRO:0.8564
pipe_fryum: I-Auroc:0.9816, I-AP:0.9918, I-F1:0.9543, P-AUROC:0.9822, P-AP:0.4368, P-F1:0.5326, P-AUPRO:0.9519
Mean: I-Auroc:0.9305, I-AP:0.9265, I-F1:0.9022, P-AUROC:0.9708, P-AP:0.4249, P-F1:0.4833, P-AUPRO:0.8998



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
transforms.Lambda(lambda x: torch.flip(x,dims=[-2]))  # 垂直翻转
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来
原始的结果*0.7 + 增强后的结果*0.3 = anomaly_map；

cuda:4
shots: 1
candle: I-Auroc:0.9420, I-AP:0.9489, I-F1:0.8889, P-AUROC:0.9852, P-AP:0.4236, P-F1:0.4840, P-AUPRO:0.9251
capsules: I-Auroc:0.9610, I-AP:0.9756, I-F1:0.9347, P-AUROC:0.9752, P-AP:0.4289, P-F1:0.4854, P-AUPRO:0.9442
cashew: I-Auroc:0.9326, I-AP:0.9680, I-F1:0.9192, P-AUROC:0.9438, P-AP:0.4558, P-F1:0.4890, P-AUPRO:0.9072
chewinggum: I-Auroc:0.9892, I-AP:0.9952, I-F1:0.9703, P-AUROC:0.9862, P-AP:0.6474, P-F1:0.6797, P-AUPRO:0.8735
fryum: I-Auroc:0.9312, I-AP:0.9692, I-F1:0.8958, P-AUROC:0.9173, P-AP:0.3368, P-F1:0.3786, P-AUPRO:0.8878
macaroni1: I-Auroc:0.7037, I-AP:0.7080, I-F1:0.7352, P-AUROC:0.9817, P-AP:0.1185, P-F1:0.2301, P-AUPRO:0.8884
macaroni2: I-Auroc:0.6613, I-AP:0.6014, I-F1:0.6882, P-AUROC:0.9759, P-AP:0.1242, P-F1:0.2314, P-AUPRO:0.9057
pcb1: I-Auroc:0.5497, I-AP:0.6101, I-F1:0.6975, P-AUROC:0.9665, P-AP:0.4353, P-F1:0.4692, P-AUPRO:0.7690
pcb2: I-Auroc:0.8951, I-AP:0.8515, I-F1:0.8515, P-AUROC:0.9607, P-AP:0.3676, P-F1:0.4677, P-AUPRO:0.7927
pcb3: I-Auroc:0.9282, I-AP:0.9299, I-F1:0.8571, P-AUROC:0.9656, P-AP:0.4025, P-F1:0.4470, P-AUPRO:0.8435
pcb4: I-Auroc:0.9953, I-AP:0.9952, I-F1:0.9754, P-AUROC:0.9280, P-AP:0.2412, P-F1:0.3127, P-AUPRO:0.7843
pipe_fryum: I-Auroc:0.9596, I-AP:0.9810, I-F1:0.9447, P-AUROC:0.9777, P-AP:0.4219, P-F1:0.5067, P-AUPRO:0.9371
Mean: I-Auroc:0.8707, I-AP:0.8778, I-F1:0.8632, P-AUROC:0.9636, P-AP:0.3670, P-F1:0.4318, P-AUPRO:0.8716
cuda:4
shots: 2
candle: I-Auroc:0.9544, I-AP:0.9593, I-F1:0.8934, P-AUROC:0.9864, P-AP:0.4435, P-F1:0.4890, P-AUPRO:0.9260
capsules: I-Auroc:0.9658, I-AP:0.9780, I-F1:0.9366, P-AUROC:0.9798, P-AP:0.4579, P-F1:0.5011, P-AUPRO:0.9488
cashew: I-Auroc:0.9400, I-AP:0.9715, I-F1:0.9239, P-AUROC:0.9400, P-AP:0.4460, P-F1:0.4867, P-AUPRO:0.9201
chewinggum: I-Auroc:0.9896, I-AP:0.9953, I-F1:0.9703, P-AUROC:0.9854, P-AP:0.6360, P-F1:0.6747, P-AUPRO:0.8688
fryum: I-Auroc:0.9394, I-AP:0.9719, I-F1:0.8976, P-AUROC:0.9200, P-AP:0.3448, P-F1:0.3842, P-AUPRO:0.8844
macaroni1: I-Auroc:0.8616, I-AP:0.8572, I-F1:0.8087, P-AUROC:0.9819, P-AP:0.1450, P-F1:0.2586, P-AUPRO:0.8812
macaroni2: I-Auroc:0.6488, I-AP:0.6008, I-F1:0.6816, P-AUROC:0.9775, P-AP:0.0781, P-F1:0.1628, P-AUPRO:0.9089
pcb1: I-Auroc:0.5169, I-AP:0.5805, I-F1:0.7071, P-AUROC:0.9657, P-AP:0.4181, P-F1:0.4592, P-AUPRO:0.7574
pcb2: I-Auroc:0.9064, I-AP:0.8513, I-F1:0.8544, P-AUROC:0.9707, P-AP:0.3790, P-F1:0.4776, P-AUPRO:0.8310
pcb3: I-Auroc:0.9375, I-AP:0.9424, I-F1:0.8692, P-AUROC:0.9711, P-AP:0.4523, P-F1:0.4838, P-AUPRO:0.8447
pcb4: I-Auroc:0.9947, I-AP:0.9941, I-F1:0.9804, P-AUROC:0.9397, P-AP:0.2599, P-F1:0.3216, P-AUPRO:0.8056
pipe_fryum: I-Auroc:0.9688, I-AP:0.9856, I-F1:0.9400, P-AUROC:0.9806, P-AP:0.4358, P-F1:0.5227, P-AUPRO:0.9501
Mean: I-Auroc:0.8853, I-AP:0.8907, I-F1:0.8719, P-AUROC:0.9666, P-AP:0.3747, P-F1:0.4352, P-AUPRO:0.8772
cuda:4
shots: 4
candle: I-Auroc:0.9663, I-AP:0.9667, I-F1:0.9064, P-AUROC:0.9879, P-AP:0.4589, P-F1:0.4978, P-AUPRO:0.9298
capsules: I-Auroc:0.9670, I-AP:0.9780, I-F1:0.9552, P-AUROC:0.9852, P-AP:0.5458, P-F1:0.5641, P-AUPRO:0.9589
cashew: I-Auroc:0.9570, I-AP:0.9796, I-F1:0.9347, P-AUROC:0.9437, P-AP:0.4605, P-F1:0.5003, P-AUPRO:0.9249
chewinggum: I-Auroc:0.9866, I-AP:0.9943, I-F1:0.9703, P-AUROC:0.9851, P-AP:0.6721, P-F1:0.6848, P-AUPRO:0.8626
fryum: I-Auroc:0.9636, I-AP:0.9810, I-F1:0.9417, P-AUROC:0.9315, P-AP:0.3733, P-F1:0.4171, P-AUPRO:0.8958
macaroni1: I-Auroc:0.8556, I-AP:0.8527, I-F1:0.8073, P-AUROC:0.9832, P-AP:0.1873, P-F1:0.3036, P-AUPRO:0.8939
macaroni2: I-Auroc:0.7636, I-AP:0.7475, I-F1:0.7331, P-AUROC:0.9854, P-AP:0.1751, P-F1:0.2924, P-AUPRO:0.9334
pcb1: I-Auroc:0.8258, I-AP:0.8068, I-F1:0.8018, P-AUROC:0.9878, P-AP:0.6248, P-F1:0.6274, P-AUPRO:0.8863
pcb2: I-Auroc:0.9223, I-AP:0.8636, I-F1:0.9010, P-AUROC:0.9733, P-AP:0.3922, P-F1:0.4941, P-AUPRO:0.8482
pcb3: I-Auroc:0.9404, I-AP:0.9514, I-F1:0.8854, P-AUROC:0.9748, P-AP:0.4668, P-F1:0.4971, P-AUPRO:0.8633
pcb4: I-Auroc:0.9932, I-AP:0.9927, I-F1:0.9709, P-AUROC:0.9551, P-AP:0.3388, P-F1:0.3948, P-AUPRO:0.8524
pipe_fryum: I-Auroc:0.9764, I-AP:0.9891, I-F1:0.9400, P-AUROC:0.9829, P-AP:0.4467, P-F1:0.5350, P-AUPRO:0.9508
Mean: I-Auroc:0.9265, I-AP:0.9253, I-F1:0.8957, P-AUROC:0.9730, P-AP:0.4285, P-F1:0.4840, P-AUPRO:0.9000



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
transforms.Lambda(lambda x: x[[2, 1, 0], :, :])  # 通道交换
anomaly_map_aug1 = model(aug_img, aug_supports, memorize_supports, use_memory, aug=1)
anomaly_map = 0.7 * anomaly_map_ori + 0.3 * anomaly_map_aug1

cuda:4
shots: 1
candle: I-Auroc:0.9439, I-AP:0.9511, I-F1:0.8889, P-AUROC:0.9849, P-AP:0.4186, P-F1:0.4827, P-AUPRO:0.9248
capsules: I-Auroc:0.9603, I-AP:0.9745, I-F1:0.9347, P-AUROC:0.9735, P-AP:0.4179, P-F1:0.4766, P-AUPRO:0.9427
cashew: I-Auroc:0.9322, I-AP:0.9679, I-F1:0.9239, P-AUROC:0.9451, P-AP:0.4531, P-F1:0.4910, P-AUPRO:0.9050
chewinggum: I-Auroc:0.9872, I-AP:0.9943, I-F1:0.9652, P-AUROC:0.9858, P-AP:0.6315, P-F1:0.6756, P-AUPRO:0.8693
fryum: I-Auroc:0.9234, I-AP:0.9659, I-F1:0.8878, P-AUROC:0.9121, P-AP:0.3285, P-F1:0.3713, P-AUPRO:0.8782
macaroni1: I-Auroc:0.7120, I-AP:0.7128, I-F1:0.7413, P-AUROC:0.9805, P-AP:0.1105, P-F1:0.2235, P-AUPRO:0.8850
macaroni2: I-Auroc:0.6391, I-AP:0.5808, I-F1:0.6862, P-AUROC:0.9745, P-AP:0.1035, P-F1:0.2119, P-AUPRO:0.8959
pcb1: I-Auroc:0.5541, I-AP:0.6209, I-F1:0.6931, P-AUROC:0.9673, P-AP:0.4376, P-F1:0.4707, P-AUPRO:0.7715
pcb2: I-Auroc:0.8913, I-AP:0.8489, I-F1:0.8257, P-AUROC:0.9591, P-AP:0.3680, P-F1:0.4662, P-AUPRO:0.7850
pcb3: I-Auroc:0.9241, I-AP:0.9250, I-F1:0.8626, P-AUROC:0.9642, P-AP:0.3906, P-F1:0.4387, P-AUPRO:0.8351
pcb4: I-Auroc:0.9936, I-AP:0.9935, I-F1:0.9612, P-AUROC:0.9285, P-AP:0.2380, P-F1:0.3077, P-AUPRO:0.7812
pipe_fryum: I-Auroc:0.9502, I-AP:0.9766, I-F1:0.9353, P-AUROC:0.9778, P-AP:0.4168, P-F1:0.5013, P-AUPRO:0.9388
Mean: I-Auroc:0.8676, I-AP:0.8760, I-F1:0.8588, P-AUROC:0.9628, P-AP:0.3596, P-F1:0.4264, P-AUPRO:0.8677
cuda:4
shots: 2
candle: I-Auroc:0.9548, I-AP:0.9592, I-F1:0.8878, P-AUROC:0.9859, P-AP:0.4358, P-F1:0.4907, P-AUPRO:0.9203
capsules: I-Auroc:0.9667, I-AP:0.9778, I-F1:0.9417, P-AUROC:0.9784, P-AP:0.4478, P-F1:0.4972, P-AUPRO:0.9464
cashew: I-Auroc:0.9400, I-AP:0.9717, I-F1:0.9239, P-AUROC:0.9405, P-AP:0.4427, P-F1:0.4877, P-AUPRO:0.9135
chewinggum: I-Auroc:0.9884, I-AP:0.9947, I-F1:0.9596, P-AUROC:0.9851, P-AP:0.6168, P-F1:0.6687, P-AUPRO:0.8638
fryum: I-Auroc:0.9334, I-AP:0.9686, I-F1:0.8995, P-AUROC:0.9154, P-AP:0.3380, P-F1:0.3772, P-AUPRO:0.8724
macaroni1: I-Auroc:0.8572, I-AP:0.8524, I-F1:0.7950, P-AUROC:0.9805, P-AP:0.1290, P-F1:0.2425, P-AUPRO:0.8730
macaroni2: I-Auroc:0.6260, I-AP:0.5806, I-F1:0.6767, P-AUROC:0.9754, P-AP:0.0640, P-F1:0.1470, P-AUPRO:0.9012
pcb1: I-Auroc:0.5244, I-AP:0.5887, I-F1:0.7046, P-AUROC:0.9664, P-AP:0.4213, P-F1:0.4614, P-AUPRO:0.7621
pcb2: I-Auroc:0.9053, I-AP:0.8520, I-F1:0.8488, P-AUROC:0.9692, P-AP:0.3780, P-F1:0.4782, P-AUPRO:0.8296
pcb3: I-Auroc:0.9371, I-AP:0.9407, I-F1:0.8676, P-AUROC:0.9700, P-AP:0.4436, P-F1:0.4809, P-AUPRO:0.8321
pcb4: I-Auroc:0.9939, I-AP:0.9932, I-F1:0.9804, P-AUROC:0.9395, P-AP:0.2594, P-F1:0.3201, P-AUPRO:0.8036
pipe_fryum: I-Auroc:0.9600, I-AP:0.9815, I-F1:0.9347, P-AUROC:0.9805, P-AP:0.4315, P-F1:0.5171, P-AUPRO:0.9502
Mean: I-Auroc:0.8823, I-AP:0.8884, I-F1:0.8683, P-AUROC:0.9656, P-AP:0.3673, P-F1:0.4307, P-AUPRO:0.8724
cuda:4
shots: 4
candle: I-Auroc:0.9671, I-AP:0.9674, I-F1:0.9108, P-AUROC:0.9876, P-AP:0.4538, P-F1:0.4918, P-AUPRO:0.9284
capsules: I-Auroc:0.9652, I-AP:0.9767, I-F1:0.9552, P-AUROC:0.9838, P-AP:0.5353, P-F1:0.5576, P-AUPRO:0.9577
cashew: I-Auroc:0.9598, I-AP:0.9819, I-F1:0.9381, P-AUROC:0.9452, P-AP:0.4634, P-F1:0.5043, P-AUPRO:0.9213
chewinggum: I-Auroc:0.9868, I-AP:0.9943, I-F1:0.9697, P-AUROC:0.9847, P-AP:0.6566, P-F1:0.6819, P-AUPRO:0.8618
fryum: I-Auroc:0.9624, I-AP:0.9800, I-F1:0.9340, P-AUROC:0.9268, P-AP:0.3649, P-F1:0.4104, P-AUPRO:0.8926
macaroni1: I-Auroc:0.8457, I-AP:0.8456, I-F1:0.8000, P-AUROC:0.9818, P-AP:0.1722, P-F1:0.2872, P-AUPRO:0.8849
macaroni2: I-Auroc:0.7266, I-AP:0.7041, I-F1:0.7101, P-AUROC:0.9833, P-AP:0.1577, P-F1:0.2612, P-AUPRO:0.9245
pcb1: I-Auroc:0.8308, I-AP:0.8169, I-F1:0.8020, P-AUROC:0.9875, P-AP:0.6271, P-F1:0.6301, P-AUPRO:0.8856
pcb2: I-Auroc:0.9240, I-AP:0.8665, I-F1:0.8955, P-AUROC:0.9718, P-AP:0.3908, P-F1:0.4912, P-AUPRO:0.8403
pcb3: I-Auroc:0.9435, I-AP:0.9535, I-F1:0.8947, P-AUROC:0.9735, P-AP:0.4607, P-F1:0.4959, P-AUPRO:0.8570
pcb4: I-Auroc:0.9930, I-AP:0.9925, I-F1:0.9756, P-AUROC:0.9548, P-AP:0.3339, P-F1:0.3920, P-AUPRO:0.8521
pipe_fryum: I-Auroc:0.9708, I-AP:0.9861, I-F1:0.9458, P-AUROC:0.9827, P-AP:0.4406, P-F1:0.5330, P-AUPRO:0.9514
Mean: I-Auroc:0.9230, I-AP:0.9221, I-F1:0.8943, P-AUROC:0.9720, P-AP:0.4214, P-F1:0.4781, P-AUPRO:0.8965



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = 0.6 * anomaly_map_ori + 0.2 * anomaly_map_aug1 + 0.2 * anomaly_map_aug2

cuda:4
shots: 1
candle: I-Auroc:0.9480, I-AP:0.9551, I-F1:0.8889, P-AUROC:0.9890, P-AP:0.4366, P-F1:0.4969, P-AUPRO:0.9433
capsules: I-Auroc:0.9598, I-AP:0.9755, I-F1:0.9347, P-AUROC:0.9765, P-AP:0.4711, P-F1:0.5108, P-AUPRO:0.9462
cashew: I-Auroc:0.9468, I-AP:0.9751, I-F1:0.9175, P-AUROC:0.9670, P-AP:0.5029, P-F1:0.5204, P-AUPRO:0.9338
chewinggum: I-Auroc:0.9900, I-AP:0.9954, I-F1:0.9697, P-AUROC:0.9902, P-AP:0.6393, P-F1:0.6750, P-AUPRO:0.9038
fryum: I-Auroc:0.9348, I-AP:0.9714, I-F1:0.8990, P-AUROC:0.9198, P-AP:0.3431, P-F1:0.3852, P-AUPRO:0.8886
macaroni1: I-Auroc:0.8340, I-AP:0.8439, I-F1:0.7705, P-AUROC:0.9903, P-AP:0.2288, P-F1:0.3167, P-AUPRO:0.9292
macaroni2: I-Auroc:0.6775, I-AP:0.6180, I-F1:0.7068, P-AUROC:0.9779, P-AP:0.1413, P-F1:0.2456, P-AUPRO:0.9105
pcb1: I-Auroc:0.5605, I-AP:0.6300, I-F1:0.7004, P-AUROC:0.9676, P-AP:0.4607, P-F1:0.4807, P-AUPRO:0.7783
pcb2: I-Auroc:0.9041, I-AP:0.8995, I-F1:0.8488, P-AUROC:0.9619, P-AP:0.4358, P-F1:0.4840, P-AUPRO:0.8009
pcb3: I-Auroc:0.9284, I-AP:0.9264, I-F1:0.8767, P-AUROC:0.9690, P-AP:0.4333, P-F1:0.4774, P-AUPRO:0.8558
pcb4: I-Auroc:0.9953, I-AP:0.9951, I-F1:0.9709, P-AUROC:0.9384, P-AP:0.2628, P-F1:0.3339, P-AUPRO:0.8085
pipe_fryum: I-Auroc:0.9546, I-AP:0.9786, I-F1:0.9261, P-AUROC:0.9826, P-AP:0.4419, P-F1:0.5202, P-AUPRO:0.9550
Mean: I-Auroc:0.8862, I-AP:0.8970, I-F1:0.8675, P-AUROC:0.9692, P-AP:0.3998, P-F1:0.4539, P-AUPRO:0.8878
cuda:4
shots: 2
candle: I-Auroc:0.9564, I-AP:0.9618, I-F1:0.9026, P-AUROC:0.9899, P-AP:0.4556, P-F1:0.5017, P-AUPRO:0.9386
capsules: I-Auroc:0.9648, I-AP:0.9776, I-F1:0.9320, P-AUROC:0.9803, P-AP:0.4948, P-F1:0.5267, P-AUPRO:0.9506
cashew: I-Auroc:0.9530, I-AP:0.9771, I-F1:0.9254, P-AUROC:0.9668, P-AP:0.4980, P-F1:0.5223, P-AUPRO:0.9448
chewinggum: I-Auroc:0.9916, I-AP:0.9960, I-F1:0.9645, P-AUROC:0.9898, P-AP:0.6332, P-F1:0.6724, P-AUPRO:0.8949
fryum: I-Auroc:0.9432, I-AP:0.9739, I-F1:0.9000, P-AUROC:0.9229, P-AP:0.3522, P-F1:0.3927, P-AUPRO:0.8871
macaroni1: I-Auroc:0.9244, I-AP:0.9261, I-F1:0.8384, P-AUROC:0.9905, P-AP:0.2480, P-F1:0.3407, P-AUPRO:0.9201
macaroni2: I-Auroc:0.6617, I-AP:0.6158, I-F1:0.6846, P-AUROC:0.9793, P-AP:0.0893, P-F1:0.1806, P-AUPRO:0.9156
pcb1: I-Auroc:0.5280, I-AP:0.5914, I-F1:0.7122, P-AUROC:0.9668, P-AP:0.4415, P-F1:0.4655, P-AUPRO:0.7671
pcb2: I-Auroc:0.9168, I-AP:0.8962, I-F1:0.8641, P-AUROC:0.9706, P-AP:0.4475, P-F1:0.4967, P-AUPRO:0.8443
pcb3: I-Auroc:0.9389, I-AP:0.9424, I-F1:0.8785, P-AUROC:0.9739, P-AP:0.4728, P-F1:0.5037, P-AUPRO:0.8591
pcb4: I-Auroc:0.9926, I-AP:0.9917, I-F1:0.9706, P-AUROC:0.9482, P-AP:0.2731, P-F1:0.3383, P-AUPRO:0.8219
pipe_fryum: I-Auroc:0.9674, I-AP:0.9847, I-F1:0.9406, P-AUROC:0.9844, P-AP:0.4557, P-F1:0.5354, P-AUPRO:0.9597
Mean: I-Auroc:0.8949, I-AP:0.9029, I-F1:0.8761, P-AUROC:0.9720, P-AP:0.4051, P-F1:0.4564, P-AUPRO:0.8920
cuda:4
shots: 4
candle: I-Auroc:0.9725, I-AP:0.9744, I-F1:0.9216, P-AUROC:0.9909, P-AP:0.4727, P-F1:0.5116, P-AUPRO:0.9422
capsules: I-Auroc:0.9593, I-AP:0.9751, I-F1:0.9453, P-AUROC:0.9856, P-AP:0.5766, P-F1:0.5833, P-AUPRO:0.9581
cashew: I-Auroc:0.9686, I-AP:0.9850, I-F1:0.9388, P-AUROC:0.9696, P-AP:0.5156, P-F1:0.5432, P-AUPRO:0.9481
chewinggum: I-Auroc:0.9926, I-AP:0.9965, I-F1:0.9694, P-AUROC:0.9897, P-AP:0.6678, P-F1:0.6817, P-AUPRO:0.8915
fryum: I-Auroc:0.9656, I-AP:0.9824, I-F1:0.9423, P-AUROC:0.9342, P-AP:0.3809, P-F1:0.4264, P-AUPRO:0.9020
macaroni1: I-Auroc:0.9445, I-AP:0.9405, I-F1:0.8995, P-AUROC:0.9914, P-AP:0.2792, P-F1:0.3689, P-AUPRO:0.9352
macaroni2: I-Auroc:0.7647, I-AP:0.7232, I-F1:0.7350, P-AUROC:0.9863, P-AP:0.1772, P-F1:0.2848, P-AUPRO:0.9372
pcb1: I-Auroc:0.8471, I-AP:0.8356, I-F1:0.8223, P-AUROC:0.9881, P-AP:0.6558, P-F1:0.6406, P-AUPRO:0.8922
pcb2: I-Auroc:0.9375, I-AP:0.9085, I-F1:0.9020, P-AUROC:0.9729, P-AP:0.4579, P-F1:0.5118, P-AUPRO:0.8529
pcb3: I-Auroc:0.9482, I-AP:0.9561, I-F1:0.8945, P-AUROC:0.9768, P-AP:0.4875, P-F1:0.5159, P-AUPRO:0.8805
pcb4: I-Auroc:0.9947, I-AP:0.9941, I-F1:0.9804, P-AUROC:0.9627, P-AP:0.3649, P-F1:0.4203, P-AUPRO:0.8734
pipe_fryum: I-Auroc:0.9762, I-AP:0.9888, I-F1:0.9552, P-AUROC:0.9854, P-AP:0.4647, P-F1:0.5491, P-AUPRO:0.9620
Mean: I-Auroc:0.9393, I-AP:0.9384, I-F1:0.9089, P-AUROC:0.9778, P-AP:0.4584, P-F1:0.5031, P-AUPRO:0.9146



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2

cuda:4
shots: 1
candle: I-Auroc:0.9462, I-AP:0.9548, I-F1:0.8936, P-AUROC:0.9905, P-AP:0.4371, P-F1:0.4958, P-AUPRO:0.9482
capsules: I-Auroc:0.9578, I-AP:0.9748, I-F1:0.9340, P-AUROC:0.9774, P-AP:0.4873, P-F1:0.5274, P-AUPRO:0.9448
cashew: I-Auroc:0.9482, I-AP:0.9748, I-F1:0.9231, P-AUROC:0.9749, P-AP:0.5171, P-F1:0.5260, P-AUPRO:0.9444
chewinggum: I-Auroc:0.9888, I-AP:0.9949, I-F1:0.9697, P-AUROC:0.9919, P-AP:0.6409, P-F1:0.6754, P-AUPRO:0.9171
fryum: I-Auroc:0.9366, I-AP:0.9723, I-F1:0.9016, P-AUROC:0.9218, P-AP:0.3466, P-F1:0.3881, P-AUPRO:0.8928
macaroni1: I-Auroc:0.9008, I-AP:0.9026, I-F1:0.8318, P-AUROC:0.9927, P-AP:0.2770, P-F1:0.3725, P-AUPRO:0.9459
macaroni2: I-Auroc:0.6837, I-AP:0.6295, I-F1:0.7176, P-AUROC:0.9789, P-AP:0.1459, P-F1:0.2482, P-AUPRO:0.9163
pcb1: I-Auroc:0.5652, I-AP:0.6377, I-F1:0.7004, P-AUROC:0.9677, P-AP:0.4691, P-F1:0.4846, P-AUPRO:0.7767
pcb2: I-Auroc:0.9069, I-AP:0.9213, I-F1:0.8390, P-AUROC:0.9611, P-AP:0.4553, P-F1:0.4908, P-AUPRO:0.8043
pcb3: I-Auroc:0.9244, I-AP:0.9217, I-F1:0.8688, P-AUROC:0.9708, P-AP:0.4455, P-F1:0.4874, P-AUPRO:0.8652
pcb4: I-Auroc:0.9944, I-AP:0.9938, I-F1:0.9655, P-AUROC:0.9409, P-AP:0.2680, P-F1:0.3435, P-AUPRO:0.8118
pipe_fryum: I-Auroc:0.9528, I-AP:0.9774, I-F1:0.9200, P-AUROC:0.9838, P-AP:0.4498, P-F1:0.5270, P-AUPRO:0.9600
Mean: I-Auroc:0.8921, I-AP:0.9046, I-F1:0.8721, P-AUROC:0.9710, P-AP:0.4116, P-F1:0.4639, P-AUPRO:0.8940
cuda:4
shots: 2
candle: I-Auroc:0.9546, I-AP:0.9608, I-F1:0.8980, P-AUROC:0.9912, P-AP:0.4557, P-F1:0.5014, P-AUPRO:0.9447
capsules: I-Auroc:0.9613, I-AP:0.9765, I-F1:0.9286, P-AUROC:0.9807, P-AP:0.5076, P-F1:0.5414, P-AUPRO:0.9473
cashew: I-Auroc:0.9552, I-AP:0.9771, I-F1:0.9353, P-AUROC:0.9761, P-AP:0.5175, P-F1:0.5310, P-AUPRO:0.9565
chewinggum: I-Auroc:0.9904, I-AP:0.9955, I-F1:0.9645, P-AUROC:0.9918, P-AP:0.6402, P-F1:0.6733, P-AUPRO:0.9116
fryum: I-Auroc:0.9428, I-AP:0.9743, I-F1:0.9005, P-AUROC:0.9253, P-AP:0.3561, P-F1:0.3966, P-AUPRO:0.8923
macaroni1: I-Auroc:0.9487, I-AP:0.9517, I-F1:0.8711, P-AUROC:0.9935, P-AP:0.2989, P-F1:0.3878, P-AUPRO:0.9430
macaroni2: I-Auroc:0.6750, I-AP:0.6264, I-F1:0.6905, P-AUROC:0.9805, P-AP:0.0969, P-F1:0.1935, P-AUPRO:0.9193
pcb1: I-Auroc:0.5294, I-AP:0.5920, I-F1:0.7101, P-AUROC:0.9669, P-AP:0.4483, P-F1:0.4665, P-AUPRO:0.7673
pcb2: I-Auroc:0.9234, I-AP:0.9255, I-F1:0.8641, P-AUROC:0.9693, P-AP:0.4775, P-F1:0.5052, P-AUPRO:0.8385
pcb3: I-Auroc:0.9381, I-AP:0.9407, I-F1:0.8846, P-AUROC:0.9752, P-AP:0.4817, P-F1:0.5121, P-AUPRO:0.8670
pcb4: I-Auroc:0.9910, I-AP:0.9890, I-F1:0.9700, P-AUROC:0.9505, P-AP:0.2715, P-F1:0.3425, P-AUPRO:0.8297
pipe_fryum: I-Auroc:0.9694, I-AP:0.9856, I-F1:0.9400, P-AUROC:0.9854, P-AP:0.4635, P-F1:0.5414, P-AUPRO:0.9638
Mean: I-Auroc:0.8983, I-AP:0.9079, I-F1:0.8798, P-AUROC:0.9739, P-AP:0.4179, P-F1:0.4660, P-AUPRO:0.8984
cuda:4
shots: 4
candle: I-Auroc:0.9713, I-AP:0.9742, I-F1:0.9192, P-AUROC:0.9921, P-AP:0.4713, P-F1:0.5117, P-AUPRO:0.9469
capsules: I-Auroc:0.9557, I-AP:0.9739, I-F1:0.9388, P-AUROC:0.9861, P-AP:0.5880, P-F1:0.5925, P-AUPRO:0.9556
cashew: I-Auroc:0.9670, I-AP:0.9834, I-F1:0.9429, P-AUROC:0.9782, P-AP:0.5344, P-F1:0.5511, P-AUPRO:0.9577
chewinggum: I-Auroc:0.9924, I-AP:0.9964, I-F1:0.9697, P-AUROC:0.9919, P-AP:0.6704, P-F1:0.6813, P-AUPRO:0.9144
fryum: I-Auroc:0.9682, I-AP:0.9843, I-F1:0.9372, P-AUROC:0.9366, P-AP:0.3864, P-F1:0.4326, P-AUPRO:0.9037
macaroni1: I-Auroc:0.9793, I-AP:0.9791, I-F1:0.9378, P-AUROC:0.9943, P-AP:0.3204, P-F1:0.4106, P-AUPRO:0.9541
macaroni2: I-Auroc:0.7710, I-AP:0.7176, I-F1:0.7469, P-AUROC:0.9870, P-AP:0.1753, P-F1:0.2767, P-AUPRO:0.9413
pcb1: I-Auroc:0.8612, I-AP:0.8524, I-F1:0.8302, P-AUROC:0.9881, P-AP:0.6638, P-F1:0.6425, P-AUPRO:0.8912
pcb2: I-Auroc:0.9447, I-AP:0.9400, I-F1:0.9014, P-AUROC:0.9714, P-AP:0.4945, P-F1:0.5200, P-AUPRO:0.8536
pcb3: I-Auroc:0.9508, I-AP:0.9582, I-F1:0.9091, P-AUROC:0.9778, P-AP:0.4976, P-F1:0.5267, P-AUPRO:0.8914
pcb4: I-Auroc:0.9934, I-AP:0.9928, I-F1:0.9703, P-AUROC:0.9651, P-AP:0.3728, P-F1:0.4324, P-AUPRO:0.8762
pipe_fryum: I-Auroc:0.9780, I-AP:0.9897, I-F1:0.9510, P-AUROC:0.9861, P-AP:0.4719, P-F1:0.5541, P-AUPRO:0.9630
Mean: I-Auroc:0.9444, I-AP:0.9452, I-F1:0.9129, P-AUROC:0.9796, P-AP:0.4706, P-F1:0.5110, P-AUPRO:0.9208



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转

cuda:4
shots: 1
candle: I-Auroc:0.9431, I-AP:0.9518, I-F1:0.8830, P-AUROC:0.9897, P-AP:0.4508, P-F1:0.5027, P-AUPRO:0.9489
capsules: I-Auroc:0.9663, I-AP:0.9800, I-F1:0.9326, P-AUROC:0.9786, P-AP:0.4770, P-F1:0.5205, P-AUPRO:0.9470
cashew: I-Auroc:0.9422, I-AP:0.9712, I-F1:0.9238, P-AUROC:0.9740, P-AP:0.4766, P-F1:0.4891, P-AUPRO:0.9446
chewinggum: I-Auroc:0.9868, I-AP:0.9940, I-F1:0.9645, P-AUROC:0.9924, P-AP:0.6327, P-F1:0.6754, P-AUPRO:0.9206
fryum: I-Auroc:0.9650, I-AP:0.9844, I-F1:0.9271, P-AUROC:0.9260, P-AP:0.3667, P-F1:0.4088, P-AUPRO:0.9021
macaroni1: I-Auroc:0.8955, I-AP:0.8994, I-F1:0.8325, P-AUROC:0.9931, P-AP:0.2834, P-F1:0.3800, P-AUPRO:0.9488
macaroni2: I-Auroc:0.7436, I-AP:0.6532, I-F1:0.7468, P-AUROC:0.9835, P-AP:0.1675, P-F1:0.2499, P-AUPRO:0.9293
pcb1: I-Auroc:0.9070, I-AP:0.8997, I-F1:0.8600, P-AUROC:0.9888, P-AP:0.6564, P-F1:0.6341, P-AUPRO:0.9072
pcb2: I-Auroc:0.9048, I-AP:0.9192, I-F1:0.8358, P-AUROC:0.9561, P-AP:0.4624, P-F1:0.5054, P-AUPRO:0.8165
pcb3: I-Auroc:0.9048, I-AP:0.8999, I-F1:0.8585, P-AUROC:0.9601, P-AP:0.4598, P-F1:0.4964, P-AUPRO:0.8641
pcb4: I-Auroc:0.9920, I-AP:0.9908, I-F1:0.9703, P-AUROC:0.9388, P-AP:0.2671, P-F1:0.3425, P-AUPRO:0.8203
pipe_fryum: I-Auroc:0.9686, I-AP:0.9851, I-F1:0.9463, P-AUROC:0.9847, P-AP:0.4557, P-F1:0.5370, P-AUPRO:0.9619
Mean: I-Auroc:0.9266, I-AP:0.9274, I-F1:0.8901, P-AUROC:0.9722, P-AP:0.4297, P-F1:0.4785, P-AUPRO:0.9093
cuda:4
shots: 2
candle: I-Auroc:0.9534, I-AP:0.9599, I-F1:0.8980, P-AUROC:0.9906, P-AP:0.4643, P-F1:0.5097, P-AUPRO:0.9463
capsules: I-Auroc:0.9738, I-AP:0.9843, I-F1:0.9347, P-AUROC:0.9821, P-AP:0.4998, P-F1:0.5357, P-AUPRO:0.9532
cashew: I-Auroc:0.9488, I-AP:0.9732, I-F1:0.9327, P-AUROC:0.9752, P-AP:0.4837, P-F1:0.5005, P-AUPRO:0.9521
chewinggum: I-Auroc:0.9886, I-AP:0.9947, I-F1:0.9645, P-AUROC:0.9922, P-AP:0.6303, P-F1:0.6744, P-AUPRO:0.9151
fryum: I-Auroc:0.9712, I-AP:0.9868, I-F1:0.9381, P-AUROC:0.9304, P-AP:0.3792, P-F1:0.4222, P-AUPRO:0.9028
macaroni1: I-Auroc:0.9541, I-AP:0.9557, I-F1:0.8826, P-AUROC:0.9940, P-AP:0.3083, P-F1:0.3981, P-AUPRO:0.9443
macaroni2: I-Auroc:0.7286, I-AP:0.6369, I-F1:0.7510, P-AUROC:0.9857, P-AP:0.1312, P-F1:0.2221, P-AUPRO:0.9335
pcb1: I-Auroc:0.9064, I-AP:0.8962, I-F1:0.8571, P-AUROC:0.9896, P-AP:0.6708, P-F1:0.6441, P-AUPRO:0.9032
pcb2: I-Auroc:0.9236, I-AP:0.9280, I-F1:0.8657, P-AUROC:0.9600, P-AP:0.4823, P-F1:0.5176, P-AUPRO:0.8420
pcb3: I-Auroc:0.9169, I-AP:0.9210, I-F1:0.8738, P-AUROC:0.9678, P-AP:0.4986, P-F1:0.5291, P-AUPRO:0.8708
pcb4: I-Auroc:0.9904, I-AP:0.9882, I-F1:0.9652, P-AUROC:0.9476, P-AP:0.2723, P-F1:0.3443, P-AUPRO:0.8351
pipe_fryum: I-Auroc:0.9796, I-AP:0.9904, I-F1:0.9652, P-AUROC:0.9859, P-AP:0.4655, P-F1:0.5486, P-AUPRO:0.9646
Mean: I-Auroc:0.9363, I-AP:0.9346, I-F1:0.9024, P-AUROC:0.9751, P-AP:0.4405, P-F1:0.4872, P-AUPRO:0.9136
cuda:4
shots: 4
candle: I-Auroc:0.9688, I-AP:0.9710, I-F1:0.9146, P-AUROC:0.9918, P-AP:0.4813, P-F1:0.5145, P-AUPRO:0.9484
capsules: I-Auroc:0.9703, I-AP:0.9834, I-F1:0.9436, P-AUROC:0.9871, P-AP:0.5883, P-F1:0.5892, P-AUPRO:0.9591
cashew: I-Auroc:0.9662, I-AP:0.9827, I-F1:0.9429, P-AUROC:0.9773, P-AP:0.5052, P-F1:0.5206, P-AUPRO:0.9541
chewinggum: I-Auroc:0.9902, I-AP:0.9955, I-F1:0.9697, P-AUROC:0.9923, P-AP:0.6503, P-F1:0.6752, P-AUPRO:0.9183
fryum: I-Auroc:0.9804, I-AP:0.9910, I-F1:0.9495, P-AUROC:0.9390, P-AP:0.4014, P-F1:0.4435, P-AUPRO:0.9089
macaroni1: I-Auroc:0.9870, I-AP:0.9872, I-F1:0.9429, P-AUROC:0.9947, P-AP:0.3206, P-F1:0.4118, P-AUPRO:0.9557
macaroni2: I-Auroc:0.7716, I-AP:0.6990, I-F1:0.7822, P-AUROC:0.9893, P-AP:0.1887, P-F1:0.2706, P-AUPRO:0.9493
pcb1: I-Auroc:0.9119, I-AP:0.8979, I-F1:0.8641, P-AUROC:0.9908, P-AP:0.6923, P-F1:0.6654, P-AUPRO:0.9145
pcb2: I-Auroc:0.9439, I-AP:0.9459, I-F1:0.8995, P-AUROC:0.9624, P-AP:0.5091, P-F1:0.5487, P-AUPRO:0.8550
pcb3: I-Auroc:0.9372, I-AP:0.9456, I-F1:0.8842, P-AUROC:0.9728, P-AP:0.5215, P-F1:0.5613, P-AUPRO:0.8946
pcb4: I-Auroc:0.9934, I-AP:0.9924, I-F1:0.9756, P-AUROC:0.9609, P-AP:0.3654, P-F1:0.4306, P-AUPRO:0.8826
pipe_fryum: I-Auroc:0.9872, I-AP:0.9945, I-F1:0.9694, P-AUROC:0.9864, P-AP:0.4694, P-F1:0.5622, P-AUPRO:0.9656
Mean: I-Auroc:0.9507, I-AP:0.9488, I-F1:0.9198, P-AUROC:0.9787, P-AP:0.4745, P-F1:0.5161, P-AUPRO:0.9255



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

cuda:4
shots: 1
candle: I-Auroc:0.9452, I-AP:0.9569, I-F1:0.8947, P-AUROC:0.9899, P-AP:0.4801, P-F1:0.5218, P-AUPRO:0.9422
capsules: I-Auroc:0.9663, I-AP:0.9813, I-F1:0.9326, P-AUROC:0.9787, P-AP:0.5484, P-F1:0.5678, P-AUPRO:0.9437
cashew: I-Auroc:0.9458, I-AP:0.9747, I-F1:0.9171, P-AUROC:0.9808, P-AP:0.5168, P-F1:0.5285, P-AUPRO:0.9508
chewinggum: I-Auroc:0.9936, I-AP:0.9970, I-F1:0.9749, P-AUROC:0.9938, P-AP:0.6814, P-F1:0.6920, P-AUPRO:0.9422
fryum: I-Auroc:0.9730, I-AP:0.9878, I-F1:0.9340, P-AUROC:0.9246, P-AP:0.3647, P-F1:0.4072, P-AUPRO:0.8946
macaroni1: I-Auroc:0.8865, I-AP:0.9009, I-F1:0.8103, P-AUROC:0.9940, P-AP:0.3148, P-F1:0.3994, P-AUPRO:0.9489
macaroni2: I-Auroc:0.7910, I-AP:0.7227, I-F1:0.7699, P-AUROC:0.9805, P-AP:0.1924, P-F1:0.2709, P-AUPRO:0.9175
pcb1: I-Auroc:0.9205, I-AP:0.9096, I-F1:0.8776, P-AUROC:0.9887, P-AP:0.6948, P-F1:0.6612, P-AUPRO:0.9009
pcb2: I-Auroc:0.9316, I-AP:0.9414, I-F1:0.8750, P-AUROC:0.9577, P-AP:0.4844, P-F1:0.5290, P-AUPRO:0.8095
pcb3: I-Auroc:0.9362, I-AP:0.9310, I-F1:0.8750, P-AUROC:0.9661, P-AP:0.5108, P-F1:0.5329, P-AUPRO:0.8715
pcb4: I-Auroc:0.9923, I-AP:0.9918, I-F1:0.9700, P-AUROC:0.9368, P-AP:0.2939, P-F1:0.3646, P-AUPRO:0.7957
pipe_fryum: I-Auroc:0.9652, I-AP:0.9834, I-F1:0.9375, P-AUROC:0.9862, P-AP:0.4751, P-F1:0.5554, P-AUPRO:0.9599
Mean: I-Auroc:0.9373, I-AP:0.9399, I-F1:0.8974, P-AUROC:0.9731, P-AP:0.4631, P-F1:0.5025, P-AUPRO:0.9065
cuda:4
shots: 2
candle: I-Auroc:0.9573, I-AP:0.9648, I-F1:0.9110, P-AUROC:0.9906, P-AP:0.4873, P-F1:0.5225, P-AUPRO:0.9414
capsules: I-Auroc:0.9832, I-AP:0.9902, I-F1:0.9485, P-AUROC:0.9822, P-AP:0.5680, P-F1:0.5744, P-AUPRO:0.9521
cashew: I-Auroc:0.9562, I-AP:0.9778, I-F1:0.9327, P-AUROC:0.9824, P-AP:0.5273, P-F1:0.5409, P-AUPRO:0.9587
chewinggum: I-Auroc:0.9932, I-AP:0.9968, I-F1:0.9694, P-AUROC:0.9935, P-AP:0.6667, P-F1:0.6879, P-AUPRO:0.9363
fryum: I-Auroc:0.9728, I-AP:0.9878, I-F1:0.9333, P-AUROC:0.9285, P-AP:0.3755, P-F1:0.4177, P-AUPRO:0.8963
macaroni1: I-Auroc:0.9526, I-AP:0.9536, I-F1:0.8986, P-AUROC:0.9942, P-AP:0.3426, P-F1:0.4271, P-AUPRO:0.9454
macaroni2: I-Auroc:0.7682, I-AP:0.6961, I-F1:0.7602, P-AUROC:0.9837, P-AP:0.1740, P-F1:0.2818, P-AUPRO:0.9257
pcb1: I-Auroc:0.9229, I-AP:0.9060, I-F1:0.8878, P-AUROC:0.9895, P-AP:0.7083, P-F1:0.6716, P-AUPRO:0.9008
pcb2: I-Auroc:0.9357, I-AP:0.9419, I-F1:0.8821, P-AUROC:0.9625, P-AP:0.5016, P-F1:0.5445, P-AUPRO:0.8403
pcb3: I-Auroc:0.9306, I-AP:0.9268, I-F1:0.8879, P-AUROC:0.9722, P-AP:0.5243, P-F1:0.5421, P-AUPRO:0.8768
pcb4: I-Auroc:0.9899, I-AP:0.9885, I-F1:0.9608, P-AUROC:0.9478, P-AP:0.3035, P-F1:0.3680, P-AUPRO:0.8136
pipe_fryum: I-Auroc:0.9780, I-AP:0.9893, I-F1:0.9552, P-AUROC:0.9871, P-AP:0.4830, P-F1:0.5673, P-AUPRO:0.9624
Mean: I-Auroc:0.9450, I-AP:0.9433, I-F1:0.9106, P-AUROC:0.9762, P-AP:0.4718, P-F1:0.5122, P-AUPRO:0.9125
cuda:4
shots: 4
candle: I-Auroc:0.9684, I-AP:0.9720, I-F1:0.9231, P-AUROC:0.9917, P-AP:0.4965, P-F1:0.5201, P-AUPRO:0.9429
capsules: I-Auroc:0.9787, I-AP:0.9882, I-F1:0.9495, P-AUROC:0.9872, P-AP:0.6414, P-F1:0.6374, P-AUPRO:0.9600
cashew: I-Auroc:0.9720, I-AP:0.9865, I-F1:0.9429, P-AUROC:0.9838, P-AP:0.5424, P-F1:0.5556, P-AUPRO:0.9608
chewinggum: I-Auroc:0.9956, I-AP:0.9979, I-F1:0.9802, P-AUROC:0.9936, P-AP:0.6718, P-F1:0.6841, P-AUPRO:0.9392
fryum: I-Auroc:0.9864, I-AP:0.9937, I-F1:0.9557, P-AUROC:0.9353, P-AP:0.3903, P-F1:0.4335, P-AUPRO:0.9060
macaroni1: I-Auroc:0.9883, I-AP:0.9878, I-F1:0.9561, P-AUROC:0.9947, P-AP:0.3510, P-F1:0.4349, P-AUPRO:0.9572
macaroni2: I-Auroc:0.8191, I-AP:0.7826, I-F1:0.7761, P-AUROC:0.9878, P-AP:0.2471, P-F1:0.3463, P-AUPRO:0.9408
pcb1: I-Auroc:0.9266, I-AP:0.9080, I-F1:0.8966, P-AUROC:0.9904, P-AP:0.7258, P-F1:0.6849, P-AUPRO:0.9082
pcb2: I-Auroc:0.9529, I-AP:0.9565, I-F1:0.9154, P-AUROC:0.9638, P-AP:0.5137, P-F1:0.5597, P-AUPRO:0.8501
pcb3: I-Auroc:0.9594, I-AP:0.9622, I-F1:0.9184, P-AUROC:0.9774, P-AP:0.5484, P-F1:0.5732, P-AUPRO:0.8979
pcb4: I-Auroc:0.9904, I-AP:0.9894, I-F1:0.9662, P-AUROC:0.9625, P-AP:0.3897, P-F1:0.4479, P-AUPRO:0.8714
pipe_fryum: I-Auroc:0.9906, I-AP:0.9959, I-F1:0.9749, P-AUROC:0.9874, P-AP:0.4832, P-F1:0.5801, P-AUPRO:0.9614
Mean: I-Auroc:0.9607, I-AP:0.9601, I-F1:0.9296, P-AUROC:0.9796, P-AP:0.5001, P-F1:0.5381, P-AUPRO:0.9246



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_small_14，结果如下：

cuda:4
shots: 1
candle: I-Auroc:0.9318, I-AP:0.9374, I-F1:0.8556, P-AUROC:0.9875, P-AP:0.4185, P-F1:0.4657, P-AUPRO:0.9278
capsules: I-Auroc:0.9645, I-AP:0.9807, I-F1:0.9388, P-AUROC:0.9625, P-AP:0.3602, P-F1:0.4611, P-AUPRO:0.9027
cashew: I-Auroc:0.9354, I-AP:0.9682, I-F1:0.9171, P-AUROC:0.9603, P-AP:0.4755, P-F1:0.4902, P-AUPRO:0.9416
chewinggum: I-Auroc:0.9742, I-AP:0.9894, I-F1:0.9592, P-AUROC:0.9879, P-AP:0.6200, P-F1:0.6876, P-AUPRO:0.8805
fryum: I-Auroc:0.9512, I-AP:0.9790, I-F1:0.9189, P-AUROC:0.9233, P-AP:0.3481, P-F1:0.3999, P-AUPRO:0.9091
macaroni1: I-Auroc:0.9179, I-AP:0.9275, I-F1:0.8440, P-AUROC:0.9899, P-AP:0.2922, P-F1:0.3739, P-AUPRO:0.9417
macaroni2: I-Auroc:0.6232, I-AP:0.5490, I-F1:0.7209, P-AUROC:0.9731, P-AP:0.0748, P-F1:0.1550, P-AUPRO:0.8964
pcb1: I-Auroc:0.8807, I-AP:0.8777, I-F1:0.8333, P-AUROC:0.9881, P-AP:0.6067, P-F1:0.6197, P-AUPRO:0.9040
pcb2: I-Auroc:0.9033, I-AP:0.9167, I-F1:0.8280, P-AUROC:0.9547, P-AP:0.4311, P-F1:0.4909, P-AUPRO:0.7994
pcb3: I-Auroc:0.9057, I-AP:0.9066, I-F1:0.8372, P-AUROC:0.9552, P-AP:0.4463, P-F1:0.4857, P-AUPRO:0.8552
pcb4: I-Auroc:0.9854, I-AP:0.9834, I-F1:0.9434, P-AUROC:0.9437, P-AP:0.2544, P-F1:0.3362, P-AUPRO:0.8264
pipe_fryum: I-Auroc:0.9864, I-AP:0.9931, I-F1:0.9648, P-AUROC:0.9867, P-AP:0.4930, P-F1:0.5772, P-AUPRO:0.9638
Mean: I-Auroc:0.9133, I-AP:0.9174, I-F1:0.8801, P-AUROC:0.9677, P-AP:0.4017, P-F1:0.4619, P-AUPRO:0.8957
cuda:4
shots: 2
candle: I-Auroc:0.9339, I-AP:0.9403, I-F1:0.8700, P-AUROC:0.9882, P-AP:0.4369, P-F1:0.4801, P-AUPRO:0.9255
capsules: I-Auroc:0.9668, I-AP:0.9821, I-F1:0.9394, P-AUROC:0.9723, P-AP:0.3926, P-F1:0.4796, P-AUPRO:0.9254
cashew: I-Auroc:0.9446, I-AP:0.9727, I-F1:0.9135, P-AUROC:0.9595, P-AP:0.4808, P-F1:0.4990, P-AUPRO:0.9452
chewinggum: I-Auroc:0.9800, I-AP:0.9913, I-F1:0.9600, P-AUROC:0.9875, P-AP:0.6178, P-F1:0.6900, P-AUPRO:0.8730
fryum: I-Auroc:0.9636, I-AP:0.9838, I-F1:0.9278, P-AUROC:0.9249, P-AP:0.3537, P-F1:0.4046, P-AUPRO:0.9052
macaroni1: I-Auroc:0.9548, I-AP:0.9589, I-F1:0.8824, P-AUROC:0.9911, P-AP:0.3319, P-F1:0.4033, P-AUPRO:0.9413
macaroni2: I-Auroc:0.6522, I-AP:0.5724, I-F1:0.7167, P-AUROC:0.9741, P-AP:0.0853, P-F1:0.1753, P-AUPRO:0.8919
pcb1: I-Auroc:0.8838, I-AP:0.8731, I-F1:0.8502, P-AUROC:0.9892, P-AP:0.6534, P-F1:0.6511, P-AUPRO:0.9104
pcb2: I-Auroc:0.9260, I-AP:0.9273, I-F1:0.8515, P-AUROC:0.9594, P-AP:0.4597, P-F1:0.5130, P-AUPRO:0.8222
pcb3: I-Auroc:0.8999, I-AP:0.9103, I-F1:0.8485, P-AUROC:0.9635, P-AP:0.4892, P-F1:0.5273, P-AUPRO:0.8468
pcb4: I-Auroc:0.9853, I-AP:0.9823, I-F1:0.9524, P-AUROC:0.9521, P-AP:0.2821, P-F1:0.3564, P-AUPRO:0.8435
pipe_fryum: I-Auroc:0.9914, I-AP:0.9956, I-F1:0.9700, P-AUROC:0.9877, P-AP:0.5049, P-F1:0.5920, P-AUPRO:0.9666
Mean: I-Auroc:0.9235, I-AP:0.9242, I-F1:0.8902, P-AUROC:0.9708, P-AP:0.4240, P-F1:0.4810, P-AUPRO:0.8997
cuda:4
shots: 4
candle: I-Auroc:0.9708, I-AP:0.9714, I-F1:0.9208, P-AUROC:0.9894, P-AP:0.4679, P-F1:0.5025, P-AUPRO:0.9314
capsules: I-Auroc:0.9545, I-AP:0.9763, I-F1:0.9278, P-AUROC:0.9813, P-AP:0.5110, P-F1:0.5342, P-AUPRO:0.9298
cashew: I-Auroc:0.9712, I-AP:0.9860, I-F1:0.9307, P-AUROC:0.9636, P-AP:0.5102, P-F1:0.5279, P-AUPRO:0.9490
chewinggum: I-Auroc:0.9856, I-AP:0.9935, I-F1:0.9697, P-AUROC:0.9878, P-AP:0.6276, P-F1:0.6811, P-AUPRO:0.8790
fryum: I-Auroc:0.9794, I-AP:0.9905, I-F1:0.9458, P-AUROC:0.9301, P-AP:0.3663, P-F1:0.4182, P-AUPRO:0.9067
macaroni1: I-Auroc:0.9763, I-AP:0.9770, I-F1:0.9327, P-AUROC:0.9930, P-AP:0.3581, P-F1:0.4271, P-AUPRO:0.9523
macaroni2: I-Auroc:0.6892, I-AP:0.5957, I-F1:0.7342, P-AUROC:0.9781, P-AP:0.1054, P-F1:0.1930, P-AUPRO:0.9080
pcb1: I-Auroc:0.9090, I-AP:0.8833, I-F1:0.8600, P-AUROC:0.9911, P-AP:0.6815, P-F1:0.6767, P-AUPRO:0.9210
pcb2: I-Auroc:0.9496, I-AP:0.9527, I-F1:0.8800, P-AUROC:0.9627, P-AP:0.4919, P-F1:0.5472, P-AUPRO:0.8409
pcb3: I-Auroc:0.9288, I-AP:0.9397, I-F1:0.8800, P-AUROC:0.9694, P-AP:0.5144, P-F1:0.5582, P-AUPRO:0.8878
pcb4: I-Auroc:0.9875, I-AP:0.9853, I-F1:0.9662, P-AUROC:0.9626, P-AP:0.3688, P-F1:0.4400, P-AUPRO:0.8858
pipe_fryum: I-Auroc:0.9950, I-AP:0.9977, I-F1:0.9796, P-AUROC:0.9876, P-AP:0.4997, P-F1:0.5969, P-AUPRO:0.9664
Mean: I-Auroc:0.9414, I-AP:0.9374, I-F1:0.9106, P-AUROC:0.9747, P-AP:0.4586, P-F1:0.5086, P-AUPRO:0.9132



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14    (R320-C280)

 cuda:4
shots: 1
candle: I-Auroc:0.9399, I-AP:0.9459, I-F1:0.8571, P-AUROC:0.9866, P-AP:0.3998, P-F1:0.4723, P-AUPRO:0.9095
capsules: I-Auroc:0.9493, I-AP:0.9689, I-F1:0.9278, P-AUROC:0.9746, P-AP:0.3847, P-F1:0.4595, P-AUPRO:0.9129
cashew: I-Auroc:0.9124, I-AP:0.9561, I-F1:0.9000, P-AUROC:0.9785, P-AP:0.5049, P-F1:0.5049, P-AUPRO:0.9408
chewinggum: I-Auroc:0.9780, I-AP:0.9908, I-F1:0.9637, P-AUROC:0.9910, P-AP:0.5786, P-F1:0.6594, P-AUPRO:0.9104
fryum: I-Auroc:0.9578, I-AP:0.9809, I-F1:0.9333, P-AUROC:0.9180, P-AP:0.3668, P-F1:0.4133, P-AUPRO:0.8654
macaroni1: I-Auroc:0.8535, I-AP:0.8662, I-F1:0.7778, P-AUROC:0.9860, P-AP:0.2383, P-F1:0.3294, P-AUPRO:0.9014
macaroni2: I-Auroc:0.6751, I-AP:0.5871, I-F1:0.7160, P-AUROC:0.9642, P-AP:0.0982, P-F1:0.1924, P-AUPRO:0.8876
pcb1: I-Auroc:0.8829, I-AP:0.8791, I-F1:0.8479, P-AUROC:0.9814, P-AP:0.6025, P-F1:0.5834, P-AUPRO:0.8316
pcb2: I-Auroc:0.8939, I-AP:0.9116, I-F1:0.8351, P-AUROC:0.9499, P-AP:0.4344, P-F1:0.4973, P-AUPRO:0.7418
pcb3: I-Auroc:0.9130, I-AP:0.9109, I-F1:0.8390, P-AUROC:0.9631, P-AP:0.3868, P-F1:0.4494, P-AUPRO:0.8157
pcb4: I-Auroc:0.9776, I-AP:0.9755, I-F1:0.9524, P-AUROC:0.9452, P-AP:0.2356, P-F1:0.3140, P-AUPRO:0.8025
pipe_fryum: I-Auroc:0.9770, I-AP:0.9896, I-F1:0.9655, P-AUROC:0.9854, P-AP:0.4813, P-F1:0.5494, P-AUPRO:0.9548
Mean: I-Auroc:0.9092, I-AP:0.9135, I-F1:0.8763, P-AUROC:0.9687, P-AP:0.3927, P-F1:0.4521, P-AUPRO:0.8729
cuda:4
shots: 2
candle: I-Auroc:0.9505, I-AP:0.9561, I-F1:0.8696, P-AUROC:0.9875, P-AP:0.4070, P-F1:0.4696, P-AUPRO:0.9137
capsules: I-Auroc:0.9572, I-AP:0.9726, I-F1:0.9314, P-AUROC:0.9791, P-AP:0.4266, P-F1:0.4843, P-AUPRO:0.9290
cashew: I-Auroc:0.9248, I-AP:0.9623, I-F1:0.9082, P-AUROC:0.9801, P-AP:0.5146, P-F1:0.5100, P-AUPRO:0.9493
chewinggum: I-Auroc:0.9888, I-AP:0.9949, I-F1:0.9596, P-AUROC:0.9911, P-AP:0.6114, P-F1:0.6609, P-AUPRO:0.9041
fryum: I-Auroc:0.9584, I-AP:0.9811, I-F1:0.9340, P-AUROC:0.9233, P-AP:0.3743, P-F1:0.4190, P-AUPRO:0.8681
macaroni1: I-Auroc:0.8935, I-AP:0.9014, I-F1:0.8241, P-AUROC:0.9875, P-AP:0.2580, P-F1:0.3459, P-AUPRO:0.9080
macaroni2: I-Auroc:0.6611, I-AP:0.5762, I-F1:0.7213, P-AUROC:0.9572, P-AP:0.0654, P-F1:0.1436, P-AUPRO:0.8460
pcb1: I-Auroc:0.8982, I-AP:0.8856, I-F1:0.8768, P-AUROC:0.9844, P-AP:0.6222, P-F1:0.5978, P-AUPRO:0.8503
pcb2: I-Auroc:0.9073, I-AP:0.9152, I-F1:0.8571, P-AUROC:0.9557, P-AP:0.4350, P-F1:0.5057, P-AUPRO:0.7576
pcb3: I-Auroc:0.9118, I-AP:0.9136, I-F1:0.8381, P-AUROC:0.9716, P-AP:0.4217, P-F1:0.4741, P-AUPRO:0.8496
pcb4: I-Auroc:0.9759, I-AP:0.9732, I-F1:0.9524, P-AUROC:0.9505, P-AP:0.2384, P-F1:0.3169, P-AUPRO:0.8119
pipe_fryum: I-Auroc:0.9856, I-AP:0.9934, I-F1:0.9751, P-AUROC:0.9865, P-AP:0.4883, P-F1:0.5586, P-AUPRO:0.9587
Mean: I-Auroc:0.9178, I-AP:0.9188, I-F1:0.8873, P-AUROC:0.9712, P-AP:0.4052, P-F1:0.4572, P-AUPRO:0.8789
cuda:4
shots: 4
candle: I-Auroc:0.9730, I-AP:0.9764, I-F1:0.9261, P-AUROC:0.9887, P-AP:0.4195, P-F1:0.4751, P-AUPRO:0.9147
capsules: I-Auroc:0.9388, I-AP:0.9641, I-F1:0.8945, P-AUROC:0.9841, P-AP:0.5356, P-F1:0.5571, P-AUPRO:0.9411
cashew: I-Auroc:0.9498, I-AP:0.9761, I-F1:0.9360, P-AUROC:0.9819, P-AP:0.5365, P-F1:0.5250, P-AUPRO:0.9528
chewinggum: I-Auroc:0.9922, I-AP:0.9965, I-F1:0.9754, P-AUROC:0.9913, P-AP:0.6410, P-F1:0.6723, P-AUPRO:0.9121
fryum: I-Auroc:0.9684, I-AP:0.9855, I-F1:0.9453, P-AUROC:0.9305, P-AP:0.3892, P-F1:0.4327, P-AUPRO:0.8748
macaroni1: I-Auroc:0.9579, I-AP:0.9554, I-F1:0.8945, P-AUROC:0.9902, P-AP:0.3013, P-F1:0.3821, P-AUPRO:0.9223
macaroni2: I-Auroc:0.7044, I-AP:0.6060, I-F1:0.7544, P-AUROC:0.9675, P-AP:0.0729, P-F1:0.1580, P-AUPRO:0.8795
pcb1: I-Auroc:0.9067, I-AP:0.8861, I-F1:0.8692, P-AUROC:0.9878, P-AP:0.6422, P-F1:0.6228, P-AUPRO:0.8730
pcb2: I-Auroc:0.9184, I-AP:0.9255, I-F1:0.8700, P-AUROC:0.9589, P-AP:0.4540, P-F1:0.5294, P-AUPRO:0.7779
pcb3: I-Auroc:0.9276, I-AP:0.9376, I-F1:0.8670, P-AUROC:0.9778, P-AP:0.4402, P-F1:0.5053, P-AUPRO:0.8723
pcb4: I-Auroc:0.9840, I-AP:0.9848, I-F1:0.9548, P-AUROC:0.9606, P-AP:0.3354, P-F1:0.4029, P-AUPRO:0.8374
pipe_fryum: I-Auroc:0.9892, I-AP:0.9955, I-F1:0.9749, P-AUROC:0.9868, P-AP:0.4844, P-F1:0.5688, P-AUPRO:0.9579
Mean: I-Auroc:0.9342, I-AP:0.9324, I-F1:0.9052, P-AUROC:0.9755, P-AP:0.4377, P-F1:0.4860, P-AUPRO:0.8930



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14    (R384-C336)

cuda:4
shots: 1
candle: I-Auroc:0.9319, I-AP:0.9387, I-F1:0.8585, P-AUROC:0.9882, P-AP:0.4273, P-F1:0.4867, P-AUPRO:0.9227
capsules: I-Auroc:0.9602, I-AP:0.9752, I-F1:0.9289, P-AUROC:0.9749, P-AP:0.4505, P-F1:0.5016, P-AUPRO:0.9363
cashew: I-Auroc:0.9306, I-AP:0.9630, I-F1:0.9216, P-AUROC:0.9772, P-AP:0.4741, P-F1:0.4858, P-AUPRO:0.9354
chewinggum: I-Auroc:0.9886, I-AP:0.9948, I-F1:0.9645, P-AUROC:0.9914, P-AP:0.6092, P-F1:0.6759, P-AUPRO:0.9108
fryum: I-Auroc:0.9482, I-AP:0.9772, I-F1:0.9110, P-AUROC:0.9218, P-AP:0.3608, P-F1:0.4004, P-AUPRO:0.8770
macaroni1: I-Auroc:0.9086, I-AP:0.9159, I-F1:0.8214, P-AUROC:0.9916, P-AP:0.2685, P-F1:0.3656, P-AUPRO:0.9285
macaroni2: I-Auroc:0.6856, I-AP:0.6008, I-F1:0.7287, P-AUROC:0.9772, P-AP:0.0872, P-F1:0.1647, P-AUPRO:0.9199
pcb1: I-Auroc:0.9008, I-AP:0.8938, I-F1:0.8654, P-AUROC:0.9876, P-AP:0.6306, P-F1:0.6007, P-AUPRO:0.8870
pcb2: I-Auroc:0.8923, I-AP:0.9147, I-F1:0.8261, P-AUROC:0.9560, P-AP:0.4418, P-F1:0.4829, P-AUPRO:0.8126
pcb3: I-Auroc:0.8773, I-AP:0.8682, I-F1:0.8295, P-AUROC:0.9630, P-AP:0.4180, P-F1:0.4606, P-AUPRO:0.8464
pcb4: I-Auroc:0.9842, I-AP:0.9823, I-F1:0.9524, P-AUROC:0.9448, P-AP:0.2624, P-F1:0.3341, P-AUPRO:0.8249
pipe_fryum: I-Auroc:0.9740, I-AP:0.9874, I-F1:0.9565, P-AUROC:0.9854, P-AP:0.4663, P-F1:0.5403, P-AUPRO:0.9612
Mean: I-Auroc:0.9152, I-AP:0.9177, I-F1:0.8804, P-AUROC:0.9716, P-AP:0.4081, P-F1:0.4583, P-AUPRO:0.8969
cuda:4
shots: 2
candle: I-Auroc:0.9461, I-AP:0.9528, I-F1:0.8878, P-AUROC:0.9895, P-AP:0.4447, P-F1:0.4980, P-AUPRO:0.9285
capsules: I-Auroc:0.9735, I-AP:0.9848, I-F1:0.9453, P-AUROC:0.9781, P-AP:0.4781, P-F1:0.5210, P-AUPRO:0.9509
cashew: I-Auroc:0.9468, I-AP:0.9702, I-F1:0.9245, P-AUROC:0.9783, P-AP:0.4919, P-F1:0.5013, P-AUPRO:0.9439
chewinggum: I-Auroc:0.9890, I-AP:0.9949, I-F1:0.9641, P-AUROC:0.9914, P-AP:0.6364, P-F1:0.6793, P-AUPRO:0.9002
fryum: I-Auroc:0.9560, I-AP:0.9801, I-F1:0.9261, P-AUROC:0.9254, P-AP:0.3689, P-F1:0.4081, P-AUPRO:0.8839
macaroni1: I-Auroc:0.9382, I-AP:0.9431, I-F1:0.8533, P-AUROC:0.9927, P-AP:0.2973, P-F1:0.3955, P-AUPRO:0.9222
macaroni2: I-Auroc:0.6925, I-AP:0.6086, I-F1:0.7489, P-AUROC:0.9776, P-AP:0.0975, P-F1:0.1722, P-AUPRO:0.9195
pcb1: I-Auroc:0.8968, I-AP:0.8804, I-F1:0.8696, P-AUROC:0.9887, P-AP:0.6403, P-F1:0.6178, P-AUPRO:0.8779
pcb2: I-Auroc:0.9043, I-AP:0.9192, I-F1:0.8687, P-AUROC:0.9597, P-AP:0.4660, P-F1:0.5088, P-AUPRO:0.8365
pcb3: I-Auroc:0.8901, I-AP:0.8926, I-F1:0.8378, P-AUROC:0.9696, P-AP:0.4660, P-F1:0.5046, P-AUPRO:0.8591
pcb4: I-Auroc:0.9850, I-AP:0.9821, I-F1:0.9615, P-AUROC:0.9499, P-AP:0.2680, P-F1:0.3412, P-AUPRO:0.8230
pipe_fryum: I-Auroc:0.9830, I-AP:0.9923, I-F1:0.9645, P-AUROC:0.9862, P-AP:0.4737, P-F1:0.5508, P-AUPRO:0.9646
Mean: I-Auroc:0.9251, I-AP:0.9251, I-F1:0.8960, P-AUROC:0.9739, P-AP:0.4274, P-F1:0.4749, P-AUPRO:0.9009
cuda:4
shots: 4
candle: I-Auroc:0.9666, I-AP:0.9698, I-F1:0.9137, P-AUROC:0.9911, P-AP:0.4603, P-F1:0.4987, P-AUPRO:0.9337
capsules: I-Auroc:0.9648, I-AP:0.9792, I-F1:0.9333, P-AUROC:0.9842, P-AP:0.5777, P-F1:0.5862, P-AUPRO:0.9492
cashew: I-Auroc:0.9558, I-AP:0.9767, I-F1:0.9327, P-AUROC:0.9792, P-AP:0.5104, P-F1:0.5189, P-AUPRO:0.9443
chewinggum: I-Auroc:0.9916, I-AP:0.9961, I-F1:0.9655, P-AUROC:0.9915, P-AP:0.6553, P-F1:0.6792, P-AUPRO:0.9079
fryum: I-Auroc:0.9682, I-AP:0.9857, I-F1:0.9406, P-AUROC:0.9360, P-AP:0.3956, P-F1:0.4309, P-AUPRO:0.9002
macaroni1: I-Auroc:0.9769, I-AP:0.9766, I-F1:0.9340, P-AUROC:0.9939, P-AP:0.3154, P-F1:0.4090, P-AUPRO:0.9333
macaroni2: I-Auroc:0.7239, I-AP:0.6435, I-F1:0.7541, P-AUROC:0.9836, P-AP:0.1277, P-F1:0.1957, P-AUPRO:0.9385
pcb1: I-Auroc:0.9132, I-AP:0.8858, I-F1:0.8725, P-AUROC:0.9899, P-AP:0.6770, P-F1:0.6535, P-AUPRO:0.8878
pcb2: I-Auroc:0.9289, I-AP:0.9381, I-F1:0.8824, P-AUROC:0.9618, P-AP:0.4966, P-F1:0.5443, P-AUPRO:0.8481
pcb3: I-Auroc:0.9373, I-AP:0.9465, I-F1:0.8737, P-AUROC:0.9756, P-AP:0.4967, P-F1:0.5392, P-AUPRO:0.8850
pcb4: I-Auroc:0.9899, I-AP:0.9894, I-F1:0.9659, P-AUROC:0.9622, P-AP:0.3587, P-F1:0.4261, P-AUPRO:0.8664
pipe_fryum: I-Auroc:0.9910, I-AP:0.9964, I-F1:0.9802, P-AUROC:0.9863, P-AP:0.4720, P-F1:0.5625, P-AUPRO:0.9637
Mean: I-Auroc:0.9423, I-AP:0.9403, I-F1:0.9124, P-AUROC:0.9779, P-AP:0.4620, P-F1:0.5037, P-AUPRO:0.9132



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14    (R512-C448)

cuda:4
shots: 1
candle: I-Auroc:0.9463, I-AP:0.9525, I-F1:0.8738, P-AUROC:0.9904, P-AP:0.4704, P-F1:0.5109, P-AUPRO:0.9499
capsules: I-Auroc:0.9847, I-AP:0.9911, I-F1:0.9588, P-AUROC:0.9802, P-AP:0.5010, P-F1:0.5374, P-AUPRO:0.9469
cashew: I-Auroc:0.9418, I-AP:0.9717, I-F1:0.9187, P-AUROC:0.9745, P-AP:0.4808, P-F1:0.4926, P-AUPRO:0.9471
chewinggum: I-Auroc:0.9892, I-AP:0.9949, I-F1:0.9694, P-AUROC:0.9931, P-AP:0.6367, P-F1:0.6846, P-AUPRO:0.9281
fryum: I-Auroc:0.9408, I-AP:0.9749, I-F1:0.9175, P-AUROC:0.9278, P-AP:0.3623, P-F1:0.3989, P-AUPRO:0.8962
macaroni1: I-Auroc:0.9143, I-AP:0.9179, I-F1:0.8400, P-AUROC:0.9941, P-AP:0.3216, P-F1:0.4186, P-AUPRO:0.9577
macaroni2: I-Auroc:0.7657, I-AP:0.6860, I-F1:0.7818, P-AUROC:0.9880, P-AP:0.2234, P-F1:0.2972, P-AUPRO:0.9588
pcb1: I-Auroc:0.9137, I-AP:0.9068, I-F1:0.8800, P-AUROC:0.9881, P-AP:0.6866, P-F1:0.6712, P-AUPRO:0.9130
pcb2: I-Auroc:0.9155, I-AP:0.9275, I-F1:0.8646, P-AUROC:0.9568, P-AP:0.4741, P-F1:0.5160, P-AUPRO:0.8604
pcb3: I-Auroc:0.9220, I-AP:0.9156, I-F1:0.8684, P-AUROC:0.9584, P-AP:0.4548, P-F1:0.4927, P-AUPRO:0.8776
pcb4: I-Auroc:0.9924, I-AP:0.9914, I-F1:0.9615, P-AUROC:0.9395, P-AP:0.2942, P-F1:0.3595, P-AUPRO:0.8291
pipe_fryum: I-Auroc:0.9680, I-AP:0.9845, I-F1:0.9469, P-AUROC:0.9854, P-AP:0.4586, P-F1:0.5387, P-AUPRO:0.9678
Mean: I-Auroc:0.9329, I-AP:0.9346, I-F1:0.8984, P-AUROC:0.9730, P-AP:0.4470, P-F1:0.4932, P-AUPRO:0.9194
cuda:4
shots: 2
candle: I-Auroc:0.9455, I-AP:0.9500, I-F1:0.8768, P-AUROC:0.9908, P-AP:0.4731, P-F1:0.5117, P-AUPRO:0.9438
capsules: I-Auroc:0.9860, I-AP:0.9915, I-F1:0.9534, P-AUROC:0.9815, P-AP:0.5171, P-F1:0.5500, P-AUPRO:0.9558
cashew: I-Auroc:0.9474, I-AP:0.9742, I-F1:0.9406, P-AUROC:0.9759, P-AP:0.4942, P-F1:0.5061, P-AUPRO:0.9518
chewinggum: I-Auroc:0.9890, I-AP:0.9947, I-F1:0.9694, P-AUROC:0.9933, P-AP:0.6346, P-F1:0.6846, P-AUPRO:0.9256
fryum: I-Auroc:0.9488, I-AP:0.9779, I-F1:0.9192, P-AUROC:0.9330, P-AP:0.3778, P-F1:0.4124, P-AUPRO:0.9031
macaroni1: I-Auroc:0.9506, I-AP:0.9507, I-F1:0.8858, P-AUROC:0.9960, P-AP:0.3277, P-F1:0.4146, P-AUPRO:0.9676
macaroni2: I-Auroc:0.7653, I-AP:0.6778, I-F1:0.7830, P-AUROC:0.9904, P-AP:0.1770, P-F1:0.2734, P-AUPRO:0.9621
pcb1: I-Auroc:0.9236, I-AP:0.9110, I-F1:0.8867, P-AUROC:0.9897, P-AP:0.7077, P-F1:0.6802, P-AUPRO:0.9192
pcb2: I-Auroc:0.9297, I-AP:0.9305, I-F1:0.8832, P-AUROC:0.9599, P-AP:0.5008, P-F1:0.5363, P-AUPRO:0.8825
pcb3: I-Auroc:0.9352, I-AP:0.9339, I-F1:0.8762, P-AUROC:0.9686, P-AP:0.5196, P-F1:0.5463, P-AUPRO:0.8953
pcb4: I-Auroc:0.9901, I-AP:0.9885, I-F1:0.9604, P-AUROC:0.9468, P-AP:0.3013, P-F1:0.3618, P-AUPRO:0.8444
pipe_fryum: I-Auroc:0.9764, I-AP:0.9884, I-F1:0.9608, P-AUROC:0.9862, P-AP:0.4644, P-F1:0.5464, P-AUPRO:0.9702
Mean: I-Auroc:0.9406, I-AP:0.9391, I-F1:0.9080, P-AUROC:0.9760, P-AP:0.4579, P-F1:0.5020, P-AUPRO:0.9268
cuda:4
shots: 4
candle: I-Auroc:0.9726, I-AP:0.9738, I-F1:0.9261, P-AUROC:0.9922, P-AP:0.4879, P-F1:0.5271, P-AUPRO:0.9488
capsules: I-Auroc:0.9878, I-AP:0.9924, I-F1:0.9648, P-AUROC:0.9863, P-AP:0.5896, P-F1:0.5918, P-AUPRO:0.9593
cashew: I-Auroc:0.9576, I-AP:0.9793, I-F1:0.9314, P-AUROC:0.9772, P-AP:0.5112, P-F1:0.5204, P-AUPRO:0.9514
chewinggum: I-Auroc:0.9926, I-AP:0.9965, I-F1:0.9746, P-AUROC:0.9927, P-AP:0.6438, P-F1:0.6775, P-AUPRO:0.9243
fryum: I-Auroc:0.9706, I-AP:0.9866, I-F1:0.9293, P-AUROC:0.9407, P-AP:0.4024, P-F1:0.4332, P-AUPRO:0.9112
macaroni1: I-Auroc:0.9878, I-AP:0.9868, I-F1:0.9524, P-AUROC:0.9966, P-AP:0.3363, P-F1:0.4214, P-AUPRO:0.9688
macaroni2: I-Auroc:0.8240, I-AP:0.7722, I-F1:0.8230, P-AUROC:0.9927, P-AP:0.2415, P-F1:0.3444, P-AUPRO:0.9686
pcb1: I-Auroc:0.9296, I-AP:0.9140, I-F1:0.8932, P-AUROC:0.9903, P-AP:0.7247, P-F1:0.6972, P-AUPRO:0.9261
pcb2: I-Auroc:0.9526, I-AP:0.9541, I-F1:0.9036, P-AUROC:0.9616, P-AP:0.5198, P-F1:0.5592, P-AUPRO:0.8840
pcb3: I-Auroc:0.9606, I-AP:0.9622, I-F1:0.8955, P-AUROC:0.9741, P-AP:0.5513, P-F1:0.5796, P-AUPRO:0.9156
pcb4: I-Auroc:0.9910, I-AP:0.9896, I-F1:0.9655, P-AUROC:0.9589, P-AP:0.3733, P-F1:0.4343, P-AUPRO:0.8837
pipe_fryum: I-Auroc:0.9820, I-AP:0.9914, I-F1:0.9754, P-AUROC:0.9869, P-AP:0.4729, P-F1:0.5693, P-AUPRO:0.9713
Mean: I-Auroc:0.9591, I-AP:0.9582, I-F1:0.9279, P-AUROC:0.9792, P-AP:0.4879, P-F1:0.5296, P-AUPRO:0.9344



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : deit_vit_base_16   (R512-C448)

cuda:4
shots: 1
candle: I-Auroc:0.9328, I-AP:0.9317, I-F1:0.8646, P-AUROC:0.9733, P-AP:0.2861, P-F1:0.3806, P-AUPRO:0.9037
capsules: I-Auroc:0.7900, I-AP:0.8830, I-F1:0.7944, P-AUROC:0.8912, P-AP:0.1215, P-F1:0.2143, P-AUPRO:0.7234
cashew: I-Auroc:0.9768, I-AP:0.9879, I-F1:0.9463, P-AUROC:0.9613, P-AP:0.6223, P-F1:0.6198, P-AUPRO:0.8209
chewinggum: I-Auroc:0.9686, I-AP:0.9870, I-F1:0.9534, P-AUROC:0.9901, P-AP:0.7661, P-F1:0.7462, P-AUPRO:0.8730
fryum: I-Auroc:0.9452, I-AP:0.9765, I-F1:0.9146, P-AUROC:0.9317, P-AP:0.3956, P-F1:0.4380, P-AUPRO:0.8791
macaroni1: I-Auroc:0.8876, I-AP:0.9021, I-F1:0.8141, P-AUROC:0.9837, P-AP:0.1967, P-F1:0.3188, P-AUPRO:0.9017
macaroni2: I-Auroc:0.5985, I-AP:0.5537, I-F1:0.6667, P-AUROC:0.9626, P-AP:0.0610, P-F1:0.1491, P-AUPRO:0.8590
pcb1: I-Auroc:0.6783, I-AP:0.7178, I-F1:0.6899, P-AUROC:0.9677, P-AP:0.5822, P-F1:0.5786, P-AUPRO:0.7625
pcb2: I-Auroc:0.8447, I-AP:0.8703, I-F1:0.7706, P-AUROC:0.9331, P-AP:0.2965, P-F1:0.3753, P-AUPRO:0.6988
pcb3: I-Auroc:0.8351, I-AP:0.8251, I-F1:0.8035, P-AUROC:0.9319, P-AP:0.2635, P-F1:0.3392, P-AUPRO:0.8268
pcb4: I-Auroc:0.9504, I-AP:0.9411, I-F1:0.8969, P-AUROC:0.9336, P-AP:0.1757, P-F1:0.2560, P-AUPRO:0.7544
pipe_fryum: I-Auroc:0.9532, I-AP:0.9749, I-F1:0.9406, P-AUROC:0.9946, P-AP:0.7430, P-F1:0.7520, P-AUPRO:0.9612
Mean: I-Auroc:0.8634, I-AP:0.8793, I-F1:0.8380, P-AUROC:0.9546, P-AP:0.3758, P-F1:0.4307, P-AUPRO:0.8304
cuda:4
shots: 2
candle: I-Auroc:0.9498, I-AP:0.9483, I-F1:0.8900, P-AUROC:0.9740, P-AP:0.3205, P-F1:0.4047, P-AUPRO:0.9107
capsules: I-Auroc:0.8647, I-AP:0.9245, I-F1:0.8372, P-AUROC:0.9066, P-AP:0.1583, P-F1:0.2707, P-AUPRO:0.7516
cashew: I-Auroc:0.9842, I-AP:0.9913, I-F1:0.9700, P-AUROC:0.9610, P-AP:0.6335, P-F1:0.6378, P-AUPRO:0.8349
chewinggum: I-Auroc:0.9874, I-AP:0.9942, I-F1:0.9604, P-AUROC:0.9894, P-AP:0.7213, P-F1:0.7316, P-AUPRO:0.8652
fryum: I-Auroc:0.9488, I-AP:0.9782, I-F1:0.9184, P-AUROC:0.9291, P-AP:0.3922, P-F1:0.4366, P-AUPRO:0.8763
macaroni1: I-Auroc:0.9108, I-AP:0.9269, I-F1:0.8416, P-AUROC:0.9861, P-AP:0.2535, P-F1:0.3778, P-AUPRO:0.9044
macaroni2: I-Auroc:0.6221, I-AP:0.5749, I-F1:0.6760, P-AUROC:0.9621, P-AP:0.0609, P-F1:0.1470, P-AUPRO:0.8526
pcb1: I-Auroc:0.7503, I-AP:0.7699, I-F1:0.7273, P-AUROC:0.9738, P-AP:0.6707, P-F1:0.6504, P-AUPRO:0.7867
pcb2: I-Auroc:0.8844, I-AP:0.9003, I-F1:0.8131, P-AUROC:0.9418, P-AP:0.3540, P-F1:0.4391, P-AUPRO:0.7453
pcb3: I-Auroc:0.7955, I-AP:0.8195, I-F1:0.7714, P-AUROC:0.9356, P-AP:0.2987, P-F1:0.3810, P-AUPRO:0.7938
pcb4: I-Auroc:0.9717, I-AP:0.9669, I-F1:0.9289, P-AUROC:0.9485, P-AP:0.2401, P-F1:0.3125, P-AUPRO:0.8099
pipe_fryum: I-Auroc:0.9516, I-AP:0.9740, I-F1:0.9372, P-AUROC:0.9946, P-AP:0.7400, P-F1:0.7513, P-AUPRO:0.9639
Mean: I-Auroc:0.8851, I-AP:0.8974, I-F1:0.8560, P-AUROC:0.9585, P-AP:0.4036, P-F1:0.4617, P-AUPRO:0.8413
cuda:4
shots: 4
candle: I-Auroc:0.9796, I-AP:0.9783, I-F1:0.9360, P-AUROC:0.9736, P-AP:0.3599, P-F1:0.4416, P-AUPRO:0.9136
capsules: I-Auroc:0.8727, I-AP:0.9255, I-F1:0.8411, P-AUROC:0.9276, P-AP:0.1948, P-F1:0.2985, P-AUPRO:0.7739
cashew: I-Auroc:0.9872, I-AP:0.9932, I-F1:0.9700, P-AUROC:0.9629, P-AP:0.6549, P-F1:0.6575, P-AUPRO:0.8472
chewinggum: I-Auroc:0.9872, I-AP:0.9943, I-F1:0.9648, P-AUROC:0.9882, P-AP:0.7145, P-F1:0.7310, P-AUPRO:0.8443
fryum: I-Auroc:0.9626, I-AP:0.9842, I-F1:0.9375, P-AUROC:0.9300, P-AP:0.4009, P-F1:0.4490, P-AUPRO:0.8799
macaroni1: I-Auroc:0.9456, I-AP:0.9556, I-F1:0.8780, P-AUROC:0.9902, P-AP:0.3072, P-F1:0.4194, P-AUPRO:0.9266
macaroni2: I-Auroc:0.6686, I-AP:0.6065, I-F1:0.6977, P-AUROC:0.9665, P-AP:0.0716, P-F1:0.1649, P-AUPRO:0.8563
pcb1: I-Auroc:0.8743, I-AP:0.8622, I-F1:0.7982, P-AUROC:0.9763, P-AP:0.7144, P-F1:0.6844, P-AUPRO:0.8077
pcb2: I-Auroc:0.9305, I-AP:0.9392, I-F1:0.8626, P-AUROC:0.9460, P-AP:0.4009, P-F1:0.4907, P-AUPRO:0.7666
pcb3: I-Auroc:0.8273, I-AP:0.8515, I-F1:0.7635, P-AUROC:0.9451, P-AP:0.3898, P-F1:0.4477, P-AUPRO:0.8352
pcb4: I-Auroc:0.9781, I-AP:0.9765, I-F1:0.9278, P-AUROC:0.9623, P-AP:0.3553, P-F1:0.4152, P-AUPRO:0.8705
pipe_fryum: I-Auroc:0.9706, I-AP:0.9859, I-F1:0.9561, P-AUROC:0.9936, P-AP:0.7289, P-F1:0.7513, P-AUPRO:0.9665
Mean: I-Auroc:0.9154, I-AP:0.9211, I-F1:0.8778, P-AUROC:0.9635, P-AP:0.4411, P-F1:0.4959, P-AUPRO:0.8574



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : deit_vit_base_16   (R256-C224)

cuda:4
shots: 1
candle: I-Auroc:0.9167, I-AP:0.9166, I-F1:0.8505, P-AUROC:0.9559, P-AP:0.2562, P-F1:0.3647, P-AUPRO:0.7780
capsules: I-Auroc:0.7215, I-AP:0.8297, I-F1:0.7869, P-AUROC:0.8760, P-AP:0.0974, P-F1:0.1749, P-AUPRO:0.4873
cashew: I-Auroc:0.8734, I-AP:0.9380, I-F1:0.8692, P-AUROC:0.9799, P-AP:0.6282, P-F1:0.6246, P-AUPRO:0.8747
chewinggum: I-Auroc:0.9768, I-AP:0.9907, I-F1:0.9645, P-AUROC:0.9836, P-AP:0.7117, P-F1:0.6865, P-AUPRO:0.8425
fryum: I-Auroc:0.8436, I-AP:0.9335, I-F1:0.8374, P-AUROC:0.9192, P-AP:0.3837, P-F1:0.4252, P-AUPRO:0.7430
macaroni1: I-Auroc:0.8562, I-AP:0.8859, I-F1:0.7907, P-AUROC:0.9366, P-AP:0.1262, P-F1:0.2390, P-AUPRO:0.7673
macaroni2: I-Auroc:0.6058, I-AP:0.5837, I-F1:0.6667, P-AUROC:0.8836, P-AP:0.0363, P-F1:0.1024, P-AUPRO:0.6727
pcb1: I-Auroc:0.5710, I-AP:0.6097, I-F1:0.6791, P-AUROC:0.9150, P-AP:0.3616, P-F1:0.3912, P-AUPRO:0.5284
pcb2: I-Auroc:0.7195, I-AP:0.7356, I-F1:0.7344, P-AUROC:0.9080, P-AP:0.1556, P-F1:0.2323, P-AUPRO:0.5594
pcb3: I-Auroc:0.7665, I-AP:0.7800, I-F1:0.7402, P-AUROC:0.9073, P-AP:0.1861, P-F1:0.2652, P-AUPRO:0.5623
pcb4: I-Auroc:0.9210, I-AP:0.9171, I-F1:0.8612, P-AUROC:0.9313, P-AP:0.2047, P-F1:0.2661, P-AUPRO:0.7386
pipe_fryum: I-Auroc:0.9834, I-AP:0.9928, I-F1:0.9700, P-AUROC:0.9927, P-AP:0.6841, P-F1:0.6953, P-AUPRO:0.9547
Mean: I-Auroc:0.8130, I-AP:0.8428, I-F1:0.8126, P-AUROC:0.9324, P-AP:0.3193, P-F1:0.3723, P-AUPRO:0.7091
cuda:4
shots: 2
candle: I-Auroc:0.9222, I-AP:0.9233, I-F1:0.8611, P-AUROC:0.9596, P-AP:0.2635, P-F1:0.3700, P-AUPRO:0.7934
capsules: I-Auroc:0.7920, I-AP:0.8807, I-F1:0.8070, P-AUROC:0.8930, P-AP:0.1272, P-F1:0.2141, P-AUPRO:0.5203
cashew: I-Auroc:0.9266, I-AP:0.9616, I-F1:0.9151, P-AUROC:0.9802, P-AP:0.6297, P-F1:0.6290, P-AUPRO:0.8849
chewinggum: I-Auroc:0.9810, I-AP:0.9917, I-F1:0.9637, P-AUROC:0.9807, P-AP:0.7099, P-F1:0.6836, P-AUPRO:0.8196
fryum: I-Auroc:0.8354, I-AP:0.9278, I-F1:0.8216, P-AUROC:0.9196, P-AP:0.3730, P-F1:0.4202, P-AUPRO:0.7258
macaroni1: I-Auroc:0.8242, I-AP:0.8505, I-F1:0.7556, P-AUROC:0.9367, P-AP:0.0921, P-F1:0.2046, P-AUPRO:0.7710
macaroni2: I-Auroc:0.6156, I-AP:0.5995, I-F1:0.6689, P-AUROC:0.8745, P-AP:0.0326, P-F1:0.0972, P-AUPRO:0.6607
pcb1: I-Auroc:0.6848, I-AP:0.7073, I-F1:0.6787, P-AUROC:0.9185, P-AP:0.4080, P-F1:0.4445, P-AUPRO:0.5737
pcb2: I-Auroc:0.7695, I-AP:0.7684, I-F1:0.7572, P-AUROC:0.9228, P-AP:0.1724, P-F1:0.2547, P-AUPRO:0.5730
pcb3: I-Auroc:0.8159, I-AP:0.8218, I-F1:0.7830, P-AUROC:0.9254, P-AP:0.2206, P-F1:0.2885, P-AUPRO:0.6359
pcb4: I-Auroc:0.9112, I-AP:0.9106, I-F1:0.8257, P-AUROC:0.9363, P-AP:0.2267, P-F1:0.2915, P-AUPRO:0.7506
pipe_fryum: I-Auroc:0.9800, I-AP:0.9914, I-F1:0.9652, P-AUROC:0.9923, P-AP:0.6686, P-F1:0.6858, P-AUPRO:0.9560
Mean: I-Auroc:0.8382, I-AP:0.8612, I-F1:0.8169, P-AUROC:0.9366, P-AP:0.3270, P-F1:0.3820, P-AUPRO:0.7221
cuda:4
shots: 4
candle: I-Auroc:0.9278, I-AP:0.9260, I-F1:0.8638, P-AUROC:0.9621, P-AP:0.2742, P-F1:0.3805, P-AUPRO:0.7970
capsules: I-Auroc:0.7858, I-AP:0.8736, I-F1:0.8075, P-AUROC:0.9141, P-AP:0.1696, P-F1:0.2557, P-AUPRO:0.5568
cashew: I-Auroc:0.9062, I-AP:0.9526, I-F1:0.8922, P-AUROC:0.9813, P-AP:0.6335, P-F1:0.6335, P-AUPRO:0.8794
chewinggum: I-Auroc:0.9866, I-AP:0.9937, I-F1:0.9583, P-AUROC:0.9812, P-AP:0.7108, P-F1:0.6892, P-AUPRO:0.8173
fryum: I-Auroc:0.8872, I-AP:0.9488, I-F1:0.8774, P-AUROC:0.9304, P-AP:0.4115, P-F1:0.4548, P-AUPRO:0.7444
macaroni1: I-Auroc:0.8735, I-AP:0.8863, I-F1:0.8019, P-AUROC:0.9410, P-AP:0.1047, P-F1:0.2207, P-AUPRO:0.7798
macaroni2: I-Auroc:0.6655, I-AP:0.6160, I-F1:0.6881, P-AUROC:0.8831, P-AP:0.0351, P-F1:0.1076, P-AUPRO:0.6692
pcb1: I-Auroc:0.7066, I-AP:0.7173, I-F1:0.6943, P-AUROC:0.9339, P-AP:0.4454, P-F1:0.4853, P-AUPRO:0.5706
pcb2: I-Auroc:0.8234, I-AP:0.8174, I-F1:0.7895, P-AUROC:0.9243, P-AP:0.1856, P-F1:0.2739, P-AUPRO:0.5909
pcb3: I-Auroc:0.8274, I-AP:0.8387, I-F1:0.7725, P-AUROC:0.9302, P-AP:0.2486, P-F1:0.3288, P-AUPRO:0.6519
pcb4: I-Auroc:0.8727, I-AP:0.8756, I-F1:0.8142, P-AUROC:0.9536, P-AP:0.2884, P-F1:0.3423, P-AUPRO:0.8028
pipe_fryum: I-Auroc:0.9802, I-AP:0.9915, I-F1:0.9645, P-AUROC:0.9909, P-AP:0.6468, P-F1:0.6732, P-AUPRO:0.9499
Mean: I-Auroc:0.8536, I-AP:0.8698, I-F1:0.8270, P-AUROC:0.9439, P-AP:0.3462, P-F1:0.4038, P-AUPRO:0.7342



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mae_vit_base_16   (R512-C448)

cuda:4
shots: 1
candle: I-Auroc:0.8448, I-AP:0.8388, I-F1:0.7962, P-AUROC:0.9398, P-AP:0.1033, P-F1:0.1937, P-AUPRO:0.8231
capsules: I-Auroc:0.6232, I-AP:0.7108, I-F1:0.7752, P-AUROC:0.9080, P-AP:0.0453, P-F1:0.1052, P-AUPRO:0.6822
cashew: I-Auroc:0.8846, I-AP:0.9333, I-F1:0.8858, P-AUROC:0.3718, P-AP:0.0292, P-F1:0.0710, P-AUPRO:0.2919
chewinggum: I-Auroc:0.8348, I-AP:0.9239, I-F1:0.8442, P-AUROC:0.8223, P-AP:0.3240, P-F1:0.3889, P-AUPRO:0.4665
fryum: I-Auroc:0.7216, I-AP:0.8710, I-F1:0.8099, P-AUROC:0.8796, P-AP:0.2115, P-F1:0.2727, P-AUPRO:0.7624
macaroni1: I-Auroc:0.6253, I-AP:0.6243, I-F1:0.6803, P-AUROC:0.9599, P-AP:0.0423, P-F1:0.1015, P-AUPRO:0.8092
macaroni2: I-Auroc:0.5671, I-AP:0.5671, I-F1:0.6712, P-AUROC:0.9519, P-AP:0.0156, P-F1:0.0500, P-AUPRO:0.8038
pcb1: I-Auroc:0.4731, I-AP:0.4713, I-F1:0.6691, P-AUROC:0.8281, P-AP:0.0297, P-F1:0.0671, P-AUPRO:0.5909
pcb2: I-Auroc:0.5963, I-AP:0.5601, I-F1:0.6950, P-AUROC:0.9064, P-AP:0.0724, P-F1:0.1258, P-AUPRO:0.6671
pcb3: I-Auroc:0.5768, I-AP:0.5649, I-F1:0.6815, P-AUROC:0.8931, P-AP:0.0342, P-F1:0.0829, P-AUPRO:0.7428
pcb4: I-Auroc:0.8251, I-AP:0.8277, I-F1:0.7847, P-AUROC:0.8378, P-AP:0.0374, P-F1:0.0658, P-AUPRO:0.4838
pipe_fryum: I-Auroc:0.8648, I-AP:0.9204, I-F1:0.8848, P-AUROC:0.9779, P-AP:0.4766, P-F1:0.4801, P-AUPRO:0.9316
Mean: I-Auroc:0.7031, I-AP:0.7345, I-F1:0.7648, P-AUROC:0.8564, P-AP:0.1185, P-F1:0.1671, P-AUPRO:0.6713
cuda:4
shots: 2
candle: I-Auroc:0.9050, I-AP:0.9144, I-F1:0.8436, P-AUROC:0.9493, P-AP:0.2069, P-F1:0.2943, P-AUPRO:0.8682
capsules: I-Auroc:0.7032, I-AP:0.7595, I-F1:0.7984, P-AUROC:0.9235, P-AP:0.0805, P-F1:0.1589, P-AUPRO:0.7132
cashew: I-Auroc:0.9060, I-AP:0.9488, I-F1:0.8919, P-AUROC:0.3751, P-AP:0.0318, P-F1:0.0715, P-AUPRO:0.2956
chewinggum: I-Auroc:0.8724, I-AP:0.9445, I-F1:0.8478, P-AUROC:0.8210, P-AP:0.3680, P-F1:0.4338, P-AUPRO:0.4673
fryum: I-Auroc:0.7116, I-AP:0.8635, I-F1:0.8235, P-AUROC:0.8862, P-AP:0.2228, P-F1:0.2815, P-AUPRO:0.7732
macaroni1: I-Auroc:0.6408, I-AP:0.6498, I-F1:0.7004, P-AUROC:0.9641, P-AP:0.0569, P-F1:0.1176, P-AUPRO:0.8062
macaroni2: I-Auroc:0.6335, I-AP:0.6176, I-F1:0.6835, P-AUROC:0.9570, P-AP:0.0217, P-F1:0.0709, P-AUPRO:0.8101
pcb1: I-Auroc:0.5245, I-AP:0.5085, I-F1:0.6901, P-AUROC:0.8553, P-AP:0.0489, P-F1:0.0992, P-AUPRO:0.6480
pcb2: I-Auroc:0.7130, I-AP:0.7060, I-F1:0.7160, P-AUROC:0.9255, P-AP:0.1711, P-F1:0.2476, P-AUPRO:0.7349
pcb3: I-Auroc:0.5585, I-AP:0.5927, I-F1:0.6645, P-AUROC:0.8973, P-AP:0.0439, P-F1:0.1044, P-AUPRO:0.7243
pcb4: I-Auroc:0.8012, I-AP:0.7889, I-F1:0.7680, P-AUROC:0.8658, P-AP:0.0509, P-F1:0.0885, P-AUPRO:0.5507
pipe_fryum: I-Auroc:0.8782, I-AP:0.9320, I-F1:0.8839, P-AUROC:0.9783, P-AP:0.4782, P-F1:0.4837, P-AUPRO:0.9332
Mean: I-Auroc:0.7373, I-AP:0.7688, I-F1:0.7760, P-AUROC:0.8665, P-AP:0.1485, P-F1:0.2043, P-AUPRO:0.6937
cuda:4
shots: 4
candle: I-Auroc:0.9111, I-AP:0.9168, I-F1:0.8276, P-AUROC:0.9515, P-AP:0.2231, P-F1:0.3106, P-AUPRO:0.8697
capsules: I-Auroc:0.6808, I-AP:0.7640, I-F1:0.7874, P-AUROC:0.9399, P-AP:0.1113, P-F1:0.1978, P-AUPRO:0.7350
cashew: I-Auroc:0.9336, I-AP:0.9635, I-F1:0.9091, P-AUROC:0.3745, P-AP:0.0327, P-F1:0.0715, P-AUPRO:0.3074
chewinggum: I-Auroc:0.8928, I-AP:0.9507, I-F1:0.8705, P-AUROC:0.8222, P-AP:0.4120, P-F1:0.4779, P-AUPRO:0.4266
fryum: I-Auroc:0.8192, I-AP:0.9171, I-F1:0.8220, P-AUROC:0.8950, P-AP:0.2739, P-F1:0.3269, P-AUPRO:0.8072
macaroni1: I-Auroc:0.6793, I-AP:0.6728, I-F1:0.7064, P-AUROC:0.9726, P-AP:0.1029, P-F1:0.1784, P-AUPRO:0.8425
macaroni2: I-Auroc:0.7020, I-AP:0.6677, I-F1:0.7179, P-AUROC:0.9645, P-AP:0.0291, P-F1:0.0917, P-AUPRO:0.8415
pcb1: I-Auroc:0.6564, I-AP:0.6419, I-F1:0.7025, P-AUROC:0.8649, P-AP:0.0847, P-F1:0.1500, P-AUPRO:0.6700
pcb2: I-Auroc:0.7991, I-AP:0.7984, I-F1:0.7611, P-AUROC:0.9334, P-AP:0.2488, P-F1:0.3166, P-AUPRO:0.7685
pcb3: I-Auroc:0.6445, I-AP:0.6427, I-F1:0.6783, P-AUROC:0.9057, P-AP:0.1047, P-F1:0.1829, P-AUPRO:0.7681
pcb4: I-Auroc:0.7919, I-AP:0.7358, I-F1:0.7967, P-AUROC:0.8855, P-AP:0.0634, P-F1:0.1092, P-AUPRO:0.6100
pipe_fryum: I-Auroc:0.9332, I-AP:0.9637, I-F1:0.9223, P-AUROC:0.9824, P-AP:0.5511, P-F1:0.5516, P-AUPRO:0.9462
Mean: I-Auroc:0.7870, I-AP:0.8029, I-F1:0.7918, P-AUROC:0.8743, P-AP:0.1865, P-F1:0.2471, P-AUPRO:0.7161



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mae_vit_base_16   (R256-C224)

cuda:3
shots: 1
candle: I-Auroc:0.7625, I-AP:0.7524, I-F1:0.7500, P-AUROC:0.9019, P-AP:0.0205, P-F1:0.0494, P-AUPRO:0.5841
capsules: I-Auroc:0.5227, I-AP:0.6799, I-F1:0.7692, P-AUROC:0.8307, P-AP:0.0319, P-F1:0.0791, P-AUPRO:0.4743
cashew: I-Auroc:0.6836, I-AP:0.8056, I-F1:0.8167, P-AUROC:0.6070, P-AP:0.0969, P-F1:0.1883, P-AUPRO:0.2682
chewinggum: I-Auroc:0.7574, I-AP:0.8694, I-F1:0.8261, P-AUROC:0.8039, P-AP:0.2356, P-F1:0.3119, P-AUPRO:0.4617
fryum: I-Auroc:0.6988, I-AP:0.8479, I-F1:0.8115, P-AUROC:0.9060, P-AP:0.2304, P-F1:0.2832, P-AUPRO:0.6654
macaroni1: I-Auroc:0.6485, I-AP:0.6328, I-F1:0.6886, P-AUROC:0.8706, P-AP:0.0064, P-F1:0.0229, P-AUPRO:0.5579
macaroni2: I-Auroc:0.5048, I-AP:0.4853, I-F1:0.6828, P-AUROC:0.8750, P-AP:0.0052, P-F1:0.0161, P-AUPRO:0.5782
pcb1: I-Auroc:0.5649, I-AP:0.5602, I-F1:0.6691, P-AUROC:0.8879, P-AP:0.0455, P-F1:0.1060, P-AUPRO:0.4974
pcb2: I-Auroc:0.5380, I-AP:0.5313, I-F1:0.6972, P-AUROC:0.8775, P-AP:0.0304, P-F1:0.0752, P-AUPRO:0.5113
pcb3: I-Auroc:0.6409, I-AP:0.6094, I-F1:0.6877, P-AUROC:0.8959, P-AP:0.0590, P-F1:0.1024, P-AUPRO:0.6417
pcb4: I-Auroc:0.7570, I-AP:0.7498, I-F1:0.7404, P-AUROC:0.8214, P-AP:0.0373, P-F1:0.0659, P-AUPRO:0.5184
pipe_fryum: I-Auroc:0.6936, I-AP:0.8201, I-F1:0.8299, P-AUROC:0.9741, P-AP:0.4454, P-F1:0.4277, P-AUPRO:0.8653
Mean: I-Auroc:0.6477, I-AP:0.6953, I-F1:0.7474, P-AUROC:0.8543, P-AP:0.1037, P-F1:0.1440, P-AUPRO:0.5520
cuda:3
shots: 2
candle: I-Auroc:0.7972, I-AP:0.8110, I-F1:0.7570, P-AUROC:0.9266, P-AP:0.0589, P-F1:0.1317, P-AUPRO:0.6777
capsules: I-Auroc:0.5590, I-AP:0.6968, I-F1:0.7722, P-AUROC:0.8618, P-AP:0.0508, P-F1:0.1148, P-AUPRO:0.4988
cashew: I-Auroc:0.8198, I-AP:0.9010, I-F1:0.8610, P-AUROC:0.6078, P-AP:0.1443, P-F1:0.2384, P-AUPRO:0.2674
chewinggum: I-Auroc:0.7472, I-AP:0.8557, I-F1:0.8349, P-AUROC:0.7909, P-AP:0.2212, P-F1:0.3144, P-AUPRO:0.3891
fryum: I-Auroc:0.7164, I-AP:0.8570, I-F1:0.8115, P-AUROC:0.9089, P-AP:0.2379, P-F1:0.2899, P-AUPRO:0.6719
macaroni1: I-Auroc:0.6203, I-AP:0.5893, I-F1:0.6885, P-AUROC:0.8793, P-AP:0.0067, P-F1:0.0217, P-AUPRO:0.5878
macaroni2: I-Auroc:0.5079, I-AP:0.4903, I-F1:0.6734, P-AUROC:0.8764, P-AP:0.0049, P-F1:0.0149, P-AUPRO:0.5930
pcb1: I-Auroc:0.5560, I-AP:0.5605, I-F1:0.6714, P-AUROC:0.8830, P-AP:0.0564, P-F1:0.1283, P-AUPRO:0.5303
pcb2: I-Auroc:0.6040, I-AP:0.5741, I-F1:0.7059, P-AUROC:0.9005, P-AP:0.0562, P-F1:0.1234, P-AUPRO:0.6080
pcb3: I-Auroc:0.6884, I-AP:0.6649, I-F1:0.6877, P-AUROC:0.9025, P-AP:0.0676, P-F1:0.1263, P-AUPRO:0.6879
pcb4: I-Auroc:0.7625, I-AP:0.7344, I-F1:0.7359, P-AUROC:0.8331, P-AP:0.0394, P-F1:0.0729, P-AUPRO:0.5360
pipe_fryum: I-Auroc:0.7500, I-AP:0.8590, I-F1:0.8511, P-AUROC:0.9809, P-AP:0.5531, P-F1:0.5259, P-AUPRO:0.8972
Mean: I-Auroc:0.6774, I-AP:0.7162, I-F1:0.7542, P-AUROC:0.8626, P-AP:0.1248, P-F1:0.1752, P-AUPRO:0.5788
cuda:3
shots: 4
candle: I-Auroc:0.8278, I-AP:0.8334, I-F1:0.7793, P-AUROC:0.9389, P-AP:0.1063, P-F1:0.1798, P-AUPRO:0.7160
capsules: I-Auroc:0.5908, I-AP:0.7171, I-F1:0.7843, P-AUROC:0.8934, P-AP:0.0917, P-F1:0.1637, P-AUPRO:0.5568
cashew: I-Auroc:0.8556, I-AP:0.9232, I-F1:0.8727, P-AUROC:0.6124, P-AP:0.1577, P-F1:0.2534, P-AUPRO:0.2758
chewinggum: I-Auroc:0.8066, I-AP:0.8997, I-F1:0.8341, P-AUROC:0.7995, P-AP:0.3039, P-F1:0.3709, P-AUPRO:0.3658
fryum: I-Auroc:0.7950, I-AP:0.9026, I-F1:0.8152, P-AUROC:0.9238, P-AP:0.3151, P-F1:0.3632, P-AUPRO:0.7127
macaroni1: I-Auroc:0.6276, I-AP:0.5977, I-F1:0.6891, P-AUROC:0.8918, P-AP:0.0097, P-F1:0.0336, P-AUPRO:0.6201
macaroni2: I-Auroc:0.5413, I-AP:0.5175, I-F1:0.6667, P-AUROC:0.8889, P-AP:0.0058, P-F1:0.0191, P-AUPRO:0.6200
pcb1: I-Auroc:0.6766, I-AP:0.6686, I-F1:0.6866, P-AUROC:0.9371, P-AP:0.3191, P-F1:0.3707, P-AUPRO:0.6787
pcb2: I-Auroc:0.6263, I-AP:0.5657, I-F1:0.7245, P-AUROC:0.9129, P-AP:0.0600, P-F1:0.1209, P-AUPRO:0.6315
pcb3: I-Auroc:0.7248, I-AP:0.6988, I-F1:0.7347, P-AUROC:0.9097, P-AP:0.0719, P-F1:0.1396, P-AUPRO:0.7121
pcb4: I-Auroc:0.7599, I-AP:0.6997, I-F1:0.7635, P-AUROC:0.8711, P-AP:0.0495, P-F1:0.0939, P-AUPRO:0.6214
pipe_fryum: I-Auroc:0.9318, I-AP:0.9626, I-F1:0.9208, P-AUROC:0.9878, P-AP:0.6482, P-F1:0.6524, P-AUPRO:0.9295
Mean: I-Auroc:0.7303, I-AP:0.7489, I-F1:0.7726, P-AUROC:0.8806, P-AP:0.1782, P-F1:0.2301, P-AUPRO:0.6200



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : digpt_vit_base_16   (R512-C448)

cuda:3
shots: 1
candle: I-Auroc:0.9701, I-AP:0.9688, I-F1:0.9254, P-AUROC:0.9772, P-AP:0.2155, P-F1:0.3282, P-AUPRO:0.9328
capsules: I-Auroc:0.8942, I-AP:0.9409, I-F1:0.8768, P-AUROC:0.9232, P-AP:0.1777, P-F1:0.2879, P-AUPRO:0.8246
cashew: I-Auroc:0.9604, I-AP:0.9822, I-F1:0.9275, P-AUROC:0.9786, P-AP:0.5824, P-F1:0.5876, P-AUPRO:0.9007
chewinggum: I-Auroc:0.9836, I-AP:0.9933, I-F1:0.9749, P-AUROC:0.9895, P-AP:0.7079, P-F1:0.6667, P-AUPRO:0.8809
fryum: I-Auroc:0.9378, I-AP:0.9741, I-F1:0.9128, P-AUROC:0.9283, P-AP:0.3378, P-F1:0.3948, P-AUPRO:0.8780
macaroni1: I-Auroc:0.8156, I-AP:0.7878, I-F1:0.7788, P-AUROC:0.9802, P-AP:0.0926, P-F1:0.1905, P-AUPRO:0.8961
macaroni2: I-Auroc:0.5837, I-AP:0.5931, I-F1:0.6667, P-AUROC:0.9516, P-AP:0.0498, P-F1:0.1148, P-AUPRO:0.8272
pcb1: I-Auroc:0.7599, I-AP:0.7850, I-F1:0.7317, P-AUROC:0.9824, P-AP:0.6296, P-F1:0.6291, P-AUPRO:0.8163
pcb2: I-Auroc:0.8154, I-AP:0.8453, I-F1:0.7477, P-AUROC:0.9385, P-AP:0.2911, P-F1:0.3716, P-AUPRO:0.7146
pcb3: I-Auroc:0.8986, I-AP:0.8921, I-F1:0.8402, P-AUROC:0.9491, P-AP:0.3041, P-F1:0.3679, P-AUPRO:0.8586
pcb4: I-Auroc:0.9496, I-AP:0.9149, I-F1:0.9423, P-AUROC:0.8999, P-AP:0.0876, P-F1:0.1771, P-AUPRO:0.6734
pipe_fryum: I-Auroc:0.9734, I-AP:0.9860, I-F1:0.9652, P-AUROC:0.9916, P-AP:0.6167, P-F1:0.6643, P-AUPRO:0.9637
Mean: I-Auroc:0.8785, I-AP:0.8886, I-F1:0.8575, P-AUROC:0.9575, P-AP:0.3411, P-F1:0.3984, P-AUPRO:0.8472
cuda:3
shots: 2
candle: I-Auroc:0.9720, I-AP:0.9707, I-F1:0.9223, P-AUROC:0.9785, P-AP:0.2250, P-F1:0.3359, P-AUPRO:0.9392
capsules: I-Auroc:0.9448, I-AP:0.9688, I-F1:0.9175, P-AUROC:0.9285, P-AP:0.2135, P-F1:0.3414, P-AUPRO:0.8550
cashew: I-Auroc:0.9754, I-AP:0.9879, I-F1:0.9423, P-AUROC:0.9814, P-AP:0.6045, P-F1:0.6004, P-AUPRO:0.9084
chewinggum: I-Auroc:0.9864, I-AP:0.9946, I-F1:0.9746, P-AUROC:0.9900, P-AP:0.6702, P-F1:0.6527, P-AUPRO:0.8803
fryum: I-Auroc:0.9344, I-AP:0.9724, I-F1:0.9206, P-AUROC:0.9303, P-AP:0.3460, P-F1:0.4060, P-AUPRO:0.8868
macaroni1: I-Auroc:0.8956, I-AP:0.8972, I-F1:0.8372, P-AUROC:0.9828, P-AP:0.1491, P-F1:0.2673, P-AUPRO:0.8976
macaroni2: I-Auroc:0.6110, I-AP:0.6042, I-F1:0.6667, P-AUROC:0.9558, P-AP:0.0638, P-F1:0.1244, P-AUPRO:0.8285
pcb1: I-Auroc:0.8164, I-AP:0.8356, I-F1:0.7592, P-AUROC:0.9844, P-AP:0.6580, P-F1:0.6498, P-AUPRO:0.8424
pcb2: I-Auroc:0.8677, I-AP:0.8814, I-F1:0.7984, P-AUROC:0.9541, P-AP:0.3995, P-F1:0.4764, P-AUPRO:0.7956
pcb3: I-Auroc:0.9150, I-AP:0.9154, I-F1:0.8557, P-AUROC:0.9530, P-AP:0.3907, P-F1:0.4540, P-AUPRO:0.8512
pcb4: I-Auroc:0.9504, I-AP:0.9316, I-F1:0.9217, P-AUROC:0.9151, P-AP:0.1097, P-F1:0.2084, P-AUPRO:0.6976
pipe_fryum: I-Auroc:0.9774, I-AP:0.9880, I-F1:0.9655, P-AUROC:0.9917, P-AP:0.6214, P-F1:0.6696, P-AUPRO:0.9654
Mean: I-Auroc:0.9039, I-AP:0.9123, I-F1:0.8735, P-AUROC:0.9621, P-AP:0.3710, P-F1:0.4322, P-AUPRO:0.8623
cuda:3
shots: 4
candle: I-Auroc:0.9862, I-AP:0.9864, I-F1:0.9500, P-AUROC:0.9774, P-AP:0.2385, P-F1:0.3497, P-AUPRO:0.9407
capsules: I-Auroc:0.8967, I-AP:0.9416, I-F1:0.8498, P-AUROC:0.9406, P-AP:0.2776, P-F1:0.3749, P-AUPRO:0.8502
cashew: I-Auroc:0.9800, I-AP:0.9898, I-F1:0.9515, P-AUROC:0.9830, P-AP:0.6251, P-F1:0.6172, P-AUPRO:0.9141
chewinggum: I-Auroc:0.9880, I-AP:0.9953, I-F1:0.9798, P-AUROC:0.9897, P-AP:0.6493, P-F1:0.6498, P-AUPRO:0.8767
fryum: I-Auroc:0.9574, I-AP:0.9819, I-F1:0.9333, P-AUROC:0.9384, P-AP:0.3787, P-F1:0.4477, P-AUPRO:0.8981
macaroni1: I-Auroc:0.9173, I-AP:0.9175, I-F1:0.8571, P-AUROC:0.9876, P-AP:0.1870, P-F1:0.3114, P-AUPRO:0.9176
macaroni2: I-Auroc:0.6481, I-AP:0.6151, I-F1:0.6780, P-AUROC:0.9578, P-AP:0.0671, P-F1:0.1405, P-AUPRO:0.8408
pcb1: I-Auroc:0.9043, I-AP:0.9143, I-F1:0.8381, P-AUROC:0.9881, P-AP:0.7222, P-F1:0.6930, P-AUPRO:0.8705
pcb2: I-Auroc:0.9280, I-AP:0.9346, I-F1:0.8585, P-AUROC:0.9571, P-AP:0.4370, P-F1:0.5111, P-AUPRO:0.8133
pcb3: I-Auroc:0.9329, I-AP:0.9393, I-F1:0.8614, P-AUROC:0.9609, P-AP:0.4345, P-F1:0.4979, P-AUPRO:0.8831
pcb4: I-Auroc:0.8947, I-AP:0.8786, I-F1:0.8444, P-AUROC:0.9368, P-AP:0.2078, P-F1:0.2909, P-AUPRO:0.7868
pipe_fryum: I-Auroc:0.9926, I-AP:0.9964, I-F1:0.9703, P-AUROC:0.9916, P-AP:0.6231, P-F1:0.6768, P-AUPRO:0.9657
Mean: I-Auroc:0.9188, I-AP:0.9242, I-F1:0.8810, P-AUROC:0.9674, P-AP:0.4040, P-F1:0.4634, P-AUPRO:0.8798



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : digpt_vit_base_16   (R256-C224)

cuda:4
shots: 1
candle: I-Auroc:0.9417, I-AP:0.9312, I-F1:0.9036, P-AUROC:0.9659, P-AP:0.2229, P-F1:0.3317, P-AUPRO:0.8588
capsules: I-Auroc:0.8123, I-AP:0.8950, I-F1:0.8133, P-AUROC:0.9094, P-AP:0.2204, P-F1:0.3480, P-AUPRO:0.7181
cashew: I-Auroc:0.9492, I-AP:0.9753, I-F1:0.9154, P-AUROC:0.9849, P-AP:0.5266, P-F1:0.5770, P-AUPRO:0.9162
chewinggum: I-Auroc:0.9682, I-AP:0.9869, I-F1:0.9596, P-AUROC:0.9824, P-AP:0.6119, P-F1:0.6260, P-AUPRO:0.8447
fryum: I-Auroc:0.8882, I-AP:0.9513, I-F1:0.8571, P-AUROC:0.9288, P-AP:0.3540, P-F1:0.4176, P-AUPRO:0.7790
macaroni1: I-Auroc:0.8463, I-AP:0.8579, I-F1:0.7876, P-AUROC:0.9366, P-AP:0.0703, P-F1:0.1713, P-AUPRO:0.7809
macaroni2: I-Auroc:0.6590, I-AP:0.6915, I-F1:0.6879, P-AUROC:0.9125, P-AP:0.0362, P-F1:0.1170, P-AUPRO:0.7543
pcb1: I-Auroc:0.8529, I-AP:0.8450, I-F1:0.7944, P-AUROC:0.9741, P-AP:0.5645, P-F1:0.5549, P-AUPRO:0.7636
pcb2: I-Auroc:0.7611, I-AP:0.7959, I-F1:0.7137, P-AUROC:0.9306, P-AP:0.2259, P-F1:0.3402, P-AUPRO:0.6277
pcb3: I-Auroc:0.8086, I-AP:0.8365, I-F1:0.7343, P-AUROC:0.9472, P-AP:0.3031, P-F1:0.3968, P-AUPRO:0.6981
pcb4: I-Auroc:0.9369, I-AP:0.9078, I-F1:0.8879, P-AUROC:0.8999, P-AP:0.0910, P-F1:0.1804, P-AUPRO:0.6866
pipe_fryum: I-Auroc:0.9940, I-AP:0.9972, I-F1:0.9800, P-AUROC:0.9884, P-AP:0.5168, P-F1:0.6072, P-AUPRO:0.9544
Mean: I-Auroc:0.8682, I-AP:0.8893, I-F1:0.8362, P-AUROC:0.9467, P-AP:0.3120, P-F1:0.3890, P-AUPRO:0.7819
cuda:4
shots: 2
candle: I-Auroc:0.9509, I-AP:0.9459, I-F1:0.9091, P-AUROC:0.9673, P-AP:0.2390, P-F1:0.3522, P-AUPRO:0.8641
capsules: I-Auroc:0.8393, I-AP:0.9082, I-F1:0.8219, P-AUROC:0.9200, P-AP:0.2441, P-F1:0.3687, P-AUPRO:0.7129
cashew: I-Auroc:0.9558, I-AP:0.9789, I-F1:0.9327, P-AUROC:0.9874, P-AP:0.5414, P-F1:0.5943, P-AUPRO:0.9180
chewinggum: I-Auroc:0.9756, I-AP:0.9902, I-F1:0.9645, P-AUROC:0.9792, P-AP:0.6196, P-F1:0.6370, P-AUPRO:0.8132
fryum: I-Auroc:0.8792, I-AP:0.9471, I-F1:0.8478, P-AUROC:0.9295, P-AP:0.3525, P-F1:0.4105, P-AUPRO:0.7691
macaroni1: I-Auroc:0.8439, I-AP:0.8439, I-F1:0.7941, P-AUROC:0.9400, P-AP:0.0628, P-F1:0.1593, P-AUPRO:0.7960
macaroni2: I-Auroc:0.6976, I-AP:0.7305, I-F1:0.7097, P-AUROC:0.9143, P-AP:0.0411, P-F1:0.1211, P-AUPRO:0.7516
pcb1: I-Auroc:0.8732, I-AP:0.8677, I-F1:0.8061, P-AUROC:0.9743, P-AP:0.5735, P-F1:0.5602, P-AUPRO:0.7882
pcb2: I-Auroc:0.8179, I-AP:0.8438, I-F1:0.7462, P-AUROC:0.9439, P-AP:0.2653, P-F1:0.3872, P-AUPRO:0.6815
pcb3: I-Auroc:0.8714, I-AP:0.8928, I-F1:0.7940, P-AUROC:0.9620, P-AP:0.3422, P-F1:0.4251, P-AUPRO:0.7783
pcb4: I-Auroc:0.9541, I-AP:0.9243, I-F1:0.9163, P-AUROC:0.9081, P-AP:0.0971, P-F1:0.1881, P-AUPRO:0.7015
pipe_fryum: I-Auroc:0.9890, I-AP:0.9949, I-F1:0.9706, P-AUROC:0.9885, P-AP:0.5176, P-F1:0.6028, P-AUPRO:0.9485
Mean: I-Auroc:0.8873, I-AP:0.9057, I-F1:0.8511, P-AUROC:0.9512, P-AP:0.3247, P-F1:0.4006, P-AUPRO:0.7936
cuda:4
shots: 4
candle: I-Auroc:0.9504, I-AP:0.9424, I-F1:0.9082, P-AUROC:0.9695, P-AP:0.2462, P-F1:0.3568, P-AUPRO:0.8714
capsules: I-Auroc:0.7995, I-AP:0.8887, I-F1:0.8051, P-AUROC:0.9327, P-AP:0.2690, P-F1:0.3948, P-AUPRO:0.6943
cashew: I-Auroc:0.9550, I-AP:0.9776, I-F1:0.9275, P-AUROC:0.9870, P-AP:0.5449, P-F1:0.6017, P-AUPRO:0.9112
chewinggum: I-Auroc:0.9816, I-AP:0.9928, I-F1:0.9694, P-AUROC:0.9809, P-AP:0.6301, P-F1:0.6430, P-AUPRO:0.8220
fryum: I-Auroc:0.9284, I-AP:0.9695, I-F1:0.8980, P-AUROC:0.9419, P-AP:0.4013, P-F1:0.4797, P-AUPRO:0.7892
macaroni1: I-Auroc:0.8383, I-AP:0.8440, I-F1:0.7907, P-AUROC:0.9493, P-AP:0.0734, P-F1:0.1692, P-AUPRO:0.8237
macaroni2: I-Auroc:0.6993, I-AP:0.7311, I-F1:0.7029, P-AUROC:0.9228, P-AP:0.0422, P-F1:0.1296, P-AUPRO:0.7654
pcb1: I-Auroc:0.9124, I-AP:0.8981, I-F1:0.8557, P-AUROC:0.9849, P-AP:0.6034, P-F1:0.5715, P-AUPRO:0.8529
pcb2: I-Auroc:0.8383, I-AP:0.8665, I-F1:0.7619, P-AUROC:0.9512, P-AP:0.2864, P-F1:0.4073, P-AUPRO:0.7091
pcb3: I-Auroc:0.8719, I-AP:0.8835, I-F1:0.7873, P-AUROC:0.9687, P-AP:0.3761, P-F1:0.4496, P-AUPRO:0.7972
pcb4: I-Auroc:0.8570, I-AP:0.8440, I-F1:0.8390, P-AUROC:0.9336, P-AP:0.2303, P-F1:0.2961, P-AUPRO:0.7789
pipe_fryum: I-Auroc:0.9886, I-AP:0.9959, I-F1:0.9849, P-AUROC:0.9895, P-AP:0.5261, P-F1:0.6201, P-AUPRO:0.9496
Mean: I-Auroc:0.8851, I-AP:0.9028, I-F1:0.8526, P-AUROC:0.9593, P-AP:0.3525, P-F1:0.4266, P-AUPRO:0.8137



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mocov3_vit_base_16   (R512-C448)

cuda:2
shots: 1
candle: I-Auroc:0.9403, I-AP:0.9481, I-F1:0.8763, P-AUROC:0.9799, P-AP:0.3283, P-F1:0.3974, P-AUPRO:0.9148
capsules: I-Auroc:0.8093, I-AP:0.8979, I-F1:0.8053, P-AUROC:0.9419, P-AP:0.1756, P-F1:0.2979, P-AUPRO:0.7852
cashew: I-Auroc:0.9470, I-AP:0.9728, I-F1:0.9268, P-AUROC:0.9659, P-AP:0.6260, P-F1:0.6174, P-AUPRO:0.8498
chewinggum: I-Auroc:0.9860, I-AP:0.9940, I-F1:0.9648, P-AUROC:0.9908, P-AP:0.7947, P-F1:0.7346, P-AUPRO:0.8827
fryum: I-Auroc:0.9184, I-AP:0.9634, I-F1:0.8901, P-AUROC:0.9291, P-AP:0.3581, P-F1:0.4008, P-AUPRO:0.8664
macaroni1: I-Auroc:0.8314, I-AP:0.8209, I-F1:0.7792, P-AUROC:0.9813, P-AP:0.1811, P-F1:0.2922, P-AUPRO:0.8956
macaroni2: I-Auroc:0.5820, I-AP:0.5318, I-F1:0.6908, P-AUROC:0.9667, P-AP:0.0666, P-F1:0.1579, P-AUPRO:0.8849
pcb1: I-Auroc:0.7198, I-AP:0.7552, I-F1:0.7027, P-AUROC:0.9805, P-AP:0.7076, P-F1:0.6788, P-AUPRO:0.7943
pcb2: I-Auroc:0.8230, I-AP:0.8502, I-F1:0.7447, P-AUROC:0.9408, P-AP:0.3096, P-F1:0.3809, P-AUPRO:0.7350
pcb3: I-Auroc:0.7816, I-AP:0.7737, I-F1:0.7511, P-AUROC:0.9317, P-AP:0.2431, P-F1:0.3119, P-AUPRO:0.8224
pcb4: I-Auroc:0.9587, I-AP:0.9482, I-F1:0.9320, P-AUROC:0.9266, P-AP:0.1619, P-F1:0.2547, P-AUPRO:0.7288
pipe_fryum: I-Auroc:0.9566, I-AP:0.9766, I-F1:0.9394, P-AUROC:0.9935, P-AP:0.7052, P-F1:0.7175, P-AUPRO:0.9495
Mean: I-Auroc:0.8545, I-AP:0.8694, I-F1:0.8336, P-AUROC:0.9607, P-AP:0.3882, P-F1:0.4368, P-AUPRO:0.8425
cuda:2
shots: 2
candle: I-Auroc:0.9538, I-AP:0.9590, I-F1:0.8922, P-AUROC:0.9813, P-AP:0.3651, P-F1:0.4213, P-AUPRO:0.9279
capsules: I-Auroc:0.8875, I-AP:0.9364, I-F1:0.8716, P-AUROC:0.9562, P-AP:0.2170, P-F1:0.3436, P-AUPRO:0.8148
cashew: I-Auroc:0.9756, I-AP:0.9873, I-F1:0.9474, P-AUROC:0.9641, P-AP:0.6436, P-F1:0.6421, P-AUPRO:0.8503
chewinggum: I-Auroc:0.9914, I-AP:0.9961, I-F1:0.9749, P-AUROC:0.9902, P-AP:0.7744, P-F1:0.7327, P-AUPRO:0.8724
fryum: I-Auroc:0.9212, I-AP:0.9641, I-F1:0.8966, P-AUROC:0.9240, P-AP:0.3459, P-F1:0.3908, P-AUPRO:0.8642
macaroni1: I-Auroc:0.8370, I-AP:0.8489, I-F1:0.7945, P-AUROC:0.9837, P-AP:0.2247, P-F1:0.3342, P-AUPRO:0.8931
macaroni2: I-Auroc:0.6367, I-AP:0.5747, I-F1:0.6963, P-AUROC:0.9695, P-AP:0.0677, P-F1:0.1561, P-AUPRO:0.8849
pcb1: I-Auroc:0.7613, I-AP:0.7760, I-F1:0.7381, P-AUROC:0.9815, P-AP:0.7433, P-F1:0.7087, P-AUPRO:0.8222
pcb2: I-Auroc:0.8784, I-AP:0.8972, I-F1:0.7963, P-AUROC:0.9486, P-AP:0.3943, P-F1:0.4722, P-AUPRO:0.7914
pcb3: I-Auroc:0.7699, I-AP:0.7866, I-F1:0.7254, P-AUROC:0.9368, P-AP:0.2845, P-F1:0.3512, P-AUPRO:0.8091
pcb4: I-Auroc:0.9702, I-AP:0.9636, I-F1:0.9282, P-AUROC:0.9388, P-AP:0.2045, P-F1:0.2906, P-AUPRO:0.7750
pipe_fryum: I-Auroc:0.9556, I-AP:0.9755, I-F1:0.9314, P-AUROC:0.9938, P-AP:0.7083, P-F1:0.7218, P-AUPRO:0.9556
Mean: I-Auroc:0.8782, I-AP:0.8888, I-F1:0.8494, P-AUROC:0.9640, P-AP:0.4144, P-F1:0.4638, P-AUPRO:0.8551
cuda:2
shots: 4
candle: I-Auroc:0.9603, I-AP:0.9650, I-F1:0.8969, P-AUROC:0.9826, P-AP:0.3857, P-F1:0.4348, P-AUPRO:0.9288
capsules: I-Auroc:0.8348, I-AP:0.9039, I-F1:0.8224, P-AUROC:0.9675, P-AP:0.2721, P-F1:0.3777, P-AUPRO:0.8156
cashew: I-Auroc:0.9868, I-AP:0.9935, I-F1:0.9608, P-AUROC:0.9650, P-AP:0.6641, P-F1:0.6609, P-AUPRO:0.8491
chewinggum: I-Auroc:0.9904, I-AP:0.9959, I-F1:0.9754, P-AUROC:0.9899, P-AP:0.7683, P-F1:0.7265, P-AUPRO:0.8654
fryum: I-Auroc:0.9462, I-AP:0.9764, I-F1:0.9073, P-AUROC:0.9291, P-AP:0.3665, P-F1:0.4137, P-AUPRO:0.8611
macaroni1: I-Auroc:0.8866, I-AP:0.8819, I-F1:0.8283, P-AUROC:0.9881, P-AP:0.2848, P-F1:0.3926, P-AUPRO:0.9121
macaroni2: I-Auroc:0.6847, I-AP:0.6058, I-F1:0.7206, P-AUROC:0.9731, P-AP:0.0724, P-F1:0.1756, P-AUPRO:0.8887
pcb1: I-Auroc:0.8930, I-AP:0.8973, I-F1:0.8269, P-AUROC:0.9835, P-AP:0.8005, P-F1:0.7550, P-AUPRO:0.8556
pcb2: I-Auroc:0.9188, I-AP:0.9348, I-F1:0.8587, P-AUROC:0.9522, P-AP:0.4406, P-F1:0.5202, P-AUPRO:0.8152
pcb3: I-Auroc:0.8369, I-AP:0.8579, I-F1:0.7788, P-AUROC:0.9445, P-AP:0.3842, P-F1:0.4424, P-AUPRO:0.8521
pcb4: I-Auroc:0.9653, I-AP:0.9645, I-F1:0.9208, P-AUROC:0.9540, P-AP:0.3196, P-F1:0.3784, P-AUPRO:0.8465
pipe_fryum: I-Auroc:0.9680, I-AP:0.9841, I-F1:0.9458, P-AUROC:0.9933, P-AP:0.7082, P-F1:0.7349, P-AUPRO:0.9578
Mean: I-Auroc:0.9060, I-AP:0.9134, I-F1:0.8702, P-AUROC:0.9686, P-AP:0.4556, P-F1:0.5010, P-AUPRO:0.8707



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : mocov3_vit_base_16   (R256-C224)

cuda:2
shots: 1
candle: I-Auroc:0.9139, I-AP:0.9074, I-F1:0.8519, P-AUROC:0.9501, P-AP:0.2572, P-F1:0.3798, P-AUPRO:0.7739
capsules: I-Auroc:0.7727, I-AP:0.8726, I-F1:0.7965, P-AUROC:0.9238, P-AP:0.1489, P-F1:0.2694, P-AUPRO:0.5773
cashew: I-Auroc:0.8886, I-AP:0.9482, I-F1:0.8663, P-AUROC:0.9784, P-AP:0.6189, P-F1:0.6324, P-AUPRO:0.8972
chewinggum: I-Auroc:0.9712, I-AP:0.9868, I-F1:0.9447, P-AUROC:0.9847, P-AP:0.7196, P-F1:0.6775, P-AUPRO:0.8560
fryum: I-Auroc:0.8056, I-AP:0.9083, I-F1:0.8216, P-AUROC:0.9271, P-AP:0.4043, P-F1:0.4437, P-AUPRO:0.7260
macaroni1: I-Auroc:0.7538, I-AP:0.7987, I-F1:0.7011, P-AUROC:0.9216, P-AP:0.0853, P-F1:0.1925, P-AUPRO:0.7181
macaroni2: I-Auroc:0.5810, I-AP:0.5367, I-F1:0.6667, P-AUROC:0.8950, P-AP:0.0171, P-F1:0.0652, P-AUPRO:0.6899
pcb1: I-Auroc:0.6780, I-AP:0.6763, I-F1:0.6975, P-AUROC:0.9315, P-AP:0.3980, P-F1:0.4132, P-AUPRO:0.5874
pcb2: I-Auroc:0.7475, I-AP:0.7752, I-F1:0.7216, P-AUROC:0.9260, P-AP:0.2497, P-F1:0.3236, P-AUPRO:0.6080
pcb3: I-Auroc:0.7516, I-AP:0.7608, I-F1:0.7304, P-AUROC:0.9368, P-AP:0.2475, P-F1:0.3147, P-AUPRO:0.6720
pcb4: I-Auroc:0.9111, I-AP:0.9087, I-F1:0.8493, P-AUROC:0.9263, P-AP:0.2163, P-F1:0.2883, P-AUPRO:0.7355
pipe_fryum: I-Auroc:0.9798, I-AP:0.9909, I-F1:0.9557, P-AUROC:0.9907, P-AP:0.6553, P-F1:0.6713, P-AUPRO:0.9456
Mean: I-Auroc:0.8129, I-AP:0.8392, I-F1:0.8003, P-AUROC:0.9410, P-AP:0.3348, P-F1:0.3893, P-AUPRO:0.7322
cuda:2
shots: 2
candle: I-Auroc:0.9035, I-AP:0.8980, I-F1:0.8485, P-AUROC:0.9520, P-AP:0.2624, P-F1:0.3798, P-AUPRO:0.7932
capsules: I-Auroc:0.7858, I-AP:0.8796, I-F1:0.8000, P-AUROC:0.9404, P-AP:0.2075, P-F1:0.3445, P-AUPRO:0.5981
cashew: I-Auroc:0.9156, I-AP:0.9613, I-F1:0.8830, P-AUROC:0.9791, P-AP:0.6195, P-F1:0.6329, P-AUPRO:0.9004
chewinggum: I-Auroc:0.9814, I-AP:0.9918, I-F1:0.9592, P-AUROC:0.9829, P-AP:0.7195, P-F1:0.6813, P-AUPRO:0.8324
fryum: I-Auroc:0.8084, I-AP:0.9102, I-F1:0.8261, P-AUROC:0.9257, P-AP:0.3953, P-F1:0.4306, P-AUPRO:0.7177
macaroni1: I-Auroc:0.7565, I-AP:0.7816, I-F1:0.7231, P-AUROC:0.9160, P-AP:0.0547, P-F1:0.1536, P-AUPRO:0.7012
macaroni2: I-Auroc:0.6519, I-AP:0.6014, I-F1:0.7009, P-AUROC:0.8986, P-AP:0.0195, P-F1:0.0667, P-AUPRO:0.7077
pcb1: I-Auroc:0.7071, I-AP:0.7204, I-F1:0.6903, P-AUROC:0.9181, P-AP:0.4131, P-F1:0.4374, P-AUPRO:0.6329
pcb2: I-Auroc:0.8041, I-AP:0.8104, I-F1:0.7538, P-AUROC:0.9402, P-AP:0.2813, P-F1:0.3718, P-AUPRO:0.6647
pcb3: I-Auroc:0.8171, I-AP:0.8236, I-F1:0.7712, P-AUROC:0.9481, P-AP:0.2893, P-F1:0.3439, P-AUPRO:0.7519
pcb4: I-Auroc:0.9099, I-AP:0.9095, I-F1:0.8283, P-AUROC:0.9312, P-AP:0.2255, P-F1:0.2998, P-AUPRO:0.7453
pipe_fryum: I-Auroc:0.9788, I-AP:0.9907, I-F1:0.9641, P-AUROC:0.9910, P-AP:0.6541, P-F1:0.6667, P-AUPRO:0.9486
Mean: I-Auroc:0.8350, I-AP:0.8566, I-F1:0.8124, P-AUROC:0.9436, P-AP:0.3451, P-F1:0.4007, P-AUPRO:0.7495
cuda:2
shots: 4
candle: I-Auroc:0.9044, I-AP:0.8948, I-F1:0.8505, P-AUROC:0.9555, P-AP:0.2670, P-F1:0.3827, P-AUPRO:0.7913
capsules: I-Auroc:0.7857, I-AP:0.8758, I-F1:0.8194, P-AUROC:0.9472, P-AP:0.2836, P-F1:0.3933, P-AUPRO:0.5949
cashew: I-Auroc:0.9250, I-AP:0.9643, I-F1:0.9038, P-AUROC:0.9800, P-AP:0.6247, P-F1:0.6400, P-AUPRO:0.8870
chewinggum: I-Auroc:0.9814, I-AP:0.9925, I-F1:0.9648, P-AUROC:0.9845, P-AP:0.7302, P-F1:0.6865, P-AUPRO:0.8437
fryum: I-Auroc:0.8440, I-AP:0.9283, I-F1:0.8333, P-AUROC:0.9375, P-AP:0.4358, P-F1:0.4709, P-AUPRO:0.7297
macaroni1: I-Auroc:0.7699, I-AP:0.8050, I-F1:0.7323, P-AUROC:0.9230, P-AP:0.0730, P-F1:0.1877, P-AUPRO:0.7258
macaroni2: I-Auroc:0.6216, I-AP:0.5829, I-F1:0.6877, P-AUROC:0.9088, P-AP:0.0258, P-F1:0.0795, P-AUPRO:0.7257
pcb1: I-Auroc:0.7822, I-AP:0.7714, I-F1:0.7593, P-AUROC:0.9491, P-AP:0.5239, P-F1:0.5298, P-AUPRO:0.7038
pcb2: I-Auroc:0.8330, I-AP:0.8450, I-F1:0.7598, P-AUROC:0.9449, P-AP:0.3185, P-F1:0.4081, P-AUPRO:0.6786
pcb3: I-Auroc:0.8354, I-AP:0.8480, I-F1:0.7788, P-AUROC:0.9549, P-AP:0.3161, P-F1:0.3796, P-AUPRO:0.7712
pcb4: I-Auroc:0.8871, I-AP:0.8876, I-F1:0.8155, P-AUROC:0.9485, P-AP:0.2899, P-F1:0.3482, P-AUPRO:0.7960
pipe_fryum: I-Auroc:0.9808, I-AP:0.9921, I-F1:0.9608, P-AUROC:0.9903, P-AP:0.6488, P-F1:0.6641, P-AUPRO:0.9414
Mean: I-Auroc:0.8459, I-AP:0.8656, I-F1:0.8222, P-AUROC:0.9520, P-AP:0.3781, P-F1:0.4309, P-AUPRO:0.7658



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dino_vit_base_16   (R512-C448)

cuda:3
shots: 1
candle: I-Auroc:0.9383, I-AP:0.9435, I-F1:0.8683, P-AUROC:0.9796, P-AP:0.3254, P-F1:0.4126, P-AUPRO:0.9240
capsules: I-Auroc:0.7972, I-AP:0.8895, I-F1:0.7919, P-AUROC:0.9391, P-AP:0.1951, P-F1:0.3005, P-AUPRO:0.8036
cashew: I-Auroc:0.9156, I-AP:0.9603, I-F1:0.9026, P-AUROC:0.9863, P-AP:0.7168, P-F1:0.6956, P-AUPRO:0.8781
chewinggum: I-Auroc:0.9754, I-AP:0.9898, I-F1:0.9645, P-AUROC:0.9920, P-AP:0.7943, P-F1:0.7344, P-AUPRO:0.9042
fryum: I-Auroc:0.9266, I-AP:0.9684, I-F1:0.9005, P-AUROC:0.9454, P-AP:0.4171, P-F1:0.4359, P-AUPRO:0.8979
macaroni1: I-Auroc:0.7792, I-AP:0.7771, I-F1:0.7586, P-AUROC:0.9798, P-AP:0.1793, P-F1:0.2904, P-AUPRO:0.8853
macaroni2: I-Auroc:0.5808, I-AP:0.5410, I-F1:0.6691, P-AUROC:0.9664, P-AP:0.0667, P-F1:0.1643, P-AUPRO:0.8787
pcb1: I-Auroc:0.7481, I-AP:0.7785, I-F1:0.7237, P-AUROC:0.9840, P-AP:0.7796, P-F1:0.7441, P-AUPRO:0.8241
pcb2: I-Auroc:0.8479, I-AP:0.8734, I-F1:0.7615, P-AUROC:0.9452, P-AP:0.3404, P-F1:0.4035, P-AUPRO:0.7349
pcb3: I-Auroc:0.7963, I-AP:0.7892, I-F1:0.7679, P-AUROC:0.9374, P-AP:0.2985, P-F1:0.3581, P-AUPRO:0.8293
pcb4: I-Auroc:0.9691, I-AP:0.9576, I-F1:0.9366, P-AUROC:0.9493, P-AP:0.2583, P-F1:0.3240, P-AUPRO:0.8319
pipe_fryum: I-Auroc:0.9642, I-AP:0.9788, I-F1:0.9469, P-AUROC:0.9942, P-AP:0.7454, P-F1:0.7397, P-AUPRO:0.9552
Mean: I-Auroc:0.8532, I-AP:0.8706, I-F1:0.8327, P-AUROC:0.9666, P-AP:0.4264, P-F1:0.4669, P-AUPRO:0.8623
cuda:3
shots: 2
candle: I-Auroc:0.9595, I-AP:0.9619, I-F1:0.8955, P-AUROC:0.9815, P-AP:0.3595, P-F1:0.4355, P-AUPRO:0.9349
capsules: I-Auroc:0.8628, I-AP:0.9198, I-F1:0.8479, P-AUROC:0.9520, P-AP:0.2444, P-F1:0.3533, P-AUPRO:0.8344
cashew: I-Auroc:0.9570, I-AP:0.9807, I-F1:0.9282, P-AUROC:0.9869, P-AP:0.7476, P-F1:0.7297, P-AUPRO:0.8951
chewinggum: I-Auroc:0.9834, I-AP:0.9928, I-F1:0.9645, P-AUROC:0.9921, P-AP:0.7806, P-F1:0.7306, P-AUPRO:0.8993
fryum: I-Auroc:0.9314, I-AP:0.9696, I-F1:0.9010, P-AUROC:0.9431, P-AP:0.4071, P-F1:0.4300, P-AUPRO:0.8986
macaroni1: I-Auroc:0.7902, I-AP:0.7958, I-F1:0.7623, P-AUROC:0.9823, P-AP:0.2210, P-F1:0.3317, P-AUPRO:0.8857
macaroni2: I-Auroc:0.6129, I-AP:0.5562, I-F1:0.6947, P-AUROC:0.9677, P-AP:0.0537, P-F1:0.1419, P-AUPRO:0.8704
pcb1: I-Auroc:0.8046, I-AP:0.8185, I-F1:0.7580, P-AUROC:0.9859, P-AP:0.8026, P-F1:0.7653, P-AUPRO:0.8440
pcb2: I-Auroc:0.9048, I-AP:0.9188, I-F1:0.8406, P-AUROC:0.9533, P-AP:0.4105, P-F1:0.4793, P-AUPRO:0.7979
pcb3: I-Auroc:0.7696, I-AP:0.7884, I-F1:0.7324, P-AUROC:0.9405, P-AP:0.3215, P-F1:0.3722, P-AUPRO:0.8090
pcb4: I-Auroc:0.9789, I-AP:0.9721, I-F1:0.9510, P-AUROC:0.9559, P-AP:0.2977, P-F1:0.3551, P-AUPRO:0.8436
pipe_fryum: I-Auroc:0.9676, I-AP:0.9813, I-F1:0.9604, P-AUROC:0.9943, P-AP:0.7460, P-F1:0.7450, P-AUPRO:0.9598
Mean: I-Auroc:0.8769, I-AP:0.8880, I-F1:0.8530, P-AUROC:0.9696, P-AP:0.4493, P-F1:0.4891, P-AUPRO:0.8727
cuda:3
shots: 4
candle: I-Auroc:0.9649, I-AP:0.9658, I-F1:0.8909, P-AUROC:0.9809, P-AP:0.3619, P-F1:0.4331, P-AUPRO:0.9376
capsules: I-Auroc:0.8273, I-AP:0.8986, I-F1:0.8342, P-AUROC:0.9653, P-AP:0.2910, P-F1:0.3871, P-AUPRO:0.8412
cashew: I-Auroc:0.9636, I-AP:0.9834, I-F1:0.9340, P-AUROC:0.9875, P-AP:0.7585, P-F1:0.7389, P-AUPRO:0.9065
chewinggum: I-Auroc:0.9904, I-AP:0.9957, I-F1:0.9694, P-AUROC:0.9919, P-AP:0.7695, P-F1:0.7233, P-AUPRO:0.8954
fryum: I-Auroc:0.9674, I-AP:0.9855, I-F1:0.9305, P-AUROC:0.9493, P-AP:0.4284, P-F1:0.4549, P-AUPRO:0.9057
macaroni1: I-Auroc:0.8491, I-AP:0.8636, I-F1:0.7841, P-AUROC:0.9881, P-AP:0.2875, P-F1:0.3958, P-AUPRO:0.9158
macaroni2: I-Auroc:0.6871, I-AP:0.6173, I-F1:0.7222, P-AUROC:0.9728, P-AP:0.0704, P-F1:0.1678, P-AUPRO:0.8928
pcb1: I-Auroc:0.9197, I-AP:0.9195, I-F1:0.8629, P-AUROC:0.9887, P-AP:0.8363, P-F1:0.7883, P-AUPRO:0.8745
pcb2: I-Auroc:0.9539, I-AP:0.9616, I-F1:0.8832, P-AUROC:0.9577, P-AP:0.4719, P-F1:0.5511, P-AUPRO:0.8275
pcb3: I-Auroc:0.8588, I-AP:0.8770, I-F1:0.7905, P-AUROC:0.9486, P-AP:0.4217, P-F1:0.4743, P-AUPRO:0.8485
pcb4: I-Auroc:0.9757, I-AP:0.9725, I-F1:0.9360, P-AUROC:0.9650, P-AP:0.3795, P-F1:0.4296, P-AUPRO:0.8877
pipe_fryum: I-Auroc:0.9810, I-AP:0.9905, I-F1:0.9565, P-AUROC:0.9934, P-AP:0.7328, P-F1:0.7454, P-AUPRO:0.9601
Mean: I-Auroc:0.9116, I-AP:0.9192, I-F1:0.8745, P-AUROC:0.9741, P-AP:0.4841, P-F1:0.5241, P-AUPRO:0.8911



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dino_vit_base_16   (R256-C224)

cuda:4
shots: 1
candle: I-Auroc:0.9119, I-AP:0.9072, I-F1:0.8426, P-AUROC:0.9629, P-AP:0.3201, P-F1:0.4280, P-AUPRO:0.8028
capsules: I-Auroc:0.7477, I-AP:0.8634, I-F1:0.7698, P-AUROC:0.8991, P-AP:0.1250, P-F1:0.2348, P-AUPRO:0.5109
cashew: I-Auroc:0.8798, I-AP:0.9427, I-F1:0.8638, P-AUROC:0.9848, P-AP:0.6877, P-F1:0.6680, P-AUPRO:0.9041
chewinggum: I-Auroc:0.9714, I-AP:0.9864, I-F1:0.9442, P-AUROC:0.9860, P-AP:0.7595, P-F1:0.7031, P-AUPRO:0.8640
fryum: I-Auroc:0.7906, I-AP:0.9061, I-F1:0.8148, P-AUROC:0.9398, P-AP:0.4315, P-F1:0.4643, P-AUPRO:0.7529
macaroni1: I-Auroc:0.7606, I-AP:0.7916, I-F1:0.7200, P-AUROC:0.9407, P-AP:0.1012, P-F1:0.1923, P-AUPRO:0.7680
macaroni2: I-Auroc:0.5695, I-AP:0.5247, I-F1:0.6740, P-AUROC:0.9054, P-AP:0.0149, P-F1:0.0533, P-AUPRO:0.7044
pcb1: I-Auroc:0.6895, I-AP:0.7107, I-F1:0.6940, P-AUROC:0.9603, P-AP:0.5586, P-F1:0.5457, P-AUPRO:0.6532
pcb2: I-Auroc:0.7502, I-AP:0.7674, I-F1:0.7331, P-AUROC:0.9290, P-AP:0.2349, P-F1:0.3059, P-AUPRO:0.6060
pcb3: I-Auroc:0.7512, I-AP:0.7544, I-F1:0.7321, P-AUROC:0.9374, P-AP:0.2427, P-F1:0.3040, P-AUPRO:0.6812
pcb4: I-Auroc:0.9294, I-AP:0.9263, I-F1:0.8638, P-AUROC:0.9575, P-AP:0.3059, P-F1:0.3677, P-AUPRO:0.8005
pipe_fryum: I-Auroc:0.9858, I-AP:0.9935, I-F1:0.9652, P-AUROC:0.9911, P-AP:0.6860, P-F1:0.6720, P-AUPRO:0.9482
Mean: I-Auroc:0.8115, I-AP:0.8395, I-F1:0.8015, P-AUROC:0.9495, P-AP:0.3723, P-F1:0.4116, P-AUPRO:0.7497
cuda:4
shots: 2
candle: I-Auroc:0.9133, I-AP:0.9085, I-F1:0.8584, P-AUROC:0.9663, P-AP:0.3205, P-F1:0.4219, P-AUPRO:0.8223
capsules: I-Auroc:0.7910, I-AP:0.8835, I-F1:0.7926, P-AUROC:0.9169, P-AP:0.1538, P-F1:0.2678, P-AUPRO:0.5317
cashew: I-Auroc:0.9000, I-AP:0.9531, I-F1:0.8846, P-AUROC:0.9861, P-AP:0.6930, P-F1:0.6759, P-AUPRO:0.9089
chewinggum: I-Auroc:0.9838, I-AP:0.9927, I-F1:0.9596, P-AUROC:0.9848, P-AP:0.7582, P-F1:0.7040, P-AUPRO:0.8486
fryum: I-Auroc:0.7956, I-AP:0.9100, I-F1:0.8197, P-AUROC:0.9399, P-AP:0.4298, P-F1:0.4642, P-AUPRO:0.7472
macaroni1: I-Auroc:0.7499, I-AP:0.7780, I-F1:0.7117, P-AUROC:0.9414, P-AP:0.0759, P-F1:0.1784, P-AUPRO:0.7706
macaroni2: I-Auroc:0.6107, I-AP:0.5791, I-F1:0.6807, P-AUROC:0.9112, P-AP:0.0193, P-F1:0.0632, P-AUPRO:0.7181
pcb1: I-Auroc:0.7190, I-AP:0.7490, I-F1:0.6930, P-AUROC:0.9587, P-AP:0.5485, P-F1:0.5389, P-AUPRO:0.6918
pcb2: I-Auroc:0.7951, I-AP:0.7953, I-F1:0.7649, P-AUROC:0.9418, P-AP:0.2685, P-F1:0.3510, P-AUPRO:0.6547
pcb3: I-Auroc:0.8101, I-AP:0.8004, I-F1:0.7778, P-AUROC:0.9478, P-AP:0.2706, P-F1:0.3271, P-AUPRO:0.7468
pcb4: I-Auroc:0.9262, I-AP:0.9306, I-F1:0.8479, P-AUROC:0.9594, P-AP:0.3191, P-F1:0.3786, P-AUPRO:0.8092
pipe_fryum: I-Auroc:0.9852, I-AP:0.9930, I-F1:0.9645, P-AUROC:0.9914, P-AP:0.6859, P-F1:0.6724, P-AUPRO:0.9471
Mean: I-Auroc:0.8317, I-AP:0.8561, I-F1:0.8130, P-AUROC:0.9538, P-AP:0.3786, P-F1:0.4203, P-AUPRO:0.7664
cuda:4
shots: 4
candle: I-Auroc:0.9161, I-AP:0.9076, I-F1:0.8557, P-AUROC:0.9690, P-AP:0.3149, P-F1:0.4204, P-AUPRO:0.8189
capsules: I-Auroc:0.7518, I-AP:0.8576, I-F1:0.7812, P-AUROC:0.9277, P-AP:0.1900, P-F1:0.2973, P-AUPRO:0.5565
cashew: I-Auroc:0.9050, I-AP:0.9560, I-F1:0.8942, P-AUROC:0.9870, P-AP:0.6892, P-F1:0.6774, P-AUPRO:0.9037
chewinggum: I-Auroc:0.9842, I-AP:0.9932, I-F1:0.9637, P-AUROC:0.9861, P-AP:0.7570, P-F1:0.7007, P-AUPRO:0.8418
fryum: I-Auroc:0.8338, I-AP:0.9248, I-F1:0.8264, P-AUROC:0.9519, P-AP:0.4751, P-F1:0.5059, P-AUPRO:0.7820
macaroni1: I-Auroc:0.7763, I-AP:0.8006, I-F1:0.7286, P-AUROC:0.9524, P-AP:0.1087, P-F1:0.2223, P-AUPRO:0.8113
macaroni2: I-Auroc:0.6691, I-AP:0.6151, I-F1:0.7018, P-AUROC:0.9225, P-AP:0.0312, P-F1:0.0889, P-AUPRO:0.7448
pcb1: I-Auroc:0.8240, I-AP:0.8195, I-F1:0.7611, P-AUROC:0.9777, P-AP:0.6533, P-F1:0.6249, P-AUPRO:0.7643
pcb2: I-Auroc:0.8419, I-AP:0.8450, I-F1:0.7826, P-AUROC:0.9465, P-AP:0.3088, P-F1:0.3889, P-AUPRO:0.6736
pcb3: I-Auroc:0.8378, I-AP:0.8342, I-F1:0.7930, P-AUROC:0.9543, P-AP:0.3168, P-F1:0.3783, P-AUPRO:0.7673
pcb4: I-Auroc:0.9221, I-AP:0.9287, I-F1:0.8333, P-AUROC:0.9689, P-AP:0.3864, P-F1:0.4173, P-AUPRO:0.8394
pipe_fryum: I-Auroc:0.9838, I-AP:0.9931, I-F1:0.9751, P-AUROC:0.9912, P-AP:0.6743, P-F1:0.6711, P-AUPRO:0.9445
Mean: I-Auroc:0.8538, I-AP:0.8730, I-F1:0.8247, P-AUROC:0.9613, P-AP:0.4088, P-F1:0.4494, P-AUPRO:0.7873




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : ibot_vit_base_16   (R512-C448)

cuda:1
shots: 1
candle: I-Auroc:0.9427, I-AP:0.9500, I-F1:0.8708, P-AUROC:0.9814, P-AP:0.3132, P-F1:0.4029, P-AUPRO:0.9284
capsules: I-Auroc:0.8005, I-AP:0.8933, I-F1:0.8000, P-AUROC:0.9472, P-AP:0.1925, P-F1:0.3049, P-AUPRO:0.8350
cashew: I-Auroc:0.9196, I-AP:0.9628, I-F1:0.9000, P-AUROC:0.9877, P-AP:0.7123, P-F1:0.6873, P-AUPRO:0.8934
chewinggum: I-Auroc:0.9894, I-AP:0.9954, I-F1:0.9749, P-AUROC:0.9925, P-AP:0.8110, P-F1:0.7438, P-AUPRO:0.9044
fryum: I-Auroc:0.9126, I-AP:0.9607, I-F1:0.8832, P-AUROC:0.9430, P-AP:0.4006, P-F1:0.4267, P-AUPRO:0.8796
macaroni1: I-Auroc:0.7779, I-AP:0.7797, I-F1:0.7444, P-AUROC:0.9785, P-AP:0.1586, P-F1:0.2545, P-AUPRO:0.8786
macaroni2: I-Auroc:0.5356, I-AP:0.5049, I-F1:0.6667, P-AUROC:0.9638, P-AP:0.0378, P-F1:0.1155, P-AUPRO:0.8674
pcb1: I-Auroc:0.7317, I-AP:0.7708, I-F1:0.7029, P-AUROC:0.9850, P-AP:0.7512, P-F1:0.7171, P-AUPRO:0.8072
pcb2: I-Auroc:0.8539, I-AP:0.8831, I-F1:0.7768, P-AUROC:0.9446, P-AP:0.3897, P-F1:0.4635, P-AUPRO:0.7362
pcb3: I-Auroc:0.8213, I-AP:0.8152, I-F1:0.8018, P-AUROC:0.9426, P-AP:0.2985, P-F1:0.3596, P-AUPRO:0.8247
pcb4: I-Auroc:0.9723, I-AP:0.9658, I-F1:0.9519, P-AUROC:0.9429, P-AP:0.2117, P-F1:0.2974, P-AUPRO:0.7871
pipe_fryum: I-Auroc:0.9646, I-AP:0.9778, I-F1:0.9655, P-AUROC:0.9948, P-AP:0.7507, P-F1:0.7537, P-AUPRO:0.9530
Mean: I-Auroc:0.8518, I-AP:0.8716, I-F1:0.8366, P-AUROC:0.9670, P-AP:0.4190, P-F1:0.4606, P-AUPRO:0.8579
cuda:1
shots: 2
candle: I-Auroc:0.9625, I-AP:0.9654, I-F1:0.9055, P-AUROC:0.9835, P-AP:0.3525, P-F1:0.4301, P-AUPRO:0.9369
capsules: I-Auroc:0.8942, I-AP:0.9419, I-F1:0.8641, P-AUROC:0.9616, P-AP:0.2568, P-F1:0.3775, P-AUPRO:0.8581
cashew: I-Auroc:0.9554, I-AP:0.9793, I-F1:0.9372, P-AUROC:0.9893, P-AP:0.7512, P-F1:0.7311, P-AUPRO:0.9050
chewinggum: I-Auroc:0.9932, I-AP:0.9968, I-F1:0.9700, P-AUROC:0.9923, P-AP:0.7954, P-F1:0.7331, P-AUPRO:0.9022
fryum: I-Auroc:0.9152, I-AP:0.9615, I-F1:0.8776, P-AUROC:0.9394, P-AP:0.3853, P-F1:0.4146, P-AUPRO:0.8763
macaroni1: I-Auroc:0.7924, I-AP:0.8021, I-F1:0.7530, P-AUROC:0.9813, P-AP:0.1791, P-F1:0.2957, P-AUPRO:0.8802
macaroni2: I-Auroc:0.5937, I-AP:0.5417, I-F1:0.6781, P-AUROC:0.9657, P-AP:0.0370, P-F1:0.1133, P-AUPRO:0.8661
pcb1: I-Auroc:0.8137, I-AP:0.8269, I-F1:0.7633, P-AUROC:0.9875, P-AP:0.7917, P-F1:0.7511, P-AUPRO:0.8380
pcb2: I-Auroc:0.8946, I-AP:0.9090, I-F1:0.8317, P-AUROC:0.9523, P-AP:0.4442, P-F1:0.5308, P-AUPRO:0.7922
pcb3: I-Auroc:0.7974, I-AP:0.8157, I-F1:0.7700, P-AUROC:0.9463, P-AP:0.3320, P-F1:0.3920, P-AUPRO:0.8064
pcb4: I-Auroc:0.9808, I-AP:0.9751, I-F1:0.9552, P-AUROC:0.9521, P-AP:0.2477, P-F1:0.3338, P-AUPRO:0.8124
pipe_fryum: I-Auroc:0.9720, I-AP:0.9829, I-F1:0.9612, P-AUROC:0.9948, P-AP:0.7483, P-F1:0.7534, P-AUPRO:0.9553
Mean: I-Auroc:0.8804, I-AP:0.8915, I-F1:0.8556, P-AUROC:0.9705, P-AP:0.4434, P-F1:0.4880, P-AUPRO:0.8691
cuda:1
shots: 4
candle: I-Auroc:0.9649, I-AP:0.9667, I-F1:0.9072, P-AUROC:0.9836, P-AP:0.3588, P-F1:0.4329, P-AUPRO:0.9400
capsules: I-Auroc:0.8660, I-AP:0.9230, I-F1:0.8372, P-AUROC:0.9728, P-AP:0.3104, P-F1:0.4206, P-AUPRO:0.8485
cashew: I-Auroc:0.9678, I-AP:0.9851, I-F1:0.9463, P-AUROC:0.9906, P-AP:0.7728, P-F1:0.7533, P-AUPRO:0.9135
chewinggum: I-Auroc:0.9950, I-AP:0.9976, I-F1:0.9754, P-AUROC:0.9925, P-AP:0.7896, P-F1:0.7271, P-AUPRO:0.8980
fryum: I-Auroc:0.9564, I-AP:0.9806, I-F1:0.9293, P-AUROC:0.9475, P-AP:0.4173, P-F1:0.4548, P-AUPRO:0.8884
macaroni1: I-Auroc:0.8542, I-AP:0.8628, I-F1:0.7864, P-AUROC:0.9875, P-AP:0.2404, P-F1:0.3501, P-AUPRO:0.9154
macaroni2: I-Auroc:0.6713, I-AP:0.6013, I-F1:0.6969, P-AUROC:0.9718, P-AP:0.0492, P-F1:0.1411, P-AUPRO:0.8910
pcb1: I-Auroc:0.9115, I-AP:0.9151, I-F1:0.8529, P-AUROC:0.9901, P-AP:0.8331, P-F1:0.7741, P-AUPRO:0.8756
pcb2: I-Auroc:0.9315, I-AP:0.9401, I-F1:0.8601, P-AUROC:0.9558, P-AP:0.4869, P-F1:0.5732, P-AUPRO:0.8235
pcb3: I-Auroc:0.8704, I-AP:0.8846, I-F1:0.7980, P-AUROC:0.9551, P-AP:0.4329, P-F1:0.4928, P-AUPRO:0.8512
pcb4: I-Auroc:0.9817, I-AP:0.9800, I-F1:0.9458, P-AUROC:0.9661, P-AP:0.3758, P-F1:0.4407, P-AUPRO:0.8810
pipe_fryum: I-Auroc:0.9842, I-AP:0.9920, I-F1:0.9800, P-AUROC:0.9944, P-AP:0.7403, P-F1:0.7525, P-AUPRO:0.9599
Mean: I-Auroc:0.9129, I-AP:0.9191, I-F1:0.8763, P-AUROC:0.9756, P-AP:0.4840, P-F1:0.5261, P-AUPRO:0.8905




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : ibot_vit_base_16   (R256-C224)

cuda:1
shots: 1
candle: I-Auroc:0.9206, I-AP:0.9109, I-F1:0.8479, P-AUROC:0.9693, P-AP:0.3179, P-F1:0.4248, P-AUPRO:0.8280
capsules: I-Auroc:0.7832, I-AP:0.8741, I-F1:0.8070, P-AUROC:0.9136, P-AP:0.1465, P-F1:0.2617, P-AUPRO:0.5698
cashew: I-Auroc:0.8718, I-AP:0.9429, I-F1:0.8600, P-AUROC:0.9881, P-AP:0.7014, P-F1:0.6794, P-AUPRO:0.9028
chewinggum: I-Auroc:0.9734, I-AP:0.9876, I-F1:0.9490, P-AUROC:0.9870, P-AP:0.7576, P-F1:0.6994, P-AUPRO:0.8741
fryum: I-Auroc:0.7954, I-AP:0.9125, I-F1:0.8182, P-AUROC:0.9425, P-AP:0.4376, P-F1:0.4747, P-AUPRO:0.7418
macaroni1: I-Auroc:0.7630, I-AP:0.7973, I-F1:0.7244, P-AUROC:0.9360, P-AP:0.0842, P-F1:0.1902, P-AUPRO:0.7485
macaroni2: I-Auroc:0.5628, I-AP:0.5158, I-F1:0.6766, P-AUROC:0.8934, P-AP:0.0132, P-F1:0.0513, P-AUPRO:0.6797
pcb1: I-Auroc:0.7026, I-AP:0.7223, I-F1:0.6953, P-AUROC:0.9635, P-AP:0.5415, P-F1:0.5326, P-AUPRO:0.6782
pcb2: I-Auroc:0.7501, I-AP:0.7628, I-F1:0.7500, P-AUROC:0.9260, P-AP:0.2496, P-F1:0.3253, P-AUPRO:0.5972
pcb3: I-Auroc:0.7447, I-AP:0.7632, I-F1:0.7232, P-AUROC:0.9389, P-AP:0.2431, P-F1:0.3171, P-AUPRO:0.6716
pcb4: I-Auroc:0.9268, I-AP:0.9253, I-F1:0.8585, P-AUROC:0.9434, P-AP:0.2418, P-F1:0.3054, P-AUPRO:0.7669
pipe_fryum: I-Auroc:0.9828, I-AP:0.9920, I-F1:0.9697, P-AUROC:0.9929, P-AP:0.7036, P-F1:0.6945, P-AUPRO:0.9521
Mean: I-Auroc:0.8148, I-AP:0.8422, I-F1:0.8067, P-AUROC:0.9496, P-AP:0.3698, P-F1:0.4130, P-AUPRO:0.7509
cuda:1
shots: 2
candle: I-Auroc:0.9166, I-AP:0.9055, I-F1:0.8381, P-AUROC:0.9721, P-AP:0.3146, P-F1:0.4226, P-AUPRO:0.8508
capsules: I-Auroc:0.7872, I-AP:0.8837, I-F1:0.7905, P-AUROC:0.9362, P-AP:0.1985, P-F1:0.3267, P-AUPRO:0.5947
cashew: I-Auroc:0.9070, I-AP:0.9579, I-F1:0.8846, P-AUROC:0.9905, P-AP:0.7215, P-F1:0.7053, P-AUPRO:0.9161
chewinggum: I-Auroc:0.9842, I-AP:0.9932, I-F1:0.9694, P-AUROC:0.9870, P-AP:0.7561, P-F1:0.6965, P-AUPRO:0.8628
fryum: I-Auroc:0.7994, I-AP:0.9115, I-F1:0.8182, P-AUROC:0.9418, P-AP:0.4250, P-F1:0.4622, P-AUPRO:0.7383
macaroni1: I-Auroc:0.7674, I-AP:0.7918, I-F1:0.7257, P-AUROC:0.9361, P-AP:0.0549, P-F1:0.1549, P-AUPRO:0.7426
macaroni2: I-Auroc:0.6175, I-AP:0.5638, I-F1:0.6891, P-AUROC:0.8958, P-AP:0.0153, P-F1:0.0561, P-AUPRO:0.6821
pcb1: I-Auroc:0.7408, I-AP:0.7629, I-F1:0.7018, P-AUROC:0.9642, P-AP:0.5355, P-F1:0.5313, P-AUPRO:0.7223
pcb2: I-Auroc:0.7980, I-AP:0.7926, I-F1:0.7764, P-AUROC:0.9388, P-AP:0.2729, P-F1:0.3613, P-AUPRO:0.6167
pcb3: I-Auroc:0.8086, I-AP:0.8089, I-F1:0.7619, P-AUROC:0.9521, P-AP:0.2806, P-F1:0.3413, P-AUPRO:0.7480
pcb4: I-Auroc:0.9226, I-AP:0.9215, I-F1:0.8491, P-AUROC:0.9484, P-AP:0.2620, P-F1:0.3305, P-AUPRO:0.7782
pipe_fryum: I-Auroc:0.9850, I-AP:0.9924, I-F1:0.9703, P-AUROC:0.9931, P-AP:0.7093, P-F1:0.6950, P-AUPRO:0.9462
Mean: I-Auroc:0.8362, I-AP:0.8572, I-F1:0.8146, P-AUROC:0.9547, P-AP:0.3789, P-F1:0.4237, P-AUPRO:0.7666
cuda:1
shots: 4
candle: I-Auroc:0.9168, I-AP:0.8992, I-F1:0.8517, P-AUROC:0.9736, P-AP:0.3093, P-F1:0.4127, P-AUPRO:0.8450
capsules: I-Auroc:0.7510, I-AP:0.8551, I-F1:0.7967, P-AUROC:0.9439, P-AP:0.2403, P-F1:0.3555, P-AUPRO:0.6044
cashew: I-Auroc:0.9116, I-AP:0.9613, I-F1:0.8878, P-AUROC:0.9908, P-AP:0.7225, P-F1:0.7085, P-AUPRO:0.9114
chewinggum: I-Auroc:0.9848, I-AP:0.9938, I-F1:0.9796, P-AUROC:0.9883, P-AP:0.7564, P-F1:0.6947, P-AUPRO:0.8687
fryum: I-Auroc:0.8380, I-AP:0.9267, I-F1:0.8312, P-AUROC:0.9538, P-AP:0.4751, P-F1:0.5152, P-AUPRO:0.7626
macaroni1: I-Auroc:0.8048, I-AP:0.8375, I-F1:0.7413, P-AUROC:0.9506, P-AP:0.0823, P-F1:0.1952, P-AUPRO:0.8038
macaroni2: I-Auroc:0.6353, I-AP:0.5776, I-F1:0.6939, P-AUROC:0.9110, P-AP:0.0192, P-F1:0.0682, P-AUPRO:0.7159
pcb1: I-Auroc:0.8338, I-AP:0.8219, I-F1:0.7736, P-AUROC:0.9816, P-AP:0.6332, P-F1:0.6060, P-AUPRO:0.8060
pcb2: I-Auroc:0.8467, I-AP:0.8417, I-F1:0.7913, P-AUROC:0.9441, P-AP:0.3200, P-F1:0.4094, P-AUPRO:0.6430
pcb3: I-Auroc:0.8345, I-AP:0.8368, I-F1:0.7778, P-AUROC:0.9586, P-AP:0.3184, P-F1:0.3828, P-AUPRO:0.7634
pcb4: I-Auroc:0.9110, I-AP:0.9140, I-F1:0.8370, P-AUROC:0.9649, P-AP:0.3468, P-F1:0.3970, P-AUPRO:0.8241
pipe_fryum: I-Auroc:0.9844, I-AP:0.9935, I-F1:0.9849, P-AUROC:0.9928, P-AP:0.6923, P-F1:0.6882, P-AUPRO:0.9456
Mean: I-Auroc:0.8544, I-AP:0.8716, I-F1:0.8289, P-AUROC:0.9628, P-AP:0.4097, P-F1:0.4528, P-AUPRO:0.7912



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2_vit_base_14   (R448-C392)

cuda:2
shots: 1
candle: I-Auroc:0.9519, I-AP:0.9605, I-F1:0.8854, P-AUROC:0.9890, P-AP:0.4534, P-F1:0.5083, P-AUPRO:0.9461
capsules: I-Auroc:0.9800, I-AP:0.9886, I-F1:0.9479, P-AUROC:0.9738, P-AP:0.4936, P-F1:0.5263, P-AUPRO:0.9452
cashew: I-Auroc:0.9474, I-AP:0.9768, I-F1:0.9261, P-AUROC:0.9789, P-AP:0.5277, P-F1:0.5283, P-AUPRO:0.9499
chewinggum: I-Auroc:0.9926, I-AP:0.9965, I-F1:0.9703, P-AUROC:0.9925, P-AP:0.6442, P-F1:0.6970, P-AUPRO:0.9217
fryum: I-Auroc:0.9572, I-AP:0.9812, I-F1:0.9278, P-AUROC:0.9344, P-AP:0.3840, P-F1:0.4232, P-AUPRO:0.9056
macaroni1: I-Auroc:0.9392, I-AP:0.9472, I-F1:0.8708, P-AUROC:0.9932, P-AP:0.3462, P-F1:0.4209, P-AUPRO:0.9510
macaroni2: I-Auroc:0.7471, I-AP:0.6707, I-F1:0.7315, P-AUROC:0.9799, P-AP:0.1784, P-F1:0.2611, P-AUPRO:0.9080
pcb1: I-Auroc:0.9120, I-AP:0.9025, I-F1:0.8667, P-AUROC:0.9890, P-AP:0.6607, P-F1:0.6507, P-AUPRO:0.9027
pcb2: I-Auroc:0.9072, I-AP:0.9157, I-F1:0.8500, P-AUROC:0.9594, P-AP:0.4673, P-F1:0.5147, P-AUPRO:0.8237
pcb3: I-Auroc:0.9141, I-AP:0.9106, I-F1:0.8651, P-AUROC:0.9644, P-AP:0.4873, P-F1:0.5233, P-AUPRO:0.8575
pcb4: I-Auroc:0.9906, I-AP:0.9895, I-F1:0.9652, P-AUROC:0.9428, P-AP:0.2712, P-F1:0.3446, P-AUPRO:0.8167
pipe_fryum: I-Auroc:0.9738, I-AP:0.9872, I-F1:0.9648, P-AUROC:0.9875, P-AP:0.5104, P-F1:0.5880, P-AUPRO:0.9657
Mean: I-Auroc:0.9344, I-AP:0.9356, I-F1:0.8976, P-AUROC:0.9737, P-AP:0.4520, P-F1:0.4989, P-AUPRO:0.9078
cuda:2
shots: 2
candle: I-Auroc:0.9650, I-AP:0.9704, I-F1:0.9082, P-AUROC:0.9896, P-AP:0.4620, P-F1:0.5170, P-AUPRO:0.9454
capsules: I-Auroc:0.9863, I-AP:0.9922, I-F1:0.9565, P-AUROC:0.9799, P-AP:0.5092, P-F1:0.5324, P-AUPRO:0.9491
cashew: I-Auroc:0.9568, I-AP:0.9799, I-F1:0.9307, P-AUROC:0.9802, P-AP:0.5359, P-F1:0.5348, P-AUPRO:0.9608
chewinggum: I-Auroc:0.9936, I-AP:0.9969, I-F1:0.9706, P-AUROC:0.9924, P-AP:0.6502, P-F1:0.6919, P-AUPRO:0.9181
fryum: I-Auroc:0.9590, I-AP:0.9815, I-F1:0.9286, P-AUROC:0.9395, P-AP:0.4017, P-F1:0.4413, P-AUPRO:0.9048
macaroni1: I-Auroc:0.9637, I-AP:0.9659, I-F1:0.8858, P-AUROC:0.9938, P-AP:0.3565, P-F1:0.4313, P-AUPRO:0.9476
macaroni2: I-Auroc:0.7499, I-AP:0.6845, I-F1:0.7402, P-AUROC:0.9820, P-AP:0.1566, P-F1:0.2650, P-AUPRO:0.9139
pcb1: I-Auroc:0.9044, I-AP:0.8879, I-F1:0.8493, P-AUROC:0.9900, P-AP:0.6791, P-F1:0.6613, P-AUPRO:0.9097
pcb2: I-Auroc:0.9203, I-AP:0.9163, I-F1:0.8796, P-AUROC:0.9633, P-AP:0.4875, P-F1:0.5374, P-AUPRO:0.8595
pcb3: I-Auroc:0.9260, I-AP:0.9299, I-F1:0.8585, P-AUROC:0.9711, P-AP:0.5209, P-F1:0.5524, P-AUPRO:0.8701
pcb4: I-Auroc:0.9884, I-AP:0.9863, I-F1:0.9608, P-AUROC:0.9527, P-AP:0.2878, P-F1:0.3596, P-AUPRO:0.8317
pipe_fryum: I-Auroc:0.9820, I-AP:0.9913, I-F1:0.9703, P-AUROC:0.9884, P-AP:0.5201, P-F1:0.5977, P-AUPRO:0.9672
Mean: I-Auroc:0.9413, I-AP:0.9403, I-F1:0.9033, P-AUROC:0.9769, P-AP:0.4640, P-F1:0.5102, P-AUPRO:0.9148
cuda:2
shots: 4
candle: I-Auroc:0.9766, I-AP:0.9786, I-F1:0.9254, P-AUROC:0.9909, P-AP:0.4764, P-F1:0.5219, P-AUPRO:0.9452
capsules: I-Auroc:0.9758, I-AP:0.9862, I-F1:0.9400, P-AUROC:0.9852, P-AP:0.5995, P-F1:0.5973, P-AUPRO:0.9598
cashew: I-Auroc:0.9736, I-AP:0.9872, I-F1:0.9400, P-AUROC:0.9821, P-AP:0.5557, P-F1:0.5564, P-AUPRO:0.9618
chewinggum: I-Auroc:0.9948, I-AP:0.9975, I-F1:0.9754, P-AUROC:0.9928, P-AP:0.6606, P-F1:0.6933, P-AUPRO:0.9213
fryum: I-Auroc:0.9804, I-AP:0.9907, I-F1:0.9500, P-AUROC:0.9455, P-AP:0.4193, P-F1:0.4589, P-AUPRO:0.9123
macaroni1: I-Auroc:0.9921, I-AP:0.9923, I-F1:0.9565, P-AUROC:0.9946, P-AP:0.3671, P-F1:0.4399, P-AUPRO:0.9576
macaroni2: I-Auroc:0.7926, I-AP:0.7431, I-F1:0.7686, P-AUROC:0.9856, P-AP:0.2268, P-F1:0.3121, P-AUPRO:0.9299
pcb1: I-Auroc:0.9141, I-AP:0.8934, I-F1:0.8716, P-AUROC:0.9917, P-AP:0.6928, P-F1:0.6752, P-AUPRO:0.9226
pcb2: I-Auroc:0.9412, I-AP:0.9421, I-F1:0.8889, P-AUROC:0.9649, P-AP:0.5139, P-F1:0.5600, P-AUPRO:0.8671
pcb3: I-Auroc:0.9558, I-AP:0.9603, I-F1:0.8866, P-AUROC:0.9769, P-AP:0.5450, P-F1:0.5790, P-AUPRO:0.8965
pcb4: I-Auroc:0.9901, I-AP:0.9887, I-F1:0.9754, P-AUROC:0.9655, P-AP:0.3856, P-F1:0.4515, P-AUPRO:0.8854
pipe_fryum: I-Auroc:0.9906, I-AP:0.9961, I-F1:0.9798, P-AUROC:0.9886, P-AP:0.5208, P-F1:0.6092, P-AUPRO:0.9670
Mean: I-Auroc:0.9565, I-AP:0.9547, I-F1:0.9215, P-AUROC:0.9804, P-AP:0.4970, P-F1:0.5379, P-AUPRO:0.9272



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2_vit_base_14   (R256-C224)

cuda:2
shots: 1
cuda:2
shots: 1
candle: I-Auroc:0.9539, I-AP:0.9582, I-F1:0.8737, P-AUROC:0.9846, P-AP:0.4080, P-F1:0.4633, P-AUPRO:0.9045
capsules: I-Auroc:0.9060, I-AP:0.9466, I-F1:0.8725, P-AUROC:0.9652, P-AP:0.3337, P-F1:0.4393, P-AUPRO:0.7895
cashew: I-Auroc:0.9006, I-AP:0.9515, I-F1:0.9000, P-AUROC:0.9820, P-AP:0.5580, P-F1:0.5388, P-AUPRO:0.8989
chewinggum: I-Auroc:0.9784, I-AP:0.9906, I-F1:0.9548, P-AUROC:0.9871, P-AP:0.5833, P-F1:0.6577, P-AUPRO:0.8828
fryum: I-Auroc:0.9256, I-AP:0.9657, I-F1:0.8984, P-AUROC:0.9116, P-AP:0.3513, P-F1:0.4164, P-AUPRO:0.7621
macaroni1: I-Auroc:0.8467, I-AP:0.8801, I-F1:0.7721, P-AUROC:0.9684, P-AP:0.2394, P-F1:0.3325, P-AUPRO:0.8644
macaroni2: I-Auroc:0.6965, I-AP:0.6447, I-F1:0.6916, P-AUROC:0.9259, P-AP:0.1102, P-F1:0.2039, P-AUPRO:0.8169
pcb1: I-Auroc:0.8369, I-AP:0.8102, I-F1:0.8057, P-AUROC:0.9702, P-AP:0.5278, P-F1:0.5196, P-AUPRO:0.7516
pcb2: I-Auroc:0.8672, I-AP:0.8806, I-F1:0.8128, P-AUROC:0.9398, P-AP:0.3428, P-F1:0.4355, P-AUPRO:0.6656
pcb3: I-Auroc:0.8457, I-AP:0.8572, I-F1:0.7721, P-AUROC:0.9514, P-AP:0.3290, P-F1:0.4111, P-AUPRO:0.6999
pcb4: I-Auroc:0.9658, I-AP:0.9553, I-F1:0.9289, P-AUROC:0.9487, P-AP:0.2208, P-F1:0.3032, P-AUPRO:0.8086
pipe_fryum: I-Auroc:0.9846, I-AP:0.9932, I-F1:0.9706, P-AUROC:0.9886, P-AP:0.5604, P-F1:0.6030, P-AUPRO:0.9540
Mean: I-Auroc:0.8923, I-AP:0.9028, I-F1:0.8544, P-AUROC:0.9603, P-AP:0.3804, P-F1:0.4437, P-AUPRO:0.8166
cuda:2
shots: 2
candle: I-Auroc:0.9626, I-AP:0.9641, I-F1:0.8962, P-AUROC:0.9867, P-AP:0.4278, P-F1:0.4845, P-AUPRO:0.9099
capsules: I-Auroc:0.9107, I-AP:0.9493, I-F1:0.8744, P-AUROC:0.9717, P-AP:0.3954, P-F1:0.4739, P-AUPRO:0.8116
cashew: I-Auroc:0.9306, I-AP:0.9646, I-F1:0.9208, P-AUROC:0.9836, P-AP:0.5677, P-F1:0.5460, P-AUPRO:0.9187
chewinggum: I-Auroc:0.9900, I-AP:0.9956, I-F1:0.9796, P-AUROC:0.9880, P-AP:0.6164, P-F1:0.6641, P-AUPRO:0.8858
fryum: I-Auroc:0.9180, I-AP:0.9644, I-F1:0.9016, P-AUROC:0.9206, P-AP:0.3654, P-F1:0.4212, P-AUPRO:0.7661
macaroni1: I-Auroc:0.8925, I-AP:0.9049, I-F1:0.8318, P-AUROC:0.9743, P-AP:0.2302, P-F1:0.3315, P-AUPRO:0.8669
macaroni2: I-Auroc:0.5942, I-AP:0.5389, I-F1:0.6833, P-AUROC:0.9045, P-AP:0.0311, P-F1:0.0997, P-AUPRO:0.7454
pcb1: I-Auroc:0.8492, I-AP:0.8198, I-F1:0.8145, P-AUROC:0.9759, P-AP:0.5610, P-F1:0.5551, P-AUPRO:0.7795
pcb2: I-Auroc:0.9088, I-AP:0.9041, I-F1:0.8387, P-AUROC:0.9514, P-AP:0.3682, P-F1:0.4660, P-AUPRO:0.7025
pcb3: I-Auroc:0.8954, I-AP:0.9005, I-F1:0.8235, P-AUROC:0.9657, P-AP:0.3754, P-F1:0.4505, P-AUPRO:0.7670
pcb4: I-Auroc:0.9660, I-AP:0.9521, I-F1:0.9458, P-AUROC:0.9507, P-AP:0.2393, P-F1:0.3215, P-AUPRO:0.8072
pipe_fryum: I-Auroc:0.9858, I-AP:0.9934, I-F1:0.9851, P-AUROC:0.9895, P-AP:0.5629, P-F1:0.6109, P-AUPRO:0.9572
Mean: I-Auroc:0.9003, I-AP:0.9043, I-F1:0.8746, P-AUROC:0.9635, P-AP:0.3951, P-F1:0.4521, P-AUPRO:0.8265
cuda:2
shots: 4
candle: I-Auroc:0.9808, I-AP:0.9810, I-F1:0.9307, P-AUROC:0.9885, P-AP:0.4322, P-F1:0.4902, P-AUPRO:0.9139
capsules: I-Auroc:0.8655, I-AP:0.9291, I-F1:0.8326, P-AUROC:0.9784, P-AP:0.5124, P-F1:0.5364, P-AUPRO:0.8288
cashew: I-Auroc:0.9564, I-AP:0.9782, I-F1:0.9340, P-AUROC:0.9852, P-AP:0.5837, P-F1:0.5627, P-AUPRO:0.9199
chewinggum: I-Auroc:0.9916, I-AP:0.9965, I-F1:0.9751, P-AUROC:0.9891, P-AP:0.6254, P-F1:0.6673, P-AUPRO:0.8888
fryum: I-Auroc:0.9394, I-AP:0.9722, I-F1:0.9158, P-AUROC:0.9271, P-AP:0.3785, P-F1:0.4363, P-AUPRO:0.7436
macaroni1: I-Auroc:0.9297, I-AP:0.9386, I-F1:0.8663, P-AUROC:0.9790, P-AP:0.2527, P-F1:0.3360, P-AUPRO:0.8918
macaroni2: I-Auroc:0.6281, I-AP:0.5850, I-F1:0.6828, P-AUROC:0.9205, P-AP:0.0473, P-F1:0.1310, P-AUPRO:0.7744
pcb1: I-Auroc:0.8625, I-AP:0.8258, I-F1:0.8384, P-AUROC:0.9827, P-AP:0.5883, P-F1:0.5793, P-AUPRO:0.8209
pcb2: I-Auroc:0.9258, I-AP:0.9230, I-F1:0.8677, P-AUROC:0.9550, P-AP:0.3738, P-F1:0.4797, P-AUPRO:0.7114
pcb3: I-Auroc:0.9300, I-AP:0.9343, I-F1:0.8597, P-AUROC:0.9729, P-AP:0.3984, P-F1:0.4690, P-AUPRO:0.8033
pcb4: I-Auroc:0.9675, I-AP:0.9628, I-F1:0.9268, P-AUROC:0.9645, P-AP:0.3469, P-F1:0.4183, P-AUPRO:0.8507
pipe_fryum: I-Auroc:0.9886, I-AP:0.9953, I-F1:0.9900, P-AUROC:0.9894, P-AP:0.5563, P-F1:0.6114, P-AUPRO:0.9540
Mean: I-Auroc:0.9138, I-AP:0.9185, I-F1:0.8850, P-AUROC:0.9694, P-AP:0.4247, P-F1:0.4765, P-AUPRO:0.8418



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14   (R256-C224)

cuda:3
shots: 1
candle: I-Auroc:0.9494, I-AP:0.9535, I-F1:0.8713, P-AUROC:0.9867, P-AP:0.4031, P-F1:0.4782, P-AUPRO:0.9090
capsules: I-Auroc:0.8788, I-AP:0.9235, I-F1:0.8598, P-AUROC:0.9613, P-AP:0.3073, P-F1:0.4003, P-AUPRO:0.7876
cashew: I-Auroc:0.9080, I-AP:0.9543, I-F1:0.9091, P-AUROC:0.9813, P-AP:0.5241, P-F1:0.5202, P-AUPRO:0.9145
chewinggum: I-Auroc:0.9738, I-AP:0.9893, I-F1:0.9596, P-AUROC:0.9881, P-AP:0.5462, P-F1:0.6412, P-AUPRO:0.8914
fryum: I-Auroc:0.9200, I-AP:0.9655, I-F1:0.9101, P-AUROC:0.9099, P-AP:0.3391, P-F1:0.3995, P-AUPRO:0.7710
macaroni1: I-Auroc:0.8816, I-AP:0.9082, I-F1:0.8081, P-AUROC:0.9684, P-AP:0.2267, P-F1:0.3232, P-AUPRO:0.8681
macaroni2: I-Auroc:0.6885, I-AP:0.6212, I-F1:0.7171, P-AUROC:0.9356, P-AP:0.0953, P-F1:0.1938, P-AUPRO:0.8451
pcb1: I-Auroc:0.7809, I-AP:0.7771, I-F1:0.7422, P-AUROC:0.9725, P-AP:0.5245, P-F1:0.5084, P-AUPRO:0.7779
pcb2: I-Auroc:0.8600, I-AP:0.8817, I-F1:0.8000, P-AUROC:0.9419, P-AP:0.3394, P-F1:0.4290, P-AUPRO:0.6768
pcb3: I-Auroc:0.8526, I-AP:0.8681, I-F1:0.7826, P-AUROC:0.9555, P-AP:0.3408, P-F1:0.4162, P-AUPRO:0.7221
pcb4: I-Auroc:0.9584, I-AP:0.9465, I-F1:0.9167, P-AUROC:0.9479, P-AP:0.2247, P-F1:0.2974, P-AUPRO:0.8039
pipe_fryum: I-Auroc:0.9738, I-AP:0.9866, I-F1:0.9612, P-AUROC:0.9852, P-AP:0.5030, P-F1:0.5478, P-AUPRO:0.9513
Mean: I-Auroc:0.8855, I-AP:0.8980, I-F1:0.8531, P-AUROC:0.9612, P-AP:0.3645, P-F1:0.4296, P-AUPRO:0.8266
cuda:3
shots: 2
candle: I-Auroc:0.9497, I-AP:0.9532, I-F1:0.8750, P-AUROC:0.9878, P-AP:0.4128, P-F1:0.4811, P-AUPRO:0.9131
capsules: I-Auroc:0.8950, I-AP:0.9347, I-F1:0.8815, P-AUROC:0.9684, P-AP:0.3595, P-F1:0.4389, P-AUPRO:0.7983
cashew: I-Auroc:0.9140, I-AP:0.9582, I-F1:0.9200, P-AUROC:0.9826, P-AP:0.5372, P-F1:0.5302, P-AUPRO:0.9223
chewinggum: I-Auroc:0.9874, I-AP:0.9944, I-F1:0.9694, P-AUROC:0.9885, P-AP:0.5861, P-F1:0.6500, P-AUPRO:0.8843
fryum: I-Auroc:0.9202, I-AP:0.9665, I-F1:0.9158, P-AUROC:0.9175, P-AP:0.3501, P-F1:0.4056, P-AUPRO:0.7748
macaroni1: I-Auroc:0.9169, I-AP:0.9324, I-F1:0.8437, P-AUROC:0.9748, P-AP:0.2368, P-F1:0.3386, P-AUPRO:0.8726
macaroni2: I-Auroc:0.5966, I-AP:0.5429, I-F1:0.6855, P-AUROC:0.9131, P-AP:0.0388, P-F1:0.1038, P-AUPRO:0.7729
pcb1: I-Auroc:0.8373, I-AP:0.8195, I-F1:0.7887, P-AUROC:0.9797, P-AP:0.5766, P-F1:0.5579, P-AUPRO:0.8247
pcb2: I-Auroc:0.9083, I-AP:0.9081, I-F1:0.8558, P-AUROC:0.9514, P-AP:0.3603, P-F1:0.4502, P-AUPRO:0.7212
pcb3: I-Auroc:0.9089, I-AP:0.9132, I-F1:0.8288, P-AUROC:0.9668, P-AP:0.3774, P-F1:0.4564, P-AUPRO:0.7815
pcb4: I-Auroc:0.9662, I-AP:0.9572, I-F1:0.9340, P-AUROC:0.9498, P-AP:0.2530, P-F1:0.3152, P-AUPRO:0.8119
pipe_fryum: I-Auroc:0.9776, I-AP:0.9883, I-F1:0.9802, P-AUROC:0.9869, P-AP:0.5134, P-F1:0.5638, P-AUPRO:0.9544
Mean: I-Auroc:0.8982, I-AP:0.9057, I-F1:0.8732, P-AUROC:0.9639, P-AP:0.3835, P-F1:0.4410, P-AUPRO:0.8360
cuda:3
shots: 4
candle: I-Auroc:0.9749, I-AP:0.9755, I-F1:0.9275, P-AUROC:0.9895, P-AP:0.4253, P-F1:0.4946, P-AUPRO:0.9184
capsules: I-Auroc:0.8437, I-AP:0.9125, I-F1:0.8223, P-AUROC:0.9764, P-AP:0.4875, P-F1:0.5277, P-AUPRO:0.8188
cashew: I-Auroc:0.9428, I-AP:0.9725, I-F1:0.9200, P-AUROC:0.9837, P-AP:0.5529, P-F1:0.5462, P-AUPRO:0.9296
chewinggum: I-Auroc:0.9890, I-AP:0.9954, I-F1:0.9749, P-AUROC:0.9893, P-AP:0.5955, P-F1:0.6472, P-AUPRO:0.8888
fryum: I-Auroc:0.9352, I-AP:0.9732, I-F1:0.9175, P-AUROC:0.9253, P-AP:0.3642, P-F1:0.4217, P-AUPRO:0.7647
macaroni1: I-Auroc:0.9455, I-AP:0.9532, I-F1:0.8763, P-AUROC:0.9789, P-AP:0.2564, P-F1:0.3482, P-AUPRO:0.9004
macaroni2: I-Auroc:0.6343, I-AP:0.5774, I-F1:0.6855, P-AUROC:0.9267, P-AP:0.0526, P-F1:0.1259, P-AUPRO:0.7966
pcb1: I-Auroc:0.8730, I-AP:0.8425, I-F1:0.8333, P-AUROC:0.9849, P-AP:0.6183, P-F1:0.5988, P-AUPRO:0.8470
pcb2: I-Auroc:0.9155, I-AP:0.9158, I-F1:0.8657, P-AUROC:0.9554, P-AP:0.3677, P-F1:0.4634, P-AUPRO:0.7209
pcb3: I-Auroc:0.9354, I-AP:0.9429, I-F1:0.8571, P-AUROC:0.9740, P-AP:0.3978, P-F1:0.4783, P-AUPRO:0.8094
pcb4: I-Auroc:0.9686, I-AP:0.9666, I-F1:0.9231, P-AUROC:0.9624, P-AP:0.3306, P-F1:0.3960, P-AUPRO:0.8451
pipe_fryum: I-Auroc:0.9880, I-AP:0.9954, I-F1:0.9798, P-AUROC:0.9873, P-AP:0.5089, P-F1:0.5710, P-AUPRO:0.9550
Mean: I-Auroc:0.9122, I-AP:0.9186, I-F1:0.8819, P-AUROC:0.9695, P-AP:0.4131, P-F1:0.4682, P-AUPRO:0.8496



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : beitv2_vit_base_16   (R256-C224)

cuda:3
shots: 1
candle: I-Auroc:0.9358, I-AP:0.9249, I-F1:0.8725, P-AUROC:0.9696, P-AP:0.2701, P-F1:0.3657, P-AUPRO:0.8497
capsules: I-Auroc:0.8422, I-AP:0.9151, I-F1:0.8235, P-AUROC:0.9372, P-AP:0.1881, P-F1:0.3334, P-AUPRO:0.6624
cashew: I-Auroc:0.9454, I-AP:0.9740, I-F1:0.9154, P-AUROC:0.9831, P-AP:0.5807, P-F1:0.5856, P-AUPRO:0.8441
chewinggum: I-Auroc:0.9824, I-AP:0.9924, I-F1:0.9645, P-AUROC:0.9838, P-AP:0.6567, P-F1:0.6649, P-AUPRO:0.8356
fryum: I-Auroc:0.8738, I-AP:0.9319, I-F1:0.8688, P-AUROC:0.8756, P-AP:0.2464, P-F1:0.3219, P-AUPRO:0.6058
macaroni1: I-Auroc:0.9001, I-AP:0.9206, I-F1:0.8458, P-AUROC:0.9384, P-AP:0.1695, P-F1:0.2901, P-AUPRO:0.7999
macaroni2: I-Auroc:0.6477, I-AP:0.5951, I-F1:0.6803, P-AUROC:0.8564, P-AP:0.0301, P-F1:0.0980, P-AUPRO:0.6491
pcb1: I-Auroc:0.6638, I-AP:0.6338, I-F1:0.6950, P-AUROC:0.9177, P-AP:0.2367, P-F1:0.3160, P-AUPRO:0.5412
pcb2: I-Auroc:0.8579, I-AP:0.8427, I-F1:0.8083, P-AUROC:0.8936, P-AP:0.1044, P-F1:0.2032, P-AUPRO:0.5491
pcb3: I-Auroc:0.8001, I-AP:0.8126, I-F1:0.7574, P-AUROC:0.8917, P-AP:0.1759, P-F1:0.2515, P-AUPRO:0.4646
pcb4: I-Auroc:0.8778, I-AP:0.8585, I-F1:0.8295, P-AUROC:0.9503, P-AP:0.2334, P-F1:0.3175, P-AUPRO:0.7746
pipe_fryum: I-Auroc:0.9976, I-AP:0.9988, I-F1:0.9852, P-AUROC:0.9869, P-AP:0.5091, P-F1:0.5800, P-AUPRO:0.9385
Mean: I-Auroc:0.8604, I-AP:0.8667, I-F1:0.8372, P-AUROC:0.9320, P-AP:0.2834, P-F1:0.3606, P-AUPRO:0.7096
cuda:3
shots: 2
candle: I-Auroc:0.9472, I-AP:0.9360, I-F1:0.8866, P-AUROC:0.9733, P-AP:0.2808, P-F1:0.3730, P-AUPRO:0.8671
capsules: I-Auroc:0.8430, I-AP:0.9178, I-F1:0.8235, P-AUROC:0.9446, P-AP:0.2082, P-F1:0.3480, P-AUPRO:0.6853
cashew: I-Auroc:0.9616, I-AP:0.9812, I-F1:0.9268, P-AUROC:0.9826, P-AP:0.5462, P-F1:0.5574, P-AUPRO:0.8613
chewinggum: I-Auroc:0.9848, I-AP:0.9934, I-F1:0.9648, P-AUROC:0.9836, P-AP:0.6585, P-F1:0.6633, P-AUPRO:0.8320
fryum: I-Auroc:0.8764, I-AP:0.9310, I-F1:0.8856, P-AUROC:0.8778, P-AP:0.2363, P-F1:0.3095, P-AUPRO:0.6185
macaroni1: I-Auroc:0.8848, I-AP:0.8988, I-F1:0.8137, P-AUROC:0.9417, P-AP:0.1396, P-F1:0.2694, P-AUPRO:0.8029
macaroni2: I-Auroc:0.6720, I-AP:0.6284, I-F1:0.6894, P-AUROC:0.8569, P-AP:0.0416, P-F1:0.1229, P-AUPRO:0.6515
pcb1: I-Auroc:0.6824, I-AP:0.6519, I-F1:0.6926, P-AUROC:0.9229, P-AP:0.2599, P-F1:0.3414, P-AUPRO:0.5600
pcb2: I-Auroc:0.8602, I-AP:0.8274, I-F1:0.8163, P-AUROC:0.8991, P-AP:0.0944, P-F1:0.1944, P-AUPRO:0.5356
pcb3: I-Auroc:0.8144, I-AP:0.8242, I-F1:0.7574, P-AUROC:0.9107, P-AP:0.2058, P-F1:0.2801, P-AUPRO:0.4996
pcb4: I-Auroc:0.8878, I-AP:0.8691, I-F1:0.8435, P-AUROC:0.9540, P-AP:0.2526, P-F1:0.3390, P-AUPRO:0.7827
pipe_fryum: I-Auroc:0.9986, I-AP:0.9993, I-F1:0.9901, P-AUROC:0.9878, P-AP:0.5155, P-F1:0.5909, P-AUPRO:0.9425
Mean: I-Auroc:0.8678, I-AP:0.8715, I-F1:0.8409, P-AUROC:0.9363, P-AP:0.2866, P-F1:0.3658, P-AUPRO:0.7199
cuda:3
shots: 4
candle: I-Auroc:0.9586, I-AP:0.9597, I-F1:0.8945, P-AUROC:0.9749, P-AP:0.3052, P-F1:0.3997, P-AUPRO:0.8685
capsules: I-Auroc:0.8492, I-AP:0.9243, I-F1:0.8211, P-AUROC:0.9505, P-AP:0.2750, P-F1:0.4088, P-AUPRO:0.6898
cashew: I-Auroc:0.9678, I-AP:0.9840, I-F1:0.9429, P-AUROC:0.9843, P-AP:0.5607, P-F1:0.5652, P-AUPRO:0.8755
chewinggum: I-Auroc:0.9938, I-AP:0.9970, I-F1:0.9746, P-AUROC:0.9847, P-AP:0.6713, P-F1:0.6734, P-AUPRO:0.8404
fryum: I-Auroc:0.8912, I-AP:0.9401, I-F1:0.8879, P-AUROC:0.8786, P-AP:0.2388, P-F1:0.3063, P-AUPRO:0.6282
macaroni1: I-Auroc:0.8746, I-AP:0.8891, I-F1:0.8038, P-AUROC:0.9500, P-AP:0.1545, P-F1:0.2850, P-AUPRO:0.8324
macaroni2: I-Auroc:0.6559, I-AP:0.5908, I-F1:0.6809, P-AUROC:0.8591, P-AP:0.0343, P-F1:0.1125, P-AUPRO:0.6586
pcb1: I-Auroc:0.6983, I-AP:0.6569, I-F1:0.7011, P-AUROC:0.9289, P-AP:0.2890, P-F1:0.3623, P-AUPRO:0.5585
pcb2: I-Auroc:0.8859, I-AP:0.8668, I-F1:0.8421, P-AUROC:0.9045, P-AP:0.0990, P-F1:0.1922, P-AUPRO:0.5385
pcb3: I-Auroc:0.8412, I-AP:0.8503, I-F1:0.7737, P-AUROC:0.9239, P-AP:0.2257, P-F1:0.2986, P-AUPRO:0.5394
pcb4: I-Auroc:0.8942, I-AP:0.8792, I-F1:0.8318, P-AUROC:0.9688, P-AP:0.3256, P-F1:0.3969, P-AUPRO:0.8280
pipe_fryum: I-Auroc:0.9986, I-AP:0.9993, I-F1:0.9901, P-AUROC:0.9878, P-AP:0.5130, P-F1:0.5952, P-AUPRO:0.9408
Mean: I-Auroc:0.8758, I-AP:0.8781, I-F1:0.8454, P-AUROC:0.9413, P-AP:0.3077, P-F1:0.3830, P-AUPRO:0.7332















-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14   默认：(R448-C392)
融合层的消融实验：interested_layers = [11]

cuda:2
shots: 1
candle: I-Auroc:0.9364, I-AP:0.9431, I-F1:0.8643, P-AUROC:0.9740, P-AP:0.3780, P-F1:0.4644, P-AUPRO:0.9147
capsules: I-Auroc:0.9167, I-AP:0.9483, I-F1:0.8986, P-AUROC:0.9463, P-AP:0.2158, P-F1:0.3049, P-AUPRO:0.8703
cashew: I-Auroc:0.9238, I-AP:0.9589, I-F1:0.9108, P-AUROC:0.9926, P-AP:0.6211, P-F1:0.6543, P-AUPRO:0.9444
chewinggum: I-Auroc:0.9710, I-AP:0.9883, I-F1:0.9529, P-AUROC:0.9916, P-AP:0.6220, P-F1:0.6728, P-AUPRO:0.8980
fryum: I-Auroc:0.9324, I-AP:0.9665, I-F1:0.9091, P-AUROC:0.8876, P-AP:0.2950, P-F1:0.3741, P-AUPRO:0.7840
macaroni1: I-Auroc:0.7694, I-AP:0.7688, I-F1:0.7468, P-AUROC:0.9732, P-AP:0.2375, P-F1:0.3381, P-AUPRO:0.8902
macaroni2: I-Auroc:0.5312, I-AP:0.4958, I-F1:0.6758, P-AUROC:0.9146, P-AP:0.0509, P-F1:0.1321, P-AUPRO:0.7749
pcb1: I-Auroc:0.8262, I-AP:0.8089, I-F1:0.7803, P-AUROC:0.9871, P-AP:0.7581, P-F1:0.7144, P-AUPRO:0.8346
pcb2: I-Auroc:0.8885, I-AP:0.8414, I-F1:0.8421, P-AUROC:0.9171, P-AP:0.2339, P-F1:0.3630, P-AUPRO:0.6013
pcb3: I-Auroc:0.7687, I-AP:0.7459, I-F1:0.7488, P-AUROC:0.9252, P-AP:0.1586, P-F1:0.2612, P-AUPRO:0.5997
pcb4: I-Auroc:0.9310, I-AP:0.9205, I-F1:0.8940, P-AUROC:0.8988, P-AP:0.1191, P-F1:0.1974, P-AUPRO:0.6859
pipe_fryum: I-Auroc:0.9206, I-AP:0.9602, I-F1:0.9036, P-AUROC:0.9858, P-AP:0.4585, P-F1:0.5220, P-AUPRO:0.9281
Mean: I-Auroc:0.8597, I-AP:0.8622, I-F1:0.8439, P-AUROC:0.9495, P-AP:0.3457, P-F1:0.4166, P-AUPRO:0.8105
cuda:2
shots: 2
candle: I-Auroc:0.9449, I-AP:0.9490, I-F1:0.8912, P-AUROC:0.9767, P-AP:0.3873, P-F1:0.4722, P-AUPRO:0.9093
capsules: I-Auroc:0.9325, I-AP:0.9570, I-F1:0.9187, P-AUROC:0.9579, P-AP:0.2579, P-F1:0.3354, P-AUPRO:0.8872
cashew: I-Auroc:0.9434, I-AP:0.9678, I-F1:0.9327, P-AUROC:0.9926, P-AP:0.6217, P-F1:0.6479, P-AUPRO:0.9471
chewinggum: I-Auroc:0.9732, I-AP:0.9890, I-F1:0.9534, P-AUROC:0.9917, P-AP:0.6229, P-F1:0.6711, P-AUPRO:0.8984
fryum: I-Auroc:0.9288, I-AP:0.9645, I-F1:0.8980, P-AUROC:0.9032, P-AP:0.3135, P-F1:0.3916, P-AUPRO:0.8003
macaroni1: I-Auroc:0.8780, I-AP:0.8854, I-F1:0.8279, P-AUROC:0.9816, P-AP:0.2671, P-F1:0.3636, P-AUPRO:0.9008
macaroni2: I-Auroc:0.5454, I-AP:0.5011, I-F1:0.6786, P-AUROC:0.9136, P-AP:0.0589, P-F1:0.1508, P-AUPRO:0.7570
pcb1: I-Auroc:0.8225, I-AP:0.8021, I-F1:0.7847, P-AUROC:0.9884, P-AP:0.7538, P-F1:0.7060, P-AUPRO:0.8514
pcb2: I-Auroc:0.9052, I-AP:0.8572, I-F1:0.8529, P-AUROC:0.9300, P-AP:0.2640, P-F1:0.3887, P-AUPRO:0.6427
pcb3: I-Auroc:0.8342, I-AP:0.8043, I-F1:0.8018, P-AUROC:0.9399, P-AP:0.2558, P-F1:0.3623, P-AUPRO:0.6478
pcb4: I-Auroc:0.9264, I-AP:0.9061, I-F1:0.8930, P-AUROC:0.9106, P-AP:0.1298, P-F1:0.2103, P-AUPRO:0.6923
pipe_fryum: I-Auroc:0.9336, I-AP:0.9655, I-F1:0.9208, P-AUROC:0.9865, P-AP:0.4611, P-F1:0.5262, P-AUPRO:0.9290
Mean: I-Auroc:0.8807, I-AP:0.8791, I-F1:0.8628, P-AUROC:0.9561, P-AP:0.3661, P-F1:0.4355, P-AUPRO:0.8219
cuda:2
shots: 4
candle: I-Auroc:0.9606, I-AP:0.9613, I-F1:0.9163, P-AUROC:0.9811, P-AP:0.4023, P-F1:0.4770, P-AUPRO:0.9162
capsules: I-Auroc:0.9403, I-AP:0.9616, I-F1:0.9091, P-AUROC:0.9663, P-AP:0.3761, P-F1:0.4180, P-AUPRO:0.9078
cashew: I-Auroc:0.9558, I-AP:0.9752, I-F1:0.9394, P-AUROC:0.9923, P-AP:0.6110, P-F1:0.6443, P-AUPRO:0.9486
chewinggum: I-Auroc:0.9792, I-AP:0.9913, I-F1:0.9637, P-AUROC:0.9923, P-AP:0.6298, P-F1:0.6718, P-AUPRO:0.9055
fryum: I-Auroc:0.9504, I-AP:0.9742, I-F1:0.9268, P-AUROC:0.9164, P-AP:0.3469, P-F1:0.4353, P-AUPRO:0.8098
macaroni1: I-Auroc:0.9056, I-AP:0.9045, I-F1:0.8505, P-AUROC:0.9864, P-AP:0.2804, P-F1:0.3702, P-AUPRO:0.9228
macaroni2: I-Auroc:0.5439, I-AP:0.5397, I-F1:0.6735, P-AUROC:0.9216, P-AP:0.1131, P-F1:0.2184, P-AUPRO:0.7816
pcb1: I-Auroc:0.8415, I-AP:0.8191, I-F1:0.8000, P-AUROC:0.9896, P-AP:0.7709, P-F1:0.7175, P-AUPRO:0.8598
pcb2: I-Auroc:0.9169, I-AP:0.8669, I-F1:0.8744, P-AUROC:0.9344, P-AP:0.2761, P-F1:0.4134, P-AUPRO:0.6436
pcb3: I-Auroc:0.8808, I-AP:0.8626, I-F1:0.8208, P-AUROC:0.9476, P-AP:0.2383, P-F1:0.3387, P-AUPRO:0.6808
pcb4: I-Auroc:0.8690, I-AP:0.8516, I-F1:0.8163, P-AUROC:0.9386, P-AP:0.1873, P-F1:0.2662, P-AUPRO:0.7728
pipe_fryum: I-Auroc:0.9728, I-AP:0.9871, I-F1:0.9417, P-AUROC:0.9872, P-AP:0.4523, P-F1:0.5397, P-AUPRO:0.9395
Mean: I-Auroc:0.8931, I-AP:0.8913, I-F1:0.8694, P-AUROC:0.9628, P-AP:0.3904, P-F1:0.4592, P-AUPRO:0.8407




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : dinov2reg_vit_base_14   默认：(R448-C392)
interested_layers = [2, 5, 8, 11]

cuda:4
shots: 1
candle: I-Auroc:0.9357, I-AP:0.9435, I-F1:0.8627, P-AUROC:0.9784, P-AP:0.3909, P-F1:0.4710, P-AUPRO:0.9219
capsules: I-Auroc:0.9330, I-AP:0.9568, I-F1:0.9065, P-AUROC:0.9560, P-AP:0.2503, P-F1:0.3374, P-AUPRO:0.8913
cashew: I-Auroc:0.9268, I-AP:0.9607, I-F1:0.9108, P-AUROC:0.9922, P-AP:0.6157, P-F1:0.6438, P-AUPRO:0.9516
chewinggum: I-Auroc:0.9748, I-AP:0.9897, I-F1:0.9538, P-AUROC:0.9923, P-AP:0.6368, P-F1:0.6845, P-AUPRO:0.9091
fryum: I-Auroc:0.9406, I-AP:0.9712, I-F1:0.9231, P-AUROC:0.9011, P-AP:0.3136, P-F1:0.3840, P-AUPRO:0.8226
macaroni1: I-Auroc:0.7992, I-AP:0.8020, I-F1:0.7586, P-AUROC:0.9810, P-AP:0.2554, P-F1:0.3502, P-AUPRO:0.9073
macaroni2: I-Auroc:0.5802, I-AP:0.5308, I-F1:0.6783, P-AUROC:0.9401, P-AP:0.0636, P-F1:0.1518, P-AUPRO:0.8270
pcb1: I-Auroc:0.8332, I-AP:0.8168, I-F1:0.7882, P-AUROC:0.9880, P-AP:0.7523, P-F1:0.7105, P-AUPRO:0.8545
pcb2: I-Auroc:0.8896, I-AP:0.8517, I-F1:0.8515, P-AUROC:0.9331, P-AP:0.2731, P-F1:0.3914, P-AUPRO:0.6480
pcb3: I-Auroc:0.7841, I-AP:0.7591, I-F1:0.7547, P-AUROC:0.9379, P-AP:0.1730, P-F1:0.2758, P-AUPRO:0.6471
pcb4: I-Auroc:0.9450, I-AP:0.9356, I-F1:0.9159, P-AUROC:0.9132, P-AP:0.1327, P-F1:0.2167, P-AUPRO:0.7260
pipe_fryum: I-Auroc:0.9288, I-AP:0.9646, I-F1:0.9154, P-AUROC:0.9863, P-AP:0.4691, P-F1:0.5290, P-AUPRO:0.9360
Mean: I-Auroc:0.8726, I-AP:0.8735, I-F1:0.8516, P-AUROC:0.9583, P-AP:0.3605, P-F1:0.4288, P-AUPRO:0.8369
cuda:4
shots: 2
candle: I-Auroc:0.9464, I-AP:0.9508, I-F1:0.8878, P-AUROC:0.9812, P-AP:0.3986, P-F1:0.4792, P-AUPRO:0.9225
capsules: I-Auroc:0.9438, I-AP:0.9638, I-F1:0.9268, P-AUROC:0.9658, P-AP:0.2902, P-F1:0.3625, P-AUPRO:0.9070
cashew: I-Auroc:0.9444, I-AP:0.9683, I-F1:0.9372, P-AUROC:0.9922, P-AP:0.6143, P-F1:0.6359, P-AUPRO:0.9540
chewinggum: I-Auroc:0.9758, I-AP:0.9899, I-F1:0.9538, P-AUROC:0.9924, P-AP:0.6388, P-F1:0.6833, P-AUPRO:0.9076
fryum: I-Auroc:0.9370, I-AP:0.9691, I-F1:0.9128, P-AUROC:0.9143, P-AP:0.3320, P-F1:0.4016, P-AUPRO:0.8316
macaroni1: I-Auroc:0.9155, I-AP:0.9189, I-F1:0.8657, P-AUROC:0.9873, P-AP:0.2842, P-F1:0.3718, P-AUPRO:0.9213
macaroni2: I-Auroc:0.6055, I-AP:0.5376, I-F1:0.6963, P-AUROC:0.9418, P-AP:0.0714, P-F1:0.1719, P-AUPRO:0.8301
pcb1: I-Auroc:0.8303, I-AP:0.8100, I-F1:0.7930, P-AUROC:0.9893, P-AP:0.7507, P-F1:0.7054, P-AUPRO:0.8673
pcb2: I-Auroc:0.9048, I-AP:0.8575, I-F1:0.8488, P-AUROC:0.9420, P-AP:0.3009, P-F1:0.4171, P-AUPRO:0.6730
pcb3: I-Auroc:0.8436, I-AP:0.8143, I-F1:0.8091, P-AUROC:0.9511, P-AP:0.2830, P-F1:0.3834, P-AUPRO:0.6996
pcb4: I-Auroc:0.9425, I-AP:0.9252, I-F1:0.9209, P-AUROC:0.9247, P-AP:0.1449, P-F1:0.2322, P-AUPRO:0.7459
pipe_fryum: I-Auroc:0.9432, I-AP:0.9711, I-F1:0.9293, P-AUROC:0.9870, P-AP:0.4720, P-F1:0.5326, P-AUPRO:0.9432
Mean: I-Auroc:0.8944, I-AP:0.8897, I-F1:0.8735, P-AUROC:0.9641, P-AP:0.3817, P-F1:0.4481, P-AUPRO:0.8502
cuda:4
shots: 4
candle: I-Auroc:0.9638, I-AP:0.9645, I-F1:0.9126, P-AUROC:0.9850, P-AP:0.4175, P-F1:0.4842, P-AUPRO:0.9247
capsules: I-Auroc:0.9565, I-AP:0.9712, I-F1:0.9268, P-AUROC:0.9730, P-AP:0.4108, P-F1:0.4452, P-AUPRO:0.9219
cashew: I-Auroc:0.9560, I-AP:0.9753, I-F1:0.9406, P-AUROC:0.9921, P-AP:0.6079, P-F1:0.6376, P-AUPRO:0.9597
chewinggum: I-Auroc:0.9826, I-AP:0.9926, I-F1:0.9637, P-AUROC:0.9929, P-AP:0.6407, P-F1:0.6815, P-AUPRO:0.9144
fryum: I-Auroc:0.9576, I-AP:0.9783, I-F1:0.9366, P-AUROC:0.9260, P-AP:0.3651, P-F1:0.4463, P-AUPRO:0.8436
macaroni1: I-Auroc:0.9407, I-AP:0.9387, I-F1:0.8804, P-AUROC:0.9902, P-AP:0.2996, P-F1:0.3807, P-AUPRO:0.9362
macaroni2: I-Auroc:0.6083, I-AP:0.5850, I-F1:0.6766, P-AUROC:0.9483, P-AP:0.1335, P-F1:0.2366, P-AUPRO:0.8341
pcb1: I-Auroc:0.8457, I-AP:0.8223, I-F1:0.8056, P-AUROC:0.9905, P-AP:0.7692, P-F1:0.7173, P-AUPRO:0.8792
pcb2: I-Auroc:0.9192, I-AP:0.8698, I-F1:0.8767, P-AUROC:0.9459, P-AP:0.3157, P-F1:0.4429, P-AUPRO:0.6807
pcb3: I-Auroc:0.8881, I-AP:0.8709, I-F1:0.8309, P-AUROC:0.9582, P-AP:0.2734, P-F1:0.3684, P-AUPRO:0.7199
pcb4: I-Auroc:0.8981, I-AP:0.8829, I-F1:0.8384, P-AUROC:0.9482, P-AP:0.2127, P-F1:0.2941, P-AUPRO:0.8171
pipe_fryum: I-Auroc:0.9814, I-AP:0.9914, I-F1:0.9510, P-AUROC:0.9879, P-AP:0.4694, P-F1:0.5532, P-AUPRO:0.9458
Mean: I-Auroc:0.9082, I-AP:0.9036, I-F1:0.8783, P-AUROC:0.9699, P-AP:0.4096, P-F1:0.4740, P-AUPRO:0.8648





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_base_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.9526, I-AP:0.9570, I-F1:0.8762, P-AUROC:0.9822, P-AP:0.3765, P-F1:0.4466, P-AUPRO:0.9010
capsules: I-Auroc:0.8953, I-AP:0.9463, I-F1:0.8646, P-AUROC:0.9631, P-AP:0.3062, P-F1:0.4263, P-AUPRO:0.7963
cashew: I-Auroc:0.9294, I-AP:0.9637, I-F1:0.9231, P-AUROC:0.9861, P-AP:0.5542, P-F1:0.5466, P-AUPRO:0.9292
chewinggum: I-Auroc:0.9830, I-AP:0.9923, I-F1:0.9596, P-AUROC:0.9883, P-AP:0.6007, P-F1:0.6356, P-AUPRO:0.8824
fryum: I-Auroc:0.9152, I-AP:0.9612, I-F1:0.8889, P-AUROC:0.9180, P-AP:0.3356, P-F1:0.4066, P-AUPRO:0.7466
macaroni1: I-Auroc:0.9120, I-AP:0.9332, I-F1:0.8473, P-AUROC:0.9715, P-AP:0.2190, P-F1:0.3182, P-AUPRO:0.8669
macaroni2: I-Auroc:0.7328, I-AP:0.6844, I-F1:0.7187, P-AUROC:0.9447, P-AP:0.1154, P-F1:0.2118, P-AUPRO:0.8478
pcb1: I-Auroc:0.7846, I-AP:0.7728, I-F1:0.7521, P-AUROC:0.9809, P-AP:0.5491, P-F1:0.5057, P-AUPRO:0.7998
pcb2: I-Auroc:0.8590, I-AP:0.8542, I-F1:0.8037, P-AUROC:0.9380, P-AP:0.2922, P-F1:0.4002, P-AUPRO:0.6902
pcb3: I-Auroc:0.8270, I-AP:0.8373, I-F1:0.7679, P-AUROC:0.9523, P-AP:0.3003, P-F1:0.3868, P-AUPRO:0.6831
pcb4: I-Auroc:0.9346, I-AP:0.9110, I-F1:0.9159, P-AUROC:0.9494, P-AP:0.2080, P-F1:0.3020, P-AUPRO:0.7997
pipe_fryum: I-Auroc:0.9820, I-AP:0.9918, I-F1:0.9700, P-AUROC:0.9902, P-AP:0.6002, P-F1:0.6245, P-AUPRO:0.9528
Mean: I-Auroc:0.8923, I-AP:0.9004, I-F1:0.8573, P-AUROC:0.9637, P-AP:0.3714, P-F1:0.4342, P-AUPRO:0.8246
cuda:4
shots: 2
candle: I-Auroc:0.9602, I-AP:0.9647, I-F1:0.8945, P-AUROC:0.9849, P-AP:0.3918, P-F1:0.4566, P-AUPRO:0.9067
capsules: I-Auroc:0.8983, I-AP:0.9470, I-F1:0.8657, P-AUROC:0.9709, P-AP:0.3527, P-F1:0.4482, P-AUPRO:0.8081
cashew: I-Auroc:0.9362, I-AP:0.9676, I-F1:0.9126, P-AUROC:0.9870, P-AP:0.5509, P-F1:0.5410, P-AUPRO:0.9379
chewinggum: I-Auroc:0.9902, I-AP:0.9954, I-F1:0.9641, P-AUROC:0.9882, P-AP:0.6132, P-F1:0.6362, P-AUPRO:0.8696
fryum: I-Auroc:0.9070, I-AP:0.9577, I-F1:0.9005, P-AUROC:0.9259, P-AP:0.3478, P-F1:0.4141, P-AUPRO:0.7416
macaroni1: I-Auroc:0.9301, I-AP:0.9448, I-F1:0.8768, P-AUROC:0.9770, P-AP:0.2155, P-F1:0.3218, P-AUPRO:0.8773
macaroni2: I-Auroc:0.6433, I-AP:0.5991, I-F1:0.6842, P-AUROC:0.9357, P-AP:0.0689, P-F1:0.1534, P-AUPRO:0.7998
pcb1: I-Auroc:0.8343, I-AP:0.8103, I-F1:0.7767, P-AUROC:0.9859, P-AP:0.6212, P-F1:0.5860, P-AUPRO:0.8483
pcb2: I-Auroc:0.9038, I-AP:0.8741, I-F1:0.8670, P-AUROC:0.9499, P-AP:0.3001, P-F1:0.4088, P-AUPRO:0.7216
pcb3: I-Auroc:0.8621, I-AP:0.8664, I-F1:0.8103, P-AUROC:0.9629, P-AP:0.3411, P-F1:0.4244, P-AUPRO:0.7396
pcb4: I-Auroc:0.9461, I-AP:0.9245, I-F1:0.9268, P-AUROC:0.9540, P-AP:0.2397, P-F1:0.3312, P-AUPRO:0.8140
pipe_fryum: I-Auroc:0.9846, I-AP:0.9933, I-F1:0.9802, P-AUROC:0.9906, P-AP:0.5946, P-F1:0.6292, P-AUPRO:0.9549
Mean: I-Auroc:0.8997, I-AP:0.9037, I-F1:0.8716, P-AUROC:0.9677, P-AP:0.3865, P-F1:0.4459, P-AUPRO:0.8349
cuda:4
shots: 4
candle: I-Auroc:0.9742, I-AP:0.9773, I-F1:0.9231, P-AUROC:0.9868, P-AP:0.4060, P-F1:0.4637, P-AUPRO:0.9140
capsules: I-Auroc:0.8853, I-AP:0.9400, I-F1:0.8528, P-AUROC:0.9770, P-AP:0.4901, P-F1:0.5182, P-AUPRO:0.8175
cashew: I-Auroc:0.9574, I-AP:0.9779, I-F1:0.9360, P-AUROC:0.9887, P-AP:0.5792, P-F1:0.5698, P-AUPRO:0.9454
chewinggum: I-Auroc:0.9924, I-AP:0.9966, I-F1:0.9751, P-AUROC:0.9896, P-AP:0.6237, P-F1:0.6391, P-AUPRO:0.8829
fryum: I-Auroc:0.9316, I-AP:0.9692, I-F1:0.9119, P-AUROC:0.9357, P-AP:0.3721, P-F1:0.4429, P-AUPRO:0.7400
macaroni1: I-Auroc:0.9404, I-AP:0.9493, I-F1:0.8643, P-AUROC:0.9818, P-AP:0.2249, P-F1:0.3195, P-AUPRO:0.8998
macaroni2: I-Auroc:0.7176, I-AP:0.6548, I-F1:0.7149, P-AUROC:0.9483, P-AP:0.0864, P-F1:0.1807, P-AUPRO:0.8360
pcb1: I-Auroc:0.8519, I-AP:0.8163, I-F1:0.8148, P-AUROC:0.9892, P-AP:0.6438, P-F1:0.6139, P-AUPRO:0.8808
pcb2: I-Auroc:0.9138, I-AP:0.8899, I-F1:0.8856, P-AUROC:0.9545, P-AP:0.3035, P-F1:0.4206, P-AUPRO:0.7310
pcb3: I-Auroc:0.9155, I-AP:0.9149, I-F1:0.8636, P-AUROC:0.9700, P-AP:0.3786, P-F1:0.4577, P-AUPRO:0.7690
pcb4: I-Auroc:0.9603, I-AP:0.9563, I-F1:0.9065, P-AUROC:0.9676, P-AP:0.3452, P-F1:0.4225, P-AUPRO:0.8579
pipe_fryum: I-Auroc:0.9884, I-AP:0.9956, I-F1:0.9851, P-AUROC:0.9903, P-AP:0.5730, P-F1:0.6252, P-AUPRO:0.9553
Mean: I-Auroc:0.9191, I-AP:0.9198, I-F1:0.8861, P-AUROC:0.9733, P-AP:0.4189, P-F1:0.4728, P-AUPRO:0.8525




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_small_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.9517, I-AP:0.9577, I-F1:0.8934, P-AUROC:0.9790, P-AP:0.3484, P-F1:0.4211, P-AUPRO:0.8833
capsules: I-Auroc:0.8615, I-AP:0.9240, I-F1:0.8454, P-AUROC:0.9433, P-AP:0.2872, P-F1:0.4135, P-AUPRO:0.7525
cashew: I-Auroc:0.9122, I-AP:0.9558, I-F1:0.8922, P-AUROC:0.9847, P-AP:0.5464, P-F1:0.5554, P-AUPRO:0.9264
chewinggum: I-Auroc:0.9794, I-AP:0.9913, I-F1:0.9588, P-AUROC:0.9848, P-AP:0.5923, P-F1:0.6475, P-AUPRO:0.8519
fryum: I-Auroc:0.8932, I-AP:0.9523, I-F1:0.8731, P-AUROC:0.9163, P-AP:0.3316, P-F1:0.3999, P-AUPRO:0.7389
macaroni1: I-Auroc:0.8834, I-AP:0.9035, I-F1:0.8119, P-AUROC:0.9647, P-AP:0.1726, P-F1:0.2752, P-AUPRO:0.8562
macaroni2: I-Auroc:0.6640, I-AP:0.6272, I-F1:0.6765, P-AUROC:0.9363, P-AP:0.0692, P-F1:0.1744, P-AUPRO:0.8245
pcb1: I-Auroc:0.8038, I-AP:0.8000, I-F1:0.7462, P-AUROC:0.9801, P-AP:0.6381, P-F1:0.6117, P-AUPRO:0.7987
pcb2: I-Auroc:0.8203, I-AP:0.8433, I-F1:0.7757, P-AUROC:0.9277, P-AP:0.2815, P-F1:0.3572, P-AUPRO:0.6549
pcb3: I-Auroc:0.7956, I-AP:0.8097, I-F1:0.7510, P-AUROC:0.9381, P-AP:0.2421, P-F1:0.3408, P-AUPRO:0.6513
pcb4: I-Auroc:0.9472, I-AP:0.9413, I-F1:0.8889, P-AUROC:0.9408, P-AP:0.1946, P-F1:0.2927, P-AUPRO:0.7871
pipe_fryum: I-Auroc:0.9824, I-AP:0.9919, I-F1:0.9802, P-AUROC:0.9900, P-AP:0.5848, P-F1:0.6318, P-AUPRO:0.9577
Mean: I-Auroc:0.8746, I-AP:0.8915, I-F1:0.8411, P-AUROC:0.9572, P-AP:0.3574, P-F1:0.4268, P-AUPRO:0.8069
cuda:4
shots: 2
candle: I-Auroc:0.9513, I-AP:0.9572, I-F1:0.8900, P-AUROC:0.9813, P-AP:0.3783, P-F1:0.4483, P-AUPRO:0.8895
capsules: I-Auroc:0.8657, I-AP:0.9250, I-F1:0.8333, P-AUROC:0.9515, P-AP:0.3407, P-F1:0.4542, P-AUPRO:0.7511
cashew: I-Auroc:0.9292, I-AP:0.9643, I-F1:0.9064, P-AUROC:0.9862, P-AP:0.5551, P-F1:0.5592, P-AUPRO:0.9314
chewinggum: I-Auroc:0.9806, I-AP:0.9917, I-F1:0.9600, P-AUROC:0.9848, P-AP:0.6089, P-F1:0.6560, P-AUPRO:0.8385
fryum: I-Auroc:0.8912, I-AP:0.9518, I-F1:0.8800, P-AUROC:0.9206, P-AP:0.3329, P-F1:0.3932, P-AUPRO:0.7349
macaroni1: I-Auroc:0.8970, I-AP:0.9211, I-F1:0.8300, P-AUROC:0.9686, P-AP:0.1737, P-F1:0.2885, P-AUPRO:0.8478
macaroni2: I-Auroc:0.6433, I-AP:0.6082, I-F1:0.6781, P-AUROC:0.9322, P-AP:0.0577, P-F1:0.1335, P-AUPRO:0.8064
pcb1: I-Auroc:0.8186, I-AP:0.8117, I-F1:0.7523, P-AUROC:0.9841, P-AP:0.6606, P-F1:0.6248, P-AUPRO:0.8364
pcb2: I-Auroc:0.8705, I-AP:0.8781, I-F1:0.8020, P-AUROC:0.9404, P-AP:0.3201, P-F1:0.4115, P-AUPRO:0.6842
pcb3: I-Auroc:0.8414, I-AP:0.8489, I-F1:0.7866, P-AUROC:0.9533, P-AP:0.3271, P-F1:0.4033, P-AUPRO:0.7203
pcb4: I-Auroc:0.9491, I-AP:0.9391, I-F1:0.9048, P-AUROC:0.9456, P-AP:0.2251, P-F1:0.3148, P-AUPRO:0.7967
pipe_fryum: I-Auroc:0.9878, I-AP:0.9944, I-F1:0.9802, P-AUROC:0.9902, P-AP:0.5847, P-F1:0.6365, P-AUPRO:0.9595
Mean: I-Auroc:0.8855, I-AP:0.8993, I-F1:0.8503, P-AUROC:0.9616, P-AP:0.3804, P-F1:0.4437, P-AUPRO:0.8164
cuda:4
shots: 4
candle: I-Auroc:0.9606, I-AP:0.9650, I-F1:0.9137, P-AUROC:0.9838, P-AP:0.3991, P-F1:0.4602, P-AUPRO:0.8936
capsules: I-Auroc:0.8268, I-AP:0.9042, I-F1:0.8173, P-AUROC:0.9621, P-AP:0.4374, P-F1:0.5078, P-AUPRO:0.7529
cashew: I-Auroc:0.9350, I-AP:0.9657, I-F1:0.9135, P-AUROC:0.9874, P-AP:0.5742, P-F1:0.5741, P-AUPRO:0.9317
chewinggum: I-Auroc:0.9822, I-AP:0.9924, I-F1:0.9744, P-AUROC:0.9856, P-AP:0.6221, P-F1:0.6574, P-AUPRO:0.8477
fryum: I-Auroc:0.9158, I-AP:0.9632, I-F1:0.9005, P-AUROC:0.9322, P-AP:0.3608, P-F1:0.4265, P-AUPRO:0.7474
macaroni1: I-Auroc:0.9140, I-AP:0.9244, I-F1:0.8545, P-AUROC:0.9743, P-AP:0.1964, P-F1:0.3043, P-AUPRO:0.8830
macaroni2: I-Auroc:0.7062, I-AP:0.6467, I-F1:0.7160, P-AUROC:0.9418, P-AP:0.0715, P-F1:0.1583, P-AUPRO:0.8256
pcb1: I-Auroc:0.8644, I-AP:0.8365, I-F1:0.8357, P-AUROC:0.9877, P-AP:0.6882, P-F1:0.6483, P-AUPRO:0.8532
pcb2: I-Auroc:0.8857, I-AP:0.8948, I-F1:0.8302, P-AUROC:0.9482, P-AP:0.3345, P-F1:0.4324, P-AUPRO:0.6976
pcb3: I-Auroc:0.8844, I-AP:0.8876, I-F1:0.8056, P-AUROC:0.9620, P-AP:0.3697, P-F1:0.4437, P-AUPRO:0.7385
pcb4: I-Auroc:0.9521, I-AP:0.9477, I-F1:0.9014, P-AUROC:0.9613, P-AP:0.3350, P-F1:0.4118, P-AUPRO:0.8417
pipe_fryum: I-Auroc:0.9896, I-AP:0.9959, I-F1:0.9849, P-AUROC:0.9900, P-AP:0.5705, P-F1:0.6300, P-AUPRO:0.9575
Mean: I-Auroc:0.9014, I-AP:0.9103, I-F1:0.8706, P-AUROC:0.9680, P-AP:0.4133, P-F1:0.4712, P-AUPRO:0.8308






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_large_14   默认：(R256-C224)
interested_layers = list(range(4, 19))

cuda:4
shots: 1
candle: I-Auroc:0.9625, I-AP:0.9678, I-F1:0.8925, P-AUROC:0.9844, P-AP:0.3958, P-F1:0.4571, P-AUPRO:0.9046
capsules: I-Auroc:0.9100, I-AP:0.9488, I-F1:0.8713, P-AUROC:0.9607, P-AP:0.3308, P-F1:0.4314, P-AUPRO:0.8341
cashew: I-Auroc:0.9370, I-AP:0.9696, I-F1:0.9293, P-AUROC:0.9826, P-AP:0.5381, P-F1:0.5430, P-AUPRO:0.9302
chewinggum: I-Auroc:0.9776, I-AP:0.9902, I-F1:0.9495, P-AUROC:0.9876, P-AP:0.6157, P-F1:0.6702, P-AUPRO:0.8878
fryum: I-Auroc:0.9190, I-AP:0.9644, I-F1:0.8995, P-AUROC:0.8959, P-AP:0.3242, P-F1:0.3814, P-AUPRO:0.7514
macaroni1: I-Auroc:0.8582, I-AP:0.8861, I-F1:0.7767, P-AUROC:0.9727, P-AP:0.2047, P-F1:0.3034, P-AUPRO:0.8792
macaroni2: I-Auroc:0.6445, I-AP:0.5997, I-F1:0.6780, P-AUROC:0.9183, P-AP:0.0746, P-F1:0.1652, P-AUPRO:0.8078
pcb1: I-Auroc:0.8164, I-AP:0.8055, I-F1:0.7627, P-AUROC:0.9718, P-AP:0.5798, P-F1:0.5627, P-AUPRO:0.7699
pcb2: I-Auroc:0.8850, I-AP:0.8924, I-F1:0.8432, P-AUROC:0.9369, P-AP:0.3395, P-F1:0.4402, P-AUPRO:0.6798
pcb3: I-Auroc:0.8436, I-AP:0.8526, I-F1:0.7679, P-AUROC:0.9517, P-AP:0.3413, P-F1:0.4031, P-AUPRO:0.6903
pcb4: I-Auroc:0.9782, I-AP:0.9742, I-F1:0.9384, P-AUROC:0.9556, P-AP:0.2598, P-F1:0.3472, P-AUPRO:0.8201
pipe_fryum: I-Auroc:0.9842, I-AP:0.9927, I-F1:0.9754, P-AUROC:0.9874, P-AP:0.5308, P-F1:0.5950, P-AUPRO:0.9553
Mean: I-Auroc:0.8930, I-AP:0.9037, I-F1:0.8570, P-AUROC:0.9588, P-AP:0.3779, P-F1:0.4417, P-AUPRO:0.8259
cuda:4
shots: 2
candle: I-Auroc:0.9700, I-AP:0.9732, I-F1:0.9045, P-AUROC:0.9868, P-AP:0.4263, P-F1:0.4830, P-AUPRO:0.9167
capsules: I-Auroc:0.9255, I-AP:0.9550, I-F1:0.9082, P-AUROC:0.9693, P-AP:0.3609, P-F1:0.4447, P-AUPRO:0.8535
cashew: I-Auroc:0.9534, I-AP:0.9774, I-F1:0.9340, P-AUROC:0.9843, P-AP:0.5518, P-F1:0.5542, P-AUPRO:0.9376
chewinggum: I-Auroc:0.9884, I-AP:0.9948, I-F1:0.9691, P-AUROC:0.9880, P-AP:0.6374, P-F1:0.6768, P-AUPRO:0.8811
fryum: I-Auroc:0.9208, I-AP:0.9659, I-F1:0.8995, P-AUROC:0.9045, P-AP:0.3344, P-F1:0.3899, P-AUPRO:0.7606
macaroni1: I-Auroc:0.9086, I-AP:0.9187, I-F1:0.8273, P-AUROC:0.9771, P-AP:0.2041, P-F1:0.3134, P-AUPRO:0.8858
macaroni2: I-Auroc:0.6131, I-AP:0.5715, I-F1:0.6751, P-AUROC:0.9113, P-AP:0.0586, P-F1:0.1423, P-AUPRO:0.7770
pcb1: I-Auroc:0.8506, I-AP:0.8301, I-F1:0.8093, P-AUROC:0.9759, P-AP:0.5861, P-F1:0.5769, P-AUPRO:0.8073
pcb2: I-Auroc:0.9229, I-AP:0.8996, I-F1:0.8670, P-AUROC:0.9462, P-AP:0.3390, P-F1:0.4480, P-AUPRO:0.7135
pcb3: I-Auroc:0.9000, I-AP:0.8963, I-F1:0.8312, P-AUROC:0.9659, P-AP:0.3884, P-F1:0.4432, P-AUPRO:0.7643
pcb4: I-Auroc:0.9799, I-AP:0.9758, I-F1:0.9434, P-AUROC:0.9591, P-AP:0.2748, P-F1:0.3654, P-AUPRO:0.8311
pipe_fryum: I-Auroc:0.9870, I-AP:0.9937, I-F1:0.9851, P-AUROC:0.9886, P-AP:0.5383, P-F1:0.6028, P-AUPRO:0.9583
Mean: I-Auroc:0.9100, I-AP:0.9127, I-F1:0.8795, P-AUROC:0.9631, P-AP:0.3917, P-F1:0.4534, P-AUPRO:0.8406
cuda:4
shots: 4
candle: I-Auroc:0.9751, I-AP:0.9774, I-F1:0.9293, P-AUROC:0.9883, P-AP:0.4390, P-F1:0.4908, P-AUPRO:0.9222
capsules: I-Auroc:0.8957, I-AP:0.9406, I-F1:0.8598, P-AUROC:0.9786, P-AP:0.4848, P-F1:0.5195, P-AUPRO:0.8686
cashew: I-Auroc:0.9702, I-AP:0.9857, I-F1:0.9495, P-AUROC:0.9853, P-AP:0.5690, P-F1:0.5688, P-AUPRO:0.9380
chewinggum: I-Auroc:0.9928, I-AP:0.9968, I-F1:0.9751, P-AUROC:0.9891, P-AP:0.6414, P-F1:0.6788, P-AUPRO:0.8917
fryum: I-Auroc:0.9408, I-AP:0.9743, I-F1:0.9286, P-AUROC:0.9090, P-AP:0.3410, P-F1:0.3979, P-AUPRO:0.7432
macaroni1: I-Auroc:0.9409, I-AP:0.9508, I-F1:0.8691, P-AUROC:0.9808, P-AP:0.2291, P-F1:0.3199, P-AUPRO:0.8959
macaroni2: I-Auroc:0.6306, I-AP:0.5807, I-F1:0.6901, P-AUROC:0.9266, P-AP:0.0661, P-F1:0.1503, P-AUPRO:0.8032
pcb1: I-Auroc:0.8697, I-AP:0.8422, I-F1:0.8190, P-AUROC:0.9832, P-AP:0.6152, P-F1:0.6005, P-AUPRO:0.8400
pcb2: I-Auroc:0.9285, I-AP:0.9171, I-F1:0.8763, P-AUROC:0.9513, P-AP:0.3616, P-F1:0.4677, P-AUPRO:0.7168
pcb3: I-Auroc:0.9311, I-AP:0.9345, I-F1:0.8660, P-AUROC:0.9718, P-AP:0.4234, P-F1:0.4794, P-AUPRO:0.7885
pcb4: I-Auroc:0.9764, I-AP:0.9720, I-F1:0.9458, P-AUROC:0.9707, P-AP:0.4040, P-F1:0.4608, P-AUPRO:0.8691
pipe_fryum: I-Auroc:0.9942, I-AP:0.9978, I-F1:0.9950, P-AUROC:0.9888, P-AP:0.5324, P-F1:0.6080, P-AUPRO:0.9606
Mean: I-Auroc:0.9205, I-AP:0.9225, I-F1:0.8920, P-AUROC:0.9686, P-AP:0.4256, P-F1:0.4785, P-AUPRO:0.8532





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_proteus_vit_base_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.9644, I-AP:0.9640, I-F1:0.9074, P-AUROC:0.9826, P-AP:0.3701, P-F1:0.4487, P-AUPRO:0.8917
capsules: I-Auroc:0.7652, I-AP:0.8710, I-F1:0.7822, P-AUROC:0.9408, P-AP:0.2868, P-F1:0.3669, P-AUPRO:0.7467
cashew: I-Auroc:0.9518, I-AP:0.9776, I-F1:0.9340, P-AUROC:0.9793, P-AP:0.5731, P-F1:0.5877, P-AUPRO:0.9343
chewinggum: I-Auroc:0.9776, I-AP:0.9906, I-F1:0.9529, P-AUROC:0.9861, P-AP:0.6895, P-F1:0.6940, P-AUPRO:0.8877
fryum: I-Auroc:0.8446, I-AP:0.9330, I-F1:0.8387, P-AUROC:0.9297, P-AP:0.3689, P-F1:0.3987, P-AUPRO:0.7618
macaroni1: I-Auroc:0.8527, I-AP:0.8719, I-F1:0.7739, P-AUROC:0.9686, P-AP:0.1776, P-F1:0.2952, P-AUPRO:0.8557
macaroni2: I-Auroc:0.5892, I-AP:0.5573, I-F1:0.6786, P-AUROC:0.9340, P-AP:0.0606, P-F1:0.1476, P-AUPRO:0.8258
pcb1: I-Auroc:0.7438, I-AP:0.7496, I-F1:0.7213, P-AUROC:0.9656, P-AP:0.6256, P-F1:0.6131, P-AUPRO:0.6661
pcb2: I-Auroc:0.7737, I-AP:0.8117, I-F1:0.7165, P-AUROC:0.9116, P-AP:0.2950, P-F1:0.3734, P-AUPRO:0.5980
pcb3: I-Auroc:0.8060, I-AP:0.8225, I-F1:0.7705, P-AUROC:0.9453, P-AP:0.3020, P-F1:0.3831, P-AUPRO:0.6751
pcb4: I-Auroc:0.9610, I-AP:0.9485, I-F1:0.9346, P-AUROC:0.9286, P-AP:0.1729, P-F1:0.2560, P-AUPRO:0.7578
pipe_fryum: I-Auroc:0.9904, I-AP:0.9963, I-F1:0.9849, P-AUROC:0.9893, P-AP:0.6303, P-F1:0.6613, P-AUPRO:0.9568
Mean: I-Auroc:0.8517, I-AP:0.8745, I-F1:0.8330, P-AUROC:0.9551, P-AP:0.3794, P-F1:0.4355, P-AUPRO:0.7964
cuda:4
shots: 2
candle: I-Auroc:0.9658, I-AP:0.9665, I-F1:0.9048, P-AUROC:0.9850, P-AP:0.3865, P-F1:0.4573, P-AUPRO:0.9063
capsules: I-Auroc:0.8548, I-AP:0.9236, I-F1:0.8341, P-AUROC:0.9527, P-AP:0.3670, P-F1:0.4490, P-AUPRO:0.7850
cashew: I-Auroc:0.9686, I-AP:0.9848, I-F1:0.9515, P-AUROC:0.9834, P-AP:0.5985, P-F1:0.6020, P-AUPRO:0.9421
chewinggum: I-Auroc:0.9820, I-AP:0.9923, I-F1:0.9645, P-AUROC:0.9850, P-AP:0.6970, P-F1:0.7017, P-AUPRO:0.8638
fryum: I-Auroc:0.8406, I-AP:0.9297, I-F1:0.8354, P-AUROC:0.9307, P-AP:0.3701, P-F1:0.3961, P-AUPRO:0.7675
macaroni1: I-Auroc:0.8383, I-AP:0.8491, I-F1:0.7778, P-AUROC:0.9725, P-AP:0.1401, P-F1:0.2624, P-AUPRO:0.8626
macaroni2: I-Auroc:0.6181, I-AP:0.5775, I-F1:0.6829, P-AUROC:0.9332, P-AP:0.0519, P-F1:0.1428, P-AUPRO:0.7975
pcb1: I-Auroc:0.7751, I-AP:0.7763, I-F1:0.7315, P-AUROC:0.9704, P-AP:0.6358, P-F1:0.6190, P-AUPRO:0.7172
pcb2: I-Auroc:0.8348, I-AP:0.8464, I-F1:0.7611, P-AUROC:0.9268, P-AP:0.3184, P-F1:0.4037, P-AUPRO:0.6144
pcb3: I-Auroc:0.8419, I-AP:0.8454, I-F1:0.7911, P-AUROC:0.9596, P-AP:0.3381, P-F1:0.4061, P-AUPRO:0.7499
pcb4: I-Auroc:0.9678, I-AP:0.9599, I-F1:0.9346, P-AUROC:0.9346, P-AP:0.1958, P-F1:0.2819, P-AUPRO:0.7685
pipe_fryum: I-Auroc:0.9926, I-AP:0.9969, I-F1:0.9851, P-AUROC:0.9904, P-AP:0.6424, P-F1:0.6705, P-AUPRO:0.9581
Mean: I-Auroc:0.8734, I-AP:0.8874, I-F1:0.8462, P-AUROC:0.9603, P-AP:0.3951, P-F1:0.4494, P-AUPRO:0.8111
cuda:4
shots: 4
candle: I-Auroc:0.9659, I-AP:0.9649, I-F1:0.9073, P-AUROC:0.9867, P-AP:0.3945, P-F1:0.4700, P-AUPRO:0.9095
capsules: I-Auroc:0.8285, I-AP:0.9137, I-F1:0.8128, P-AUROC:0.9665, P-AP:0.4524, P-F1:0.5073, P-AUPRO:0.8096
cashew: I-Auroc:0.9670, I-AP:0.9843, I-F1:0.9406, P-AUROC:0.9830, P-AP:0.6047, P-F1:0.6113, P-AUPRO:0.9322
chewinggum: I-Auroc:0.9858, I-AP:0.9938, I-F1:0.9694, P-AUROC:0.9863, P-AP:0.7016, P-F1:0.7086, P-AUPRO:0.8685
fryum: I-Auroc:0.9256, I-AP:0.9683, I-F1:0.8995, P-AUROC:0.9428, P-AP:0.4255, P-F1:0.4577, P-AUPRO:0.8091
macaroni1: I-Auroc:0.8909, I-AP:0.9046, I-F1:0.8205, P-AUROC:0.9814, P-AP:0.1878, P-F1:0.3094, P-AUPRO:0.9012
macaroni2: I-Auroc:0.6608, I-AP:0.6177, I-F1:0.6984, P-AUROC:0.9434, P-AP:0.0722, P-F1:0.1692, P-AUPRO:0.8214
pcb1: I-Auroc:0.8406, I-AP:0.8246, I-F1:0.8113, P-AUROC:0.9821, P-AP:0.6799, P-F1:0.6405, P-AUPRO:0.7934
pcb2: I-Auroc:0.8706, I-AP:0.8827, I-F1:0.7967, P-AUROC:0.9340, P-AP:0.3503, P-F1:0.4373, P-AUPRO:0.6365
pcb3: I-Auroc:0.8667, I-AP:0.8801, I-F1:0.7837, P-AUROC:0.9668, P-AP:0.3946, P-F1:0.4564, P-AUPRO:0.7809
pcb4: I-Auroc:0.9506, I-AP:0.9462, I-F1:0.8910, P-AUROC:0.9559, P-AP:0.3149, P-F1:0.3710, P-AUPRO:0.8142
pipe_fryum: I-Auroc:0.9940, I-AP:0.9977, I-F1:0.9950, P-AUROC:0.9909, P-AP:0.6470, P-F1:0.6769, P-AUPRO:0.9613
Mean: I-Auroc:0.8956, I-AP:0.9065, I-F1:0.8605, P-AUROC:0.9683, P-AP:0.4354, P-F1:0.4846, P-AUPRO:0.8365





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : CLIP_proteus_vit_base_14   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.7301, I-AP:0.6989, I-F1:0.7244, P-AUROC:0.6594, P-AP:0.0044, P-F1:0.0111, P-AUPRO:0.2354
capsules: I-Auroc:0.7480, I-AP:0.8228, I-F1:0.8087, P-AUROC:0.7272, P-AP:0.0109, P-F1:0.0262, P-AUPRO:0.2583
cashew: I-Auroc:0.4672, I-AP:0.6246, I-F1:0.8032, P-AUROC:0.8354, P-AP:0.0542, P-F1:0.1131, P-AUPRO:0.3111
chewinggum: I-Auroc:0.5022, I-AP:0.6913, I-F1:0.8000, P-AUROC:0.5848, P-AP:0.0152, P-F1:0.0377, P-AUPRO:0.3420
fryum: I-Auroc:0.8696, I-AP:0.9280, I-F1:0.8744, P-AUROC:0.6747, P-AP:0.0516, P-F1:0.1101, P-AUPRO:0.1632
macaroni1: I-Auroc:0.7187, I-AP:0.6593, I-F1:0.7331, P-AUROC:0.7686, P-AP:0.0023, P-F1:0.0051, P-AUPRO:0.2721
macaroni2: I-Auroc:0.3894, I-AP:0.4262, I-F1:0.6689, P-AUROC:0.3834, P-AP:0.0007, P-F1:0.0021, P-AUPRO:0.0631
pcb1: I-Auroc:0.5590, I-AP:0.5855, I-F1:0.6689, P-AUROC:0.2795, P-AP:0.0085, P-F1:0.0378, P-AUPRO:0.3110
pcb2: I-Auroc:0.5089, I-AP:0.4852, I-F1:0.6807, P-AUROC:0.7963, P-AP:0.0118, P-F1:0.0256, P-AUPRO:0.4137
pcb3: I-Auroc:0.5605, I-AP:0.5241, I-F1:0.6807, P-AUROC:0.8081, P-AP:0.0146, P-F1:0.0312, P-AUPRO:0.5912
pcb4: I-Auroc:0.8337, I-AP:0.8048, I-F1:0.7897, P-AUROC:0.7945, P-AP:0.0347, P-F1:0.0609, P-AUPRO:0.4699
pipe_fryum: I-Auroc:0.6180, I-AP:0.7763, I-F1:0.8065, P-AUROC:0.9257, P-AP:0.1391, P-F1:0.2003, P-AUPRO:0.6514
Mean: I-Auroc:0.6254, I-AP:0.6689, I-F1:0.7533, P-AUROC:0.6865, P-AP:0.0290, P-F1:0.0551, P-AUPRO:0.3402
cuda:4
shots: 2
candle: I-Auroc:0.6980, I-AP:0.6310, I-F1:0.7197, P-AUROC:0.7016, P-AP:0.0066, P-F1:0.0235, P-AUPRO:0.3007
capsules: I-Auroc:0.7518, I-AP:0.8334, I-F1:0.8066, P-AUROC:0.7485, P-AP:0.0118, P-F1:0.0271, P-AUPRO:0.2503
cashew: I-Auroc:0.5060, I-AP:0.6461, I-F1:0.8220, P-AUROC:0.8462, P-AP:0.0628, P-F1:0.1334, P-AUPRO:0.3098
chewinggum: I-Auroc:0.5546, I-AP:0.7269, I-F1:0.8115, P-AUROC:0.5882, P-AP:0.0195, P-F1:0.0497, P-AUPRO:0.3544
fryum: I-Auroc:0.8212, I-AP:0.9100, I-F1:0.8455, P-AUROC:0.7105, P-AP:0.0599, P-F1:0.1196, P-AUPRO:0.2183
macaroni1: I-Auroc:0.6806, I-AP:0.6398, I-F1:0.6929, P-AUROC:0.8040, P-AP:0.0032, P-F1:0.0075, P-AUPRO:0.3475
macaroni2: I-Auroc:0.4663, I-AP:0.4783, I-F1:0.6711, P-AUROC:0.4130, P-AP:0.0008, P-F1:0.0027, P-AUPRO:0.0832
pcb1: I-Auroc:0.5988, I-AP:0.6567, I-F1:0.6711, P-AUROC:0.2971, P-AP:0.0110, P-F1:0.0454, P-AUPRO:0.3269
pcb2: I-Auroc:0.5233, I-AP:0.5101, I-F1:0.6873, P-AUROC:0.8065, P-AP:0.0130, P-F1:0.0287, P-AUPRO:0.4149
pcb3: I-Auroc:0.5399, I-AP:0.5274, I-F1:0.6667, P-AUROC:0.8224, P-AP:0.0161, P-F1:0.0355, P-AUPRO:0.6240
pcb4: I-Auroc:0.8744, I-AP:0.8611, I-F1:0.8100, P-AUROC:0.7988, P-AP:0.0366, P-F1:0.0616, P-AUPRO:0.4684
pipe_fryum: I-Auroc:0.6674, I-AP:0.8347, I-F1:0.8115, P-AUROC:0.9442, P-AP:0.2522, P-F1:0.2722, P-AUPRO:0.7107
Mean: I-Auroc:0.6402, I-AP:0.6880, I-F1:0.7513, P-AUROC:0.7068, P-AP:0.0411, P-F1:0.0672, P-AUPRO:0.3674
cuda:4
shots: 4
candle: I-Auroc:0.6748, I-AP:0.6522, I-F1:0.7000, P-AUROC:0.7408, P-AP:0.0114, P-F1:0.0496, P-AUPRO:0.3361
capsules: I-Auroc:0.7345, I-AP:0.8278, I-F1:0.8089, P-AUROC:0.7834, P-AP:0.0156, P-F1:0.0398, P-AUPRO:0.2800
cashew: I-Auroc:0.6058, I-AP:0.7064, I-F1:0.8333, P-AUROC:0.8531, P-AP:0.0706, P-F1:0.1514, P-AUPRO:0.3084
chewinggum: I-Auroc:0.6402, I-AP:0.7843, I-F1:0.8117, P-AUROC:0.6019, P-AP:0.0267, P-F1:0.0668, P-AUPRO:0.3698
fryum: I-Auroc:0.8468, I-AP:0.9247, I-F1:0.8472, P-AUROC:0.7259, P-AP:0.0630, P-F1:0.1267, P-AUPRO:0.2146
macaroni1: I-Auroc:0.6912, I-AP:0.6453, I-F1:0.7073, P-AUROC:0.8263, P-AP:0.0038, P-F1:0.0099, P-AUPRO:0.3923
macaroni2: I-Auroc:0.5002, I-AP:0.4958, I-F1:0.6667, P-AUROC:0.4280, P-AP:0.0008, P-F1:0.0025, P-AUPRO:0.0891
pcb1: I-Auroc:0.5741, I-AP:0.6353, I-F1:0.6667, P-AUROC:0.2905, P-AP:0.0130, P-F1:0.0474, P-AUPRO:0.2700
pcb2: I-Auroc:0.6482, I-AP:0.6012, I-F1:0.6957, P-AUROC:0.8295, P-AP:0.0238, P-F1:0.0491, P-AUPRO:0.4719
pcb3: I-Auroc:0.5884, I-AP:0.5580, I-F1:0.6794, P-AUROC:0.8332, P-AP:0.0177, P-F1:0.0395, P-AUPRO:0.6512
pcb4: I-Auroc:0.8493, I-AP:0.8323, I-F1:0.7909, P-AUROC:0.8055, P-AP:0.0349, P-F1:0.0600, P-AUPRO:0.4783
pipe_fryum: I-Auroc:0.6944, I-AP:0.8427, I-F1:0.8000, P-AUROC:0.9565, P-AP:0.3119, P-F1:0.3367, P-AUPRO:0.7603
Mean: I-Auroc:0.6707, I-AP:0.7088, I-F1:0.7506, P-AUROC:0.7229, P-AP:0.0494, P-F1:0.0816, P-AUPRO:0.3852





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_proteus_vit_base_14   默认：(R448-C392)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.9723, I-AP:0.9753, I-F1:0.9239, P-AUROC:0.9891, P-AP:0.4035, P-F1:0.4500, P-AUPRO:0.9479
capsules: I-Auroc:0.8323, I-AP:0.9125, I-F1:0.8113, P-AUROC:0.9483, P-AP:0.2709, P-F1:0.3551, P-AUPRO:0.8794
cashew: I-Auroc:0.9662, I-AP:0.9847, I-F1:0.9312, P-AUROC:0.9648, P-AP:0.5614, P-F1:0.5702, P-AUPRO:0.9201
chewinggum: I-Auroc:0.9910, I-AP:0.9961, I-F1:0.9798, P-AUROC:0.9911, P-AP:0.7551, P-F1:0.7429, P-AUPRO:0.9028
fryum: I-Auroc:0.9040, I-AP:0.9596, I-F1:0.8877, P-AUROC:0.9375, P-AP:0.3913, P-F1:0.4190, P-AUPRO:0.8763
macaroni1: I-Auroc:0.8974, I-AP:0.8954, I-F1:0.8241, P-AUROC:0.9883, P-AP:0.2632, P-F1:0.3601, P-AUPRO:0.9348
macaroni2: I-Auroc:0.5325, I-AP:0.5230, I-F1:0.6735, P-AUROC:0.9644, P-AP:0.0799, P-F1:0.1518, P-AUPRO:0.8691
pcb1: I-Auroc:0.7675, I-AP:0.8004, I-F1:0.7082, P-AUROC:0.9835, P-AP:0.6934, P-F1:0.6671, P-AUPRO:0.8371
pcb2: I-Auroc:0.8548, I-AP:0.8862, I-F1:0.7938, P-AUROC:0.9437, P-AP:0.4095, P-F1:0.4749, P-AUPRO:0.7296
pcb3: I-Auroc:0.8412, I-AP:0.8389, I-F1:0.7982, P-AUROC:0.9544, P-AP:0.3493, P-F1:0.4004, P-AUPRO:0.8462
pcb4: I-Auroc:0.9775, I-AP:0.9727, I-F1:0.9524, P-AUROC:0.9217, P-AP:0.1671, P-F1:0.2563, P-AUPRO:0.7182
pipe_fryum: I-Auroc:0.9778, I-AP:0.9870, I-F1:0.9659, P-AUROC:0.9911, P-AP:0.6611, P-F1:0.6812, P-AUPRO:0.9662
Mean: I-Auroc:0.8762, I-AP:0.8943, I-F1:0.8542, P-AUROC:0.9648, P-AP:0.4171, P-F1:0.4608, P-AUPRO:0.8690
cuda:4
shots: 2
candle: I-Auroc:0.9726, I-AP:0.9753, I-F1:0.9307, P-AUROC:0.9903, P-AP:0.4265, P-F1:0.4675, P-AUPRO:0.9544
capsules: I-Auroc:0.9350, I-AP:0.9610, I-F1:0.8912, P-AUROC:0.9622, P-AP:0.3821, P-F1:0.4660, P-AUPRO:0.9069
cashew: I-Auroc:0.9862, I-AP:0.9932, I-F1:0.9561, P-AUROC:0.9689, P-AP:0.5966, P-F1:0.6060, P-AUPRO:0.9325
chewinggum: I-Auroc:0.9930, I-AP:0.9968, I-F1:0.9798, P-AUROC:0.9910, P-AP:0.7368, P-F1:0.7361, P-AUPRO:0.8951
fryum: I-Auroc:0.9012, I-AP:0.9579, I-F1:0.8743, P-AUROC:0.9374, P-AP:0.3846, P-F1:0.4113, P-AUPRO:0.8792
macaroni1: I-Auroc:0.9158, I-AP:0.9157, I-F1:0.8444, P-AUROC:0.9899, P-AP:0.2950, P-F1:0.3970, P-AUPRO:0.9461
macaroni2: I-Auroc:0.5564, I-AP:0.5348, I-F1:0.6738, P-AUROC:0.9673, P-AP:0.0756, P-F1:0.1439, P-AUPRO:0.8673
pcb1: I-Auroc:0.8090, I-AP:0.8250, I-F1:0.7607, P-AUROC:0.9866, P-AP:0.7259, P-F1:0.6890, P-AUPRO:0.8687
pcb2: I-Auroc:0.8896, I-AP:0.9044, I-F1:0.8145, P-AUROC:0.9511, P-AP:0.4565, P-F1:0.5227, P-AUPRO:0.7790
pcb3: I-Auroc:0.8379, I-AP:0.8435, I-F1:0.7943, P-AUROC:0.9600, P-AP:0.3849, P-F1:0.4375, P-AUPRO:0.8418
pcb4: I-Auroc:0.9822, I-AP:0.9738, I-F1:0.9565, P-AUROC:0.9343, P-AP:0.1844, P-F1:0.2747, P-AUPRO:0.7501
pipe_fryum: I-Auroc:0.9856, I-AP:0.9922, I-F1:0.9751, P-AUROC:0.9915, P-AP:0.6623, P-F1:0.6841, P-AUPRO:0.9682
Mean: I-Auroc:0.8970, I-AP:0.9061, I-F1:0.8710, P-AUROC:0.9692, P-AP:0.4426, P-F1:0.4863, P-AUPRO:0.8824
cuda:4
shots: 4
candle: I-Auroc:0.9803, I-AP:0.9822, I-F1:0.9442, P-AUROC:0.9910, P-AP:0.4332, P-F1:0.4800, P-AUPRO:0.9589
capsules: I-Auroc:0.9488, I-AP:0.9719, I-F1:0.8995, P-AUROC:0.9729, P-AP:0.4577, P-F1:0.5248, P-AUPRO:0.9117
cashew: I-Auroc:0.9858, I-AP:0.9930, I-F1:0.9565, P-AUROC:0.9710, P-AP:0.6098, P-F1:0.6242, P-AUPRO:0.9351
chewinggum: I-Auroc:0.9930, I-AP:0.9968, I-F1:0.9749, P-AUROC:0.9915, P-AP:0.7134, P-F1:0.7347, P-AUPRO:0.8995
fryum: I-Auroc:0.9612, I-AP:0.9830, I-F1:0.9319, P-AUROC:0.9448, P-AP:0.4184, P-F1:0.4563, P-AUPRO:0.9045
macaroni1: I-Auroc:0.9495, I-AP:0.9523, I-F1:0.8808, P-AUROC:0.9933, P-AP:0.3526, P-F1:0.4460, P-AUPRO:0.9592
macaroni2: I-Auroc:0.6314, I-AP:0.5757, I-F1:0.6977, P-AUROC:0.9733, P-AP:0.1005, P-F1:0.1879, P-AUPRO:0.8900
pcb1: I-Auroc:0.9065, I-AP:0.8993, I-F1:0.8505, P-AUROC:0.9899, P-AP:0.7647, P-F1:0.7186, P-AUPRO:0.9027
pcb2: I-Auroc:0.9233, I-AP:0.9362, I-F1:0.8571, P-AUROC:0.9550, P-AP:0.4881, P-F1:0.5512, P-AUPRO:0.8060
pcb3: I-Auroc:0.9027, I-AP:0.9142, I-F1:0.8316, P-AUROC:0.9682, P-AP:0.4887, P-F1:0.5335, P-AUPRO:0.8768
pcb4: I-Auroc:0.9818, I-AP:0.9801, I-F1:0.9458, P-AUROC:0.9574, P-AP:0.3037, P-F1:0.3806, P-AUPRO:0.8357
pipe_fryum: I-Auroc:0.9950, I-AP:0.9975, I-F1:0.9802, P-AUROC:0.9921, P-AP:0.6754, P-F1:0.6994, P-AUPRO:0.9679
Mean: I-Auroc:0.9299, I-AP:0.9318, I-F1:0.8959, P-AUROC:0.9750, P-AP:0.4839, P-F1:0.5281, P-AUPRO:0.9040




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_small_14   默认：(R448-C392)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.9347, I-AP:0.9403, I-F1:0.8677, P-AUROC:0.9872, P-AP:0.3580, P-F1:0.4361, P-AUPRO:0.9401
capsules: I-Auroc:0.9343, I-AP:0.9636, I-F1:0.9154, P-AUROC:0.9631, P-AP:0.3543, P-F1:0.4833, P-AUPRO:0.9057
cashew: I-Auroc:0.9358, I-AP:0.9646, I-F1:0.9118, P-AUROC:0.9909, P-AP:0.6760, P-F1:0.6518, P-AUPRO:0.9455
chewinggum: I-Auroc:0.9902, I-AP:0.9955, I-F1:0.9645, P-AUROC:0.9907, P-AP:0.6795, P-F1:0.6963, P-AUPRO:0.9025
fryum: I-Auroc:0.9216, I-AP:0.9657, I-F1:0.8913, P-AUROC:0.9401, P-AP:0.3868, P-F1:0.4407, P-AUPRO:0.8829
macaroni1: I-Auroc:0.9064, I-AP:0.9216, I-F1:0.8421, P-AUROC:0.9861, P-AP:0.2294, P-F1:0.3217, P-AUPRO:0.9327
macaroni2: I-Auroc:0.5587, I-AP:0.5365, I-F1:0.6667, P-AUROC:0.9587, P-AP:0.0490, P-F1:0.1298, P-AUPRO:0.8682
pcb1: I-Auroc:0.8082, I-AP:0.8212, I-F1:0.7383, P-AUROC:0.9869, P-AP:0.6943, P-F1:0.6764, P-AUPRO:0.8628
pcb2: I-Auroc:0.8775, I-AP:0.9015, I-F1:0.8177, P-AUROC:0.9534, P-AP:0.4053, P-F1:0.4660, P-AUPRO:0.7695
pcb3: I-Auroc:0.8444, I-AP:0.8300, I-F1:0.7982, P-AUROC:0.9571, P-AP:0.3064, P-F1:0.3822, P-AUPRO:0.8139
pcb4: I-Auroc:0.9591, I-AP:0.9444, I-F1:0.9372, P-AUROC:0.9272, P-AP:0.1519, P-F1:0.2554, P-AUPRO:0.7540
pipe_fryum: I-Auroc:0.9736, I-AP:0.9845, I-F1:0.9557, P-AUROC:0.9930, P-AP:0.6427, P-F1:0.6810, P-AUPRO:0.9638
Mean: I-Auroc:0.8870, I-AP:0.8975, I-F1:0.8589, P-AUROC:0.9695, P-AP:0.4111, P-F1:0.4684, P-AUPRO:0.8785
cuda:4
shots: 2
candle: I-Auroc:0.9382, I-AP:0.9444, I-F1:0.8602, P-AUROC:0.9880, P-AP:0.3661, P-F1:0.4440, P-AUPRO:0.9449
capsules: I-Auroc:0.9435, I-AP:0.9672, I-F1:0.9167, P-AUROC:0.9764, P-AP:0.4265, P-F1:0.5411, P-AUPRO:0.9348
cashew: I-Auroc:0.9474, I-AP:0.9722, I-F1:0.9275, P-AUROC:0.9920, P-AP:0.6935, P-F1:0.6690, P-AUPRO:0.9572
chewinggum: I-Auroc:0.9906, I-AP:0.9961, I-F1:0.9800, P-AUROC:0.9910, P-AP:0.6548, P-F1:0.6849, P-AUPRO:0.8917
fryum: I-Auroc:0.9282, I-AP:0.9671, I-F1:0.8984, P-AUROC:0.9439, P-AP:0.4010, P-F1:0.4525, P-AUPRO:0.8820
macaroni1: I-Auroc:0.9348, I-AP:0.9437, I-F1:0.8493, P-AUROC:0.9893, P-AP:0.2860, P-F1:0.3862, P-AUPRO:0.9400
macaroni2: I-Auroc:0.5511, I-AP:0.5271, I-F1:0.6690, P-AUROC:0.9590, P-AP:0.0490, P-F1:0.1254, P-AUPRO:0.8478
pcb1: I-Auroc:0.8443, I-AP:0.8455, I-F1:0.7860, P-AUROC:0.9888, P-AP:0.7204, P-F1:0.6933, P-AUPRO:0.8913
pcb2: I-Auroc:0.9138, I-AP:0.9182, I-F1:0.8416, P-AUROC:0.9601, P-AP:0.4522, P-F1:0.5218, P-AUPRO:0.8102
pcb3: I-Auroc:0.8321, I-AP:0.8436, I-F1:0.7731, P-AUROC:0.9626, P-AP:0.3624, P-F1:0.4345, P-AUPRO:0.8199
pcb4: I-Auroc:0.9596, I-AP:0.9432, I-F1:0.9216, P-AUROC:0.9391, P-AP:0.1840, P-F1:0.2962, P-AUPRO:0.7816
pipe_fryum: I-Auroc:0.9808, I-AP:0.9894, I-F1:0.9612, P-AUROC:0.9930, P-AP:0.6396, P-F1:0.6818, P-AUPRO:0.9645
Mean: I-Auroc:0.8970, I-AP:0.9048, I-F1:0.8654, P-AUROC:0.9736, P-AP:0.4363, P-F1:0.4942, P-AUPRO:0.8888
cuda:4
shots: 4
candle: I-Auroc:0.9743, I-AP:0.9764, I-F1:0.9179, P-AUROC:0.9885, P-AP:0.3825, P-F1:0.4651, P-AUPRO:0.9488
capsules: I-Auroc:0.9203, I-AP:0.9559, I-F1:0.8821, P-AUROC:0.9829, P-AP:0.5195, P-F1:0.5895, P-AUPRO:0.9427
cashew: I-Auroc:0.9660, I-AP:0.9824, I-F1:0.9378, P-AUROC:0.9930, P-AP:0.7173, P-F1:0.6948, P-AUPRO:0.9619
chewinggum: I-Auroc:0.9932, I-AP:0.9969, I-F1:0.9800, P-AUROC:0.9915, P-AP:0.6579, P-F1:0.6786, P-AUPRO:0.9018
fryum: I-Auroc:0.9528, I-AP:0.9768, I-F1:0.9223, P-AUROC:0.9493, P-AP:0.4168, P-F1:0.4697, P-AUPRO:0.8946
macaroni1: I-Auroc:0.9599, I-AP:0.9633, I-F1:0.9045, P-AUROC:0.9929, P-AP:0.3278, P-F1:0.4060, P-AUPRO:0.9554
macaroni2: I-Auroc:0.5875, I-AP:0.5427, I-F1:0.6828, P-AUROC:0.9675, P-AP:0.0504, P-F1:0.1405, P-AUPRO:0.8770
pcb1: I-Auroc:0.8891, I-AP:0.8691, I-F1:0.8341, P-AUROC:0.9904, P-AP:0.7473, P-F1:0.7113, P-AUPRO:0.9013
pcb2: I-Auroc:0.9352, I-AP:0.9382, I-F1:0.8720, P-AUROC:0.9630, P-AP:0.4799, P-F1:0.5505, P-AUPRO:0.8372
pcb3: I-Auroc:0.8936, I-AP:0.8917, I-F1:0.8436, P-AUROC:0.9699, P-AP:0.4297, P-F1:0.4942, P-AUPRO:0.8610
pcb4: I-Auroc:0.9473, I-AP:0.9325, I-F1:0.9083, P-AUROC:0.9564, P-AP:0.2968, P-F1:0.3834, P-AUPRO:0.8523
pipe_fryum: I-Auroc:0.9886, I-AP:0.9941, I-F1:0.9652, P-AUROC:0.9930, P-AP:0.6463, P-F1:0.6922, P-AUPRO:0.9651
Mean: I-Auroc:0.9173, I-AP:0.9183, I-F1:0.8875, P-AUROC:0.9782, P-AP:0.4727, P-F1:0.5230, P-AUPRO:0.9083





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_large_14   默认：(R448-C392)
interested_layers = list(range(4, 19))

cuda:3
shots: 1
candle: I-Auroc:0.9462, I-AP:0.9522, I-F1:0.8708, P-AUROC:0.9912, P-AP:0.4043, P-F1:0.4758, P-AUPRO:0.9586
capsules: I-Auroc:0.9552, I-AP:0.9758, I-F1:0.9119, P-AUROC:0.9635, P-AP:0.4152, P-F1:0.4958, P-AUPRO:0.9333
cashew: I-Auroc:0.9524, I-AP:0.9764, I-F1:0.9146, P-AUROC:0.9858, P-AP:0.6319, P-F1:0.6228, P-AUPRO:0.9424
chewinggum: I-Auroc:0.9924, I-AP:0.9966, I-F1:0.9796, P-AUROC:0.9928, P-AP:0.7195, P-F1:0.7269, P-AUPRO:0.9269
fryum: I-Auroc:0.9426, I-AP:0.9755, I-F1:0.9208, P-AUROC:0.9299, P-AP:0.3633, P-F1:0.4080, P-AUPRO:0.8938
macaroni1: I-Auroc:0.9225, I-AP:0.9329, I-F1:0.8458, P-AUROC:0.9904, P-AP:0.3079, P-F1:0.3921, P-AUPRO:0.9390
macaroni2: I-Auroc:0.6199, I-AP:0.5715, I-F1:0.6718, P-AUROC:0.9619, P-AP:0.1164, P-F1:0.1905, P-AUPRO:0.8544
pcb1: I-Auroc:0.8784, I-AP:0.8712, I-F1:0.8318, P-AUROC:0.9858, P-AP:0.6863, P-F1:0.6654, P-AUPRO:0.8686
pcb2: I-Auroc:0.9079, I-AP:0.9263, I-F1:0.8542, P-AUROC:0.9592, P-AP:0.4548, P-F1:0.5158, P-AUPRO:0.8073
pcb3: I-Auroc:0.8703, I-AP:0.8691, I-F1:0.8288, P-AUROC:0.9673, P-AP:0.4388, P-F1:0.4760, P-AUPRO:0.8651
pcb4: I-Auroc:0.9848, I-AP:0.9827, I-F1:0.9569, P-AUROC:0.9366, P-AP:0.2376, P-F1:0.3250, P-AUPRO:0.7853
pipe_fryum: I-Auroc:0.9530, I-AP:0.9762, I-F1:0.9216, P-AUROC:0.9892, P-AP:0.5478, P-F1:0.6081, P-AUPRO:0.9546
Mean: I-Auroc:0.9105, I-AP:0.9172, I-F1:0.8757, P-AUROC:0.9711, P-AP:0.4436, P-F1:0.4919, P-AUPRO:0.8941
cuda:3
shots: 2
candle: I-Auroc:0.9553, I-AP:0.9600, I-F1:0.8835, P-AUROC:0.9921, P-AP:0.4221, P-F1:0.4925, P-AUPRO:0.9573
capsules: I-Auroc:0.9842, I-AP:0.9902, I-F1:0.9515, P-AUROC:0.9749, P-AP:0.4622, P-F1:0.5291, P-AUPRO:0.9498
cashew: I-Auroc:0.9672, I-AP:0.9837, I-F1:0.9347, P-AUROC:0.9875, P-AP:0.6564, P-F1:0.6468, P-AUPRO:0.9490
chewinggum: I-Auroc:0.9930, I-AP:0.9969, I-F1:0.9746, P-AUROC:0.9932, P-AP:0.6920, P-F1:0.7146, P-AUPRO:0.9264
fryum: I-Auroc:0.9348, I-AP:0.9706, I-F1:0.9064, P-AUROC:0.9348, P-AP:0.3810, P-F1:0.4213, P-AUPRO:0.8995
macaroni1: I-Auroc:0.9356, I-AP:0.9435, I-F1:0.8528, P-AUROC:0.9921, P-AP:0.3493, P-F1:0.4259, P-AUPRO:0.9470
macaroni2: I-Auroc:0.6367, I-AP:0.5951, I-F1:0.6791, P-AUROC:0.9668, P-AP:0.1275, P-F1:0.2178, P-AUPRO:0.8594
pcb1: I-Auroc:0.8843, I-AP:0.8771, I-F1:0.8349, P-AUROC:0.9879, P-AP:0.7109, P-F1:0.6857, P-AUPRO:0.8864
pcb2: I-Auroc:0.9281, I-AP:0.9334, I-F1:0.8638, P-AUROC:0.9642, P-AP:0.4801, P-F1:0.5361, P-AUPRO:0.8398
pcb3: I-Auroc:0.8791, I-AP:0.8767, I-F1:0.8365, P-AUROC:0.9711, P-AP:0.4593, P-F1:0.4984, P-AUPRO:0.8648
pcb4: I-Auroc:0.9864, I-AP:0.9839, I-F1:0.9662, P-AUROC:0.9456, P-AP:0.2547, P-F1:0.3364, P-AUPRO:0.8016
pipe_fryum: I-Auroc:0.9654, I-AP:0.9831, I-F1:0.9252, P-AUROC:0.9900, P-AP:0.5557, P-F1:0.6127, P-AUPRO:0.9605
Mean: I-Auroc:0.9208, I-AP:0.9245, I-F1:0.8841, P-AUROC:0.9750, P-AP:0.4626, P-F1:0.5098, P-AUPRO:0.9034
cuda:3
shots: 4
candle: I-Auroc:0.9781, I-AP:0.9789, I-F1:0.9353, P-AUROC:0.9931, P-AP:0.4504, P-F1:0.5067, P-AUPRO:0.9611
capsules: I-Auroc:0.9742, I-AP:0.9845, I-F1:0.9372, P-AUROC:0.9818, P-AP:0.5375, P-F1:0.5792, P-AUPRO:0.9545
cashew: I-Auroc:0.9826, I-AP:0.9915, I-F1:0.9524, P-AUROC:0.9890, P-AP:0.6737, P-F1:0.6637, P-AUPRO:0.9547
chewinggum: I-Auroc:0.9952, I-AP:0.9977, I-F1:0.9751, P-AUROC:0.9937, P-AP:0.6916, P-F1:0.7141, P-AUPRO:0.9343
fryum: I-Auroc:0.9684, I-AP:0.9845, I-F1:0.9436, P-AUROC:0.9400, P-AP:0.3968, P-F1:0.4398, P-AUPRO:0.9050
macaroni1: I-Auroc:0.9726, I-AP:0.9747, I-F1:0.9048, P-AUROC:0.9947, P-AP:0.3781, P-F1:0.4387, P-AUPRO:0.9572
macaroni2: I-Auroc:0.6700, I-AP:0.6445, I-F1:0.6901, P-AUROC:0.9738, P-AP:0.1742, P-F1:0.2816, P-AUPRO:0.8811
pcb1: I-Auroc:0.9103, I-AP:0.8851, I-F1:0.8585, P-AUROC:0.9896, P-AP:0.7334, P-F1:0.6968, P-AUPRO:0.9061
pcb2: I-Auroc:0.9431, I-AP:0.9453, I-F1:0.8911, P-AUROC:0.9667, P-AP:0.4954, P-F1:0.5500, P-AUPRO:0.8619
pcb3: I-Auroc:0.9320, I-AP:0.9359, I-F1:0.8780, P-AUROC:0.9780, P-AP:0.5259, P-F1:0.5722, P-AUPRO:0.8954
pcb4: I-Auroc:0.9866, I-AP:0.9850, I-F1:0.9615, P-AUROC:0.9633, P-AP:0.3516, P-F1:0.4225, P-AUPRO:0.8636
pipe_fryum: I-Auroc:0.9862, I-AP:0.9924, I-F1:0.9709, P-AUROC:0.9909, P-AP:0.5746, P-F1:0.6468, P-AUPRO:0.9645
Mean: I-Auroc:0.9416, I-AP:0.9417, I-F1:0.9082, P-AUROC:0.9795, P-AP:0.4986, P-F1:0.5427, P-AUPRO:0.9200







-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : DINOV2_proteus_vit_base_14   默认：(R448-C392)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:3
shots: 1
candle: I-Auroc:0.9263, I-AP:0.9300, I-F1:0.8532, P-AUROC:0.9893, P-AP:0.3595, P-F1:0.4314, P-AUPRO:0.9514
capsules: I-Auroc:0.9698, I-AP:0.9838, I-F1:0.9381, P-AUROC:0.9728, P-AP:0.3900, P-F1:0.4889, P-AUPRO:0.9385
cashew: I-Auroc:0.9184, I-AP:0.9586, I-F1:0.8986, P-AUROC:0.9910, P-AP:0.6749, P-F1:0.6356, P-AUPRO:0.9307
chewinggum: I-Auroc:0.9914, I-AP:0.9961, I-F1:0.9744, P-AUROC:0.9939, P-AP:0.6862, P-F1:0.6909, P-AUPRO:0.9317
fryum: I-Auroc:0.9378, I-AP:0.9705, I-F1:0.9045, P-AUROC:0.9463, P-AP:0.4015, P-F1:0.4540, P-AUPRO:0.8821
macaroni1: I-Auroc:0.8421, I-AP:0.8640, I-F1:0.7812, P-AUROC:0.9868, P-AP:0.1826, P-F1:0.2610, P-AUPRO:0.9418
macaroni2: I-Auroc:0.6901, I-AP:0.6232, I-F1:0.6983, P-AUROC:0.9555, P-AP:0.1266, P-F1:0.2063, P-AUPRO:0.8620
pcb1: I-Auroc:0.8324, I-AP:0.8356, I-F1:0.7742, P-AUROC:0.9874, P-AP:0.6892, P-F1:0.6671, P-AUPRO:0.8728
pcb2: I-Auroc:0.9143, I-AP:0.9202, I-F1:0.8544, P-AUROC:0.9603, P-AP:0.4084, P-F1:0.4740, P-AUPRO:0.8047
pcb3: I-Auroc:0.8724, I-AP:0.8721, I-F1:0.8148, P-AUROC:0.9681, P-AP:0.3785, P-F1:0.4403, P-AUPRO:0.8361
pcb4: I-Auroc:0.9769, I-AP:0.9717, I-F1:0.9469, P-AUROC:0.9320, P-AP:0.1950, P-F1:0.2874, P-AUPRO:0.7684
pipe_fryum: I-Auroc:0.9542, I-AP:0.9753, I-F1:0.9412, P-AUROC:0.9912, P-AP:0.6014, P-F1:0.6407, P-AUPRO:0.9495
Mean: I-Auroc:0.9022, I-AP:0.9084, I-F1:0.8650, P-AUROC:0.9729, P-AP:0.4245, P-F1:0.4731, P-AUPRO:0.8892
cuda:3
shots: 2
candle: I-Auroc:0.9282, I-AP:0.9326, I-F1:0.8533, P-AUROC:0.9900, P-AP:0.3625, P-F1:0.4425, P-AUPRO:0.9524
capsules: I-Auroc:0.9862, I-AP:0.9926, I-F1:0.9608, P-AUROC:0.9817, P-AP:0.4375, P-F1:0.5145, P-AUPRO:0.9527
cashew: I-Auroc:0.9302, I-AP:0.9635, I-F1:0.9109, P-AUROC:0.9920, P-AP:0.6824, P-F1:0.6454, P-AUPRO:0.9420
chewinggum: I-Auroc:0.9946, I-AP:0.9974, I-F1:0.9746, P-AUROC:0.9943, P-AP:0.6754, P-F1:0.6817, P-AUPRO:0.9361
fryum: I-Auroc:0.9450, I-AP:0.9732, I-F1:0.9208, P-AUROC:0.9505, P-AP:0.4169, P-F1:0.4695, P-AUPRO:0.8876
macaroni1: I-Auroc:0.9456, I-AP:0.9494, I-F1:0.8857, P-AUROC:0.9907, P-AP:0.3353, P-F1:0.4101, P-AUPRO:0.9485
macaroni2: I-Auroc:0.6597, I-AP:0.6208, I-F1:0.6855, P-AUROC:0.9582, P-AP:0.1331, P-F1:0.2262, P-AUPRO:0.8575
pcb1: I-Auroc:0.8491, I-AP:0.8493, I-F1:0.8037, P-AUROC:0.9896, P-AP:0.7125, P-F1:0.6823, P-AUPRO:0.8902
pcb2: I-Auroc:0.9297, I-AP:0.9292, I-F1:0.8708, P-AUROC:0.9632, P-AP:0.4363, P-F1:0.5036, P-AUPRO:0.8372
pcb3: I-Auroc:0.8595, I-AP:0.8629, I-F1:0.8111, P-AUROC:0.9714, P-AP:0.4121, P-F1:0.4667, P-AUPRO:0.8406
pcb4: I-Auroc:0.9770, I-AP:0.9714, I-F1:0.9469, P-AUROC:0.9417, P-AP:0.2111, P-F1:0.3027, P-AUPRO:0.7858
pipe_fryum: I-Auroc:0.9688, I-AP:0.9839, I-F1:0.9390, P-AUROC:0.9919, P-AP:0.6079, P-F1:0.6529, P-AUPRO:0.9548
Mean: I-Auroc:0.9145, I-AP:0.9188, I-F1:0.8802, P-AUROC:0.9763, P-AP:0.4519, P-F1:0.4998, P-AUPRO:0.8988
cuda:3
shots: 4
candle: I-Auroc:0.9684, I-AP:0.9704, I-F1:0.9268, P-AUROC:0.9917, P-AP:0.3799, P-F1:0.4602, P-AUPRO:0.9565
capsules: I-Auroc:0.9770, I-AP:0.9874, I-F1:0.9495, P-AUROC:0.9860, P-AP:0.5327, P-F1:0.5769, P-AUPRO:0.9617
cashew: I-Auroc:0.9488, I-AP:0.9738, I-F1:0.9187, P-AUROC:0.9933, P-AP:0.7068, P-F1:0.6743, P-AUPRO:0.9524
chewinggum: I-Auroc:0.9952, I-AP:0.9977, I-F1:0.9746, P-AUROC:0.9946, P-AP:0.6749, P-F1:0.6712, P-AUPRO:0.9406
fryum: I-Auroc:0.9570, I-AP:0.9785, I-F1:0.9442, P-AUROC:0.9560, P-AP:0.4394, P-F1:0.4958, P-AUPRO:0.8965
macaroni1: I-Auroc:0.9732, I-AP:0.9747, I-F1:0.9100, P-AUROC:0.9939, P-AP:0.3576, P-F1:0.4207, P-AUPRO:0.9585
macaroni2: I-Auroc:0.6408, I-AP:0.6073, I-F1:0.6849, P-AUROC:0.9648, P-AP:0.1386, P-F1:0.2278, P-AUPRO:0.8713
pcb1: I-Auroc:0.8652, I-AP:0.8485, I-F1:0.8333, P-AUROC:0.9914, P-AP:0.7349, P-F1:0.6989, P-AUPRO:0.9020
pcb2: I-Auroc:0.9338, I-AP:0.9288, I-F1:0.8942, P-AUROC:0.9659, P-AP:0.4530, P-F1:0.5304, P-AUPRO:0.8516
pcb3: I-Auroc:0.9089, I-AP:0.9088, I-F1:0.8557, P-AUROC:0.9777, P-AP:0.4619, P-F1:0.5167, P-AUPRO:0.8754
pcb4: I-Auroc:0.9649, I-AP:0.9593, I-F1:0.9390, P-AUROC:0.9585, P-AP:0.3008, P-F1:0.3789, P-AUPRO:0.8496
pipe_fryum: I-Auroc:0.9822, I-AP:0.9905, I-F1:0.9612, P-AUROC:0.9915, P-AP:0.6009, P-F1:0.6575, P-AUPRO:0.9592
Mean: I-Auroc:0.9263, I-AP:0.9271, I-F1:0.8993, P-AUROC:0.9804, P-AP:0.4818, P-F1:0.5258, P-AUPRO:0.9146



-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_vit_base_16   默认：(R256-C224)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.9416, I-AP:0.9428, I-F1:0.8785, P-AUROC:0.9791, P-AP:0.3100, P-F1:0.4082, P-AUPRO:0.8693
capsules: I-Auroc:0.8158, I-AP:0.8940, I-F1:0.8214, P-AUROC:0.9232, P-AP:0.2105, P-F1:0.3358, P-AUPRO:0.6437
cashew: I-Auroc:0.9254, I-AP:0.9661, I-F1:0.8910, P-AUROC:0.9810, P-AP:0.5907, P-F1:0.5929, P-AUPRO:0.9137
chewinggum: I-Auroc:0.9712, I-AP:0.9869, I-F1:0.9538, P-AUROC:0.9860, P-AP:0.7138, P-F1:0.6865, P-AUPRO:0.8629
fryum: I-Auroc:0.8368, I-AP:0.9318, I-F1:0.8249, P-AUROC:0.9312, P-AP:0.3679, P-F1:0.4074, P-AUPRO:0.7299
macaroni1: I-Auroc:0.8541, I-AP:0.8766, I-F1:0.7911, P-AUROC:0.9486, P-AP:0.1255, P-F1:0.2370, P-AUPRO:0.7945
macaroni2: I-Auroc:0.5471, I-AP:0.5269, I-F1:0.6760, P-AUROC:0.8898, P-AP:0.0161, P-F1:0.0642, P-AUPRO:0.6981
pcb1: I-Auroc:0.7446, I-AP:0.7547, I-F1:0.7117, P-AUROC:0.9618, P-AP:0.5432, P-F1:0.5656, P-AUPRO:0.6297
pcb2: I-Auroc:0.7897, I-AP:0.7734, I-F1:0.7745, P-AUROC:0.9199, P-AP:0.1931, P-F1:0.2892, P-AUPRO:0.6053
pcb3: I-Auroc:0.7726, I-AP:0.7900, I-F1:0.7402, P-AUROC:0.9326, P-AP:0.2336, P-F1:0.3081, P-AUPRO:0.5768
pcb4: I-Auroc:0.9690, I-AP:0.9587, I-F1:0.9238, P-AUROC:0.9448, P-AP:0.2663, P-F1:0.3289, P-AUPRO:0.7715
pipe_fryum: I-Auroc:0.9962, I-AP:0.9981, I-F1:0.9851, P-AUROC:0.9917, P-AP:0.6577, P-F1:0.6734, P-AUPRO:0.9568
Mean: I-Auroc:0.8470, I-AP:0.8667, I-F1:0.8310, P-AUROC:0.9492, P-AP:0.3524, P-F1:0.4081, P-AUPRO:0.7543
cuda:4
shots: 2
candle: I-Auroc:0.9541, I-AP:0.9534, I-F1:0.8922, P-AUROC:0.9827, P-AP:0.3243, P-F1:0.4193, P-AUPRO:0.8894
capsules: I-Auroc:0.8128, I-AP:0.8935, I-F1:0.8139, P-AUROC:0.9460, P-AP:0.2428, P-F1:0.3664, P-AUPRO:0.6825
cashew: I-Auroc:0.9516, I-AP:0.9773, I-F1:0.9158, P-AUROC:0.9848, P-AP:0.6060, P-F1:0.6081, P-AUPRO:0.9204
chewinggum: I-Auroc:0.9790, I-AP:0.9909, I-F1:0.9583, P-AUROC:0.9851, P-AP:0.7267, P-F1:0.7023, P-AUPRO:0.8507
fryum: I-Auroc:0.8316, I-AP:0.9271, I-F1:0.8255, P-AUROC:0.9337, P-AP:0.3661, P-F1:0.4075, P-AUPRO:0.7389
macaroni1: I-Auroc:0.8464, I-AP:0.8738, I-F1:0.7583, P-AUROC:0.9514, P-AP:0.0937, P-F1:0.2188, P-AUPRO:0.8054
macaroni2: I-Auroc:0.5676, I-AP:0.5392, I-F1:0.6757, P-AUROC:0.8945, P-AP:0.0147, P-F1:0.0541, P-AUPRO:0.6906
pcb1: I-Auroc:0.7470, I-AP:0.7600, I-F1:0.7031, P-AUROC:0.9661, P-AP:0.5507, P-F1:0.5612, P-AUPRO:0.6735
pcb2: I-Auroc:0.8634, I-AP:0.8186, I-F1:0.8019, P-AUROC:0.9235, P-AP:0.2203, P-F1:0.3576, P-AUPRO:0.5856
pcb3: I-Auroc:0.8223, I-AP:0.8310, I-F1:0.7615, P-AUROC:0.9510, P-AP:0.2811, P-F1:0.3443, P-AUPRO:0.6801
pcb4: I-Auroc:0.9727, I-AP:0.9589, I-F1:0.9400, P-AUROC:0.9497, P-AP:0.2810, P-F1:0.3398, P-AUPRO:0.7811
pipe_fryum: I-Auroc:0.9968, I-AP:0.9984, I-F1:0.9802, P-AUROC:0.9919, P-AP:0.6538, P-F1:0.6807, P-AUPRO:0.9542
Mean: I-Auroc:0.8621, I-AP:0.8768, I-F1:0.8355, P-AUROC:0.9550, P-AP:0.3634, P-F1:0.4217, P-AUPRO:0.7710
cuda:4
shots: 4
candle: I-Auroc:0.9493, I-AP:0.9487, I-F1:0.8900, P-AUROC:0.9852, P-AP:0.3296, P-F1:0.4234, P-AUPRO:0.8939
capsules: I-Auroc:0.7952, I-AP:0.8893, I-F1:0.8000, P-AUROC:0.9546, P-AP:0.3210, P-F1:0.4186, P-AUPRO:0.6877
cashew: I-Auroc:0.9440, I-AP:0.9738, I-F1:0.9137, P-AUROC:0.9860, P-AP:0.6223, P-F1:0.6269, P-AUPRO:0.9082
chewinggum: I-Auroc:0.9848, I-AP:0.9935, I-F1:0.9652, P-AUROC:0.9859, P-AP:0.7245, P-F1:0.7016, P-AUPRO:0.8536
fryum: I-Auroc:0.9146, I-AP:0.9632, I-F1:0.8821, P-AUROC:0.9456, P-AP:0.4153, P-F1:0.4659, P-AUPRO:0.7892
macaroni1: I-Auroc:0.8650, I-AP:0.8824, I-F1:0.7948, P-AUROC:0.9606, P-AP:0.1156, P-F1:0.2441, P-AUPRO:0.8420
macaroni2: I-Auroc:0.6350, I-AP:0.5838, I-F1:0.7025, P-AUROC:0.9124, P-AP:0.0217, P-F1:0.0706, P-AUPRO:0.7291
pcb1: I-Auroc:0.8004, I-AP:0.7964, I-F1:0.7554, P-AUROC:0.9780, P-AP:0.5892, P-F1:0.5808, P-AUPRO:0.7573
pcb2: I-Auroc:0.9173, I-AP:0.9046, I-F1:0.8643, P-AUROC:0.9348, P-AP:0.2766, P-F1:0.4006, P-AUPRO:0.6068
pcb3: I-Auroc:0.8399, I-AP:0.8515, I-F1:0.7716, P-AUROC:0.9600, P-AP:0.3217, P-F1:0.4003, P-AUPRO:0.7190
pcb4: I-Auroc:0.9607, I-AP:0.9560, I-F1:0.8995, P-AUROC:0.9686, P-AP:0.3757, P-F1:0.4341, P-AUPRO:0.8295
pipe_fryum: I-Auroc:0.9992, I-AP:0.9996, I-F1:0.9950, P-AUROC:0.9916, P-AP:0.6516, P-F1:0.6792, P-AUPRO:0.9533
Mean: I-Auroc:0.8838, I-AP:0.8952, I-F1:0.8528, P-AUROC:0.9636, P-AP:0.3971, P-F1:0.4539, P-AUPRO:0.7975






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone : SynCLR_vit_base_16   默认：(R448-C384)
interested_layers = [2, 3, 4, 5, 6, 7, 8, 9]

cuda:4
shots: 1
candle: I-Auroc:0.9675, I-AP:0.9697, I-F1:0.9208, P-AUROC:0.9821, P-AP:0.3422, P-F1:0.4283, P-AUPRO:0.9372
capsules: I-Auroc:0.8653, I-AP:0.9196, I-F1:0.8458, P-AUROC:0.9364, P-AP:0.2270, P-F1:0.3523, P-AUPRO:0.8275
cashew: I-Auroc:0.9342, I-AP:0.9685, I-F1:0.9048, P-AUROC:0.9765, P-AP:0.6194, P-F1:0.6098, P-AUPRO:0.8706
chewinggum: I-Auroc:0.9848, I-AP:0.9935, I-F1:0.9604, P-AUROC:0.9901, P-AP:0.7808, P-F1:0.7362, P-AUPRO:0.8811
fryum: I-Auroc:0.8968, I-AP:0.9545, I-F1:0.8626, P-AUROC:0.9403, P-AP:0.3967, P-F1:0.4345, P-AUPRO:0.8646
macaroni1: I-Auroc:0.8514, I-AP:0.8659, I-F1:0.7767, P-AUROC:0.9820, P-AP:0.1904, P-F1:0.3003, P-AUPRO:0.9032
macaroni2: I-Auroc:0.5419, I-AP:0.5050, I-F1:0.6713, P-AUROC:0.9643, P-AP:0.0537, P-F1:0.1411, P-AUPRO:0.8708
pcb1: I-Auroc:0.7979, I-AP:0.8107, I-F1:0.7350, P-AUROC:0.9869, P-AP:0.7170, P-F1:0.6906, P-AUPRO:0.8470
pcb2: I-Auroc:0.9001, I-AP:0.9119, I-F1:0.8387, P-AUROC:0.9396, P-AP:0.3869, P-F1:0.4714, P-AUPRO:0.7014
pcb3: I-Auroc:0.8445, I-AP:0.8549, I-F1:0.7909, P-AUROC:0.9512, P-AP:0.3587, P-F1:0.4229, P-AUPRO:0.8081
pcb4: I-Auroc:0.9832, I-AP:0.9824, I-F1:0.9479, P-AUROC:0.9470, P-AP:0.2695, P-F1:0.3492, P-AUPRO:0.8221
pipe_fryum: I-Auroc:0.9826, I-AP:0.9909, I-F1:0.9604, P-AUROC:0.9937, P-AP:0.7245, P-F1:0.7199, P-AUPRO:0.9606
Mean: I-Auroc:0.8792, I-AP:0.8940, I-F1:0.8513, P-AUROC:0.9658, P-AP:0.4222, P-F1:0.4714, P-AUPRO:0.8578
cuda:4
shots: 2
candle: I-Auroc:0.9705, I-AP:0.9711, I-F1:0.9208, P-AUROC:0.9840, P-AP:0.3597, P-F1:0.4427, P-AUPRO:0.9441
capsules: I-Auroc:0.9233, I-AP:0.9553, I-F1:0.9005, P-AUROC:0.9516, P-AP:0.2772, P-F1:0.3960, P-AUPRO:0.8684
cashew: I-Auroc:0.9712, I-AP:0.9842, I-F1:0.9519, P-AUROC:0.9809, P-AP:0.6656, P-F1:0.6552, P-AUPRO:0.9037
chewinggum: I-Auroc:0.9868, I-AP:0.9943, I-F1:0.9700, P-AUROC:0.9898, P-AP:0.7731, P-F1:0.7318, P-AUPRO:0.8791
fryum: I-Auroc:0.8970, I-AP:0.9552, I-F1:0.8636, P-AUROC:0.9413, P-AP:0.3923, P-F1:0.4329, P-AUPRO:0.8704
macaroni1: I-Auroc:0.8507, I-AP:0.8564, I-F1:0.7729, P-AUROC:0.9848, P-AP:0.1867, P-F1:0.2963, P-AUPRO:0.9163
macaroni2: I-Auroc:0.5461, I-AP:0.5124, I-F1:0.6712, P-AUROC:0.9615, P-AP:0.0396, P-F1:0.1151, P-AUPRO:0.8584
pcb1: I-Auroc:0.8476, I-AP:0.8418, I-F1:0.7902, P-AUROC:0.9891, P-AP:0.7395, P-F1:0.7042, P-AUPRO:0.8597
pcb2: I-Auroc:0.9127, I-AP:0.9160, I-F1:0.8585, P-AUROC:0.9458, P-AP:0.4174, P-F1:0.5070, P-AUPRO:0.7249
pcb3: I-Auroc:0.8346, I-AP:0.8483, I-F1:0.7879, P-AUROC:0.9585, P-AP:0.3907, P-F1:0.4437, P-AUPRO:0.8250
pcb4: I-Auroc:0.9877, I-AP:0.9860, I-F1:0.9561, P-AUROC:0.9562, P-AP:0.3076, P-F1:0.3868, P-AUPRO:0.8373
pipe_fryum: I-Auroc:0.9888, I-AP:0.9943, I-F1:0.9703, P-AUROC:0.9939, P-AP:0.7235, P-F1:0.7219, P-AUPRO:0.9626
Mean: I-Auroc:0.8931, I-AP:0.9013, I-F1:0.8678, P-AUROC:0.9698, P-AP:0.4394, P-F1:0.4861, P-AUPRO:0.8708
cuda:4
shots: 4
candle: I-Auroc:0.9747, I-AP:0.9762, I-F1:0.9200, P-AUROC:0.9875, P-AP:0.3679, P-F1:0.4464, P-AUPRO:0.9525
capsules: I-Auroc:0.9035, I-AP:0.9445, I-F1:0.8614, P-AUROC:0.9650, P-AP:0.3383, P-F1:0.4383, P-AUPRO:0.8696
cashew: I-Auroc:0.9622, I-AP:0.9797, I-F1:0.9320, P-AUROC:0.9809, P-AP:0.6832, P-F1:0.6759, P-AUPRO:0.8936
chewinggum: I-Auroc:0.9872, I-AP:0.9943, I-F1:0.9652, P-AUROC:0.9902, P-AP:0.7583, P-F1:0.7296, P-AUPRO:0.8806
fryum: I-Auroc:0.9534, I-AP:0.9795, I-F1:0.9184, P-AUROC:0.9472, P-AP:0.4155, P-F1:0.4682, P-AUPRO:0.8914
macaroni1: I-Auroc:0.8986, I-AP:0.9067, I-F1:0.8326, P-AUROC:0.9901, P-AP:0.2605, P-F1:0.3712, P-AUPRO:0.9409
macaroni2: I-Auroc:0.6057, I-AP:0.5462, I-F1:0.6855, P-AUROC:0.9671, P-AP:0.0442, P-F1:0.1359, P-AUPRO:0.8824
pcb1: I-Auroc:0.9034, I-AP:0.8774, I-F1:0.8571, P-AUROC:0.9921, P-AP:0.7586, P-F1:0.7148, P-AUPRO:0.8898
pcb2: I-Auroc:0.9481, I-AP:0.9497, I-F1:0.8934, P-AUROC:0.9514, P-AP:0.4416, P-F1:0.5249, P-AUPRO:0.7481
pcb3: I-Auroc:0.9049, I-AP:0.9180, I-F1:0.8387, P-AUROC:0.9676, P-AP:0.4859, P-F1:0.5318, P-AUPRO:0.8591
pcb4: I-Auroc:0.9932, I-AP:0.9934, I-F1:0.9604, P-AUROC:0.9699, P-AP:0.4102, P-F1:0.4735, P-AUPRO:0.8861
pipe_fryum: I-Auroc:0.9946, I-AP:0.9974, I-F1:0.9802, P-AUROC:0.9938, P-AP:0.7238, P-F1:0.7279, P-AUPRO:0.9640
Mean: I-Auroc:0.9191, I-AP:0.9219, I-F1:0.8871, P-AUROC:0.9752, P-AP:0.4740, P-F1:0.5199, P-AUPRO:0.8882





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

Backbone 为 dinov2reg_vit_large_14，结果如下：
shot=8; 更换 --seed 

cuda:4
shots: 8
seed: 2
candle: I-Auroc:0.9709, I-AP:0.9728, I-F1:0.9073, P-AUROC:0.9923, P-AP:0.4833, P-F1:0.5081, P-AUPRO:0.9512
capsules: I-Auroc:0.9752, I-AP:0.9850, I-F1:0.9458, P-AUROC:0.9823, P-AP:0.6531, P-F1:0.6527, P-AUPRO:0.9604
cashew: I-Auroc:0.9658, I-AP:0.9827, I-F1:0.9302, P-AUROC:0.9842, P-AP:0.5564, P-F1:0.5637, P-AUPRO:0.9513
chewinggum: I-Auroc:0.9960, I-AP:0.9980, I-F1:0.9802, P-AUROC:0.9938, P-AP:0.6567, P-F1:0.6890, P-AUPRO:0.9394
fryum: I-Auroc:0.9754, I-AP:0.9887, I-F1:0.9424, P-AUROC:0.9425, P-AP:0.4085, P-F1:0.4481, P-AUPRO:0.8994
macaroni1: I-Auroc:0.9862, I-AP:0.9867, I-F1:0.9366, P-AUROC:0.9954, P-AP:0.3297, P-F1:0.4246, P-AUPRO:0.9627
macaroni2: I-Auroc:0.8066, I-AP:0.7404, I-F1:0.7967, P-AUROC:0.9930, P-AP:0.2229, P-F1:0.3166, P-AUPRO:0.9672
pcb1: I-Auroc:0.9461, I-AP:0.9350, I-F1:0.9307, P-AUROC:0.9899, P-AP:0.7780, P-F1:0.7351, P-AUPRO:0.9191
pcb2: I-Auroc:0.9518, I-AP:0.9570, I-F1:0.9055, P-AUROC:0.9653, P-AP:0.5301, P-F1:0.5556, P-AUPRO:0.8465
pcb3: I-Auroc:0.9680, I-AP:0.9679, I-F1:0.9135, P-AUROC:0.9832, P-AP:0.5663, P-F1:0.5888, P-AUPRO:0.9121
pcb4: I-Auroc:0.9949, I-AP:0.9942, I-F1:0.9746, P-AUROC:0.9655, P-AP:0.3780, P-F1:0.4255, P-AUPRO:0.8780
pipe_fryum: I-Auroc:0.9944, I-AP:0.9974, I-F1:0.9798, P-AUROC:0.9883, P-AP:0.4970, P-F1:0.5973, P-AUPRO:0.9622
Mean: I-Auroc:0.9609, I-AP:0.9588, I-F1:0.9286, P-AUROC:0.9813, P-AP:0.5050, P-F1:0.5421, P-AUPRO:0.9291
cuda:4
shots: 8
seed: 111
candle: I-Auroc:0.9769, I-AP:0.9794, I-F1:0.9286, P-AUROC:0.9923, P-AP:0.4925, P-F1:0.5014, P-AUPRO:0.9533
capsules: I-Auroc:0.9813, I-AP:0.9892, I-F1:0.9430, P-AUROC:0.9851, P-AP:0.6155, P-F1:0.6197, P-AUPRO:0.9610
cashew: I-Auroc:0.9656, I-AP:0.9819, I-F1:0.9366, P-AUROC:0.9838, P-AP:0.5548, P-F1:0.5491, P-AUPRO:0.9622
chewinggum: I-Auroc:0.9958, I-AP:0.9980, I-F1:0.9754, P-AUROC:0.9931, P-AP:0.6400, P-F1:0.6779, P-AUPRO:0.9333
fryum: I-Auroc:0.9406, I-AP:0.9743, I-F1:0.9072, P-AUROC:0.9383, P-AP:0.4082, P-F1:0.4454, P-AUPRO:0.8924
macaroni1: I-Auroc:0.9604, I-AP:0.9645, I-F1:0.9016, P-AUROC:0.9949, P-AP:0.3404, P-F1:0.4336, P-AUPRO:0.9473
macaroni2: I-Auroc:0.8584, I-AP:0.8520, I-F1:0.8053, P-AUROC:0.9945, P-AP:0.2977, P-F1:0.3975, P-AUPRO:0.9678
pcb1: I-Auroc:0.9419, I-AP:0.9295, I-F1:0.9200, P-AUROC:0.9908, P-AP:0.7659, P-F1:0.7242, P-AUPRO:0.9177
pcb2: I-Auroc:0.9454, I-AP:0.9412, I-F1:0.9128, P-AUROC:0.9666, P-AP:0.4996, P-F1:0.5420, P-AUPRO:0.8538
pcb3: I-Auroc:0.9699, I-AP:0.9710, I-F1:0.9194, P-AUROC:0.9825, P-AP:0.5646, P-F1:0.5914, P-AUPRO:0.9141
pcb4: I-Auroc:0.9958, I-AP:0.9954, I-F1:0.9751, P-AUROC:0.9655, P-AP:0.3719, P-F1:0.4252, P-AUPRO:0.8742
pipe_fryum: I-Auroc:0.9836, I-AP:0.9922, I-F1:0.9604, P-AUROC:0.9882, P-AP:0.5068, P-F1:0.5945, P-AUPRO:0.9627
Mean: I-Auroc:0.9596, I-AP:0.9640, I-F1:0.9238, P-AUROC:0.9813, P-AP:0.5048, P-F1:0.5418, P-AUPRO:0.9283
cuda:4
shots: 8
seed: 0
candle: I-Auroc:0.9721, I-AP:0.9758, I-F1:0.9286, P-AUROC:0.9920, P-AP:0.4911, P-F1:0.5137, P-AUPRO:0.9452
capsules: I-Auroc:0.9807, I-AP:0.9891, I-F1:0.9548, P-AUROC:0.9873, P-AP:0.6609, P-F1:0.6525, P-AUPRO:0.9594
cashew: I-Auroc:0.9686, I-AP:0.9838, I-F1:0.9353, P-AUROC:0.9849, P-AP:0.5636, P-F1:0.5695, P-AUPRO:0.9587
chewinggum: I-Auroc:0.9964, I-AP:0.9982, I-F1:0.9851, P-AUROC:0.9939, P-AP:0.6841, P-F1:0.6796, P-AUPRO:0.9358
fryum: I-Auroc:0.9570, I-AP:0.9810, I-F1:0.9175, P-AUROC:0.9402, P-AP:0.4085, P-F1:0.4467, P-AUPRO:0.9030
macaroni1: I-Auroc:0.9882, I-AP:0.9876, I-F1:0.9608, P-AUROC:0.9950, P-AP:0.3489, P-F1:0.4314, P-AUPRO:0.9559
macaroni2: I-Auroc:0.8677, I-AP:0.8537, I-F1:0.8056, P-AUROC:0.9912, P-AP:0.2890, P-F1:0.4035, P-AUPRO:0.9565
pcb1: I-Auroc:0.9319, I-AP:0.9148, I-F1:0.9192, P-AUROC:0.9910, P-AP:0.7648, P-F1:0.7258, P-AUPRO:0.9236
pcb2: I-Auroc:0.9570, I-AP:0.9543, I-F1:0.9239, P-AUROC:0.9669, P-AP:0.5265, P-F1:0.5666, P-AUPRO:0.8604
pcb3: I-Auroc:0.9775, I-AP:0.9778, I-F1:0.9261, P-AUROC:0.9828, P-AP:0.5688, P-F1:0.5914, P-AUPRO:0.9099
pcb4: I-Auroc:0.9956, I-AP:0.9954, I-F1:0.9709, P-AUROC:0.9686, P-AP:0.4220, P-F1:0.4754, P-AUPRO:0.8901
pipe_fryum: I-Auroc:0.9938, I-AP:0.9974, I-F1:0.9848, P-AUROC:0.9882, P-AP:0.4958, P-F1:0.5932, P-AUPRO:0.9637
Mean: I-Auroc:0.9655, I-AP:0.9674, I-F1:0.9344, P-AUROC:0.9818, P-AP:0.5187, P-F1:0.5541, P-AUPRO:0.9302
cuda:4
shots: 8
seed: 3407
candle: I-Auroc:0.9758, I-AP:0.9790, I-F1:0.9388, P-AUROC:0.9925, P-AP:0.4831, P-F1:0.5105, P-AUPRO:0.9578
capsules: I-Auroc:0.9642, I-AP:0.9820, I-F1:0.9406, P-AUROC:0.9842, P-AP:0.6491, P-F1:0.6571, P-AUPRO:0.9571
cashew: I-Auroc:0.9678, I-AP:0.9839, I-F1:0.9378, P-AUROC:0.9852, P-AP:0.5772, P-F1:0.5658, P-AUPRO:0.9512
chewinggum: I-Auroc:0.9962, I-AP:0.9981, I-F1:0.9804, P-AUROC:0.9937, P-AP:0.6635, P-F1:0.6811, P-AUPRO:0.9373
fryum: I-Auroc:0.9796, I-AP:0.9905, I-F1:0.9447, P-AUROC:0.9395, P-AP:0.4039, P-F1:0.4401, P-AUPRO:0.9035
macaroni1: I-Auroc:0.9739, I-AP:0.9742, I-F1:0.9245, P-AUROC:0.9952, P-AP:0.3412, P-F1:0.4298, P-AUPRO:0.9436
macaroni2: I-Auroc:0.8303, I-AP:0.7665, I-F1:0.8186, P-AUROC:0.9931, P-AP:0.2257, P-F1:0.3216, P-AUPRO:0.9667
pcb1: I-Auroc:0.9365, I-AP:0.9263, I-F1:0.9293, P-AUROC:0.9905, P-AP:0.7681, P-F1:0.7327, P-AUPRO:0.9062
pcb2: I-Auroc:0.9510, I-AP:0.9574, I-F1:0.9064, P-AUROC:0.9679, P-AP:0.5249, P-F1:0.5512, P-AUPRO:0.8626
pcb3: I-Auroc:0.9725, I-AP:0.9745, I-F1:0.9159, P-AUROC:0.9832, P-AP:0.5741, P-F1:0.5963, P-AUPRO:0.9072
pcb4: I-Auroc:0.9974, I-AP:0.9973, I-F1:0.9852, P-AUROC:0.9700, P-AP:0.4418, P-F1:0.4935, P-AUPRO:0.8873
pipe_fryum: I-Auroc:0.9924, I-AP:0.9963, I-F1:0.9703, P-AUROC:0.9878, P-AP:0.4946, P-F1:0.5902, P-AUPRO:0.9685
Mean: I-Auroc:0.9615, I-AP:0.9605, I-F1:0.9327, P-AUROC:0.9819, P-AP:0.5123, P-F1:0.5475, P-AUPRO:0.9291
cuda:4
shots: 8
seed: 114514
candle: I-Auroc:0.9552, I-AP:0.9630, I-F1:0.8958, P-AUROC:0.9923, P-AP:0.5012, P-F1:0.5271, P-AUPRO:0.9441
capsules: I-Auroc:0.9665, I-AP:0.9813, I-F1:0.9171, P-AUROC:0.9840, P-AP:0.6551, P-F1:0.6500, P-AUPRO:0.9557
cashew: I-Auroc:0.9646, I-AP:0.9825, I-F1:0.9275, P-AUROC:0.9851, P-AP:0.5640, P-F1:0.5689, P-AUPRO:0.9559
chewinggum: I-Auroc:0.9968, I-AP:0.9984, I-F1:0.9852, P-AUROC:0.9944, P-AP:0.6767, P-F1:0.6899, P-AUPRO:0.9460
fryum: I-Auroc:0.9848, I-AP:0.9930, I-F1:0.9548, P-AUROC:0.9391, P-AP:0.4042, P-F1:0.4440, P-AUPRO:0.8932
macaroni1: I-Auroc:0.9936, I-AP:0.9934, I-F1:0.9655, P-AUROC:0.9946, P-AP:0.3460, P-F1:0.4330, P-AUPRO:0.9587
macaroni2: I-Auroc:0.8799, I-AP:0.8561, I-F1:0.8442, P-AUROC:0.9948, P-AP:0.2881, P-F1:0.4006, P-AUPRO:0.9657
pcb1: I-Auroc:0.9421, I-AP:0.9399, I-F1:0.9300, P-AUROC:0.9904, P-AP:0.7844, P-F1:0.7310, P-AUPRO:0.9198
pcb2: I-Auroc:0.9426, I-AP:0.9437, I-F1:0.8955, P-AUROC:0.9680, P-AP:0.5159, P-F1:0.5488, P-AUPRO:0.8582
pcb3: I-Auroc:0.9832, I-AP:0.9833, I-F1:0.9394, P-AUROC:0.9833, P-AP:0.5669, P-F1:0.5915, P-AUPRO:0.9062
pcb4: I-Auroc:0.9968, I-AP:0.9964, I-F1:0.9852, P-AUROC:0.9688, P-AP:0.4399, P-F1:0.4901, P-AUPRO:0.8862
pipe_fryum: I-Auroc:0.9946, I-AP:0.9974, I-F1:0.9802, P-AUROC:0.9879, P-AP:0.5035, P-F1:0.5960, P-AUPRO:0.9576
Mean: I-Auroc:0.9667, I-AP:0.9690, I-F1:0.9350, P-AUROC:0.9819, P-AP:0.5205, P-F1:0.5559, P-AUPRO:0.9289
