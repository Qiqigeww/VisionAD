
-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 0(原始种子0)

cuda:4
shots: 1
candle: I-Auroc:0.9452, I-AP:0.9569, I-F1:0.8947, P-AUROC:0.9899, P-AP:0.4801, P-F1:0.5218, P-AUPRO:0.9422
capsules: I-Auroc:0.9663, I-AP:0.9813, I-F1:0.9326, P-AUROC:0.9787, P-AP:0.5484, P-F1:0.5678, P-AUPRO:0.9437
cashew: I-Auroc:0.9458, I-AP:0.9747, I-F1:0.9171, P-AUROC:0.9808, P-AP:0.5168, P-F1:0.5285, P-AUPRO:0.9508
chewinggum: I-Auroc:0.9936, I-AP:0.9970, I-F1:0.9749, P-AUROC:0.9938, P-AP:0.6814, P-F1:0.6920, P-AUPRO:0.9422
fryum: I-Auroc:0.9730, I-AP:0.9878, I-F1:0.9340, P-AUROC:0.9246, P-AP:0.3647, P-F1:0.4072, P-AUPRO:0.8946
macaroni1: I-Auroc:0.8865, I-AP:0.9009, I-F1:0.8103, P-AUROC:0.9940, P-AP:0.3148, P-F1:0.3994, P-AUPRO:0.9489
macaroni2: I-Auroc:0.7910, I-AP:0.7227, I-F1:0.7699, P-AUROC:0.9805, P-AP:0.1924, P-F1:0.2709, P-AUPRO:0.9175
pcb1: I-Auroc:0.9205, I-AP:0.9096, I-F1:0.8776, P-AUROC:0.9887, P-AP:0.6948, P-F1:0.6612, P-AUPRO:0.9009
pcb2: I-Auroc:0.9316, I-AP:0.9414, I-F1:0.8750, P-AUROC:0.9577, P-AP:0.4844, P-F1:0.5290, P-AUPRO:0.8095
pcb3: I-Auroc:0.9362, I-AP:0.9310, I-F1:0.8750, P-AUROC:0.9661, P-AP:0.5108, P-F1:0.5329, P-AUPRO:0.8715
pcb4: I-Auroc:0.9923, I-AP:0.9918, I-F1:0.9700, P-AUROC:0.9368, P-AP:0.2939, P-F1:0.3646, P-AUPRO:0.7957
pipe_fryum: I-Auroc:0.9652, I-AP:0.9834, I-F1:0.9375, P-AUROC:0.9862, P-AP:0.4751, P-F1:0.5554, P-AUPRO:0.9599
Mean: I-Auroc:0.9373, I-AP:0.9399, I-F1:0.8974, P-AUROC:0.9731, P-AP:0.4631, P-F1:0.5025, P-AUPRO:0.9065
cuda:4
shots: 2
candle: I-Auroc:0.9573, I-AP:0.9648, I-F1:0.9110, P-AUROC:0.9906, P-AP:0.4873, P-F1:0.5225, P-AUPRO:0.9414
capsules: I-Auroc:0.9832, I-AP:0.9902, I-F1:0.9485, P-AUROC:0.9822, P-AP:0.5680, P-F1:0.5744, P-AUPRO:0.9521
cashew: I-Auroc:0.9562, I-AP:0.9778, I-F1:0.9327, P-AUROC:0.9824, P-AP:0.5273, P-F1:0.5409, P-AUPRO:0.9587
chewinggum: I-Auroc:0.9932, I-AP:0.9968, I-F1:0.9694, P-AUROC:0.9935, P-AP:0.6667, P-F1:0.6879, P-AUPRO:0.9363
fryum: I-Auroc:0.9728, I-AP:0.9878, I-F1:0.9333, P-AUROC:0.9285, P-AP:0.3755, P-F1:0.4177, P-AUPRO:0.8963
macaroni1: I-Auroc:0.9526, I-AP:0.9536, I-F1:0.8986, P-AUROC:0.9942, P-AP:0.3426, P-F1:0.4271, P-AUPRO:0.9454
macaroni2: I-Auroc:0.7682, I-AP:0.6961, I-F1:0.7602, P-AUROC:0.9837, P-AP:0.1740, P-F1:0.2818, P-AUPRO:0.9257
pcb1: I-Auroc:0.9229, I-AP:0.9060, I-F1:0.8878, P-AUROC:0.9895, P-AP:0.7083, P-F1:0.6716, P-AUPRO:0.9008
pcb2: I-Auroc:0.9357, I-AP:0.9419, I-F1:0.8821, P-AUROC:0.9625, P-AP:0.5016, P-F1:0.5445, P-AUPRO:0.8403
pcb3: I-Auroc:0.9306, I-AP:0.9268, I-F1:0.8879, P-AUROC:0.9722, P-AP:0.5243, P-F1:0.5421, P-AUPRO:0.8768
pcb4: I-Auroc:0.9899, I-AP:0.9885, I-F1:0.9608, P-AUROC:0.9478, P-AP:0.3035, P-F1:0.3680, P-AUPRO:0.8136
pipe_fryum: I-Auroc:0.9780, I-AP:0.9893, I-F1:0.9552, P-AUROC:0.9871, P-AP:0.4830, P-F1:0.5673, P-AUPRO:0.9624
Mean: I-Auroc:0.9450, I-AP:0.9433, I-F1:0.9106, P-AUROC:0.9762, P-AP:0.4718, P-F1:0.5122, P-AUPRO:0.9125
cuda:4
shots: 4
candle: I-Auroc:0.9684, I-AP:0.9720, I-F1:0.9231, P-AUROC:0.9917, P-AP:0.4965, P-F1:0.5201, P-AUPRO:0.9429
capsules: I-Auroc:0.9787, I-AP:0.9882, I-F1:0.9495, P-AUROC:0.9872, P-AP:0.6414, P-F1:0.6374, P-AUPRO:0.9600
cashew: I-Auroc:0.9720, I-AP:0.9865, I-F1:0.9429, P-AUROC:0.9838, P-AP:0.5424, P-F1:0.5556, P-AUPRO:0.9608
chewinggum: I-Auroc:0.9956, I-AP:0.9979, I-F1:0.9802, P-AUROC:0.9936, P-AP:0.6718, P-F1:0.6841, P-AUPRO:0.9392
fryum: I-Auroc:0.9864, I-AP:0.9937, I-F1:0.9557, P-AUROC:0.9353, P-AP:0.3903, P-F1:0.4335, P-AUPRO:0.9060
macaroni1: I-Auroc:0.9883, I-AP:0.9878, I-F1:0.9561, P-AUROC:0.9947, P-AP:0.3510, P-F1:0.4349, P-AUPRO:0.9572
macaroni2: I-Auroc:0.8191, I-AP:0.7826, I-F1:0.7761, P-AUROC:0.9878, P-AP:0.2471, P-F1:0.3463, P-AUPRO:0.9408
pcb1: I-Auroc:0.9266, I-AP:0.9080, I-F1:0.8966, P-AUROC:0.9904, P-AP:0.7258, P-F1:0.6849, P-AUPRO:0.9082
pcb2: I-Auroc:0.9529, I-AP:0.9565, I-F1:0.9154, P-AUROC:0.9638, P-AP:0.5137, P-F1:0.5597, P-AUPRO:0.8501
pcb3: I-Auroc:0.9594, I-AP:0.9622, I-F1:0.9184, P-AUROC:0.9774, P-AP:0.5484, P-F1:0.5732, P-AUPRO:0.8979
pcb4: I-Auroc:0.9904, I-AP:0.9894, I-F1:0.9662, P-AUROC:0.9625, P-AP:0.3897, P-F1:0.4479, P-AUPRO:0.8714
pipe_fryum: I-Auroc:0.9906, I-AP:0.9959, I-F1:0.9749, P-AUROC:0.9874, P-AP:0.4832, P-F1:0.5801, P-AUPRO:0.9614
Mean: I-Auroc:0.9607, I-AP:0.9601, I-F1:0.9296, P-AUROC:0.9796, P-AP:0.5001, P-F1:0.5381, P-AUPRO:0.9246





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 111

cuda:5
shots: 1
candle: I-Auroc:0.9531, I-AP:0.9622, I-F1:0.8990, P-AUROC:0.9890, P-AP:0.4389, P-F1:0.4978, P-AUPRO:0.9426
capsules: I-Auroc:0.9563, I-AP:0.9746, I-F1:0.9223, P-AUROC:0.9737, P-AP:0.5291, P-F1:0.5567, P-AUPRO:0.9338
cashew: I-Auroc:0.9676, I-AP:0.9836, I-F1:0.9366, P-AUROC:0.9760, P-AP:0.4672, P-F1:0.4986, P-AUPRO:0.9671
chewinggum: I-Auroc:0.9962, I-AP:0.9981, I-F1:0.9852, P-AUROC:0.9944, P-AP:0.6725, P-F1:0.6989, P-AUPRO:0.9401
fryum: I-Auroc:0.9770, I-AP:0.9898, I-F1:0.9596, P-AUROC:0.9207, P-AP:0.3458, P-F1:0.3851, P-AUPRO:0.8704
macaroni1: I-Auroc:0.9113, I-AP:0.9204, I-F1:0.8437, P-AUROC:0.9909, P-AP:0.3000, P-F1:0.3946, P-AUPRO:0.9355
macaroni2: I-Auroc:0.7475, I-AP:0.7028, I-F1:0.7166, P-AUROC:0.9866, P-AP:0.2321, P-F1:0.3179, P-AUPRO:0.9442
pcb1: I-Auroc:0.9367, I-AP:0.9281, I-F1:0.9137, P-AUROC:0.9863, P-AP:0.7313, P-F1:0.6954, P-AUPRO:0.8935
pcb2: I-Auroc:0.8924, I-AP:0.9018, I-F1:0.8018, P-AUROC:0.9548, P-AP:0.4273, P-F1:0.4739, P-AUPRO:0.8405
pcb3: I-Auroc:0.9113, I-AP:0.9279, I-F1:0.8272, P-AUROC:0.9680, P-AP:0.4407, P-F1:0.4918, P-AUPRO:0.8842
pcb4: I-Auroc:0.9920, I-AP:0.9908, I-F1:0.9703, P-AUROC:0.9525, P-AP:0.3279, P-F1:0.3861, P-AUPRO:0.8470
pipe_fryum: I-Auroc:0.9922, I-AP:0.9962, I-F1:0.9648, P-AUROC:0.9835, P-AP:0.4396, P-F1:0.5557, P-AUPRO:0.9615
Mean: I-Auroc:0.9361, I-AP:0.9397, I-F1:0.8951, P-AUROC:0.9730, P-AP:0.4460, P-F1:0.4960, P-AUPRO:0.9134
cuda:5
shots: 2
candle: I-Auroc:0.9664, I-AP:0.9713, I-F1:0.9184, P-AUROC:0.9905, P-AP:0.4552, P-F1:0.5025, P-AUPRO:0.9443
capsules: I-Auroc:0.9433, I-AP:0.9689, I-F1:0.9126, P-AUROC:0.9756, P-AP:0.5438, P-F1:0.5684, P-AUPRO:0.9429
cashew: I-Auroc:0.9658, I-AP:0.9827, I-F1:0.9458, P-AUROC:0.9795, P-AP:0.4913, P-F1:0.5088, P-AUPRO:0.9639
chewinggum: I-Auroc:0.9956, I-AP:0.9978, I-F1:0.9802, P-AUROC:0.9940, P-AP:0.6675, P-F1:0.6938, P-AUPRO:0.9340
fryum: I-Auroc:0.9168, I-AP:0.9638, I-F1:0.8804, P-AUROC:0.9320, P-AP:0.3900, P-F1:0.4238, P-AUPRO:0.8802
macaroni1: I-Auroc:0.9671, I-AP:0.9707, I-F1:0.9048, P-AUROC:0.9937, P-AP:0.3483, P-F1:0.4329, P-AUPRO:0.9505
macaroni2: I-Auroc:0.8297, I-AP:0.8382, I-F1:0.7733, P-AUROC:0.9906, P-AP:0.2818, P-F1:0.3857, P-AUPRO:0.9540
pcb1: I-Auroc:0.9328, I-AP:0.9225, I-F1:0.9100, P-AUROC:0.9888, P-AP:0.7448, P-F1:0.7055, P-AUPRO:0.9036
pcb2: I-Auroc:0.9298, I-AP:0.9325, I-F1:0.8812, P-AUROC:0.9606, P-AP:0.4806, P-F1:0.5245, P-AUPRO:0.8389
pcb3: I-Auroc:0.9727, I-AP:0.9730, I-F1:0.9163, P-AUROC:0.9777, P-AP:0.5280, P-F1:0.5698, P-AUPRO:0.9100
pcb4: I-Auroc:0.9926, I-AP:0.9917, I-F1:0.9751, P-AUROC:0.9539, P-AP:0.3388, P-F1:0.3970, P-AUPRO:0.8509
pipe_fryum: I-Auroc:0.9948, I-AP:0.9975, I-F1:0.9744, P-AUROC:0.9863, P-AP:0.4659, P-F1:0.5749, P-AUPRO:0.9671
Mean: I-Auroc:0.9506, I-AP:0.9592, I-F1:0.9144, P-AUROC:0.9769, P-AP:0.4780, P-F1:0.5240, P-AUPRO:0.9200
cuda:5
shots: 4
candle: I-Auroc:0.9705, I-AP:0.9745, I-F1:0.9184, P-AUROC:0.9914, P-AP:0.4603, P-F1:0.5003, P-AUPRO:0.9498
capsules: I-Auroc:0.9617, I-AP:0.9773, I-F1:0.9286, P-AUROC:0.9814, P-AP:0.6008, P-F1:0.6091, P-AUPRO:0.9526
cashew: I-Auroc:0.9670, I-AP:0.9824, I-F1:0.9388, P-AUROC:0.9825, P-AP:0.5150, P-F1:0.5280, P-AUPRO:0.9680
chewinggum: I-Auroc:0.9966, I-AP:0.9983, I-F1:0.9852, P-AUROC:0.9936, P-AP:0.6411, P-F1:0.6732, P-AUPRO:0.9368
fryum: I-Auroc:0.9418, I-AP:0.9749, I-F1:0.9005, P-AUROC:0.9343, P-AP:0.3970, P-F1:0.4318, P-AUPRO:0.8908
macaroni1: I-Auroc:0.9367, I-AP:0.9463, I-F1:0.8629, P-AUROC:0.9943, P-AP:0.3281, P-F1:0.4264, P-AUPRO:0.9509
macaroni2: I-Auroc:0.8257, I-AP:0.8179, I-F1:0.7706, P-AUROC:0.9921, P-AP:0.2884, P-F1:0.3902, P-AUPRO:0.9619
pcb1: I-Auroc:0.9338, I-AP:0.9227, I-F1:0.9200, P-AUROC:0.9895, P-AP:0.7548, P-F1:0.7149, P-AUPRO:0.9090
pcb2: I-Auroc:0.9311, I-AP:0.9346, I-F1:0.8878, P-AUROC:0.9638, P-AP:0.4889, P-F1:0.5290, P-AUPRO:0.8524
pcb3: I-Auroc:0.9722, I-AP:0.9732, I-F1:0.9151, P-AUROC:0.9801, P-AP:0.5438, P-F1:0.5797, P-AUPRO:0.9153
pcb4: I-Auroc:0.9949, I-AP:0.9944, I-F1:0.9754, P-AUROC:0.9597, P-AP:0.3531, P-F1:0.4088, P-AUPRO:0.8584
pipe_fryum: I-Auroc:0.9904, I-AP:0.9955, I-F1:0.9746, P-AUROC:0.9871, P-AP:0.4770, P-F1:0.5790, P-AUPRO:0.9626
Mean: I-Auroc:0.9519, I-AP:0.9577, I-F1:0.9148, P-AUROC:0.9792, P-AP:0.4874, P-F1:0.5309, P-AUPRO:0.9257




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 1

cuda:5
shots: 1
candle: I-Auroc:0.9681, I-AP:0.9720, I-F1:0.9163, P-AUROC:0.9890, P-AP:0.4695, P-F1:0.5107, P-AUPRO:0.9313
capsules: I-Auroc:0.9593, I-AP:0.9782, I-F1:0.9216, P-AUROC:0.9828, P-AP:0.5873, P-F1:0.6005, P-AUPRO:0.9540
cashew: I-Auroc:0.9288, I-AP:0.9633, I-F1:0.9137, P-AUROC:0.9799, P-AP:0.4833, P-F1:0.4940, P-AUPRO:0.9633
chewinggum: I-Auroc:0.9956, I-AP:0.9978, I-F1:0.9751, P-AUROC:0.9939, P-AP:0.6659, P-F1:0.6937, P-AUPRO:0.9377
fryum: I-Auroc:0.9558, I-AP:0.9814, I-F1:0.9255, P-AUROC:0.9210, P-AP:0.3699, P-F1:0.4051, P-AUPRO:0.8778
macaroni1: I-Auroc:0.9082, I-AP:0.9199, I-F1:0.8357, P-AUROC:0.9916, P-AP:0.2906, P-F1:0.3720, P-AUPRO:0.9387
macaroni2: I-Auroc:0.7234, I-AP:0.6383, I-F1:0.7294, P-AUROC:0.9893, P-AP:0.1562, P-F1:0.2583, P-AUPRO:0.9472
pcb1: I-Auroc:0.9391, I-AP:0.9166, I-F1:0.8901, P-AUROC:0.9864, P-AP:0.7358, P-F1:0.6972, P-AUPRO:0.8927
pcb2: I-Auroc:0.9353, I-AP:0.9354, I-F1:0.8708, P-AUROC:0.9611, P-AP:0.4673, P-F1:0.5142, P-AUPRO:0.8289
pcb3: I-Auroc:0.9319, I-AP:0.9369, I-F1:0.8788, P-AUROC:0.9704, P-AP:0.5045, P-F1:0.5346, P-AUPRO:0.8531
pcb4: I-Auroc:0.9937, I-AP:0.9935, I-F1:0.9648, P-AUROC:0.9347, P-AP:0.3010, P-F1:0.3614, P-AUPRO:0.7820
pipe_fryum: I-Auroc:0.9474, I-AP:0.9756, I-F1:0.9137, P-AUROC:0.9846, P-AP:0.4600, P-F1:0.5394, P-AUPRO:0.9589
Mean: I-Auroc:0.9322, I-AP:0.9341, I-F1:0.8946, P-AUROC:0.9737, P-AP:0.4576, P-F1:0.4984, P-AUPRO:0.9055
cuda:5
shots: 2
candle: I-Auroc:0.9413, I-AP:0.9487, I-F1:0.8756, P-AUROC:0.9903, P-AP:0.4825, P-F1:0.5164, P-AUPRO:0.9358
capsules: I-Auroc:0.9602, I-AP:0.9793, I-F1:0.9261, P-AUROC:0.9823, P-AP:0.6075, P-F1:0.6173, P-AUPRO:0.9458
cashew: I-Auroc:0.9542, I-AP:0.9760, I-F1:0.9327, P-AUROC:0.9827, P-AP:0.5292, P-F1:0.5441, P-AUPRO:0.9669
chewinggum: I-Auroc:0.9940, I-AP:0.9971, I-F1:0.9703, P-AUROC:0.9935, P-AP:0.6660, P-F1:0.6909, P-AUPRO:0.9318
fryum: I-Auroc:0.9776, I-AP:0.9904, I-F1:0.9534, P-AUROC:0.9320, P-AP:0.3850, P-F1:0.4188, P-AUPRO:0.8932
macaroni1: I-Auroc:0.8791, I-AP:0.9033, I-F1:0.8152, P-AUROC:0.9928, P-AP:0.3072, P-F1:0.4108, P-AUPRO:0.9370
macaroni2: I-Auroc:0.7581, I-AP:0.6869, I-F1:0.7692, P-AUROC:0.9900, P-AP:0.2035, P-F1:0.3053, P-AUPRO:0.9479
pcb1: I-Auroc:0.9511, I-AP:0.9361, I-F1:0.9254, P-AUROC:0.9877, P-AP:0.7580, P-F1:0.7163, P-AUPRO:0.8982
pcb2: I-Auroc:0.9334, I-AP:0.9298, I-F1:0.8812, P-AUROC:0.9625, P-AP:0.4728, P-F1:0.5264, P-AUPRO:0.8378
pcb3: I-Auroc:0.9521, I-AP:0.9553, I-F1:0.8808, P-AUROC:0.9764, P-AP:0.5278, P-F1:0.5599, P-AUPRO:0.8855
pcb4: I-Auroc:0.9955, I-AP:0.9953, I-F1:0.9751, P-AUROC:0.9491, P-AP:0.3372, P-F1:0.3960, P-AUPRO:0.8328
pipe_fryum: I-Auroc:0.9826, I-AP:0.9921, I-F1:0.9500, P-AUROC:0.9862, P-AP:0.4773, P-F1:0.5766, P-AUPRO:0.9652
Mean: I-Auroc:0.9399, I-AP:0.9408, I-F1:0.9046, P-AUROC:0.9771, P-AP:0.4795, P-F1:0.5232, P-AUPRO:0.9148
cuda:5
shots: 4
candle: I-Auroc:0.9570, I-AP:0.9613, I-F1:0.9036, P-AUROC:0.9915, P-AP:0.4806, P-F1:0.5067, P-AUPRO:0.9443
capsules: I-Auroc:0.9508, I-AP:0.9756, I-F1:0.9254, P-AUROC:0.9863, P-AP:0.6121, P-F1:0.6154, P-AUPRO:0.9595
cashew: I-Auroc:0.9642, I-AP:0.9813, I-F1:0.9423, P-AUROC:0.9846, P-AP:0.5465, P-F1:0.5554, P-AUPRO:0.9663
chewinggum: I-Auroc:0.9950, I-AP:0.9975, I-F1:0.9802, P-AUROC:0.9935, P-AP:0.6791, P-F1:0.6872, P-AUPRO:0.9319
fryum: I-Auroc:0.9788, I-AP:0.9909, I-F1:0.9641, P-AUROC:0.9361, P-AP:0.3959, P-F1:0.4325, P-AUPRO:0.8974
macaroni1: I-Auroc:0.8723, I-AP:0.8981, I-F1:0.8021, P-AUROC:0.9927, P-AP:0.3038, P-F1:0.4071, P-AUPRO:0.9342
macaroni2: I-Auroc:0.8002, I-AP:0.7553, I-F1:0.7769, P-AUROC:0.9921, P-AP:0.2572, P-F1:0.3552, P-AUPRO:0.9525
pcb1: I-Auroc:0.9385, I-AP:0.9219, I-F1:0.9300, P-AUROC:0.9899, P-AP:0.7732, P-F1:0.7305, P-AUPRO:0.9068
pcb2: I-Auroc:0.9470, I-AP:0.9501, I-F1:0.8945, P-AUROC:0.9657, P-AP:0.5074, P-F1:0.5472, P-AUPRO:0.8451
pcb3: I-Auroc:0.9554, I-AP:0.9603, I-F1:0.8804, P-AUROC:0.9798, P-AP:0.5437, P-F1:0.5789, P-AUPRO:0.8887
pcb4: I-Auroc:0.9946, I-AP:0.9940, I-F1:0.9706, P-AUROC:0.9551, P-AP:0.3468, P-F1:0.4027, P-AUPRO:0.8541
pipe_fryum: I-Auroc:0.9816, I-AP:0.9918, I-F1:0.9529, P-AUROC:0.9874, P-AP:0.4935, P-F1:0.5945, P-AUPRO:0.9656
Mean: I-Auroc:0.9446, I-AP:0.9482, I-F1:0.9102, P-AUROC:0.9796, P-AP:0.4950, P-F1:0.5344, P-AUPRO:0.9205




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 1234

cuda:5
shots: 1
candle: I-Auroc:0.9423, I-AP:0.9511, I-F1:0.8677, P-AUROC:0.9901, P-AP:0.4536, P-F1:0.4964, P-AUPRO:0.9412
capsules: I-Auroc:0.9655, I-AP:0.9800, I-F1:0.9282, P-AUROC:0.9741, P-AP:0.5656, P-F1:0.5864, P-AUPRO:0.9264
cashew: I-Auroc:0.9662, I-AP:0.9833, I-F1:0.9340, P-AUROC:0.9798, P-AP:0.4998, P-F1:0.5207, P-AUPRO:0.9566
chewinggum: I-Auroc:0.9946, I-AP:0.9973, I-F1:0.9754, P-AUROC:0.9941, P-AP:0.6621, P-F1:0.6820, P-AUPRO:0.9424
fryum: I-Auroc:0.9614, I-AP:0.9822, I-F1:0.9231, P-AUROC:0.9303, P-AP:0.3712, P-F1:0.4080, P-AUPRO:0.8907
macaroni1: I-Auroc:0.9734, I-AP:0.9760, I-F1:0.9175, P-AUROC:0.9939, P-AP:0.3623, P-F1:0.4395, P-AUPRO:0.9426
macaroni2: I-Auroc:0.8286, I-AP:0.7942, I-F1:0.8057, P-AUROC:0.9877, P-AP:0.2352, P-F1:0.3339, P-AUPRO:0.9377
pcb1: I-Auroc:0.9354, I-AP:0.9225, I-F1:0.8800, P-AUROC:0.9851, P-AP:0.6913, P-F1:0.6571, P-AUPRO:0.8978
pcb2: I-Auroc:0.9504, I-AP:0.9518, I-F1:0.8990, P-AUROC:0.9572, P-AP:0.4714, P-F1:0.5180, P-AUPRO:0.8208
pcb3: I-Auroc:0.9271, I-AP:0.9311, I-F1:0.8812, P-AUROC:0.9595, P-AP:0.4472, P-F1:0.4946, P-AUPRO:0.8616
pcb4: I-Auroc:0.9944, I-AP:0.9938, I-F1:0.9751, P-AUROC:0.9412, P-AP:0.3074, P-F1:0.3739, P-AUPRO:0.7965
pipe_fryum: I-Auroc:0.9296, I-AP:0.9653, I-F1:0.8923, P-AUROC:0.9840, P-AP:0.4427, P-F1:0.5104, P-AUPRO:0.9632
Mean: I-Auroc:0.9474, I-AP:0.9524, I-F1:0.9066, P-AUROC:0.9731, P-AP:0.4591, P-F1:0.5017, P-AUPRO:0.9065
cuda:5
shots: 2
candle: I-Auroc:0.9735, I-AP:0.9760, I-F1:0.9163, P-AUROC:0.9907, P-AP:0.4852, P-F1:0.5057, P-AUPRO:0.9459
capsules: I-Auroc:0.9763, I-AP:0.9873, I-F1:0.9561, P-AUROC:0.9796, P-AP:0.5931, P-F1:0.6103, P-AUPRO:0.9414
cashew: I-Auroc:0.9672, I-AP:0.9840, I-F1:0.9314, P-AUROC:0.9830, P-AP:0.5307, P-F1:0.5392, P-AUPRO:0.9586
chewinggum: I-Auroc:0.9950, I-AP:0.9975, I-F1:0.9754, P-AUROC:0.9934, P-AP:0.6461, P-F1:0.6723, P-AUPRO:0.9367
fryum: I-Auroc:0.9752, I-AP:0.9881, I-F1:0.9360, P-AUROC:0.9337, P-AP:0.3836, P-F1:0.4235, P-AUPRO:0.8955
macaroni1: I-Auroc:0.9762, I-AP:0.9762, I-F1:0.9314, P-AUROC:0.9941, P-AP:0.3582, P-F1:0.4359, P-AUPRO:0.9545
macaroni2: I-Auroc:0.8228, I-AP:0.8179, I-F1:0.7624, P-AUROC:0.9912, P-AP:0.2778, P-F1:0.3889, P-AUPRO:0.9582
pcb1: I-Auroc:0.9401, I-AP:0.9383, I-F1:0.9045, P-AUROC:0.9889, P-AP:0.7518, P-F1:0.7061, P-AUPRO:0.9017
pcb2: I-Auroc:0.9460, I-AP:0.9472, I-F1:0.8889, P-AUROC:0.9592, P-AP:0.4851, P-F1:0.5266, P-AUPRO:0.8381
pcb3: I-Auroc:0.9321, I-AP:0.9322, I-F1:0.8815, P-AUROC:0.9732, P-AP:0.5039, P-F1:0.5378, P-AUPRO:0.8649
pcb4: I-Auroc:0.9943, I-AP:0.9936, I-F1:0.9751, P-AUROC:0.9504, P-AP:0.3136, P-F1:0.3788, P-AUPRO:0.8258
pipe_fryum: I-Auroc:0.9620, I-AP:0.9821, I-F1:0.9406, P-AUROC:0.9865, P-AP:0.4834, P-F1:0.5640, P-AUPRO:0.9627
Mean: I-Auroc:0.9551, I-AP:0.9600, I-F1:0.9166, P-AUROC:0.9770, P-AP:0.4844, P-F1:0.5241, P-AUPRO:0.9153
cuda:5
shots: 4
candle: I-Auroc:0.9788, I-AP:0.9808, I-F1:0.9208, P-AUROC:0.9916, P-AP:0.4880, P-F1:0.5113, P-AUPRO:0.9473
capsules: I-Auroc:0.9782, I-AP:0.9878, I-F1:0.9495, P-AUROC:0.9831, P-AP:0.5988, P-F1:0.6091, P-AUPRO:0.9585
cashew: I-Auroc:0.9662, I-AP:0.9829, I-F1:0.9347, P-AUROC:0.9833, P-AP:0.5434, P-F1:0.5478, P-AUPRO:0.9593
chewinggum: I-Auroc:0.9958, I-AP:0.9979, I-F1:0.9802, P-AUROC:0.9936, P-AP:0.6468, P-F1:0.6777, P-AUPRO:0.9408
fryum: I-Auroc:0.9748, I-AP:0.9880, I-F1:0.9327, P-AUROC:0.9355, P-AP:0.3885, P-F1:0.4279, P-AUPRO:0.8968
macaroni1: I-Auroc:0.9807, I-AP:0.9790, I-F1:0.9423, P-AUROC:0.9939, P-AP:0.3428, P-F1:0.4328, P-AUPRO:0.9563
macaroni2: I-Auroc:0.8398, I-AP:0.7971, I-F1:0.7948, P-AUROC:0.9937, P-AP:0.2853, P-F1:0.3754, P-AUPRO:0.9721
pcb1: I-Auroc:0.9313, I-AP:0.9318, I-F1:0.9254, P-AUROC:0.9894, P-AP:0.7617, P-F1:0.7162, P-AUPRO:0.9082
pcb2: I-Auroc:0.9418, I-AP:0.9420, I-F1:0.9137, P-AUROC:0.9631, P-AP:0.4978, P-F1:0.5356, P-AUPRO:0.8471
pcb3: I-Auroc:0.9499, I-AP:0.9512, I-F1:0.8966, P-AUROC:0.9798, P-AP:0.5351, P-F1:0.5585, P-AUPRO:0.8865
pcb4: I-Auroc:0.9947, I-AP:0.9939, I-F1:0.9751, P-AUROC:0.9586, P-AP:0.3238, P-F1:0.3868, P-AUPRO:0.8539
pipe_fryum: I-Auroc:0.9846, I-AP:0.9931, I-F1:0.9583, P-AUROC:0.9875, P-AP:0.4941, P-F1:0.5807, P-AUPRO:0.9651
Mean: I-Auroc:0.9597, I-AP:0.9605, I-F1:0.9270, P-AUROC:0.9794, P-AP:0.4922, P-F1:0.5300, P-AUPRO:0.9243





-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 42

cuda:2
shots: 4
candle: I-Auroc:0.9800, I-AP:0.9818, I-F1:0.9239, P-AUROC:0.9917, P-AP:0.4741, P-F1:0.5015, P-AUPRO:0.9429
capsules: I-Auroc:0.9705, I-AP:0.9847, I-F1:0.9412, P-AUROC:0.9852, P-AP:0.6123, P-F1:0.6209, P-AUPRO:0.9481
cashew: I-Auroc:0.9780, I-AP:0.9888, I-F1:0.9474, P-AUROC:0.9833, P-AP:0.5464, P-F1:0.5457, P-AUPRO:0.9694
chewinggum: I-Auroc:0.9948, I-AP:0.9974, I-F1:0.9746, P-AUROC:0.9941, P-AP:0.6228, P-F1:0.6742, P-AUPRO:0.9486
fryum: I-Auroc:0.9836, I-AP:0.9924, I-F1:0.9534, P-AUROC:0.9352, P-AP:0.3848, P-F1:0.4232, P-AUPRO:0.9051
macaroni1: I-Auroc:0.9047, I-AP:0.9092, I-F1:0.8216, P-AUROC:0.9944, P-AP:0.3021, P-F1:0.4053, P-AUPRO:0.9580
macaroni2: I-Auroc:0.8243, I-AP:0.8112, I-F1:0.7793, P-AUROC:0.9904, P-AP:0.2762, P-F1:0.3931, P-AUPRO:0.9487
pcb1: I-Auroc:0.9193, I-AP:0.9128, I-F1:0.9109, P-AUROC:0.9901, P-AP:0.7542, P-F1:0.7106, P-AUPRO:0.9120
pcb2: I-Auroc:0.9109, I-AP:0.9214, I-F1:0.8261, P-AUROC:0.9633, P-AP:0.4820, P-F1:0.5220, P-AUPRO:0.8456
pcb3: I-Auroc:0.9625, I-AP:0.9631, I-F1:0.8940, P-AUROC:0.9812, P-AP:0.5397, P-F1:0.5767, P-AUPRO:0.8908
pcb4: I-Auroc:0.9949, I-AP:0.9938, I-F1:0.9798, P-AUROC:0.9620, P-AP:0.3424, P-F1:0.4011, P-AUPRO:0.8570
pipe_fryum: I-Auroc:0.9844, I-AP:0.9926, I-F1:0.9561, P-AUROC:0.9870, P-AP:0.4692, P-F1:0.5719, P-AUPRO:0.9612
Mean: I-Auroc:0.9507, I-AP:0.9541, I-F1:0.9090, P-AUROC:0.9798, P-AP:0.4839, P-F1:0.5289, P-AUPRO:0.9239
cuda:2
shots: 2
candle: I-Auroc:0.9764, I-AP:0.9777, I-F1:0.9159, P-AUROC:0.9908, P-AP:0.4772, P-F1:0.4956, P-AUPRO:0.9343
capsules: I-Auroc:0.9693, I-AP:0.9844, I-F1:0.9394, P-AUROC:0.9821, P-AP:0.6152, P-F1:0.6197, P-AUPRO:0.9563
cashew: I-Auroc:0.9710, I-AP:0.9845, I-F1:0.9463, P-AUROC:0.9794, P-AP:0.5122, P-F1:0.5147, P-AUPRO:0.9653
chewinggum: I-Auroc:0.9950, I-AP:0.9976, I-F1:0.9746, P-AUROC:0.9944, P-AP:0.6500, P-F1:0.6818, P-AUPRO:0.9454
fryum: I-Auroc:0.9882, I-AP:0.9945, I-F1:0.9645, P-AUROC:0.9290, P-AP:0.3703, P-F1:0.4114, P-AUPRO:0.9006
macaroni1: I-Auroc:0.9145, I-AP:0.9186, I-F1:0.8246, P-AUROC:0.9945, P-AP:0.3052, P-F1:0.4080, P-AUPRO:0.9590
macaroni2: I-Auroc:0.7871, I-AP:0.7926, I-F1:0.7429, P-AUROC:0.9858, P-AP:0.2579, P-F1:0.3742, P-AUPRO:0.9317
pcb1: I-Auroc:0.9348, I-AP:0.9280, I-F1:0.9082, P-AUROC:0.9890, P-AP:0.7494, P-F1:0.7074, P-AUPRO:0.9097
pcb2: I-Auroc:0.8820, I-AP:0.8956, I-F1:0.8020, P-AUROC:0.9592, P-AP:0.4306, P-F1:0.4792, P-AUPRO:0.8300
pcb3: I-Auroc:0.9550, I-AP:0.9591, I-F1:0.8878, P-AUROC:0.9766, P-AP:0.5166, P-F1:0.5626, P-AUPRO:0.8745
pcb4: I-Auroc:0.9945, I-AP:0.9937, I-F1:0.9798, P-AUROC:0.9573, P-AP:0.3371, P-F1:0.3942, P-AUPRO:0.8341
pipe_fryum: I-Auroc:0.9712, I-AP:0.9862, I-F1:0.9458, P-AUROC:0.9848, P-AP:0.4427, P-F1:0.5506, P-AUPRO:0.9540
Mean: I-Auroc:0.9449, I-AP:0.9510, I-F1:0.9026, P-AUROC:0.9769, P-AP:0.4720, P-F1:0.5166, P-AUPRO:0.9163
cuda:2
shots: 1
candle: I-Auroc:0.9755, I-AP:0.9784, I-F1:0.9100, P-AUROC:0.9899, P-AP:0.4486, P-F1:0.4807, P-AUPRO:0.9345
capsules: I-Auroc:0.9645, I-AP:0.9804, I-F1:0.9442, P-AUROC:0.9806, P-AP:0.5652, P-F1:0.5807, P-AUPRO:0.9457
cashew: I-Auroc:0.9540, I-AP:0.9749, I-F1:0.9412, P-AUROC:0.9766, P-AP:0.4885, P-F1:0.4848, P-AUPRO:0.9590
chewinggum: I-Auroc:0.9940, I-AP:0.9971, I-F1:0.9694, P-AUROC:0.9943, P-AP:0.6192, P-F1:0.6789, P-AUPRO:0.9413
fryum: I-Auroc:0.9876, I-AP:0.9941, I-F1:0.9600, P-AUROC:0.9295, P-AP:0.3741, P-F1:0.4186, P-AUPRO:0.8995
macaroni1: I-Auroc:0.8791, I-AP:0.8989, I-F1:0.8083, P-AUROC:0.9931, P-AP:0.2942, P-F1:0.3984, P-AUPRO:0.9523
macaroni2: I-Auroc:0.7606, I-AP:0.7005, I-F1:0.7397, P-AUROC:0.9867, P-AP:0.2163, P-F1:0.3218, P-AUPRO:0.9280
pcb1: I-Auroc:0.9425, I-AP:0.9342, I-F1:0.9135, P-AUROC:0.9874, P-AP:0.7542, P-F1:0.7087, P-AUPRO:0.8992
pcb2: I-Auroc:0.8863, I-AP:0.8971, I-F1:0.8053, P-AUROC:0.9552, P-AP:0.4187, P-F1:0.4726, P-AUPRO:0.8101
pcb3: I-Auroc:0.8749, I-AP:0.9013, I-F1:0.7933, P-AUROC:0.9659, P-AP:0.4362, P-F1:0.4826, P-AUPRO:0.8590
pcb4: I-Auroc:0.9949, I-AP:0.9942, I-F1:0.9754, P-AUROC:0.9427, P-AP:0.3069, P-F1:0.3685, P-AUPRO:0.7891
pipe_fryum: I-Auroc:0.9710, I-AP:0.9863, I-F1:0.9515, P-AUROC:0.9839, P-AP:0.4315, P-F1:0.5314, P-AUPRO:0.9537
Mean: I-Auroc:0.9321, I-AP:0.9364, I-F1:0.8926, P-AUROC:0.9738, P-AP:0.4461, P-F1:0.4940, P-AUPRO:0.9059




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 4

cuda:2
shots: 4
candle: I-Auroc:0.9648, I-AP:0.9701, I-F1:0.9223, P-AUROC:0.9911, P-AP:0.4815, P-F1:0.5024, P-AUPRO:0.9483
capsules: I-Auroc:0.9765, I-AP:0.9874, I-F1:0.9458, P-AUROC:0.9839, P-AP:0.6057, P-F1:0.6066, P-AUPRO:0.9463
cashew: I-Auroc:0.9650, I-AP:0.9837, I-F1:0.9320, P-AUROC:0.9832, P-AP:0.5523, P-F1:0.5515, P-AUPRO:0.9590
chewinggum: I-Auroc:0.9952, I-AP:0.9976, I-F1:0.9709, P-AUROC:0.9936, P-AP:0.6353, P-F1:0.6730, P-AUPRO:0.9391
fryum: I-Auroc:0.9818, I-AP:0.9913, I-F1:0.9442, P-AUROC:0.9318, P-AP:0.3891, P-F1:0.4314, P-AUPRO:0.8920
macaroni1: I-Auroc:0.9435, I-AP:0.9474, I-F1:0.8622, P-AUROC:0.9950, P-AP:0.3343, P-F1:0.4200, P-AUPRO:0.9526
macaroni2: I-Auroc:0.8381, I-AP:0.8246, I-F1:0.7931, P-AUROC:0.9938, P-AP:0.2801, P-F1:0.3842, P-AUPRO:0.9628
pcb1: I-Auroc:0.9501, I-AP:0.9499, I-F1:0.9239, P-AUROC:0.9899, P-AP:0.7818, P-F1:0.7349, P-AUPRO:0.9077
pcb2: I-Auroc:0.9443, I-AP:0.9362, I-F1:0.9026, P-AUROC:0.9604, P-AP:0.4933, P-F1:0.5335, P-AUPRO:0.8386
pcb3: I-Auroc:0.9610, I-AP:0.9596, I-F1:0.9036, P-AUROC:0.9822, P-AP:0.5516, P-F1:0.5782, P-AUPRO:0.9051
pcb4: I-Auroc:0.9955, I-AP:0.9951, I-F1:0.9749, P-AUROC:0.9584, P-AP:0.3623, P-F1:0.4177, P-AUPRO:0.8495
pipe_fryum: I-Auroc:0.9886, I-AP:0.9950, I-F1:0.9744, P-AUROC:0.9872, P-AP:0.4924, P-F1:0.5746, P-AUPRO:0.9645
Mean: I-Auroc:0.9587, I-AP:0.9615, I-F1:0.9208, P-AUROC:0.9792, P-AP:0.4966, P-F1:0.5340, P-AUPRO:0.9221
cuda:2
shots: 2
candle: I-Auroc:0.9677, I-AP:0.9748, I-F1:0.9307, P-AUROC:0.9906, P-AP:0.4816, P-F1:0.5070, P-AUPRO:0.9558
capsules: I-Auroc:0.9792, I-AP:0.9877, I-F1:0.9417, P-AUROC:0.9792, P-AP:0.5736, P-F1:0.5789, P-AUPRO:0.9481
cashew: I-Auroc:0.9548, I-AP:0.9770, I-F1:0.9268, P-AUROC:0.9800, P-AP:0.5117, P-F1:0.5211, P-AUPRO:0.9545
chewinggum: I-Auroc:0.9926, I-AP:0.9965, I-F1:0.9694, P-AUROC:0.9934, P-AP:0.6320, P-F1:0.6724, P-AUPRO:0.9410
fryum: I-Auroc:0.9718, I-AP:0.9869, I-F1:0.9307, P-AUROC:0.9320, P-AP:0.3791, P-F1:0.4185, P-AUPRO:0.8827
macaroni1: I-Auroc:0.9542, I-AP:0.9580, I-F1:0.8738, P-AUROC:0.9947, P-AP:0.3389, P-F1:0.4230, P-AUPRO:0.9506
macaroni2: I-Auroc:0.7980, I-AP:0.8008, I-F1:0.7573, P-AUROC:0.9912, P-AP:0.2632, P-F1:0.3778, P-AUPRO:0.9534
pcb1: I-Auroc:0.9411, I-AP:0.9424, I-F1:0.8990, P-AUROC:0.9886, P-AP:0.7610, P-F1:0.7186, P-AUPRO:0.8966
pcb2: I-Auroc:0.9438, I-AP:0.9396, I-F1:0.9020, P-AUROC:0.9562, P-AP:0.4745, P-F1:0.5210, P-AUPRO:0.8246
pcb3: I-Auroc:0.9431, I-AP:0.9468, I-F1:0.8911, P-AUROC:0.9770, P-AP:0.5215, P-F1:0.5589, P-AUPRO:0.8941
pcb4: I-Auroc:0.9934, I-AP:0.9922, I-F1:0.9749, P-AUROC:0.9504, P-AP:0.3379, P-F1:0.3961, P-AUPRO:0.8233
pipe_fryum: I-Auroc:0.9938, I-AP:0.9971, I-F1:0.9749, P-AUROC:0.9863, P-AP:0.4706, P-F1:0.5540, P-AUPRO:0.9667
Mean: I-Auroc:0.9528, I-AP:0.9583, I-F1:0.9144, P-AUROC:0.9766, P-AP:0.4788, P-F1:0.5206, P-AUPRO:0.9160
cuda:2
shots: 1
candle: I-Auroc:0.9667, I-AP:0.9732, I-F1:0.9175, P-AUROC:0.9896, P-AP:0.4674, P-F1:0.5048, P-AUPRO:0.9569
capsules: I-Auroc:0.9842, I-AP:0.9905, I-F1:0.9557, P-AUROC:0.9811, P-AP:0.5372, P-F1:0.5562, P-AUPRO:0.9669
cashew: I-Auroc:0.9270, I-AP:0.9641, I-F1:0.9038, P-AUROC:0.9738, P-AP:0.4532, P-F1:0.4615, P-AUPRO:0.9475
chewinggum: I-Auroc:0.9912, I-AP:0.9959, I-F1:0.9694, P-AUROC:0.9933, P-AP:0.6512, P-F1:0.6870, P-AUPRO:0.9351
fryum: I-Auroc:0.9692, I-AP:0.9860, I-F1:0.9314, P-AUROC:0.9260, P-AP:0.3710, P-F1:0.4114, P-AUPRO:0.8823
macaroni1: I-Auroc:0.9007, I-AP:0.9136, I-F1:0.8145, P-AUROC:0.9928, P-AP:0.3252, P-F1:0.4057, P-AUPRO:0.9409
macaroni2: I-Auroc:0.7204, I-AP:0.6649, I-F1:0.7289, P-AUROC:0.9872, P-AP:0.2034, P-F1:0.2882, P-AUPRO:0.9387
pcb1: I-Auroc:0.8970, I-AP:0.9121, I-F1:0.8615, P-AUROC:0.9873, P-AP:0.7299, P-F1:0.6903, P-AUPRO:0.8900
pcb2: I-Auroc:0.9237, I-AP:0.9144, I-F1:0.8826, P-AUROC:0.9537, P-AP:0.4118, P-F1:0.4746, P-AUPRO:0.8068
pcb3: I-Auroc:0.8767, I-AP:0.9012, I-F1:0.8105, P-AUROC:0.9689, P-AP:0.4391, P-F1:0.4958, P-AUPRO:0.8787
pcb4: I-Auroc:0.9916, I-AP:0.9905, I-F1:0.9700, P-AUROC:0.9431, P-AP:0.3018, P-F1:0.3660, P-AUPRO:0.7992
pipe_fryum: I-Auroc:0.9816, I-AP:0.9907, I-F1:0.9557, P-AUROC:0.9838, P-AP:0.4501, P-F1:0.5357, P-AUPRO:0.9682
Mean: I-Auroc:0.9275, I-AP:0.9331, I-F1:0.8918, P-AUROC:0.9734, P-AP:0.4451, P-F1:0.4898, P-AUPRO:0.9093




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 114514

cuda:2
shots: 4
candle: I-Auroc:0.9478, I-AP:0.9576, I-F1:0.8934, P-AUROC:0.9912, P-AP:0.4961, P-F1:0.5300, P-AUPRO:0.9344
capsules: I-Auroc:0.9622, I-AP:0.9790, I-F1:0.9261, P-AUROC:0.9799, P-AP:0.6448, P-F1:0.6471, P-AUPRO:0.9426
cashew: I-Auroc:0.9618, I-AP:0.9801, I-F1:0.9360, P-AUROC:0.9843, P-AP:0.5435, P-F1:0.5493, P-AUPRO:0.9536
chewinggum: I-Auroc:0.9950, I-AP:0.9976, I-F1:0.9746, P-AUROC:0.9946, P-AP:0.6959, P-F1:0.6932, P-AUPRO:0.9430
fryum: I-Auroc:0.9808, I-AP:0.9910, I-F1:0.9500, P-AUROC:0.9370, P-AP:0.3933, P-F1:0.4368, P-AUPRO:0.8999
macaroni1: I-Auroc:0.9601, I-AP:0.9624, I-F1:0.8900, P-AUROC:0.9943, P-AP:0.3445, P-F1:0.4299, P-AUPRO:0.9497
macaroni2: I-Auroc:0.8669, I-AP:0.8404, I-F1:0.8341, P-AUROC:0.9942, P-AP:0.2725, P-F1:0.3854, P-AUPRO:0.9593
pcb1: I-Auroc:0.9477, I-AP:0.9475, I-F1:0.9307, P-AUROC:0.9875, P-AP:0.7783, P-F1:0.7255, P-AUPRO:0.9044
pcb2: I-Auroc:0.9428, I-AP:0.9468, I-F1:0.9064, P-AUROC:0.9633, P-AP:0.5016, P-F1:0.5370, P-AUPRO:0.8528
pcb3: I-Auroc:0.9712, I-AP:0.9732, I-F1:0.9091, P-AUROC:0.9794, P-AP:0.5474, P-F1:0.5832, P-AUPRO:0.9001
pcb4: I-Auroc:0.9965, I-AP:0.9961, I-F1:0.9852, P-AUROC:0.9620, P-AP:0.4177, P-F1:0.4759, P-AUPRO:0.8655
pipe_fryum: I-Auroc:0.9916, I-AP:0.9960, I-F1:0.9751, P-AUROC:0.9877, P-AP:0.5009, P-F1:0.5878, P-AUPRO:0.9566
Mean: I-Auroc:0.9604, I-AP:0.9640, I-F1:0.9259, P-AUROC:0.9796, P-AP:0.5114, P-F1:0.5484, P-AUPRO:0.9218
cuda:2
shots: 2
candle: I-Auroc:0.9745, I-AP:0.9785, I-F1:0.9239, P-AUROC:0.9903, P-AP:0.4777, P-F1:0.5118, P-AUPRO:0.9464
capsules: I-Auroc:0.9757, I-AP:0.9858, I-F1:0.9463, P-AUROC:0.9773, P-AP:0.6293, P-F1:0.6422, P-AUPRO:0.9443
cashew: I-Auroc:0.9824, I-AP:0.9909, I-F1:0.9612, P-AUROC:0.9823, P-AP:0.5117, P-F1:0.5206, P-AUPRO:0.9738
chewinggum: I-Auroc:0.9958, I-AP:0.9979, I-F1:0.9756, P-AUROC:0.9942, P-AP:0.6742, P-F1:0.6866, P-AUPRO:0.9402
fryum: I-Auroc:0.9736, I-AP:0.9884, I-F1:0.9442, P-AUROC:0.9345, P-AP:0.3840, P-F1:0.4306, P-AUPRO:0.8889
macaroni1: I-Auroc:0.9693, I-AP:0.9718, I-F1:0.9026, P-AUROC:0.9945, P-AP:0.3496, P-F1:0.4410, P-AUPRO:0.9556
macaroni2: I-Auroc:0.8444, I-AP:0.8408, I-F1:0.7984, P-AUROC:0.9925, P-AP:0.2884, P-F1:0.3957, P-AUPRO:0.9564
pcb1: I-Auroc:0.9429, I-AP:0.9352, I-F1:0.9268, P-AUROC:0.9872, P-AP:0.7464, P-F1:0.7041, P-AUPRO:0.9004
pcb2: I-Auroc:0.9397, I-AP:0.9445, I-F1:0.9026, P-AUROC:0.9587, P-AP:0.4872, P-F1:0.5312, P-AUPRO:0.8333
pcb3: I-Auroc:0.8699, I-AP:0.8998, I-F1:0.7869, P-AUROC:0.9702, P-AP:0.4266, P-F1:0.4859, P-AUPRO:0.8752
pcb4: I-Auroc:0.9880, I-AP:0.9865, I-F1:0.9662, P-AUROC:0.9513, P-AP:0.3736, P-F1:0.4427, P-AUPRO:0.8248
pipe_fryum: I-Auroc:0.9804, I-AP:0.9894, I-F1:0.9608, P-AUROC:0.9858, P-AP:0.4802, P-F1:0.5594, P-AUPRO:0.9536
Mean: I-Auroc:0.9530, I-AP:0.9591, I-F1:0.9163, P-AUROC:0.9765, P-AP:0.4857, P-F1:0.5293, P-AUPRO:0.9161
cuda:2
shots: 1
candle: I-Auroc:0.9664, I-AP:0.9706, I-F1:0.8966, P-AUROC:0.9881, P-AP:0.4655, P-F1:0.5027, P-AUPRO:0.9347
capsules: I-Auroc:0.9782, I-AP:0.9881, I-F1:0.9500, P-AUROC:0.9691, P-AP:0.5439, P-F1:0.5684, P-AUPRO:0.9402
cashew: I-Auroc:0.9724, I-AP:0.9860, I-F1:0.9388, P-AUROC:0.9771, P-AP:0.4558, P-F1:0.4753, P-AUPRO:0.9670
chewinggum: I-Auroc:0.9954, I-AP:0.9978, I-F1:0.9709, P-AUROC:0.9941, P-AP:0.6713, P-F1:0.6848, P-AUPRO:0.9435
fryum: I-Auroc:0.9726, I-AP:0.9879, I-F1:0.9394, P-AUROC:0.9270, P-AP:0.3704, P-F1:0.4163, P-AUPRO:0.8879
macaroni1: I-Auroc:0.9722, I-AP:0.9737, I-F1:0.9184, P-AUROC:0.9943, P-AP:0.3536, P-F1:0.4363, P-AUPRO:0.9461
macaroni2: I-Auroc:0.8680, I-AP:0.8609, I-F1:0.8295, P-AUROC:0.9884, P-AP:0.2656, P-F1:0.3718, P-AUPRO:0.9403
pcb1: I-Auroc:0.9415, I-AP:0.9390, I-F1:0.8980, P-AUROC:0.9853, P-AP:0.7001, P-F1:0.6611, P-AUPRO:0.8952
pcb2: I-Auroc:0.9405, I-AP:0.9484, I-F1:0.9000, P-AUROC:0.9526, P-AP:0.4597, P-F1:0.5054, P-AUPRO:0.8011
pcb3: I-Auroc:0.8319, I-AP:0.8756, I-F1:0.7765, P-AUROC:0.9635, P-AP:0.3690, P-F1:0.4417, P-AUPRO:0.8611
pcb4: I-Auroc:0.9204, I-AP:0.9343, I-F1:0.8529, P-AUROC:0.9305, P-AP:0.3022, P-F1:0.3758, P-AUPRO:0.7638
pipe_fryum: I-Auroc:0.9728, I-AP:0.9867, I-F1:0.9490, P-AUROC:0.9849, P-AP:0.4721, P-F1:0.5465, P-AUPRO:0.9524
Mean: I-Auroc:0.9444, I-AP:0.9541, I-F1:0.9017, P-AUROC:0.9712, P-AP:0.4524, P-F1:0.4988, P-AUPRO:0.9028






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 333

cuda:3
shots: 1
candle: I-Auroc:0.9690, I-AP:0.9721, I-F1:0.9005, P-AUROC:0.9892, P-AP:0.4559, P-F1:0.4989, P-AUPRO:0.9186
capsules: I-Auroc:0.9462, I-AP:0.9710, I-F1:0.9010, P-AUROC:0.9740, P-AP:0.5483, P-F1:0.5689, P-AUPRO:0.9039
cashew: I-Auroc:0.9620, I-AP:0.9816, I-F1:0.9447, P-AUROC:0.9808, P-AP:0.5271, P-F1:0.5311, P-AUPRO:0.9699
chewinggum: I-Auroc:0.9952, I-AP:0.9977, I-F1:0.9796, P-AUROC:0.9945, P-AP:0.7263, P-F1:0.7046, P-AUPRO:0.9392
fryum: I-Auroc:0.9742, I-AP:0.9888, I-F1:0.9485, P-AUROC:0.9358, P-AP:0.3772, P-F1:0.4168, P-AUPRO:0.8981
macaroni1: I-Auroc:0.8653, I-AP:0.8825, I-F1:0.7845, P-AUROC:0.9907, P-AP:0.2824, P-F1:0.3665, P-AUPRO:0.9295
macaroni2: I-Auroc:0.7354, I-AP:0.6707, I-F1:0.7407, P-AUROC:0.9862, P-AP:0.1674, P-F1:0.2862, P-AUPRO:0.9314
pcb1: I-Auroc:0.9142, I-AP:0.9071, I-F1:0.8600, P-AUROC:0.9859, P-AP:0.6937, P-F1:0.6583, P-AUPRO:0.8920
pcb2: I-Auroc:0.9442, I-AP:0.9501, I-F1:0.8912, P-AUROC:0.9573, P-AP:0.4634, P-F1:0.5108, P-AUPRO:0.8270
pcb3: I-Auroc:0.9324, I-AP:0.9326, I-F1:0.8676, P-AUROC:0.9649, P-AP:0.4944, P-F1:0.5281, P-AUPRO:0.8433
pcb4: I-Auroc:0.8993, I-AP:0.9200, I-F1:0.8333, P-AUROC:0.9202, P-AP:0.2741, P-F1:0.3534, P-AUPRO:0.7213
pipe_fryum: I-Auroc:0.9878, I-AP:0.9942, I-F1:0.9592, P-AUROC:0.9872, P-AP:0.4792, P-F1:0.5762, P-AUPRO:0.9682
Mean: I-Auroc:0.9271, I-AP:0.9307, I-F1:0.8842, P-AUROC:0.9722, P-AP:0.4575, P-F1:0.5000, P-AUPRO:0.8952
cuda:3
shots: 2
candle: I-Auroc:0.9707, I-AP:0.9749, I-F1:0.9057, P-AUROC:0.9907, P-AP:0.4760, P-F1:0.5072, P-AUPRO:0.9312
capsules: I-Auroc:0.9640, I-AP:0.9798, I-F1:0.9216, P-AUROC:0.9831, P-AP:0.5535, P-F1:0.5777, P-AUPRO:0.9414
cashew: I-Auroc:0.9656, I-AP:0.9829, I-F1:0.9307, P-AUROC:0.9824, P-AP:0.5615, P-F1:0.5545, P-AUPRO:0.9655
chewinggum: I-Auroc:0.9952, I-AP:0.9977, I-F1:0.9744, P-AUROC:0.9934, P-AP:0.6830, P-F1:0.6898, P-AUPRO:0.9349
fryum: I-Auroc:0.9856, I-AP:0.9934, I-F1:0.9588, P-AUROC:0.9357, P-AP:0.3777, P-F1:0.4181, P-AUPRO:0.8969
macaroni1: I-Auroc:0.8993, I-AP:0.9141, I-F1:0.8061, P-AUROC:0.9945, P-AP:0.3240, P-F1:0.4052, P-AUPRO:0.9574
macaroni2: I-Auroc:0.8074, I-AP:0.7987, I-F1:0.7814, P-AUROC:0.9900, P-AP:0.2515, P-F1:0.3740, P-AUPRO:0.9520
pcb1: I-Auroc:0.9280, I-AP:0.9168, I-F1:0.8846, P-AUROC:0.9878, P-AP:0.7394, P-F1:0.6975, P-AUPRO:0.8999
pcb2: I-Auroc:0.9427, I-AP:0.9470, I-F1:0.8922, P-AUROC:0.9606, P-AP:0.4889, P-F1:0.5306, P-AUPRO:0.8312
pcb3: I-Auroc:0.9400, I-AP:0.9414, I-F1:0.8762, P-AUROC:0.9708, P-AP:0.5245, P-F1:0.5568, P-AUPRO:0.8744
pcb4: I-Auroc:0.9893, I-AP:0.9881, I-F1:0.9608, P-AUROC:0.9492, P-AP:0.3635, P-F1:0.4316, P-AUPRO:0.8157
pipe_fryum: I-Auroc:0.9864, I-AP:0.9935, I-F1:0.9543, P-AUROC:0.9867, P-AP:0.4832, P-F1:0.5657, P-AUPRO:0.9709
Mean: I-Auroc:0.9479, I-AP:0.9524, I-F1:0.9039, P-AUROC:0.9771, P-AP:0.4855, P-F1:0.5257, P-AUPRO:0.9143
cuda:3
shots: 4
candle: I-Auroc:0.9709, I-AP:0.9735, I-F1:0.9163, P-AUROC:0.9919, P-AP:0.4862, P-F1:0.5106, P-AUPRO:0.9367
capsules: I-Auroc:0.9682, I-AP:0.9811, I-F1:0.9278, P-AUROC:0.9873, P-AP:0.6172, P-F1:0.6223, P-AUPRO:0.9506
cashew: I-Auroc:0.9734, I-AP:0.9864, I-F1:0.9447, P-AUROC:0.9834, P-AP:0.5751, P-F1:0.5627, P-AUPRO:0.9635
chewinggum: I-Auroc:0.9962, I-AP:0.9982, I-F1:0.9754, P-AUROC:0.9939, P-AP:0.6901, P-F1:0.6950, P-AUPRO:0.9370
fryum: I-Auroc:0.9774, I-AP:0.9899, I-F1:0.9534, P-AUROC:0.9394, P-AP:0.3935, P-F1:0.4309, P-AUPRO:0.8939
macaroni1: I-Auroc:0.9635, I-AP:0.9668, I-F1:0.9005, P-AUROC:0.9951, P-AP:0.3551, P-F1:0.4418, P-AUPRO:0.9580
macaroni2: I-Auroc:0.8205, I-AP:0.7933, I-F1:0.7665, P-AUROC:0.9917, P-AP:0.2591, P-F1:0.3615, P-AUPRO:0.9604
pcb1: I-Auroc:0.9338, I-AP:0.9206, I-F1:0.9000, P-AUROC:0.9896, P-AP:0.7649, P-F1:0.7200, P-AUPRO:0.9146
pcb2: I-Auroc:0.9365, I-AP:0.9425, I-F1:0.8856, P-AUROC:0.9652, P-AP:0.5018, P-F1:0.5390, P-AUPRO:0.8446
pcb3: I-Auroc:0.9404, I-AP:0.9442, I-F1:0.8804, P-AUROC:0.9765, P-AP:0.5352, P-F1:0.5630, P-AUPRO:0.8840
pcb4: I-Auroc:0.9943, I-AP:0.9940, I-F1:0.9652, P-AUROC:0.9612, P-AP:0.4062, P-F1:0.4644, P-AUPRO:0.8603
pipe_fryum: I-Auroc:0.9934, I-AP:0.9967, I-F1:0.9703, P-AUROC:0.9875, P-AP:0.4904, P-F1:0.5830, P-AUPRO:0.9711
Mean: I-Auroc:0.9557, I-AP:0.9573, I-F1:0.9155, P-AUROC:0.9802, P-AP:0.5062, P-F1:0.5412, P-AUPRO:0.9229




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 2

cuda:3
shots: 1
candle: I-Auroc:0.9385, I-AP:0.9494, I-F1:0.8763, P-AUROC:0.9898, P-AP:0.4553, P-F1:0.4946, P-AUPRO:0.9478
capsules: I-Auroc:0.9698, I-AP:0.9807, I-F1:0.9490, P-AUROC:0.9695, P-AP:0.5853, P-F1:0.6011, P-AUPRO:0.9464
cashew: I-Auroc:0.9770, I-AP:0.9886, I-F1:0.9423, P-AUROC:0.9790, P-AP:0.4963, P-F1:0.5140, P-AUPRO:0.9730
chewinggum: I-Auroc:0.9958, I-AP:0.9979, I-F1:0.9754, P-AUROC:0.9941, P-AP:0.6874, P-F1:0.6851, P-AUPRO:0.9394
fryum: I-Auroc:0.9756, I-AP:0.9890, I-F1:0.9458, P-AUROC:0.9376, P-AP:0.3909, P-F1:0.4282, P-AUPRO:0.9000
macaroni1: I-Auroc:0.9690, I-AP:0.9718, I-F1:0.9005, P-AUROC:0.9955, P-AP:0.3607, P-F1:0.4397, P-AUPRO:0.9572
macaroni2: I-Auroc:0.8035, I-AP:0.7488, I-F1:0.7671, P-AUROC:0.9868, P-AP:0.2386, P-F1:0.3325, P-AUPRO:0.9411
pcb1: I-Auroc:0.9397, I-AP:0.9218, I-F1:0.9135, P-AUROC:0.9869, P-AP:0.7362, P-F1:0.7004, P-AUPRO:0.8970
pcb2: I-Auroc:0.9227, I-AP:0.9225, I-F1:0.8762, P-AUROC:0.9516, P-AP:0.4156, P-F1:0.4714, P-AUPRO:0.7904
pcb3: I-Auroc:0.9299, I-AP:0.9334, I-F1:0.8762, P-AUROC:0.9686, P-AP:0.4993, P-F1:0.5366, P-AUPRO:0.8537
pcb4: I-Auroc:0.9941, I-AP:0.9934, I-F1:0.9749, P-AUROC:0.9387, P-AP:0.3107, P-F1:0.3711, P-AUPRO:0.7811
pipe_fryum: I-Auroc:0.9842, I-AP:0.9923, I-F1:0.9596, P-AUROC:0.9851, P-AP:0.4582, P-F1:0.5466, P-AUPRO:0.9677
Mean: I-Auroc:0.9500, I-AP:0.9491, I-F1:0.9131, P-AUROC:0.9736, P-AP:0.4695, P-F1:0.5101, P-AUPRO:0.9079
cuda:3
shots: 2
candle: I-Auroc:0.9533, I-AP:0.9606, I-F1:0.8911, P-AUROC:0.9906, P-AP:0.4627, P-F1:0.5067, P-AUPRO:0.9564
capsules: I-Auroc:0.9767, I-AP:0.9842, I-F1:0.9561, P-AUROC:0.9724, P-AP:0.5940, P-F1:0.6072, P-AUPRO:0.9478
cashew: I-Auroc:0.9648, I-AP:0.9824, I-F1:0.9286, P-AUROC:0.9810, P-AP:0.5163, P-F1:0.5314, P-AUPRO:0.9640
chewinggum: I-Auroc:0.9944, I-AP:0.9973, I-F1:0.9706, P-AUROC:0.9939, P-AP:0.6682, P-F1:0.6743, P-AUPRO:0.9386
fryum: I-Auroc:0.9820, I-AP:0.9921, I-F1:0.9596, P-AUROC:0.9387, P-AP:0.3939, P-F1:0.4329, P-AUPRO:0.9061
macaroni1: I-Auroc:0.9643, I-AP:0.9668, I-F1:0.9151, P-AUROC:0.9954, P-AP:0.3469, P-F1:0.4352, P-AUPRO:0.9570
macaroni2: I-Auroc:0.7767, I-AP:0.7296, I-F1:0.7500, P-AUROC:0.9887, P-AP:0.2306, P-F1:0.3225, P-AUPRO:0.9468
pcb1: I-Auroc:0.9354, I-AP:0.9198, I-F1:0.9300, P-AUROC:0.9887, P-AP:0.7463, P-F1:0.7092, P-AUPRO:0.9075
pcb2: I-Auroc:0.9312, I-AP:0.9262, I-F1:0.8986, P-AUROC:0.9583, P-AP:0.4673, P-F1:0.5180, P-AUPRO:0.8223
pcb3: I-Auroc:0.9488, I-AP:0.9526, I-F1:0.8932, P-AUROC:0.9751, P-AP:0.5114, P-F1:0.5524, P-AUPRO:0.8868
pcb4: I-Auroc:0.9946, I-AP:0.9934, I-F1:0.9802, P-AUROC:0.9532, P-AP:0.3489, P-F1:0.4076, P-AUPRO:0.8293
pipe_fryum: I-Auroc:0.9906, I-AP:0.9955, I-F1:0.9798, P-AUROC:0.9866, P-AP:0.4711, P-F1:0.5707, P-AUPRO:0.9691
Mean: I-Auroc:0.9511, I-AP:0.9500, I-F1:0.9211, P-AUROC:0.9769, P-AP:0.4798, P-F1:0.5224, P-AUPRO:0.9193
cuda:3
shots: 4
candle: I-Auroc:0.9652, I-AP:0.9684, I-F1:0.9184, P-AUROC:0.9920, P-AP:0.4751, P-F1:0.5132, P-AUPRO:0.9546
capsules: I-Auroc:0.9807, I-AP:0.9887, I-F1:0.9608, P-AUROC:0.9782, P-AP:0.6166, P-F1:0.6191, P-AUPRO:0.9582
cashew: I-Auroc:0.9628, I-AP:0.9810, I-F1:0.9302, P-AUROC:0.9835, P-AP:0.5518, P-F1:0.5617, P-AUPRO:0.9570
chewinggum: I-Auroc:0.9962, I-AP:0.9981, I-F1:0.9849, P-AUROC:0.9939, P-AP:0.6516, P-F1:0.6782, P-AUPRO:0.9386
fryum: I-Auroc:0.9818, I-AP:0.9919, I-F1:0.9588, P-AUROC:0.9412, P-AP:0.4009, P-F1:0.4415, P-AUPRO:0.9002
macaroni1: I-Auroc:0.9814, I-AP:0.9829, I-F1:0.9215, P-AUROC:0.9954, P-AP:0.3350, P-F1:0.4281, P-AUPRO:0.9575
macaroni2: I-Auroc:0.8085, I-AP:0.7398, I-F1:0.7881, P-AUROC:0.9916, P-AP:0.2339, P-F1:0.3195, P-AUPRO:0.9570
pcb1: I-Auroc:0.9438, I-AP:0.9390, I-F1:0.9314, P-AUROC:0.9895, P-AP:0.7703, P-F1:0.7213, P-AUPRO:0.9145
pcb2: I-Auroc:0.9372, I-AP:0.9390, I-F1:0.8966, P-AUROC:0.9609, P-AP:0.4985, P-F1:0.5347, P-AUPRO:0.8338
pcb3: I-Auroc:0.9613, I-AP:0.9633, I-F1:0.9163, P-AUROC:0.9807, P-AP:0.5472, P-F1:0.5776, P-AUPRO:0.8964
pcb4: I-Auroc:0.9959, I-AP:0.9952, I-F1:0.9851, P-AUROC:0.9590, P-AP:0.3654, P-F1:0.4180, P-AUPRO:0.8454
pipe_fryum: I-Auroc:0.9954, I-AP:0.9979, I-F1:0.9796, P-AUROC:0.9871, P-AP:0.4765, P-F1:0.5821, P-AUPRO:0.9678
Mean: I-Auroc:0.9592, I-AP:0.9571, I-F1:0.9310, P-AUROC:0.9794, P-AP:0.4936, P-F1:0.5329, P-AUPRO:0.9234




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 7

cuda:3
shots: 1
candle: I-Auroc:0.9626, I-AP:0.9674, I-F1:0.9045, P-AUROC:0.9883, P-AP:0.4544, P-F1:0.5005, P-AUPRO:0.9265
capsules: I-Auroc:0.9673, I-AP:0.9822, I-F1:0.9293, P-AUROC:0.9721, P-AP:0.5438, P-F1:0.5636, P-AUPRO:0.9465
cashew: I-Auroc:0.9682, I-AP:0.9843, I-F1:0.9360, P-AUROC:0.9785, P-AP:0.4773, P-F1:0.4829, P-AUPRO:0.9718
chewinggum: I-Auroc:0.9896, I-AP:0.9951, I-F1:0.9703, P-AUROC:0.9937, P-AP:0.6808, P-F1:0.6886, P-AUPRO:0.9313
fryum: I-Auroc:0.9806, I-AP:0.9912, I-F1:0.9495, P-AUROC:0.9294, P-AP:0.3731, P-F1:0.4084, P-AUPRO:0.8856
macaroni1: I-Auroc:0.7793, I-AP:0.8081, I-F1:0.7309, P-AUROC:0.9878, P-AP:0.2557, P-F1:0.3478, P-AUPRO:0.9320
macaroni2: I-Auroc:0.6062, I-AP:0.5839, I-F1:0.6807, P-AUROC:0.9810, P-AP:0.0817, P-F1:0.1679, P-AUPRO:0.9023
pcb1: I-Auroc:0.8981, I-AP:0.8892, I-F1:0.8462, P-AUROC:0.9865, P-AP:0.6738, P-F1:0.6397, P-AUPRO:0.8999
pcb2: I-Auroc:0.9307, I-AP:0.9372, I-F1:0.8683, P-AUROC:0.9564, P-AP:0.4639, P-F1:0.5170, P-AUPRO:0.8274
pcb3: I-Auroc:0.9310, I-AP:0.9337, I-F1:0.8704, P-AUROC:0.9661, P-AP:0.5045, P-F1:0.5379, P-AUPRO:0.8653
pcb4: I-Auroc:0.9924, I-AP:0.9922, I-F1:0.9600, P-AUROC:0.9417, P-AP:0.3184, P-F1:0.3900, P-AUPRO:0.8025
pipe_fryum: I-Auroc:0.9894, I-AP:0.9949, I-F1:0.9652, P-AUROC:0.9838, P-AP:0.4341, P-F1:0.5304, P-AUPRO:0.9665
Mean: I-Auroc:0.9163, I-AP:0.9216, I-F1:0.8843, P-AUROC:0.9721, P-AP:0.4385, P-F1:0.4812, P-AUPRO:0.9048
cuda:3
shots: 2
candle: I-Auroc:0.9758, I-AP:0.9787, I-F1:0.9271, P-AUROC:0.9906, P-AP:0.4779, P-F1:0.5040, P-AUPRO:0.9424
capsules: I-Auroc:0.9567, I-AP:0.9769, I-F1:0.9319, P-AUROC:0.9760, P-AP:0.5899, P-F1:0.6017, P-AUPRO:0.9326
cashew: I-Auroc:0.9172, I-AP:0.9587, I-F1:0.8932, P-AUROC:0.9812, P-AP:0.5319, P-F1:0.5160, P-AUPRO:0.9523
chewinggum: I-Auroc:0.9952, I-AP:0.9976, I-F1:0.9709, P-AUROC:0.9938, P-AP:0.6720, P-F1:0.6818, P-AUPRO:0.9422
fryum: I-Auroc:0.9846, I-AP:0.9927, I-F1:0.9561, P-AUROC:0.9359, P-AP:0.3913, P-F1:0.4320, P-AUPRO:0.8943
macaroni1: I-Auroc:0.9675, I-AP:0.9686, I-F1:0.9179, P-AUROC:0.9947, P-AP:0.3327, P-F1:0.4283, P-AUPRO:0.9473
macaroni2: I-Auroc:0.8065, I-AP:0.7484, I-F1:0.7654, P-AUROC:0.9901, P-AP:0.2476, P-F1:0.3482, P-AUPRO:0.9433
pcb1: I-Auroc:0.9122, I-AP:0.9012, I-F1:0.8571, P-AUROC:0.9881, P-AP:0.7183, P-F1:0.6792, P-AUPRO:0.8978
pcb2: I-Auroc:0.9344, I-AP:0.9381, I-F1:0.8792, P-AUROC:0.9602, P-AP:0.4820, P-F1:0.5258, P-AUPRO:0.8398
pcb3: I-Auroc:0.9254, I-AP:0.9288, I-F1:0.8664, P-AUROC:0.9694, P-AP:0.5047, P-F1:0.5362, P-AUPRO:0.8665
pcb4: I-Auroc:0.9955, I-AP:0.9955, I-F1:0.9746, P-AUROC:0.9538, P-AP:0.3516, P-F1:0.4112, P-AUPRO:0.8445
pipe_fryum: I-Auroc:0.9880, I-AP:0.9947, I-F1:0.9700, P-AUROC:0.9849, P-AP:0.4492, P-F1:0.5401, P-AUPRO:0.9659
Mean: I-Auroc:0.9466, I-AP:0.9483, I-F1:0.9092, P-AUROC:0.9766, P-AP:0.4791, P-F1:0.5170, P-AUPRO:0.9141
cuda:3
shots: 4
candle: I-Auroc:0.9713, I-AP:0.9733, I-F1:0.9073, P-AUROC:0.9915, P-AP:0.4869, P-F1:0.5037, P-AUPRO:0.9420
capsules: I-Auroc:0.9682, I-AP:0.9836, I-F1:0.9485, P-AUROC:0.9800, P-AP:0.6042, P-F1:0.6081, P-AUPRO:0.9384
cashew: I-Auroc:0.9482, I-AP:0.9743, I-F1:0.9194, P-AUROC:0.9834, P-AP:0.5479, P-F1:0.5377, P-AUPRO:0.9574
chewinggum: I-Auroc:0.9968, I-AP:0.9984, I-F1:0.9849, P-AUROC:0.9935, P-AP:0.6619, P-F1:0.6769, P-AUPRO:0.9368
fryum: I-Auroc:0.9876, I-AP:0.9942, I-F1:0.9543, P-AUROC:0.9367, P-AP:0.3957, P-F1:0.4379, P-AUPRO:0.9005
macaroni1: I-Auroc:0.9799, I-AP:0.9804, I-F1:0.9314, P-AUROC:0.9949, P-AP:0.3450, P-F1:0.4328, P-AUPRO:0.9481
macaroni2: I-Auroc:0.8787, I-AP:0.8693, I-F1:0.8341, P-AUROC:0.9925, P-AP:0.3005, P-F1:0.4218, P-AUPRO:0.9612
pcb1: I-Auroc:0.9378, I-AP:0.9259, I-F1:0.9200, P-AUROC:0.9899, P-AP:0.7639, P-F1:0.7274, P-AUPRO:0.9150
pcb2: I-Auroc:0.9424, I-AP:0.9454, I-F1:0.9072, P-AUROC:0.9637, P-AP:0.5158, P-F1:0.5457, P-AUPRO:0.8580
pcb3: I-Auroc:0.9310, I-AP:0.9290, I-F1:0.8796, P-AUROC:0.9773, P-AP:0.5358, P-F1:0.5511, P-AUPRO:0.8975
pcb4: I-Auroc:0.9966, I-AP:0.9964, I-F1:0.9798, P-AUROC:0.9634, P-AP:0.3709, P-F1:0.4212, P-AUPRO:0.8688
pipe_fryum: I-Auroc:0.9880, I-AP:0.9946, I-F1:0.9600, P-AUROC:0.9863, P-AP:0.4623, P-F1:0.5599, P-AUPRO:0.9650
Mean: I-Auroc:0.9605, I-AP:0.9637, I-F1:0.9272, P-AUROC:0.9794, P-AP:0.4992, P-F1:0.5354, P-AUPRO:0.9241






-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 999

cuda:0
shots: 4
candle: I-Auroc:0.9763, I-AP:0.9787, I-F1:0.9447, P-AUROC:0.9913, P-AP:0.4671, P-F1:0.4921, P-AUPRO:0.9527
capsules: I-Auroc:0.9813, I-AP:0.9895, I-F1:0.9543, P-AUROC:0.9839, P-AP:0.6170, P-F1:0.6176, P-AUPRO:0.9622
cashew: I-Auroc:0.9508, I-AP:0.9759, I-F1:0.9171, P-AUROC:0.9823, P-AP:0.5273, P-F1:0.5342, P-AUPRO:0.9502
chewinggum: I-Auroc:0.9940, I-AP:0.9971, I-F1:0.9746, P-AUROC:0.9933, P-AP:0.6363, P-F1:0.6803, P-AUPRO:0.9347
fryum: I-Auroc:0.9740, I-AP:0.9878, I-F1:0.9312, P-AUROC:0.9354, P-AP:0.3888, P-F1:0.4326, P-AUPRO:0.8909
macaroni1: I-Auroc:0.9689, I-AP:0.9709, I-F1:0.9072, P-AUROC:0.9950, P-AP:0.3347, P-F1:0.4139, P-AUPRO:0.9493
macaroni2: I-Auroc:0.8179, I-AP:0.8222, I-F1:0.7822, P-AUROC:0.9912, P-AP:0.2806, P-F1:0.4034, P-AUPRO:0.9586
pcb1: I-Auroc:0.9381, I-AP:0.9248, I-F1:0.9146, P-AUROC:0.9903, P-AP:0.7682, P-F1:0.7223, P-AUPRO:0.9156
pcb2: I-Auroc:0.9449, I-AP:0.9393, I-F1:0.9118, P-AUROC:0.9624, P-AP:0.4987, P-F1:0.5377, P-AUPRO:0.8457
pcb3: I-Auroc:0.9568, I-AP:0.9587, I-F1:0.8889, P-AUROC:0.9814, P-AP:0.5470, P-F1:0.5804, P-AUPRO:0.9025
pcb4: I-Auroc:0.9968, I-AP:0.9965, I-F1:0.9802, P-AUROC:0.9589, P-AP:0.3707, P-F1:0.4236, P-AUPRO:0.8530
pipe_fryum: I-Auroc:0.9808, I-AP:0.9905, I-F1:0.9600, P-AUROC:0.9871, P-AP:0.4900, P-F1:0.5726, P-AUPRO:0.9577
Mean: I-Auroc:0.9567, I-AP:0.9610, I-F1:0.9222, P-AUROC:0.9794, P-AP:0.4939, P-F1:0.5342, P-AUPRO:0.9228
cuda:0
shots: 2
candle: I-Auroc:0.9717, I-AP:0.9739, I-F1:0.9154, P-AUROC:0.9900, P-AP:0.4521, P-F1:0.4860, P-AUPRO:0.9497
capsules: I-Auroc:0.9762, I-AP:0.9869, I-F1:0.9495, P-AUROC:0.9779, P-AP:0.6007, P-F1:0.6075, P-AUPRO:0.9513
cashew: I-Auroc:0.9386, I-AP:0.9710, I-F1:0.9126, P-AUROC:0.9800, P-AP:0.5084, P-F1:0.5144, P-AUPRO:0.9612
chewinggum: I-Auroc:0.9906, I-AP:0.9956, I-F1:0.9694, P-AUROC:0.9930, P-AP:0.6262, P-F1:0.6768, P-AUPRO:0.9295
fryum: I-Auroc:0.9884, I-AP:0.9942, I-F1:0.9706, P-AUROC:0.9255, P-AP:0.3696, P-F1:0.4148, P-AUPRO:0.8847
macaroni1: I-Auroc:0.9060, I-AP:0.9147, I-F1:0.8235, P-AUROC:0.9939, P-AP:0.3146, P-F1:0.3912, P-AUPRO:0.9509
macaroni2: I-Auroc:0.7827, I-AP:0.7988, I-F1:0.7296, P-AUROC:0.9886, P-AP:0.2435, P-F1:0.3559, P-AUPRO:0.9400
pcb1: I-Auroc:0.9379, I-AP:0.9236, I-F1:0.9010, P-AUROC:0.9890, P-AP:0.7391, P-F1:0.6975, P-AUPRO:0.9022
pcb2: I-Auroc:0.9300, I-AP:0.9325, I-F1:0.8720, P-AUROC:0.9587, P-AP:0.4914, P-F1:0.5303, P-AUPRO:0.8372
pcb3: I-Auroc:0.8832, I-AP:0.9060, I-F1:0.7956, P-AUROC:0.9745, P-AP:0.4339, P-F1:0.4935, P-AUPRO:0.8834
pcb4: I-Auroc:0.9962, I-AP:0.9958, I-F1:0.9802, P-AUROC:0.9527, P-AP:0.3501, P-F1:0.4069, P-AUPRO:0.8311
pipe_fryum: I-Auroc:0.9842, I-AP:0.9926, I-F1:0.9655, P-AUROC:0.9859, P-AP:0.4713, P-F1:0.5552, P-AUPRO:0.9610
Mean: I-Auroc:0.9405, I-AP:0.9488, I-F1:0.8987, P-AUROC:0.9758, P-AP:0.4667, P-F1:0.5108, P-AUPRO:0.9152
cuda:0
shots: 1
candle: I-Auroc:0.9709, I-AP:0.9753, I-F1:0.9128, P-AUROC:0.9898, P-AP:0.4527, P-F1:0.5025, P-AUPRO:0.9506
capsules: I-Auroc:0.9717, I-AP:0.9841, I-F1:0.9417, P-AUROC:0.9718, P-AP:0.5259, P-F1:0.5526, P-AUPRO:0.9573
cashew: I-Auroc:0.9216, I-AP:0.9616, I-F1:0.9014, P-AUROC:0.9789, P-AP:0.5070, P-F1:0.5050, P-AUPRO:0.9524
chewinggum: I-Auroc:0.9920, I-AP:0.9963, I-F1:0.9697, P-AUROC:0.9929, P-AP:0.6552, P-F1:0.6865, P-AUPRO:0.9262
fryum: I-Auroc:0.9882, I-AP:0.9941, I-F1:0.9615, P-AUROC:0.9254, P-AP:0.3678, P-F1:0.4106, P-AUPRO:0.8880
macaroni1: I-Auroc:0.9577, I-AP:0.9622, I-F1:0.8945, P-AUROC:0.9943, P-AP:0.3504, P-F1:0.4275, P-AUPRO:0.9538
macaroni2: I-Auroc:0.6845, I-AP:0.6984, I-F1:0.6857, P-AUROC:0.9845, P-AP:0.1398, P-F1:0.2552, P-AUPRO:0.9174
pcb1: I-Auroc:0.9415, I-AP:0.9270, I-F1:0.9100, P-AUROC:0.9861, P-AP:0.7031, P-F1:0.6671, P-AUPRO:0.8871
pcb2: I-Auroc:0.9129, I-AP:0.9196, I-F1:0.8601, P-AUROC:0.9539, P-AP:0.4515, P-F1:0.5082, P-AUPRO:0.8153
pcb3: I-Auroc:0.8835, I-AP:0.9119, I-F1:0.8108, P-AUROC:0.9676, P-AP:0.4228, P-F1:0.4837, P-AUPRO:0.8672
pcb4: I-Auroc:0.9958, I-AP:0.9954, I-F1:0.9800, P-AUROC:0.9439, P-AP:0.3205, P-F1:0.3822, P-AUPRO:0.8098
pipe_fryum: I-Auroc:0.9940, I-AP:0.9971, I-F1:0.9800, P-AUROC:0.9862, P-AP:0.4683, P-F1:0.5621, P-AUPRO:0.9645
Mean: I-Auroc:0.9345, I-AP:0.9436, I-F1:0.9007, P-AUROC:0.9729, P-AP:0.4471, P-F1:0.4953, P-AUPRO:0.9075




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 3

cuda:0
shots: 4
candle: I-Auroc:0.9799, I-AP:0.9823, I-F1:0.9326, P-AUROC:0.9912, P-AP:0.4726, P-F1:0.5055, P-AUPRO:0.9538
capsules: I-Auroc:0.9735, I-AP:0.9848, I-F1:0.9500, P-AUROC:0.9837, P-AP:0.6350, P-F1:0.6446, P-AUPRO:0.9561
cashew: I-Auroc:0.9616, I-AP:0.9813, I-F1:0.9378, P-AUROC:0.9827, P-AP:0.5616, P-F1:0.5571, P-AUPRO:0.9549
chewinggum: I-Auroc:0.9954, I-AP:0.9978, I-F1:0.9756, P-AUROC:0.9935, P-AP:0.6304, P-F1:0.6750, P-AUPRO:0.9336
fryum: I-Auroc:0.9694, I-AP:0.9864, I-F1:0.9319, P-AUROC:0.9371, P-AP:0.3959, P-F1:0.4349, P-AUPRO:0.8970
macaroni1: I-Auroc:0.9603, I-AP:0.9626, I-F1:0.8976, P-AUROC:0.9951, P-AP:0.3434, P-F1:0.4385, P-AUPRO:0.9550
macaroni2: I-Auroc:0.8178, I-AP:0.7523, I-F1:0.7895, P-AUROC:0.9920, P-AP:0.2218, P-F1:0.3188, P-AUPRO:0.9486
pcb1: I-Auroc:0.9470, I-AP:0.9255, I-F1:0.9300, P-AUROC:0.9883, P-AP:0.7508, P-F1:0.7135, P-AUPRO:0.8962
pcb2: I-Auroc:0.9420, I-AP:0.9447, I-F1:0.8911, P-AUROC:0.9621, P-AP:0.5044, P-F1:0.5411, P-AUPRO:0.8438
pcb3: I-Auroc:0.9762, I-AP:0.9795, I-F1:0.9400, P-AUROC:0.9791, P-AP:0.5407, P-F1:0.5851, P-AUPRO:0.8874
pcb4: I-Auroc:0.9948, I-AP:0.9937, I-F1:0.9849, P-AUROC:0.9592, P-AP:0.3467, P-F1:0.4044, P-AUPRO:0.8577
pipe_fryum: I-Auroc:0.9844, I-AP:0.9921, I-F1:0.9703, P-AUROC:0.9866, P-AP:0.4685, P-F1:0.5632, P-AUPRO:0.9683
Mean: I-Auroc:0.9585, I-AP:0.9569, I-F1:0.9276, P-AUROC:0.9792, P-AP:0.4893, P-F1:0.5318, P-AUPRO:0.9210
cuda:0
shots: 2
candle: I-Auroc:0.9725, I-AP:0.9755, I-F1:0.9394, P-AUROC:0.9908, P-AP:0.4707, P-F1:0.5025, P-AUPRO:0.9500
capsules: I-Auroc:0.9725, I-AP:0.9840, I-F1:0.9458, P-AUROC:0.9809, P-AP:0.6313, P-F1:0.6462, P-AUPRO:0.9582
cashew: I-Auroc:0.9462, I-AP:0.9743, I-F1:0.9163, P-AUROC:0.9807, P-AP:0.5468, P-F1:0.5450, P-AUPRO:0.9520
chewinggum: I-Auroc:0.9936, I-AP:0.9969, I-F1:0.9697, P-AUROC:0.9935, P-AP:0.6262, P-F1:0.6740, P-AUPRO:0.9341
fryum: I-Auroc:0.9672, I-AP:0.9861, I-F1:0.9388, P-AUROC:0.9347, P-AP:0.3874, P-F1:0.4259, P-AUPRO:0.8916
macaroni1: I-Auroc:0.9648, I-AP:0.9668, I-F1:0.8962, P-AUROC:0.9939, P-AP:0.3670, P-F1:0.4464, P-AUPRO:0.9459
macaroni2: I-Auroc:0.8057, I-AP:0.7479, I-F1:0.7753, P-AUROC:0.9916, P-AP:0.2117, P-F1:0.3141, P-AUPRO:0.9521
pcb1: I-Auroc:0.9472, I-AP:0.9231, I-F1:0.9314, P-AUROC:0.9864, P-AP:0.7332, P-F1:0.7024, P-AUPRO:0.8940
pcb2: I-Auroc:0.9238, I-AP:0.9261, I-F1:0.8557, P-AUROC:0.9576, P-AP:0.4717, P-F1:0.5133, P-AUPRO:0.8338
pcb3: I-Auroc:0.9565, I-AP:0.9621, I-F1:0.8976, P-AUROC:0.9722, P-AP:0.4994, P-F1:0.5556, P-AUPRO:0.8703
pcb4: I-Auroc:0.9957, I-AP:0.9952, I-F1:0.9800, P-AUROC:0.9522, P-AP:0.3403, P-F1:0.3997, P-AUPRO:0.8383
pipe_fryum: I-Auroc:0.9808, I-AP:0.9904, I-F1:0.9703, P-AUROC:0.9868, P-AP:0.4728, P-F1:0.5650, P-AUPRO:0.9661
Mean: I-Auroc:0.9522, I-AP:0.9524, I-F1:0.9180, P-AUROC:0.9768, P-AP:0.4799, P-F1:0.5242, P-AUPRO:0.9155
cuda:0
shots: 1
candle: I-Auroc:0.9657, I-AP:0.9706, I-F1:0.9175, P-AUROC:0.9895, P-AP:0.4444, P-F1:0.4841, P-AUPRO:0.9518
capsules: I-Auroc:0.9648, I-AP:0.9795, I-F1:0.9400, P-AUROC:0.9760, P-AP:0.5780, P-F1:0.5995, P-AUPRO:0.9441
cashew: I-Auroc:0.9110, I-AP:0.9569, I-F1:0.8942, P-AUROC:0.9759, P-AP:0.5077, P-F1:0.5155, P-AUPRO:0.9358
chewinggum: I-Auroc:0.9902, I-AP:0.9956, I-F1:0.9648, P-AUROC:0.9937, P-AP:0.6593, P-F1:0.6930, P-AUPRO:0.9369
fryum: I-Auroc:0.9664, I-AP:0.9847, I-F1:0.9333, P-AUROC:0.9292, P-AP:0.3699, P-F1:0.4088, P-AUPRO:0.8944
macaroni1: I-Auroc:0.9253, I-AP:0.9331, I-F1:0.8458, P-AUROC:0.9927, P-AP:0.3600, P-F1:0.4326, P-AUPRO:0.9421
macaroni2: I-Auroc:0.8244, I-AP:0.8103, I-F1:0.7826, P-AUROC:0.9915, P-AP:0.2804, P-F1:0.3834, P-AUPRO:0.9535
pcb1: I-Auroc:0.9548, I-AP:0.9339, I-F1:0.9372, P-AUROC:0.9856, P-AP:0.7124, P-F1:0.6823, P-AUPRO:0.8911
pcb2: I-Auroc:0.9165, I-AP:0.9214, I-F1:0.8643, P-AUROC:0.9534, P-AP:0.4591, P-F1:0.5086, P-AUPRO:0.8044
pcb3: I-Auroc:0.8101, I-AP:0.8529, I-F1:0.7396, P-AUROC:0.9600, P-AP:0.3187, P-F1:0.3966, P-AUPRO:0.8136
pcb4: I-Auroc:0.9933, I-AP:0.9921, I-F1:0.9746, P-AUROC:0.9409, P-AP:0.2914, P-F1:0.3552, P-AUPRO:0.7975
pipe_fryum: I-Auroc:0.9850, I-AP:0.9926, I-F1:0.9655, P-AUROC:0.9855, P-AP:0.4519, P-F1:0.5399, P-AUPRO:0.9697
Mean: I-Auroc:0.9340, I-AP:0.9436, I-F1:0.8966, P-AUROC:0.9728, P-AP:0.4528, P-F1:0.4999, P-AUPRO:0.9029




-------------------------------------------------------------------------------------------------------------------------------------
transforms.Normalize(mean=mean_train, std=std_train),
...
augmented_image = torch.flip(augmented_image, dims=[-2])
anomaly_map_aug1 = model(img_aug1, supports_aug1, memorize_supports, use_memory, aug=1)
anomaly_map_aug1 = torch.flip(anomaly_map_aug1, dims=[-2])  # 沿着高度翻转回来

value = value.clamp(min=0)
anomaly_map_aug2 = model(img_aug2, supports_aug2, memorize_supports, use_memory, aug=2) 

anomaly_map = anomaly_map_ori + anomaly_map_aug1 + anomaly_map_aug2
三次旋转  -------->   idea加上去的最终版本

更换 Backbone 为 dinov2reg_vit_large_14，结果如下：

--seed 3407

cuda:0
shots: 4
candle: I-Auroc:0.9776, I-AP:0.9802, I-F1:0.9360, P-AUROC:0.9918, P-AP:0.4675, P-F1:0.5021, P-AUPRO:0.9521
capsules: I-Auroc:0.9675, I-AP:0.9818, I-F1:0.9515, P-AUROC:0.9817, P-AP:0.6003, P-F1:0.6039, P-AUPRO:0.9632
cashew: I-Auroc:0.9610, I-AP:0.9802, I-F1:0.9340, P-AUROC:0.9830, P-AP:0.5459, P-F1:0.5293, P-AUPRO:0.9583
chewinggum: I-Auroc:0.9950, I-AP:0.9976, I-F1:0.9746, P-AUROC:0.9942, P-AP:0.6388, P-F1:0.6795, P-AUPRO:0.9439
fryum: I-Auroc:0.9750, I-AP:0.9885, I-F1:0.9400, P-AUROC:0.9370, P-AP:0.3944, P-F1:0.4304, P-AUPRO:0.8997
macaroni1: I-Auroc:0.9608, I-AP:0.9631, I-F1:0.8990, P-AUROC:0.9949, P-AP:0.3431, P-F1:0.4300, P-AUPRO:0.9447
macaroni2: I-Auroc:0.7832, I-AP:0.7304, I-F1:0.7699, P-AUROC:0.9921, P-AP:0.2186, P-F1:0.3252, P-AUPRO:0.9592
pcb1: I-Auroc:0.9400, I-AP:0.9267, I-F1:0.9010, P-AUROC:0.9899, P-AP:0.7401, P-F1:0.6995, P-AUPRO:0.9107
pcb2: I-Auroc:0.9537, I-AP:0.9596, I-F1:0.9055, P-AUROC:0.9647, P-AP:0.5162, P-F1:0.5453, P-AUPRO:0.8596
pcb3: I-Auroc:0.9719, I-AP:0.9722, I-F1:0.9100, P-AUROC:0.9787, P-AP:0.5430, P-F1:0.5750, P-AUPRO:0.9057
pcb4: I-Auroc:0.9963, I-AP:0.9960, I-F1:0.9800, P-AUROC:0.9622, P-AP:0.3737, P-F1:0.4191, P-AUPRO:0.8704
pipe_fryum: I-Auroc:0.9812, I-AP:0.9906, I-F1:0.9700, P-AUROC:0.9868, P-AP:0.4830, P-F1:0.5667, P-AUPRO:0.9644
Mean: I-Auroc:0.9553, I-AP:0.9556, I-F1:0.9226, P-AUROC:0.9798, P-AP:0.4887, P-F1:0.5255, P-AUPRO:0.9277
cuda:0
shots: 2
candle: I-Auroc:0.9601, I-AP:0.9679, I-F1:0.9032, P-AUROC:0.9911, P-AP:0.4727, P-F1:0.5114, P-AUPRO:0.9461
capsules: I-Auroc:0.9705, I-AP:0.9841, I-F1:0.9557, P-AUROC:0.9787, P-AP:0.5975, P-F1:0.6053, P-AUPRO:0.9475
cashew: I-Auroc:0.9738, I-AP:0.9859, I-F1:0.9552, P-AUROC:0.9805, P-AP:0.5249, P-F1:0.5127, P-AUPRO:0.9683
chewinggum: I-Auroc:0.9952, I-AP:0.9977, I-F1:0.9749, P-AUROC:0.9946, P-AP:0.6301, P-F1:0.6746, P-AUPRO:0.9451
fryum: I-Auroc:0.9674, I-AP:0.9851, I-F1:0.9239, P-AUROC:0.9331, P-AP:0.3826, P-F1:0.4185, P-AUPRO:0.8917
macaroni1: I-Auroc:0.9684, I-AP:0.9705, I-F1:0.9073, P-AUROC:0.9949, P-AP:0.3341, P-F1:0.4331, P-AUPRO:0.9492
macaroni2: I-Auroc:0.7829, I-AP:0.7328, I-F1:0.7565, P-AUROC:0.9911, P-AP:0.2202, P-F1:0.3347, P-AUPRO:0.9481
pcb1: I-Auroc:0.9320, I-AP:0.9223, I-F1:0.8912, P-AUROC:0.9870, P-AP:0.7261, P-F1:0.6875, P-AUPRO:0.8929
pcb2: I-Auroc:0.9289, I-AP:0.9226, I-F1:0.8700, P-AUROC:0.9600, P-AP:0.4583, P-F1:0.5122, P-AUPRO:0.8449
pcb3: I-Auroc:0.9552, I-AP:0.9599, I-F1:0.8945, P-AUROC:0.9750, P-AP:0.5248, P-F1:0.5615, P-AUPRO:0.9090
pcb4: I-Auroc:0.9956, I-AP:0.9948, I-F1:0.9804, P-AUROC:0.9546, P-AP:0.3553, P-F1:0.4045, P-AUPRO:0.8427
pipe_fryum: I-Auroc:0.9802, I-AP:0.9905, I-F1:0.9557, P-AUROC:0.9849, P-AP:0.4484, P-F1:0.5424, P-AUPRO:0.9672
Mean: I-Auroc:0.9509, I-AP:0.9512, I-F1:0.9140, P-AUROC:0.9771, P-AP:0.4729, P-F1:0.5165, P-AUPRO:0.9211
cuda:0
shots: 1
candle: I-Auroc:0.9569, I-AP:0.9663, I-F1:0.9062, P-AUROC:0.9889, P-AP:0.4644, P-F1:0.5103, P-AUPRO:0.9411
capsules: I-Auroc:0.9693, I-AP:0.9827, I-F1:0.9515, P-AUROC:0.9762, P-AP:0.5832, P-F1:0.6021, P-AUPRO:0.9443
cashew: I-Auroc:0.9682, I-AP:0.9843, I-F1:0.9360, P-AUROC:0.9785, P-AP:0.4773, P-F1:0.4829, P-AUPRO:0.9718
chewinggum: I-Auroc:0.9964, I-AP:0.9982, I-F1:0.9751, P-AUROC:0.9946, P-AP:0.6261, P-F1:0.6713, P-AUPRO:0.9484
fryum: I-Auroc:0.9806, I-AP:0.9912, I-F1:0.9495, P-AUROC:0.9294, P-AP:0.3731, P-F1:0.4084, P-AUPRO:0.8856
macaroni1: I-Auroc:0.9745, I-AP:0.9744, I-F1:0.9293, P-AUROC:0.9938, P-AP:0.3252, P-F1:0.4254, P-AUPRO:0.9401
macaroni2: I-Auroc:0.7209, I-AP:0.6732, I-F1:0.7333, P-AUROC:0.9860, P-AP:0.1836, P-F1:0.3049, P-AUPRO:0.9320
pcb1: I-Auroc:0.9171, I-AP:0.9108, I-F1:0.8673, P-AUROC:0.9839, P-AP:0.6825, P-F1:0.6512, P-AUPRO:0.8770
pcb2: I-Auroc:0.9412, I-AP:0.9393, I-F1:0.8986, P-AUROC:0.9528, P-AP:0.4499, P-F1:0.5027, P-AUPRO:0.7893
pcb3: I-Auroc:0.9559, I-AP:0.9600, I-F1:0.8934, P-AUROC:0.9739, P-AP:0.5108, P-F1:0.5551, P-AUPRO:0.8975
pcb4: I-Auroc:0.9957, I-AP:0.9951, I-F1:0.9851, P-AUROC:0.9450, P-AP:0.3390, P-F1:0.3961, P-AUPRO:0.8181
pipe_fryum: I-Auroc:0.9894, I-AP:0.9949, I-F1:0.9652, P-AUROC:0.9838, P-AP:0.4341, P-F1:0.5304, P-AUPRO:0.9665
Mean: I-Auroc:0.9472, I-AP:0.9476, I-F1:0.9159, P-AUROC:0.9739, P-AP:0.4541, P-F1:0.5034, P-AUPRO:0.9093
